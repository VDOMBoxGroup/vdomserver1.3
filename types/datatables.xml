<?xml version="1.0" encoding="utf-8"?><Type>
	<Information>
		<Name>datatables</Name>
		<DisplayName>#Lang(001)</DisplayName>
		<Description>#Lang(002)</Description>
		<ClassName>VDOM_datatables</ClassName>
		<ID>9fd5cc88-e1a2-48a5-8328-df1368c8e44b</ID>
		<Icon>#Res(d3e6612f-b2a2-ee88-7419-af3e7cdc6016)</Icon>
		<EditorIcon>#Res(6d804848-fc36-8b66-2fc7-3a2de7ec897b)</EditorIcon>
		<StructureIcon>#Res(e5017294-a4b6-df2c-3ed1-f458cc6f43a0)</StructureIcon>
		<Moveable>1</Moveable>
		<Resizable>3</Resizable>
		<Category>Standard</Category>
		<Container>1</Container>
		<Dynamic>1</Dynamic>
		<Version>1</Version>
		<InterfaceType>1</InterfaceType>
		<OptimizationPriority>1</OptimizationPriority>
		<Containers>htmlcontainer,dialog,container,tablecell</Containers>
		<Languages>en_US, ru_RU, fr_FR</Languages>
	</Information>
	<Attributes>
		<Attribute>
			<Name>hierarchy</Name>
			<DisplayName>#Lang(101)</DisplayName>
			<DefaultValue>0</DefaultValue>
			<RegularExpressionValidation>^\d{1,2}$</RegularExpressionValidation>
			<ErrorValidationMessage>#Lang(201)</ErrorValidationMessage>
			<Visible>1</Visible>
			<Help>#Lang(301)</Help>
			<InterfaceType>0</InterfaceType>
			<CodeInterface>TextField(2)</CodeInterface>
			<Colorgroup>1</Colorgroup>
		</Attribute>
		<Attribute>
			<Name>visible</Name>
			<DisplayName>#Lang(102)</DisplayName>
			<DefaultValue>0</DefaultValue>
			<RegularExpressionValidation>^[01]$</RegularExpressionValidation>
			<ErrorValidationMessage>#Lang(202)</ErrorValidationMessage>
			<Visible>1</Visible>
			<Help>#Lang(302)</Help>
			<InterfaceType>0</InterfaceType>
			<CodeInterface>DropDown((#Lang(401)|0)|(#Lang(402)|1))</CodeInterface>
			<Colorgroup>1</Colorgroup>
		</Attribute>
		<Attribute>
			<Name>zindex</Name>
			<DisplayName>#Lang(103)</DisplayName>
			<DefaultValue>0</DefaultValue>
			<RegularExpressionValidation>^\d{1,2}$</RegularExpressionValidation>
			<ErrorValidationMessage>#Lang(203)</ErrorValidationMessage>
			<Visible>1</Visible>
			<Help>#Lang(303)</Help>
			<InterfaceType>0</InterfaceType>
			<CodeInterface>TextField(2)</CodeInterface>
			<Colorgroup>1</Colorgroup>
		</Attribute>
		<Attribute>
			<Name>top</Name>
			<DisplayName>#Lang(104)</DisplayName>
			<DefaultValue>0</DefaultValue>
			<RegularExpressionValidation>^\d{1,4}$</RegularExpressionValidation>
			<ErrorValidationMessage>#Lang(204)</ErrorValidationMessage>
			<Visible>1</Visible>
			<Help>#Lang(304)</Help>
			<InterfaceType>0</InterfaceType>
			<CodeInterface>TextField(4)</CodeInterface>
			<Colorgroup>1</Colorgroup>
		</Attribute>
		<Attribute>
			<Name>left</Name>
			<DisplayName>#Lang(105)</DisplayName>
			<DefaultValue>0</DefaultValue>
			<RegularExpressionValidation>^\d{1,4}$</RegularExpressionValidation>
			<ErrorValidationMessage>#Lang(205)</ErrorValidationMessage>
			<Visible>1</Visible>
			<Help>#Lang(305)</Help>
			<InterfaceType>0</InterfaceType>
			<CodeInterface>TextField(4)</CodeInterface>
			<Colorgroup>1</Colorgroup>
		</Attribute>
		<Attribute>
			<Name>width</Name>
			<DisplayName>#Lang(106)</DisplayName>
			<DefaultValue>50</DefaultValue>
			<RegularExpressionValidation>^\d{1,4}$</RegularExpressionValidation>
			<ErrorValidationMessage>#Lang(206)</ErrorValidationMessage>
			<Visible>1</Visible>
			<Help>#Lang(306)</Help>
			<InterfaceType>0</InterfaceType>
			<CodeInterface>TextField(4)</CodeInterface>
			<Colorgroup>1</Colorgroup>
		</Attribute>
		<Attribute>
			<Name>height</Name>
			<DisplayName>#Lang(107)</DisplayName>
			<DefaultValue>50</DefaultValue>
			<RegularExpressionValidation>^\d{1,4}$</RegularExpressionValidation>
			<ErrorValidationMessage>#Lang(207)</ErrorValidationMessage>
			<Visible>1</Visible>
			<Help>#Lang(307)</Help>
			<InterfaceType>0</InterfaceType>
			<CodeInterface>TextField(4)</CodeInterface>
			<Colorgroup>1</Colorgroup>
		</Attribute>
		<Attribute>
			<Name>method</Name>
			<DisplayName>#Lang(142)</DisplayName>
			<DefaultValue>post</DefaultValue>
			<RegularExpressionValidation>.*</RegularExpressionValidation>
			<ErrorValidationMessage>#Lang(212)</ErrorValidationMessage>
			<Visible>1</Visible>
			<Help>#Lang(315)</Help>
			<InterfaceType>3</InterfaceType>
			<CodeInterface>DropDown((#Lang(407)|post)|(#Lang(408)|event))</CodeInterface>
			<Colorgroup>2</Colorgroup>
		</Attribute>
		<Attribute>
			<Name>target</Name>
			<DisplayName>#Lang(131)</DisplayName>
			<DefaultValue/>
			<RegularExpressionValidation>.*</RegularExpressionValidation>
			<ErrorValidationMessage>#Lang(208)</ErrorValidationMessage>
			<Visible>1</Visible>
			<Help>#Lang(308)</Help>
			<InterfaceType>0</InterfaceType>
			<CodeInterface>PageLink()</CodeInterface>
			<Colorgroup>2</Colorgroup>
		</Attribute>
		<Attribute>
			<Name>tableheader</Name>
			<DisplayName>#Lang(123)</DisplayName>
			<DefaultValue />
			<RegularExpressionValidation>.*</RegularExpressionValidation>
			<ErrorValidationMessage>#Lang(211)</ErrorValidationMessage>
			<Visible>1</Visible>
			<Help>#Lang(315)</Help>
			<InterfaceType>3</InterfaceType>
			<CodeInterface>MultiLine(10000)</CodeInterface>
			<Colorgroup>2</Colorgroup>
		</Attribute>
		<Attribute>
			<Name>htmlcode</Name>
			<DisplayName>#Lang(114)</DisplayName>
			<DefaultValue />
			<RegularExpressionValidation>.*</RegularExpressionValidation>
			<ErrorValidationMessage>#Lang(211)</ErrorValidationMessage>
			<Visible>1</Visible>
			<Help>#Lang(315)</Help>
			<InterfaceType>3</InterfaceType>
			<CodeInterface>MultiLine(10000)</CodeInterface>
			<Colorgroup>2</Colorgroup>
		</Attribute>
		<Attribute>
			<Name>tablekey</Name>
			<DisplayName>#Lang(125)</DisplayName>
			<DefaultValue />
			<RegularExpressionValidation>.*</RegularExpressionValidation>
			<ErrorValidationMessage>#Lang(211)</ErrorValidationMessage>
			<Visible>1</Visible>
			<Help>#Lang(315)</Help>
			<InterfaceType>3</InterfaceType>
			<CodeInterface>TextField(15)</CodeInterface>
			<Colorgroup>2</Colorgroup>
		</Attribute>
		<Attribute>
			<Name>hiddenfields</Name>
			<DisplayName>#Lang(132)</DisplayName>
			<DefaultValue><![CDATA[{}]]></DefaultValue>
			<RegularExpressionValidation>.*</RegularExpressionValidation>
			<ErrorValidationMessage>#Lang(211)</ErrorValidationMessage>
			<Visible>1</Visible>
			<Help>#Lang(315)</Help>
			<InterfaceType>3</InterfaceType>
			<CodeInterface>TextField(100)</CodeInterface>
			<Colorgroup>2</Colorgroup>
		</Attribute>
		<Attribute>
			<Name>showsearch</Name>
			<DisplayName>#Lang(115)</DisplayName>
			<DefaultValue>0</DefaultValue>
			<RegularExpressionValidation>^[01]$</RegularExpressionValidation>
			<ErrorValidationMessage>#Lang(211)</ErrorValidationMessage>
			<Visible>1</Visible>
			<Help>#Lang(315)</Help>
			<InterfaceType>0</InterfaceType>
			<CodeInterface>DropDown((#Lang(403)|0)|(#Lang(404)|1))</CodeInterface>
			<Colorgroup>2</Colorgroup>
		</Attribute>
		<Attribute>
			<Name>showinformation</Name>
			<DisplayName>#Lang(116)</DisplayName>
			<DefaultValue>0</DefaultValue>
			<RegularExpressionValidation>^[01]$</RegularExpressionValidation>
			<ErrorValidationMessage>#Lang(211)</ErrorValidationMessage>
			<Visible>1</Visible>
			<Help>#Lang(315)</Help>
			<InterfaceType>0</InterfaceType>
			<CodeInterface>DropDown((#Lang(403)|0)|(#Lang(404)|1))</CodeInterface>
			<Colorgroup>2</Colorgroup>
		</Attribute>
		<Attribute>
			<Name>showlength</Name>
			<DisplayName>#Lang(117)</DisplayName>
			<DefaultValue>0</DefaultValue>
			<RegularExpressionValidation>^[01]$</RegularExpressionValidation>
			<ErrorValidationMessage>#Lang(211)</ErrorValidationMessage>
			<Visible>0</Visible>
			<Help>#Lang(315)</Help>
			<InterfaceType>0</InterfaceType>
			<CodeInterface>DropDown((#Lang(403)|0)|(#Lang(404)|1))</CodeInterface>
			<Colorgroup>2</Colorgroup>
		</Attribute>
		<Attribute>
			<Name>multiselect</Name>
			<DisplayName>#Lang(133)</DisplayName>
			<DefaultValue>1</DefaultValue>
			<RegularExpressionValidation>^[01]$</RegularExpressionValidation>
			<ErrorValidationMessage>#Lang(211)</ErrorValidationMessage>
			<Visible>1</Visible>
			<Help>#Lang(315)</Help>
			<InterfaceType>0</InterfaceType>
			<CodeInterface>DropDown((#Lang(405)|1)|(#Lang(406)|0))</CodeInterface>
			<Colorgroup>2</Colorgroup>
		</Attribute>
		<Attribute>
			<Name>lengthtext</Name>
			<DisplayName>#Lang(126)</DisplayName>
			<DefaultValue><![CDATA[Display _MENU_ records per page]]></DefaultValue> 
			<RegularExpressionValidation>.*</RegularExpressionValidation>
			<ErrorValidationMessage>#Lang(211)</ErrorValidationMessage>
			<Visible>1</Visible>
			<Help>#Lang(315)</Help>
			<InterfaceType>3</InterfaceType>
			<CodeInterface>TextField(100)</CodeInterface>
			<Colorgroup>2</Colorgroup>
		</Attribute>
		<Attribute>
			<Name>zerorecords</Name>
			<DisplayName>#Lang(127)</DisplayName>
			<DefaultValue><![CDATA[Nothing found - sorry]]></DefaultValue> 
			<RegularExpressionValidation>.*</RegularExpressionValidation>
			<ErrorValidationMessage>#Lang(211)</ErrorValidationMessage>
			<Visible>1</Visible>
			<Help>#Lang(315)</Help>
			<InterfaceType>3</InterfaceType>
			<CodeInterface>TextField(100)</CodeInterface>
			<Colorgroup>2</Colorgroup>
		</Attribute>
		<Attribute>
			<Name>information</Name>
			<DisplayName>#Lang(128)</DisplayName>
			<DefaultValue><![CDATA[Showing _START_ to _END_ of _TOTAL_ records]]></DefaultValue> 
			<RegularExpressionValidation>.*</RegularExpressionValidation>
			<ErrorValidationMessage>#Lang(211)</ErrorValidationMessage>
			<Visible>1</Visible>
			<Help>#Lang(315)</Help>
			<InterfaceType>3</InterfaceType>
			<CodeInterface>TextField(100)</CodeInterface>
			<Colorgroup>2</Colorgroup>
		</Attribute>
		<Attribute>
			<Name>infoempty</Name>
			<DisplayName>#Lang(129)</DisplayName>
			<DefaultValue><![CDATA[Showing 0 to 0 of 0 records]]></DefaultValue>
			<RegularExpressionValidation>.*</RegularExpressionValidation>
			<ErrorValidationMessage>#Lang(211)</ErrorValidationMessage>
			<Visible>1</Visible>
			<Help>#Lang(315)</Help>
			<InterfaceType>3</InterfaceType>
			<CodeInterface>TextField(100)</CodeInterface>
			<Colorgroup>2</Colorgroup>
		</Attribute>
		<Attribute>
			<Name>infofiltred</Name>
			<DisplayName>#Lang(130)</DisplayName>
			<DefaultValue><![CDATA[(filtered from _MAX_ total records)]]></DefaultValue>
			<RegularExpressionValidation>.*</RegularExpressionValidation>
			<ErrorValidationMessage>#Lang(211)</ErrorValidationMessage>
			<Visible>1</Visible>
			<Help>#Lang(315)</Help>
			<InterfaceType>3</InterfaceType>
			<CodeInterface>TextField(100)</CodeInterface>
			<Colorgroup>2</Colorgroup>
		</Attribute>
		<Attribute>
			<Name>selected_css</Name>
			<DisplayName>#Lang(135)</DisplayName>
			<DefaultValue><![CDATA[]]></DefaultValue>
			<RegularExpressionValidation>.*</RegularExpressionValidation>
			<ErrorValidationMessage>#Lang(211)</ErrorValidationMessage>
			<Visible>1</Visible>
			<Help>#Lang(315)</Help>
			<InterfaceType>3</InterfaceType>
			<CodeInterface>MultiLine(10000)</CodeInterface>
			<Colorgroup>2</Colorgroup>
		</Attribute>
		<Attribute>
			<Name>odd_css</Name>
			<DisplayName>#Lang(136)</DisplayName>
			<DefaultValue><![CDATA[ ]]></DefaultValue>
			<RegularExpressionValidation>.*</RegularExpressionValidation>
			<ErrorValidationMessage>#Lang(211)</ErrorValidationMessage>
			<Visible>1</Visible>
			<Help>#Lang(315)</Help>
			<InterfaceType>3</InterfaceType>
			<CodeInterface>MultiLine(10000)</CodeInterface>
			<Colorgroup>2</Colorgroup>
		</Attribute>
		<Attribute>
			<Name>even_css</Name>
			<DisplayName>#Lang(137)</DisplayName>
			<DefaultValue><![CDATA[ ]]></DefaultValue>
			<RegularExpressionValidation>.*</RegularExpressionValidation>
			<ErrorValidationMessage>#Lang(211)</ErrorValidationMessage>
			<Visible>1</Visible>
			<Help>#Lang(315)</Help>
			<InterfaceType>3</InterfaceType>
			<CodeInterface>MultiLine(10000)</CodeInterface>
			<Colorgroup>2</Colorgroup>
		</Attribute>
		<Attribute>
			<Name>table_css</Name>
			<DisplayName>#Lang(138)</DisplayName>
			<DefaultValue><![CDATA[ ]]></DefaultValue>
			<RegularExpressionValidation>.*</RegularExpressionValidation>
			<ErrorValidationMessage>#Lang(211)</ErrorValidationMessage>
			<Visible>1</Visible>
			<Help>#Lang(315)</Help>
			<InterfaceType>3</InterfaceType>
			<CodeInterface>MultiLine(10000)</CodeInterface>
			<Colorgroup>2</Colorgroup>
		</Attribute>
		<Attribute>
			<Name>search_css</Name>
			<DisplayName>#Lang(139)</DisplayName>
			<DefaultValue><![CDATA[ ]]></DefaultValue>
			<RegularExpressionValidation>.*</RegularExpressionValidation>
			<ErrorValidationMessage>#Lang(211)</ErrorValidationMessage>
			<Visible>1</Visible>
			<Help>#Lang(315)</Help>
			<InterfaceType>3</InterfaceType>
			<CodeInterface>MultiLine(10000)</CodeInterface>
			<Colorgroup>2</Colorgroup>
		</Attribute>
		<Attribute>
			<Name>info_css</Name>
			<DisplayName>#Lang(140)</DisplayName>
			<DefaultValue><![CDATA[ ]]></DefaultValue>
			<RegularExpressionValidation>.*</RegularExpressionValidation>
			<ErrorValidationMessage>#Lang(211)</ErrorValidationMessage>
			<Visible>1</Visible>
			<Help>#Lang(315)</Help>
			<InterfaceType>3</InterfaceType>
			<CodeInterface>MultiLine(10000)</CodeInterface>
			<Colorgroup>2</Colorgroup>
		</Attribute>
		<Attribute>
			<Name>length_css</Name>
			<DisplayName>#Lang(141)</DisplayName>
			<DefaultValue><![CDATA[ ]]></DefaultValue>
			<RegularExpressionValidation>.*</RegularExpressionValidation>
			<ErrorValidationMessage>#Lang(211)</ErrorValidationMessage>
			<Visible>1</Visible>
			<Help>#Lang(315)</Help>
			<InterfaceType>3</InterfaceType>
			<CodeInterface>MultiLine(10000)</CodeInterface>
			<Colorgroup>2</Colorgroup>
		</Attribute>
		<Attribute>
			<Name>table_td_css</Name>
			<DisplayName>#Lang(143)</DisplayName>
			<DefaultValue><![CDATA[ ]]></DefaultValue>
			<RegularExpressionValidation>.*</RegularExpressionValidation>
			<ErrorValidationMessage>#Lang(211)</ErrorValidationMessage>
			<Visible>1</Visible>
			<Help>#Lang(315)</Help>
			<InterfaceType>3</InterfaceType>
			<CodeInterface>MultiLine(10000)</CodeInterface>
			<Colorgroup>2</Colorgroup>
		</Attribute>
		<Attribute>
			<Name>table_th_css</Name>
			<DisplayName>#Lang(144)</DisplayName>
			<DefaultValue><![CDATA[ ]]></DefaultValue>
			<RegularExpressionValidation>.*</RegularExpressionValidation>
			<ErrorValidationMessage>#Lang(211)</ErrorValidationMessage>
			<Visible>1</Visible>
			<Help>#Lang(315)</Help>
			<InterfaceType>3</InterfaceType>
			<CodeInterface>MultiLine(10000)</CodeInterface>
			<Colorgroup>2</Colorgroup>
		</Attribute>
	</Attributes>
	<Languages>
		<Language Code="en_US">
			<Sentence ID="001">Datatables</Sentence>
			<Sentence ID="002">HTML table for data</Sentence>
			<Sentence ID="101">Hierarchy</Sentence>
			<Sentence ID="102">Visibility</Sentence>
			<Sentence ID="103">Z-Index</Sentence>
			<Sentence ID="104">Top</Sentence>
			<Sentence ID="105">Left</Sentence>
			<Sentence ID="106">Width</Sentence>
			<Sentence ID="107">Height</Sentence>
			<Sentence ID="108">Minimum Width</Sentence>
			<Sentence ID="109">Minimum Height</Sentence>
			<Sentence ID="110">Title</Sentence>
			<Sentence ID="111">Resizable</Sentence>
			<Sentence ID="112">Draggable</Sentence>
			<Sentence ID="113">Show</Sentence>
			<Sentence ID="114">Htmlcode</Sentence>
			<Sentence ID="115">Show search</Sentence>
			<Sentence ID="116">Show information</Sentence>
			<Sentence ID="117">Show length</Sentence>
			<Sentence ID="118">Text length</Sentence>
			<Sentence ID="119">Search result text</Sentence>
			<Sentence ID="120">Info text</Sentence>
			<Sentence ID="121">Info empty</Sentence>
			<Sentence ID="122">Info search</Sentence>
			<Sentence ID="123">Table header</Sentence>
			<Sentence ID="124">Row ID</Sentence>
			<Sentence ID="125">Table key</Sentence>
			<Sentence ID="126">Length text</Sentence>
			<Sentence ID="127">Zero records</Sentence>
			<Sentence ID="128">Information</Sentence>
			<Sentence ID="129">Info empty</Sentence>
			<Sentence ID="130">Info filtred</Sentence>
			<Sentence ID="131">Target</Sentence>
			<Sentence ID="132">Hidden fields</Sentence>
			<Sentence ID="133">Multiselect</Sentence>
			<Sentence ID="134">Odd selected CSS</Sentence>
			<Sentence ID="135">Selected CSS</Sentence>
			<Sentence ID="136">Odd CSS</Sentence>
			<Sentence ID="137">Even CSS</Sentence>
			<Sentence ID="138">Table CSS </Sentence>
			<Sentence ID="139">Search CSS</Sentence>
			<Sentence ID="140">Info CSS</Sentence>
			<Sentence ID="141">Length CSS</Sentence>
			<Sentence ID="142">Form send method</Sentence>
			<Sentence ID="143">Table td CSS</Sentence>
			<Sentence ID="144">Table th CSS</Sentence>
			<Sentence ID="201">Incorrect value, must be positive integer</Sentence>
			<Sentence ID="202">Incorrect value</Sentence>
			<Sentence ID="203">Incorrect value, must be positive integer</Sentence>
			<Sentence ID="204">Incorrect value, must be positive integer</Sentence>
			<Sentence ID="205">Incorrect value, must be positive integer</Sentence>
			<Sentence ID="206">Incorrect value, must be positive integer</Sentence>
			<Sentence ID="207">Incorrect value, must be positive integer</Sentence>
			<Sentence ID="208">Incorrect value, must be positive integer</Sentence>
			<Sentence ID="209">Incorrect value, must be positive integer</Sentence>
			<Sentence ID="210">Incorrect value, must be string</Sentence>
			<Sentence ID="211">Incorrect value</Sentence>
			<Sentence ID="212">Incorrect value</Sentence>
			<Sentence ID="301">Hierarchy</Sentence>
			<Sentence ID="303">Z-Index</Sentence>
			<Sentence ID="302">Show or not object</Sentence>
			<Sentence ID="304">Distance from the top edge of the parent in pixels</Sentence>
			<Sentence ID="305">Distance from the left edge of the parent in pixels</Sentence>
			<Sentence ID="306">Width in pixels</Sentence>
			<Sentence ID="307">Height in pixels</Sentence>
			<Sentence ID="308">Minimum width in pixels</Sentence>
			<Sentence ID="309">Minimum height in pixels</Sentence>
			<Sentence ID="310">Title of the dialog</Sentence>
			<Sentence ID="311">Allow to resize dialog or not</Sentence>
			<Sentence ID="312">Allow to drag dialog or not (if not modal)</Sentence>
			<Sentence ID="313">Show after create</Sentence>
			<Sentence ID="314">JSON data for diagram</Sentence>
			<Sentence ID="315">no help</Sentence>
			<Sentence ID="401">Yes</Sentence>
			<Sentence ID="402">No</Sentence>
			<Sentence ID="403">Show</Sentence>
			<Sentence ID="404">Don't show</Sentence>
			<Sentence ID="405">Multiselect</Sentence>
			<Sentence ID="406">Singleselect</Sentence>
			<Sentence ID="407">post</Sentence>
			<Sentence ID="408">event</Sentence>
		</Language>
		<Language Code="ru_RU">
			<Sentence ID="001">Flot</Sentence>
			<Sentence ID="002">Diagram</Sentence>
			<Sentence ID="101">Иерархия</Sentence>
			<Sentence ID="102">Отображение</Sentence>
			<Sentence ID="103">Z-Индекс</Sentence>
			<Sentence ID="104">Верх</Sentence>
			<Sentence ID="105">Лево</Sentence>
			<Sentence ID="106">Ширина</Sentence>
			<Sentence ID="107">Высота</Sentence>
			<Sentence ID="108">Минимальная ширина</Sentence>
			<Sentence ID="109">Минимальная высота</Sentence>
			<Sentence ID="110">Заголовок</Sentence>
			<Sentence ID="111">Масштабируемый</Sentence>
			<Sentence ID="112">Перемещаемый</Sentence>
			<Sentence ID="113">Показать</Sentence>
			<Sentence ID="114">Данные</Sentence>
			<Sentence ID="201">Неправильное значение</Sentence>
			<Sentence ID="202">Incorrect value</Sentence>
			<Sentence ID="203">Неправильное значение, должно быть целое положительное число</Sentence>
			<Sentence ID="204">Неправильное значение, должно быть целое положительное число</Sentence>
			<Sentence ID="205">Неправильное значение, должно быть целое положительное число</Sentence>
			<Sentence ID="206">Неправильное значение, должно быть целое положительное число</Sentence>
			<Sentence ID="207">Неправильное значение, должно быть целое положительное число</Sentence>
			<Sentence ID="208">Неправильное значение, должно быть целое положительное число</Sentence>
			<Sentence ID="209">Неправильное значение, должно быть целое положительное число</Sentence>
			<Sentence ID="210">Неправильное значение, должна быть строка</Sentence>
			<Sentence ID="211">Неправильное значение</Sentence>
			<Sentence ID="212">Неправильное значение</Sentence>
			<Sentence ID="301">Приоритет в потоке гипертекста</Sentence>
			<Sentence ID="303">Заголовок контейнера</Sentence>
			<Sentence ID="302">Show or not object</Sentence>
			<Sentence ID="304">Расстояние от верхней границы родительского контейнера до объекта в пикселях</Sentence>
			<Sentence ID="305">Расстояние от левой границы родительского контейнера до объекта в пикселях</Sentence>
			<Sentence ID="306">Ширина объекта в пикселях</Sentence>
			<Sentence ID="307">Высота объекта в пикселях</Sentence>
			<Sentence ID="308">Минимальня ширина в пикселях</Sentence>
			<Sentence ID="309">Минимальная высота в пикселях</Sentence>
			<Sentence ID="310">Заголовок диалога</Sentence>
			<Sentence ID="311">Разрешить масштабирование диалога или нет</Sentence>
			<Sentence ID="312">Разрешить перемещение диалога или нет</Sentence>
			<Sentence ID="313">Показать после создания</Sentence>
			<Sentence ID="401">Да</Sentence>
			<Sentence ID="401">Да</Sentence>
			<Sentence ID="402">Нет</Sentence>
		</Language>
		<Language Code="fr_FR">
			<Sentence ID="001">Flot</Sentence>
			<Sentence ID="002">Diagram</Sentence>
			<Sentence ID="101">Hiérarchie</Sentence>
			<Sentence ID="102">Visibilité</Sentence>
			<Sentence ID="103">Z-Index</Sentence>
			<Sentence ID="104">Haut</Sentence>
			<Sentence ID="105">Gauche</Sentence>
			<Sentence ID="106">Largeur</Sentence>
			<Sentence ID="107">Hauteur</Sentence>
			<Sentence ID="108">Largeur Minimum</Sentence>
			<Sentence ID="109">Hauteur Minimum</Sentence>
			<Sentence ID="110">Titre</Sentence>
			<Sentence ID="111">Redimensionnable</Sentence>
			<Sentence ID="112">Déplaçables</Sentence>
			<Sentence ID="113">Show</Sentence>
			<Sentence ID="114">Data</Sentence>
			<Sentence ID="201">Valeur Incorrecte, doit être positive</Sentence>
			<Sentence ID="202">Incorrect value</Sentence>
			<Sentence ID="203">Valeur Incorrecte, doit être positive</Sentence>
			<Sentence ID="204">Valeur Incorrecte, doit être positive</Sentence>
			<Sentence ID="205">Valeur Incorrecte, doit être positive</Sentence>
			<Sentence ID="206">Valeur Incorrecte, doit être positive</Sentence>
			<Sentence ID="207">Valeur Incorrecte, doit être positive</Sentence>
			<Sentence ID="208">Valeur Incorrecte, doit être positive</Sentence>
			<Sentence ID="209">Valeur Incorrecte, doit être positive</Sentence>
			<Sentence ID="210">Valeur Incorrecte, doit être une chaîne</Sentence>
			<Sentence ID="211">Valeur Incorrecte</Sentence>
			<Sentence ID="212">Valeur Incorrecte</Sentence>
			<Sentence ID="301">Hiérarchie de l'objet, ordre de chargement de l'objet par rapport aux autres</Sentence>
			<Sentence ID="303">Niveau de superposition de l'objet par rapport aux autres</Sentence>
			<Sentence ID="302">Show or not object</Sentence>
			<Sentence ID="304">Distance depuis le bord haut de l'objet parent en pixels</Sentence>
			<Sentence ID="305">Distance depuis le bord gauche de l'objet parent en pixels</Sentence>
			<Sentence ID="306">Largeur de l'objet en pixels</Sentence>
			<Sentence ID="307">Hauteur de l'objet en pixels</Sentence>
			<Sentence ID="308">Largeur Minimum en pixels</Sentence>
			<Sentence ID="309">Hauteur Minimum en pixels</Sentence>
			<Sentence ID="310">Titre du dialogue</Sentence>
			<Sentence ID="311">Autoriser ou interdir le redimensionnement du dialogue</Sentence>
			<Sentence ID="312">Autoriser ou interdir le déplacement du dialogue</Sentence>
			<Sentence ID="313">Show after create</Sentence>
			<Sentence ID="401">Oui</Sentence>
			<Sentence ID="402">Non</Sentence>
		</Language>
	</Languages>
	<Resources>
		<Resource ID="d3e6612f-b2a2-ee88-7419-af3e7cdc6016" Name="Icon" Type="png"><![CDATA[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]]></Resource>
		<Resource ID="6d804848-fc36-8b66-2fc7-3a2de7ec897b" Name="Icon" Type="jpg"><![CDATA[/9j/4AAQSkZJRgABAgEASABIAAD/7QUaUGhvdG9zaG9wIDMuMAA4QklNA+0AAAAAABAASAAAAAEAAQBIAAAAAQABOEJJTQQNAAAAAAAEAAAAeDhCSU0D8wAAAAAACAAAAAAAAAAAOEJJTQQKAAAAAAABAAA4QklNJxAAAAAAAAoAAQAAAAAAAAACOEJJTQP1AAAAAABIAC9mZgABAGxmZgAGAAAAAAABAC9mZgABAKGZmgAGAAAAAAABADIAAAABAFoAAAAGAAAAAAABADUAAAABAC0AAAAGAAAAAAABOEJJTQP4AAAAAABwAAD/////////////////////////////A+gAAAAA/////////////////////////////wPoAAAAAP////////////////////////////8D6AAAAAD/////////////////////////////A+gAADhCSU0ECAAAAAAAEAAAAAEAAAJAAAACQAAAAAA4QklNBBQAAAAAAAQAAAADOEJJTQQMAAAAAAOKAAAAAQAAABgAAAAYAAAASAAABsAAAANuABgAAf/Y/+AAEEpGSUYAAQIBAEgASAAA/+4ADkFkb2JlAGSAAAAAAf/bAIQADAgICAkIDAkJDBELCgsRFQ8MDA8VGBMTFRMTGBEMDAwMDAwRDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAENCwsNDg0QDg4QFA4ODhQUDg4ODhQRDAwMDAwREQwMDAwMDBEMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwM/8AAEQgAGAAYAwEiAAIRAQMRAf/dAAQAAv/EAT8AAAEFAQEBAQEBAAAAAAAAAAMAAQIEBQYHCAkKCwEAAQUBAQEBAQEAAAAAAAAAAQACAwQFBgcICQoLEAABBAEDAgQCBQcGCAUDDDMBAAIRAwQhEjEFQVFhEyJxgTIGFJGhsUIjJBVSwWIzNHKC0UMHJZJT8OHxY3M1FqKygyZEk1RkRcKjdDYX0lXiZfKzhMPTdePzRieUpIW0lcTU5PSltcXV5fVWZnaGlqa2xtbm9jdHV2d3h5ent8fX5/cRAAICAQIEBAMEBQYHBwYFNQEAAhEDITESBEFRYXEiEwUygZEUobFCI8FS0fAzJGLhcoKSQ1MVY3M08SUGFqKygwcmNcLSRJNUoxdkRVU2dGXi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]]></Resource>
		<Resource ID="e5017294-a4b6-df2c-3ed1-f458cc6f43a0" Name="Icon" Type="png"><![CDATA[iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAARRQTFRF4ODg7+/v8fHx+vr6/f395eXl/v7+4uLix8fH3Nzc/Pz81tjYt7e36urq1NTUzs7O6OjoqampxMTEzMzM9/j48PDw5OTklJSU266utbW1p6env7+/6enprKys7vT03t7e9/v73d/furq6TU1N2c/P8vPzycnJ2L+/9/b20qGh/f7+l5eXlpaWpaWl8vLyn5+fvr6+z8/PWlpa9PX1qqqqxJyc3d3d297e4dHRJiYm+fz8y8vL28HBxcXFo6Oj09PT5ubmtra2u7u77Ozs1dXV0tLS39/f+PX14eHh7uTk6eXl+/z8ioqKpKSk9PT01tbW9fX17u7ukJCQ3+Hh6+vr+Pj49vb2+/v7+fn59/f3////////pFFVPQAAAFx0Uk5T/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wCDbRfgAAAA10lEQVR42izP11rDMAyAUSW2s7on0LLK6mZDy55lrxYS2/L7v0ejkHOhi/9CnwSGiIibFNBQkxz4NRkLkmDV1486P7XlYnH6bVO4/W0v6qpWSknZBM//s1uX4/OIaCcLK1lReVp9fa7qGPsqg7n/FKOT7ntI+MtpvMNfyGy99RTBvEVLCweZ7QAZU9q5SUIZcx+HLrIwCh6T4CHC5tkFao0VuoPnuYM469vaWbumS+0dibEIrPpdSIF7Bdd1QTyA3P9/Ti41SqXj4WDvaiP9NsXErjFzAQYAm+s6UwNybn0AAAAASUVORK5CYIIw8qwXZWg0thBhlivw1ld0KjUN4hMGmiGh4u8RoVxRFOkblaPDBTJUzIdTV9NKyzm1ir2EDSSg0RBiHm3bYG+izSENFnBtaBC39hNrYGVtkLQDCjAVs/M0NKRlcrFySOSBXCpUztsABCxSQsyCvCABjoAYfgYGZgFuKfZQiOeYBGsZGRktMxJk3aG+hQFulsZGgAADAGSATSItKo16AAAAAElFTkSuQmCCp6mEc/bAwCBNjE1QSVlpU2trS6Cnp8eXjYPZUgjY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]]></Resource>
		<Resource ID="b53f403c-efe7-4fa7-bff3-35e71027f393" Name="datatables" Type="js"><![CDATA[LyoKICogRmlsZTogICAgICAgIGpxdWVyeS5kYXRhVGFibGVzLmpzCiAqIFZlcnNpb246ICAgICAxLjcuNAogKiBEZXNjcmlwdGlvbjogUGFnaW5hdGUsIHNlYXJjaCBhbmQgc29ydCBIVE1MIHRhYmxlcwogKiBBdXRob3I6ICAgICAgQWxsYW4gSmFyZGluZSAod3d3LnNwcnltZWRpYS5jby51aykKICogQ3JlYXRlZDogICAgIDI4LzMvMjAwOAogKiBMYW5ndWFnZTogICAgSmF2YXNjcmlwdAogKiBMaWNlbnNlOiAgICAgR1BMIHYyIG9yIEJTRCAzIHBvaW50IHN0eWxlCiAqIFByb2plY3Q6ICAgICBNdGFhbGEKICogQ29udGFjdDogICAgIGFsbGFuLmphcmRpbmVAc3ByeW1lZGlhLmNvLnVrCiAqIAogKiBDb3B5cmlnaHQgMjAwOC0yMDEwIEFsbGFuIEphcmRpbmUsIGFsbCByaWdodHMgcmVzZXJ2ZWQuCiAqCiAqIFRoaXMgc291cmNlIGZpbGUgaXMgZnJlZSBzb2Z0d2FyZSwgdW5kZXIgZWl0aGVyIHRoZSBHUEwgdjIgbGljZW5zZSBvciBhCiAqIEJTRCBzdHlsZSBsaWNlbnNlLCBhcyBzdXBwbGllZCB3aXRoIHRoaXMgc29mdHdhcmUuCiAqIAogKiBUaGlzIHNvdXJjZSBmaWxlIGlzIGRpc3RyaWJ1dGVkIGluIHRoZSBob3BlIHRoYXQgaXQgd2lsbCBiZSB1c2VmdWwsIGJ1dCAKICogV0lUSE9VVCBBTlkgV0FSUkFOVFk7IHdpdGhvdXQgZXZlbiB0aGUgaW1wbGllZCB3YXJyYW50eSBvZiBNRVJDSEFOVEFCSUxJVFkgCiAqIG9yIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFLiBTZWUgdGhlIGxpY2Vuc2UgZmlsZXMgZm9yIGRldGFpbHMuCiAqIAogKiBGb3IgZGV0YWlscyBwbGVhc2UgcmVmZXIgdG86IGh0dHA6Ly93d3cuZGF0YXRhYmxlcy5uZXQKICovCgovKgogKiBXaGVuIGNvbnNpZGVyaW5nIGpzTGludCwgd2UgbmVlZCB0byBhbGxvdyBldmFsKCkgYXMgaXQgaXQgaXMgdXNlZCBmb3IgcmVhZGluZyBjb29raWVzIGFuZCAKICogYnVpbGRpbmcgdGhlIGR5bmFtaWMgbXVsdGktY29sdW1uIHNvcnQgZnVuY3Rpb25zLgogKi8KLypqc2xpbnQgZXZpbDogdHJ1ZSwgdW5kZWY6IHRydWUsIGJyb3dzZXI6IHRydWUgKi8KLypnbG9iYWxzICQsIGpRdWVyeSxfZm5FeHRlcm5BcGlGdW5jLF9mbkluaXRhbGlzZSxfZm5MYW5ndWFnZVByb2Nlc3MsX2ZuQWRkQ29sdW1uLF9mbkNvbHVtbk9wdGlvbnMsX2ZuQWRkRGF0YSxfZm5HYXRoZXJEYXRhLF9mbkRyYXdIZWFkLF9mbkRyYXcsX2ZuUmVEcmF3LF9mbkFqYXhVcGRhdGUsX2ZuQWpheFVwZGF0ZURyYXcsX2ZuQWRkT3B0aW9uc0h0bWwsX2ZuRmVhdHVyZUh0bWxUYWJsZSxfZm5TY3JvbGxEcmF3LF9mbkFqdXN0Q29sdW1uU2l6aW5nLF9mbkZlYXR1cmVIdG1sRmlsdGVyLF9mbkZpbHRlckNvbXBsZXRlLF9mbkZpbHRlckN1c3RvbSxfZm5GaWx0ZXJDb2x1bW4sX2ZuRmlsdGVyLF9mbkJ1aWxkU2VhcmNoQXJyYXksX2ZuQnVpbGRTZWFyY2hSb3csX2ZuRmlsdGVyQ3JlYXRlU2VhcmNoLF9mbkRhdGFUb1NlYXJjaCxfZm5Tb3J0LF9mblNvcnRBdHRhY2hMaXN0ZW5lcixfZm5Tb3J0aW5nQ2xhc3NlcyxfZm5GZWF0dXJlSHRtbFBhZ2luYXRlLF9mblBhZ2VDaGFuZ2UsX2ZuRmVhdHVyZUh0bWxJbmZvLF9mblVwZGF0ZUluZm8sX2ZuRmVhdHVyZUh0bWxMZW5ndGgsX2ZuRmVhdHVyZUh0bWxQcm9jZXNzaW5nLF9mblByb2Nlc3NpbmdEaXNwbGF5LF9mblZpc2libGVUb0NvbHVtbkluZGV4LF9mbkNvbHVtbkluZGV4VG9WaXNpYmxlLF9mbk5vZGVUb0RhdGFJbmRleCxfZm5WaXNibGVDb2x1bW5zLF9mbkNhbGN1bGF0ZUVuZCxfZm5Db252ZXJ0VG9XaWR0aCxfZm5DYWxjdWxhdGVDb2x1bW5XaWR0aHMsX2ZuU2Nyb2xsaW5nV2lkdGhBZGp1c3QsX2ZuR2V0V2lkZXN0Tm9kZSxfZm5HZXRNYXhMZW5TdHJpbmcsX2ZuU3RyaW5nVG9Dc3MsX2ZuQXJyYXlDbXAsX2ZuRGV0ZWN0VHlwZSxfZm5TZXR0aW5nc0Zyb21Ob2RlLF9mbkdldERhdGFNYXN0ZXIsX2ZuR2V0VHJOb2RlcyxfZm5HZXRUZE5vZGVzLF9mbkVzY2FwZVJlZ2V4LF9mbkRlbGV0ZUluZGV4LF9mblJlT3JkZXJJbmRleCxfZm5Db2x1bW5PcmRlcmluZyxfZm5Mb2csX2ZuQ2xlYXJUYWJsZSxfZm5TYXZlU3RhdGUsX2ZuTG9hZFN0YXRlLF9mbkNyZWF0ZUNvb2tpZSxfZm5SZWFkQ29va2llLF9mbkdldFVuaXF1ZVRocyxfZm5TY3JvbGxCYXJXaWR0aCxfZm5BcHBseVRvQ2hpbGRyZW4sX2ZuTWFwKi8KCihmdW5jdGlvbigkLCB3aW5kb3csIGRvY3VtZW50KSB7CgkvKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqCgkgKiBTZWN0aW9uIC0gRGF0YVRhYmxlcyB2YXJpYWJsZXMKCSAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICovCgkKCS8qCgkgKiBWYXJpYWJsZTogZGF0YVRhYmxlU2V0dGluZ3MKCSAqIFB1cnBvc2U6ICBTdG9yZSB0aGUgc2V0dGluZ3MgZm9yIGVhY2ggZGF0YVRhYmxlcyBpbnN0YW5jZQoJICogU2NvcGU6ICAgIGpRdWVyeS5mbgoJICovCgkkLmZuLmRhdGFUYWJsZVNldHRpbmdzID0gW107Cgl2YXIgX2FvU2V0dGluZ3MgPSAkLmZuLmRhdGFUYWJsZVNldHRpbmdzOyAvKiBTaG9ydCByZWZlcmVuY2UgZm9yIGZhc3QgaW50ZXJuYWwgbG9va3VwICovCgkKCS8qCgkgKiBWYXJpYWJsZTogZGF0YVRhYmxlRXh0CgkgKiBQdXJwb3NlOiAgQ29udGFpbmVyIGZvciBjdXN0b21pc2FibGUgcGFydHMgb2YgRGF0YVRhYmxlcwoJICogU2NvcGU6ICAgIGpRdWVyeS5mbgoJICovCgkkLmZuLmRhdGFUYWJsZUV4dCA9IHt9OwoJdmFyIF9vRXh0ID0gJC5mbi5kYXRhVGFibGVFeHQ7CgkKCQoJLyogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKgoJICogU2VjdGlvbiAtIERhdGFUYWJsZXMgZXh0ZW5zaWJsZSBvYmplY3RzCgkgKiAKCSAqIFRoZSBfb0V4dCBvYmplY3QgaXMgdXNlZCB0byBwcm92aWRlIGFuIGFyZWEgd2hlcmUgdXNlciBkZmluZWQgcGx1Z2lucyBjYW4gYmUgCgkgKiBhZGRlZCB0byBEYXRhVGFibGVzLiBUaGUgZm9sbG93aW5nIHByb3BlcnRpZXMgb2YgdGhlIG9iamVjdCBhcmUgdXNlZDoKCSAqICAgb0FwaSAtIFBsdWctaW4gQVBJIGZ1bmN0aW9ucwoJICogICBhVHlwZXMgLSBBdXRvLWRldGVjdGlvbiBvZiB0eXBlcwoJICogICBvU29ydCAtIFNvcnRpbmcgZnVuY3Rpb25zIHVzZWQgYnkgRGF0YVRhYmxlcyAoYmFzZWQgb24gdGhlIHR5cGUpCgkgKiAgIG9QYWdpbmF0aW9uIC0gUGFnaW5hdGlvbiBmdW5jdGlvbnMgZm9yIGRpZmZlcmVudCBpbnB1dCBzdHlsZXMKCSAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICovCgkKCS8qCgkgKiBWYXJpYWJsZTogc1ZlcnNpb24KCSAqIFB1cnBvc2U6ICBWZXJzaW9uIHN0cmluZyBmb3IgcGx1Zy1pbnMgdG8gY2hlY2sgY29tcGF0aWJpbGl0eQoJICogU2NvcGU6ICAgIGpRdWVyeS5mbi5kYXRhVGFibGVFeHQKCSAqIE5vdGVzOiAgICBBbGxvd2VkIGZvcm1hdCBpcyBhLmIuYy5kLmUgd2hlcmU6CgkgKiAgIGE6aW50LCBiOmludCwgYzppbnQsIGQ6c3RyaW5nKGRldnxiZXRhKSwgZTppbnQuIGQgYW5kIGUgYXJlIG9wdGlvbmFsCgkgKi8KCV9vRXh0LnNWZXJzaW9uID0gIjEuNy40IjsKCQoJLyoKCSAqIFZhcmlhYmxlOiBzRXJyTW9kZQoJICogUHVycG9zZTogIEhvdyBzaG91bGQgRGF0YVRhYmxlcyByZXBvcnQgYW4gZXJyb3IuIENhbiB0YWtlIHRoZSB2YWx1ZSAnYWxlcnQnIG9yICd0aHJvdycKCSAqIFNjb3BlOiAgICBqUXVlcnkuZm4uZGF0YVRhYmxlRXh0CgkgKi8KCV9vRXh0LnNFcnJNb2RlID0gImFsZXJ0IjsKCQoJLyoKCSAqIFZhcmlhYmxlOiBpQXBpSW5kZXgKCSAqIFB1cnBvc2U6ICBJbmRleCBmb3Igd2hhdCAndGhpcycgaW5kZXggQVBJIGZ1bmN0aW9ucyBzaG91bGQgdXNlCgkgKiBTY29wZTogICAgalF1ZXJ5LmZuLmRhdGFUYWJsZUV4dAoJICovCglfb0V4dC5pQXBpSW5kZXggPSAwOwoJCgkvKgoJICogVmFyaWFibGU6IG9BcGkKCSAqIFB1cnBvc2U6ICBDb250YWluZXIgZm9yIHBsdWdpbiBBUEkgZnVuY3Rpb25zCgkgKiBTY29wZTogICAgalF1ZXJ5LmZuLmRhdGFUYWJsZUV4dAoJICovCglfb0V4dC5vQXBpID0geyB9OwoJCgkvKgoJICogVmFyaWFibGU6IGFGaWx0ZXJpbmcKCSAqIFB1cnBvc2U6ICBDb250YWluZXIgZm9yIHBsdWdpbiBmaWx0ZXJpbmcgZnVuY3Rpb25zCgkgKiBTY29wZTogICAgalF1ZXJ5LmZuLmRhdGFUYWJsZUV4dAoJICovCglfb0V4dC5hZm5GaWx0ZXJpbmcgPSBbIF07CgkKCS8qCgkgKiBWYXJpYWJsZTogYW9GZWF0dXJlcwoJICogUHVycG9zZTogIENvbnRhaW5lciBmb3IgcGx1Z2luIGZ1bmN0aW9uIGZ1bmN0aW9ucwoJICogU2NvcGU6ICAgIGpRdWVyeS5mbi5kYXRhVGFibGVFeHQKCSAqIE5vdGVzOiAgICBBcnJheSBvZiBvYmplY3RzIHdpdGggdGhlIGZvbGxvd2luZyBwYXJhbWV0ZXJzOgoJICogICBmbkluaXQ6IEZ1bmN0aW9uIGZvciBpbml0aWFsaXNhdGlvbiBvZiBGZWF0dXJlLiBUYWtlcyBvU2V0dGluZ3MgYW5kIHJldHVybnMgbm9kZQoJICogICBjRmVhdHVyZTogQ2hhcmFjdGVyIHRoYXQgd2lsbCBiZSBtYXRjaGVkIGluIHNEb20gLSBjYXNlIHNlbnNpdGl2ZQoJICogICBzRmVhdHVyZTogRmVhdHVyZSBuYW1lIC0ganVzdCBmb3IgY29tcGxldGVuZXNzIDotKQoJICovCglfb0V4dC5hb0ZlYXR1cmVzID0gWyBdOwoJCgkvKgoJICogVmFyaWFibGU6IG9mblNlYXJjaAoJICogUHVycG9zZTogIENvbnRhaW5lciBmb3IgY3VzdG9tIGZpbHRlcmluZyBmdW5jdGlvbnMKCSAqIFNjb3BlOiAgICBqUXVlcnkuZm4uZGF0YVRhYmxlRXh0CgkgKiBOb3RlczogICAgVGhpcyBpcyBhbiBvYmplY3QgKHRoZSBuYW1lIHNob3VsZCBtYXRjaCB0aGUgdHlwZSkgZm9yIGN1c3RvbSBmaWx0ZXJpbmcgZnVuY3Rpb24sCgkgKiAgIHdoaWNoIGNhbiBiZSB1c2VkIGZvciBsaXZlIERPTSBjaGVja2luZyBvciBmb3JtYXR0ZWQgdGV4dCBmaWx0ZXJpbmcKCSAqLwoJX29FeHQub2ZuU2VhcmNoID0geyB9OwoJCgkvKgoJICogVmFyaWFibGU6IGFmblNvcnREYXRhCgkgKiBQdXJwb3NlOiAgQ29udGFpbmVyIGZvciBjdXN0b20gc29ydGluZyBkYXRhIHNvdXJjZSBmdW5jdGlvbnMKCSAqIFNjb3BlOiAgICBqUXVlcnkuZm4uZGF0YVRhYmxlRXh0CgkgKiBOb3RlczogICAgQXJyYXkgKGFzc29jaWF0aXZlKSBvZiBmdW5jdGlvbnMgd2hpY2ggaXMgcnVuIHByaW9yIHRvIGEgY29sdW1uIG9mIHRoaXMgCgkgKiAgICdTb3J0RGF0YVR5cGUnIGJlaW5nIHNvcnRlZCB1cG9uLgoJICogICBGdW5jdGlvbiBpbnB1dCBwYXJhbWV0ZXJzOgoJICogICAgIG9iamVjdDpvU2V0dGluZ3MtICBEYXRhVGFibGVzIHNldHRpbmdzIG9iamVjdAoJICogICAgIGludDppQ29sdW1uIC0gVGFyZ2V0IGNvbHVtbiBudW1iZXIKCSAqICAgUmV0dXJuIHZhbHVlOiBBcnJheSBvZiBkYXRhIHdoaWNoIGV4YWN0bHkgbWF0Y2hlZCB0aGUgZnVsbCBkYXRhIHNldCBzaXplIGZvciB0aGUgY29sdW1uIHRvCgkgKiAgICAgYmUgc29ydGVkIHVwb24KCSAqLwoJX29FeHQuYWZuU29ydERhdGEgPSBbIF07CgkKCS8qCgkgKiBWYXJpYWJsZTogb1N0ZENsYXNzZXMKCSAqIFB1cnBvc2U6ICBTdG9yYWdlIGZvciB0aGUgdmFyaW91cyBjbGFzc2VzIHRoYXQgRGF0YVRhYmxlcyB1c2VzCgkgKiBTY29wZTogICAgalF1ZXJ5LmZuLmRhdGFUYWJsZUV4dAoJICovCglfb0V4dC5vU3RkQ2xhc3NlcyA9IHsKCQkvKiBUd28gYnV0dG9ucyBidXR0b25zICovCgkJInNQYWdlUHJldkVuYWJsZWQiOiAicGFnaW5hdGVfZW5hYmxlZF9wcmV2aW91cyIsCgkJInNQYWdlUHJldkRpc2FibGVkIjogInBhZ2luYXRlX2Rpc2FibGVkX3ByZXZpb3VzIiwKCQkic1BhZ2VOZXh0RW5hYmxlZCI6ICJwYWdpbmF0ZV9lbmFibGVkX25leHQiLAoJCSJzUGFnZU5leHREaXNhYmxlZCI6ICJwYWdpbmF0ZV9kaXNhYmxlZF9uZXh0IiwKCQkic1BhZ2VKVUlOZXh0IjogIiIsCgkJInNQYWdlSlVJUHJldiI6ICIiLAoJCQoJCS8qIEZ1bGwgbnVtYmVycyBwYWdpbmcgYnV0dG9ucyAqLwoJCSJzUGFnZUJ1dHRvbiI6ICJwYWdpbmF0ZV9idXR0b24iLAoJCSJzUGFnZUJ1dHRvbkFjdGl2ZSI6ICJwYWdpbmF0ZV9hY3RpdmUiLAoJCSJzUGFnZUJ1dHRvblN0YXRpY0Rpc2FibGVkIjogInBhZ2luYXRlX2J1dHRvbiIsCgkJInNQYWdlRmlyc3QiOiAiZmlyc3QiLAoJCSJzUGFnZVByZXZpb3VzIjogInByZXZpb3VzIiwKCQkic1BhZ2VOZXh0IjogIm5leHQiLAoJCSJzUGFnZUxhc3QiOiAibGFzdCIsCgkJCgkJLyogU3RyaXBwaW5nIGNsYXNzZXMgKi8KCQkic1N0cmlwT2RkIjogIm9kZCIsCgkJInNTdHJpcEV2ZW4iOiAiZXZlbiIsCgkJCgkJLyogRW1wdHkgcm93ICovCgkJInNSb3dFbXB0eSI6ICJkYXRhVGFibGVzX2VtcHR5IiwKCQkKCQkvKiBGZWF0dXJlcyAqLwoJCSJzV3JhcHBlciI6ICJkYXRhVGFibGVzX3dyYXBwZXIiLAoJCSJzRmlsdGVyIjogImRhdGFUYWJsZXNfZmlsdGVyIiwKCQkic0luZm8iOiAiZGF0YVRhYmxlc19pbmZvIiwKCQkic1BhZ2luZyI6ICJkYXRhVGFibGVzX3BhZ2luYXRlIHBhZ2luZ18iLCAvKiBOb3RlIHRoYXQgdGhlIHR5cGUgaXMgcG9zdGZpeGVkICovCgkJInNMZW5ndGgiOiAiZGF0YVRhYmxlc19sZW5ndGgiLAoJCSJzUHJvY2Vzc2luZyI6ICJkYXRhVGFibGVzX3Byb2Nlc3NpbmciLAoJCQoJCS8qIFNvcnRpbmcgKi8KCQkic1NvcnRBc2MiOiAic29ydGluZ19hc2MiLAoJCSJzU29ydERlc2MiOiAic29ydGluZ19kZXNjIiwKCQkic1NvcnRhYmxlIjogInNvcnRpbmciLCAvKiBTb3J0YWJsZSBpbiBib3RoIGRpcmVjdGlvbnMgKi8KCQkic1NvcnRhYmxlQXNjIjogInNvcnRpbmdfYXNjX2Rpc2FibGVkIiwKCQkic1NvcnRhYmxlRGVzYyI6ICJzb3J0aW5nX2Rlc2NfZGlzYWJsZWQiLAoJCSJzU29ydGFibGVOb25lIjogInNvcnRpbmdfZGlzYWJsZWQiLAoJCSJzU29ydENvbHVtbiI6ICJzb3J0aW5nXyIsIC8qIE5vdGUgdGhhdCBhbiBpbnQgaXMgcG9zdGZpeGVkIGZvciB0aGUgc29ydGluZyBvcmRlciAqLwoJCSJzU29ydEpVSUFzYyI6ICIiLAoJCSJzU29ydEpVSURlc2MiOiAiIiwKCQkic1NvcnRKVUkiOiAiIiwKCQkic1NvcnRKVUlBc2NBbGxvd2VkIjogIiIsCgkJInNTb3J0SlVJRGVzY0FsbG93ZWQiOiAiIiwKCQkic1NvcnRKVUlXcmFwcGVyIjogIiIsCgkJCgkJLyogU2Nyb2xsaW5nICovCgkJInNTY3JvbGxXcmFwcGVyIjogImRhdGFUYWJsZXNfc2Nyb2xsIiwKCQkic1Njcm9sbEhlYWQiOiAiZGF0YVRhYmxlc19zY3JvbGxIZWFkIiwKCQkic1Njcm9sbEhlYWRJbm5lciI6ICJkYXRhVGFibGVzX3Njcm9sbEhlYWRJbm5lciIsCgkJInNTY3JvbGxCb2R5IjogImRhdGFUYWJsZXNfc2Nyb2xsQm9keSIsCgkJInNTY3JvbGxGb290IjogImRhdGFUYWJsZXNfc2Nyb2xsRm9vdCIsCgkJInNTY3JvbGxGb290SW5uZXIiOiAiZGF0YVRhYmxlc19zY3JvbGxGb290SW5uZXIiLAoJCQoJCS8qIE1pc2MgKi8KCQkic0Zvb3RlclRIIjogIiIKCX07CgkKCS8qCgkgKiBWYXJpYWJsZTogb0pVSUNsYXNzZXMKCSAqIFB1cnBvc2U6ICBTdG9yYWdlIGZvciB0aGUgdmFyaW91cyBjbGFzc2VzIHRoYXQgRGF0YVRhYmxlcyB1c2VzIC0galF1ZXJ5IFVJIHN1aXRhYmxlCgkgKiBTY29wZTogICAgalF1ZXJ5LmZuLmRhdGFUYWJsZUV4dAoJICovCglfb0V4dC5vSlVJQ2xhc3NlcyA9IHsKCQkvKiBUd28gYnV0dG9ucyBidXR0b25zICovCgkJInNQYWdlUHJldkVuYWJsZWQiOiAiZmctYnV0dG9uIHVpLWJ1dHRvbiB1aS1zdGF0ZS1kZWZhdWx0IHVpLWNvcm5lci1sZWZ0IiwKCQkic1BhZ2VQcmV2RGlzYWJsZWQiOiAiZmctYnV0dG9uIHVpLWJ1dHRvbiB1aS1zdGF0ZS1kZWZhdWx0IHVpLWNvcm5lci1sZWZ0IHVpLXN0YXRlLWRpc2FibGVkIiwKCQkic1BhZ2VOZXh0RW5hYmxlZCI6ICJmZy1idXR0b24gdWktYnV0dG9uIHVpLXN0YXRlLWRlZmF1bHQgdWktY29ybmVyLXJpZ2h0IiwKCQkic1BhZ2VOZXh0RGlzYWJsZWQiOiAiZmctYnV0dG9uIHVpLWJ1dHRvbiB1aS1zdGF0ZS1kZWZhdWx0IHVpLWNvcm5lci1yaWdodCB1aS1zdGF0ZS1kaXNhYmxlZCIsCgkJInNQYWdlSlVJTmV4dCI6ICJ1aS1pY29uIHVpLWljb24tY2lyY2xlLWFycm93LWUiLAoJCSJzUGFnZUpVSVByZXYiOiAidWktaWNvbiB1aS1pY29uLWNpcmNsZS1hcnJvdy13IiwKCQkKCQkvKiBGdWxsIG51bWJlcnMgcGFnaW5nIGJ1dHRvbnMgKi8KCQkic1BhZ2VCdXR0b24iOiAiZmctYnV0dG9uIHVpLWJ1dHRvbiB1aS1zdGF0ZS1kZWZhdWx0IiwKCQkic1BhZ2VCdXR0b25BY3RpdmUiOiAiZmctYnV0dG9uIHVpLWJ1dHRvbiB1aS1zdGF0ZS1kZWZhdWx0IHVpLXN0YXRlLWRpc2FibGVkIiwKCQkic1BhZ2VCdXR0b25TdGF0aWNEaXNhYmxlZCI6ICJmZy1idXR0b24gdWktYnV0dG9uIHVpLXN0YXRlLWRlZmF1bHQgdWktc3RhdGUtZGlzYWJsZWQiLAoJCSJzUGFnZUZpcnN0IjogImZpcnN0IHVpLWNvcm5lci10bCB1aS1jb3JuZXItYmwiLAoJCSJzUGFnZVByZXZpb3VzIjogInByZXZpb3VzIiwKCQkic1BhZ2VOZXh0IjogIm5leHQiLAoJCSJzUGFnZUxhc3QiOiAibGFzdCB1aS1jb3JuZXItdHIgdWktY29ybmVyLWJyIiwKCQkKCQkvKiBTdHJpcHBpbmcgY2xhc3NlcyAqLwoJCSJzU3RyaXBPZGQiOiAib2RkIiwKCQkic1N0cmlwRXZlbiI6ICJldmVuIiwKCQkKCQkvKiBFbXB0eSByb3cgKi8KCQkic1Jvd0VtcHR5IjogImRhdGFUYWJsZXNfZW1wdHkiLAoJCQoJCS8qIEZlYXR1cmVzICovCgkJInNXcmFwcGVyIjogImRhdGFUYWJsZXNfd3JhcHBlciIsCgkJInNGaWx0ZXIiOiAiZGF0YVRhYmxlc19maWx0ZXIiLAoJCSJzSW5mbyI6ICJkYXRhVGFibGVzX2luZm8iLAoJCSJzUGFnaW5nIjogImRhdGFUYWJsZXNfcGFnaW5hdGUgZmctYnV0dG9uc2V0IHVpLWJ1dHRvbnNldCBmZy1idXR0b25zZXQtbXVsdGkgIisKCQkJInVpLWJ1dHRvbnNldC1tdWx0aSBwYWdpbmdfIiwgLyogTm90ZSB0aGF0IHRoZSB0eXBlIGlzIHBvc3RmaXhlZCAqLwoJCSJzTGVuZ3RoIjogImRhdGFUYWJsZXNfbGVuZ3RoIiwKCQkic1Byb2Nlc3NpbmciOiAiZGF0YVRhYmxlc19wcm9jZXNzaW5nIiwKCQkKCQkvKiBTb3J0aW5nICovCgkJInNTb3J0QXNjIjogInVpLXN0YXRlLWRlZmF1bHQiLAoJCSJzU29ydERlc2MiOiAidWktc3RhdGUtZGVmYXVsdCIsCgkJInNTb3J0YWJsZSI6ICJ1aS1zdGF0ZS1kZWZhdWx0IiwKCQkic1NvcnRhYmxlQXNjIjogInVpLXN0YXRlLWRlZmF1bHQiLAoJCSJzU29ydGFibGVEZXNjIjogInVpLXN0YXRlLWRlZmF1bHQiLAoJCSJzU29ydGFibGVOb25lIjogInVpLXN0YXRlLWRlZmF1bHQiLAoJCSJzU29ydENvbHVtbiI6ICJzb3J0aW5nXyIsIC8qIE5vdGUgdGhhdCBhbiBpbnQgaXMgcG9zdGZpeGVkIGZvciB0aGUgc29ydGluZyBvcmRlciAqLwoJCSJzU29ydEpVSUFzYyI6ICJjc3NfcmlnaHQgdWktaWNvbiB1aS1pY29uLXRyaWFuZ2xlLTEtbiIsCgkJInNTb3J0SlVJRGVzYyI6ICJjc3NfcmlnaHQgdWktaWNvbiB1aS1pY29uLXRyaWFuZ2xlLTEtcyIsCgkJInNTb3J0SlVJIjogImNzc19yaWdodCB1aS1pY29uIHVpLWljb24tY2FyYXQtMi1uLXMiLAoJCSJzU29ydEpVSUFzY0FsbG93ZWQiOiAiY3NzX3JpZ2h0IHVpLWljb24gdWktaWNvbi1jYXJhdC0xLW4iLAoJCSJzU29ydEpVSURlc2NBbGxvd2VkIjogImNzc19yaWdodCB1aS1pY29uIHVpLWljb24tY2FyYXQtMS1zIiwKCQkic1NvcnRKVUlXcmFwcGVyIjogIkRhdGFUYWJsZXNfc29ydF93cmFwcGVyIiwKCQkKCQkvKiBTY3JvbGxpbmcgKi8KCQkic1Njcm9sbFdyYXBwZXIiOiAiZGF0YVRhYmxlc19zY3JvbGwiLAoJCSJzU2Nyb2xsSGVhZCI6ICJkYXRhVGFibGVzX3Njcm9sbEhlYWQgdWktc3RhdGUtZGVmYXVsdCIsCgkJInNTY3JvbGxIZWFkSW5uZXIiOiAiZGF0YVRhYmxlc19zY3JvbGxIZWFkSW5uZXIiLAoJCSJzU2Nyb2xsQm9keSI6ICJkYXRhVGFibGVzX3Njcm9sbEJvZHkiLAoJCSJzU2Nyb2xsRm9vdCI6ICJkYXRhVGFibGVzX3Njcm9sbEZvb3QgdWktc3RhdGUtZGVmYXVsdCIsCgkJInNTY3JvbGxGb290SW5uZXIiOiAiZGF0YVRhYmxlc19zY3JvbGxGb290SW5uZXIiLAoJCQoJCS8qIE1pc2MgKi8KCQkic0Zvb3RlclRIIjogInVpLXN0YXRlLWRlZmF1bHQiCgl9OwoJCgkvKgoJICogVmFyaWFibGU6IG9QYWdpbmF0aW9uCgkgKiBQdXJwb3NlOiAgQ29udGFpbmVyIGZvciB0aGUgdmFyaW91cyB0eXBlIG9mIHBhZ2luYXRpb24gdGhhdCBkYXRhVGFibGVzIHN1cHBvcnRzCgkgKiBTY29wZTogICAgalF1ZXJ5LmZuLmRhdGFUYWJsZUV4dAoJICovCglfb0V4dC5vUGFnaW5hdGlvbiA9IHsKCQkvKgoJCSAqIFZhcmlhYmxlOiB0d29fYnV0dG9uCgkJICogUHVycG9zZTogIFN0YW5kYXJkIHR3byBidXR0b24gKGZvcndhcmQvYmFjaykgcGFnaW5hdGlvbgoJIAkgKiBTY29wZTogICAgalF1ZXJ5LmZuLmRhdGFUYWJsZUV4dC5vUGFnaW5hdGlvbgoJCSAqLwoJCSJ0d29fYnV0dG9uIjogewoJCQkvKgoJCQkgKiBGdW5jdGlvbjogb1BhZ2luYXRpb24udHdvX2J1dHRvbi5mbkluaXQKCQkJICogUHVycG9zZTogIEluaXRhbGlzZSBkb20gZWxlbWVudHMgcmVxdWlyZWQgZm9yIHBhZ2luYXRpb24gd2l0aCBmb3J3YXJkL2JhY2sgYnV0dG9ucyBvbmx5CgkJCSAqIFJldHVybnM6ICAtCgkgCQkgKiBJbnB1dHM6ICAgb2JqZWN0Om9TZXR0aW5ncyAtIGRhdGFUYWJsZXMgc2V0dGluZ3Mgb2JqZWN0CgkgICAgICogICAgICAgICAgIG5vZGU6blBhZ2luZyAtIHRoZSBESVYgd2hpY2ggY29udGFpbnMgdGhpcyBwYWdpbmF0aW9uIGNvbnRyb2wKCQkJICogICAgICAgICAgIGZ1bmN0aW9uOmZuQ2FsbGJhY2tEcmF3IC0gZHJhdyBmdW5jdGlvbiB3aGljaCBtdXN0IGJlIGNhbGxlZCBvbiB1cGRhdGUKCQkJICovCgkJCSJmbkluaXQiOiBmdW5jdGlvbiAoIG9TZXR0aW5ncywgblBhZ2luZywgZm5DYWxsYmFja0RyYXcgKQoJCQl7CgkJCQl2YXIgblByZXZpb3VzLCBuTmV4dCwgblByZXZpb3VzSW5uZXIsIG5OZXh0SW5uZXI7CgkJCQkKCQkJCS8qIFN0b3JlIHRoZSBuZXh0IGFuZCBwcmV2aW91cyBlbGVtZW50cyBpbiB0aGUgb1NldHRpbmdzIG9iamVjdCBhcyB0aGV5IGNhbiBiZSB2ZXJ5CgkJCQkgKiB1c2Z1bCBmb3IgYXV0b21hdGlvbiAtIHBhcnRpY3VsYXJseSB0ZXN0aW5nCgkJCQkgKi8KCQkJCWlmICggIW9TZXR0aW5ncy5iSlVJICkKCQkJCXsKCQkJCQluUHJldmlvdXMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCAnZGl2JyApOwoJCQkJCW5OZXh0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCggJ2RpdicgKTsKCQkJCX0KCQkJCWVsc2UKCQkJCXsKCQkJCQluUHJldmlvdXMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCAnYScgKTsKCQkJCQluTmV4dCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoICdhJyApOwoJCQkJCQoJCQkJCW5OZXh0SW5uZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7CgkJCQkJbk5leHRJbm5lci5jbGFzc05hbWUgPSBvU2V0dGluZ3Mub0NsYXNzZXMuc1BhZ2VKVUlOZXh0OwoJCQkJCW5OZXh0LmFwcGVuZENoaWxkKCBuTmV4dElubmVyICk7CgkJCQkJCgkJCQkJblByZXZpb3VzSW5uZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7CgkJCQkJblByZXZpb3VzSW5uZXIuY2xhc3NOYW1lID0gb1NldHRpbmdzLm9DbGFzc2VzLnNQYWdlSlVJUHJldjsKCQkJCQluUHJldmlvdXMuYXBwZW5kQ2hpbGQoIG5QcmV2aW91c0lubmVyICk7CgkJCQl9CgkJCQkKCQkJCW5QcmV2aW91cy5jbGFzc05hbWUgPSBvU2V0dGluZ3Mub0NsYXNzZXMuc1BhZ2VQcmV2RGlzYWJsZWQ7CgkJCQluTmV4dC5jbGFzc05hbWUgPSBvU2V0dGluZ3Mub0NsYXNzZXMuc1BhZ2VOZXh0RGlzYWJsZWQ7CgkJCQkKCQkJCW5QcmV2aW91cy50aXRsZSA9IG9TZXR0aW5ncy5vTGFuZ3VhZ2Uub1BhZ2luYXRlLnNQcmV2aW91czsKCQkJCW5OZXh0LnRpdGxlID0gb1NldHRpbmdzLm9MYW5ndWFnZS5vUGFnaW5hdGUuc05leHQ7CgkJCQkKCQkJCW5QYWdpbmcuYXBwZW5kQ2hpbGQoIG5QcmV2aW91cyApOwoJCQkJblBhZ2luZy5hcHBlbmRDaGlsZCggbk5leHQgKTsKCQkJCQoJCQkJJChuUHJldmlvdXMpLmNsaWNrKCBmdW5jdGlvbigpIHsKCQkJCQlpZiAoIG9TZXR0aW5ncy5vQXBpLl9mblBhZ2VDaGFuZ2UoIG9TZXR0aW5ncywgInByZXZpb3VzIiApICkKCQkJCQl7CgkJCQkJCS8qIE9ubHkgZHJhdyB3aGVuIHRoZSBwYWdlIGhhcyBhY3R1YWxseSBjaGFuZ2VkICovCgkJCQkJCWZuQ2FsbGJhY2tEcmF3KCBvU2V0dGluZ3MgKTsKCQkJCQl9CgkJCQl9ICk7CgkJCQkKCQkJCSQobk5leHQpLmNsaWNrKCBmdW5jdGlvbigpIHsKCQkJCQlpZiAoIG9TZXR0aW5ncy5vQXBpLl9mblBhZ2VDaGFuZ2UoIG9TZXR0aW5ncywgIm5leHQiICkgKQoJCQkJCXsKCQkJCQkJZm5DYWxsYmFja0RyYXcoIG9TZXR0aW5ncyApOwoJCQkJCX0KCQkJCX0gKTsKCQkJCQoJCQkJLyogVGFrZSB0aGUgYnJ1dGFsIGFwcHJvYWNoIHRvIGNhbmNlbGxpbmcgdGV4dCBzZWxlY3Rpb24gKi8KCQkJCSQoblByZXZpb3VzKS5iaW5kKCAnc2VsZWN0c3RhcnQnLCBmdW5jdGlvbiAoKSB7IHJldHVybiBmYWxzZTsgfSApOwoJCQkJJChuTmV4dCkuYmluZCggJ3NlbGVjdHN0YXJ0JywgZnVuY3Rpb24gKCkgeyByZXR1cm4gZmFsc2U7IH0gKTsKCQkJCQoJCQkJLyogSUQgdGhlIGZpcnN0IGVsZW1lbnRzIG9ubHkgKi8KCQkJCWlmICggb1NldHRpbmdzLnNUYWJsZUlkICE9PSAnJyAmJiB0eXBlb2Ygb1NldHRpbmdzLmFhbkZlYXR1cmVzLnAgPT0gInVuZGVmaW5lZCIgKQoJCQkJewoJCQkJCW5QYWdpbmcuc2V0QXR0cmlidXRlKCAnaWQnLCBvU2V0dGluZ3Muc1RhYmxlSWQrJ19wYWdpbmF0ZScgKTsKCQkJCQluUHJldmlvdXMuc2V0QXR0cmlidXRlKCAnaWQnLCBvU2V0dGluZ3Muc1RhYmxlSWQrJ19wcmV2aW91cycgKTsKCQkJCQluTmV4dC5zZXRBdHRyaWJ1dGUoICdpZCcsIG9TZXR0aW5ncy5zVGFibGVJZCsnX25leHQnICk7CgkJCQl9CgkJCX0sCgkJCQoJCQkvKgoJCQkgKiBGdW5jdGlvbjogb1BhZ2luYXRpb24udHdvX2J1dHRvbi5mblVwZGF0ZQoJCQkgKiBQdXJwb3NlOiAgVXBkYXRlIHRoZSB0d28gYnV0dG9uIHBhZ2luYXRpb24gYXQgdGhlIGVuZCBvZiB0aGUgZHJhdwoJCQkgKiBSZXR1cm5zOiAgLQoJIAkJICogSW5wdXRzOiAgIG9iamVjdDpvU2V0dGluZ3MgLSBkYXRhVGFibGVzIHNldHRpbmdzIG9iamVjdAoJCQkgKiAgICAgICAgICAgZnVuY3Rpb246Zm5DYWxsYmFja0RyYXcgLSBkcmF3IGZ1bmN0aW9uIHRvIGNhbGwgb24gcGFnZSBjaGFuZ2UKCQkJICovCgkJCSJmblVwZGF0ZSI6IGZ1bmN0aW9uICggb1NldHRpbmdzLCBmbkNhbGxiYWNrRHJhdyApCgkJCXsKCQkJCWlmICggIW9TZXR0aW5ncy5hYW5GZWF0dXJlcy5wICkKCQkJCXsKCQkJCQlyZXR1cm47CgkJCQl9CgkJCQkKCQkJCS8qIExvb3Agb3ZlciBlYWNoIGluc3RhbmNlIG9mIHRoZSBwYWdlciAqLwoJCQkJdmFyIGFuID0gb1NldHRpbmdzLmFhbkZlYXR1cmVzLnA7CgkJCQlmb3IgKCB2YXIgaT0wLCBpTGVuPWFuLmxlbmd0aCA7IGk8aUxlbiA7IGkrKyApCgkJCQl7CgkJCQkJaWYgKCBhbltpXS5jaGlsZE5vZGVzLmxlbmd0aCAhPT0gMCApCgkJCQkJewoJCQkJCQlhbltpXS5jaGlsZE5vZGVzWzBdLmNsYXNzTmFtZSA9IAoJCQkJCQkJKCBvU2V0dGluZ3MuX2lEaXNwbGF5U3RhcnQgPT09IDAgKSA/IAoJCQkJCQkJb1NldHRpbmdzLm9DbGFzc2VzLnNQYWdlUHJldkRpc2FibGVkIDogb1NldHRpbmdzLm9DbGFzc2VzLnNQYWdlUHJldkVuYWJsZWQ7CgkJCQkJCQoJCQkJCQlhbltpXS5jaGlsZE5vZGVzWzFdLmNsYXNzTmFtZSA9IAoJCQkJCQkJKCBvU2V0dGluZ3MuZm5EaXNwbGF5RW5kKCkgPT0gb1NldHRpbmdzLmZuUmVjb3Jkc0Rpc3BsYXkoKSApID8gCgkJCQkJCQlvU2V0dGluZ3Mub0NsYXNzZXMuc1BhZ2VOZXh0RGlzYWJsZWQgOiBvU2V0dGluZ3Mub0NsYXNzZXMuc1BhZ2VOZXh0RW5hYmxlZDsKCQkJCQl9CgkJCQl9CgkJCX0KCQl9LAoJCQoJCQoJCS8qCgkJICogVmFyaWFibGU6IGlGdWxsTnVtYmVyc1Nob3dQYWdlcwoJCSAqIFB1cnBvc2U6ICBDaGFuZ2UgdGhlIG51bWJlciBvZiBwYWdlcyB3aGljaCBjYW4gYmUgc2VlbgoJIAkgKiBTY29wZTogICAgalF1ZXJ5LmZuLmRhdGFUYWJsZUV4dC5vUGFnaW5hdGlvbgoJCSAqLwoJCSJpRnVsbE51bWJlcnNTaG93UGFnZXMiOiA1LAoJCQoJCS8qCgkJICogVmFyaWFibGU6IGZ1bGxfbnVtYmVycwoJCSAqIFB1cnBvc2U6ICBGdWxsIG51bWJlcnMgcGFnaW5hdGlvbgoJIAkgKiBTY29wZTogICAgalF1ZXJ5LmZuLmRhdGFUYWJsZUV4dC5vUGFnaW5hdGlvbgoJCSAqLwoJCSJmdWxsX251bWJlcnMiOiB7CgkJCS8qCgkJCSAqIEZ1bmN0aW9uOiBvUGFnaW5hdGlvbi5mdWxsX251bWJlcnMuZm5Jbml0CgkJCSAqIFB1cnBvc2U6ICBJbml0YWxpc2UgZG9tIGVsZW1lbnRzIHJlcXVpcmVkIGZvciBwYWdpbmF0aW9uIHdpdGggYSBsaXN0IG9mIHRoZSBwYWdlcwoJCQkgKiBSZXR1cm5zOiAgLQoJIAkJICogSW5wdXRzOiAgIG9iamVjdDpvU2V0dGluZ3MgLSBkYXRhVGFibGVzIHNldHRpbmdzIG9iamVjdAoJICAgICAqICAgICAgICAgICBub2RlOm5QYWdpbmcgLSB0aGUgRElWIHdoaWNoIGNvbnRhaW5zIHRoaXMgcGFnaW5hdGlvbiBjb250cm9sCgkJCSAqICAgICAgICAgICBmdW5jdGlvbjpmbkNhbGxiYWNrRHJhdyAtIGRyYXcgZnVuY3Rpb24gd2hpY2ggbXVzdCBiZSBjYWxsZWQgb24gdXBkYXRlCgkJCSAqLwoJCQkiZm5Jbml0IjogZnVuY3Rpb24gKCBvU2V0dGluZ3MsIG5QYWdpbmcsIGZuQ2FsbGJhY2tEcmF3ICkKCQkJewoJCQkJdmFyIG5GaXJzdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoICdzcGFuJyApOwoJCQkJdmFyIG5QcmV2aW91cyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoICdzcGFuJyApOwoJCQkJdmFyIG5MaXN0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCggJ3NwYW4nICk7CgkJCQl2YXIgbk5leHQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCAnc3BhbicgKTsKCQkJCXZhciBuTGFzdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoICdzcGFuJyApOwoJCQkJCgkJCQluRmlyc3QuaW5uZXJIVE1MID0gb1NldHRpbmdzLm9MYW5ndWFnZS5vUGFnaW5hdGUuc0ZpcnN0OwoJCQkJblByZXZpb3VzLmlubmVySFRNTCA9IG9TZXR0aW5ncy5vTGFuZ3VhZ2Uub1BhZ2luYXRlLnNQcmV2aW91czsKCQkJCW5OZXh0LmlubmVySFRNTCA9IG9TZXR0aW5ncy5vTGFuZ3VhZ2Uub1BhZ2luYXRlLnNOZXh0OwoJCQkJbkxhc3QuaW5uZXJIVE1MID0gb1NldHRpbmdzLm9MYW5ndWFnZS5vUGFnaW5hdGUuc0xhc3Q7CgkJCQkKCQkJCXZhciBvQ2xhc3NlcyA9IG9TZXR0aW5ncy5vQ2xhc3NlczsKCQkJCW5GaXJzdC5jbGFzc05hbWUgPSBvQ2xhc3Nlcy5zUGFnZUJ1dHRvbisiICIrb0NsYXNzZXMuc1BhZ2VGaXJzdDsKCQkJCW5QcmV2aW91cy5jbGFzc05hbWUgPSBvQ2xhc3Nlcy5zUGFnZUJ1dHRvbisiICIrb0NsYXNzZXMuc1BhZ2VQcmV2aW91czsKCQkJCW5OZXh0LmNsYXNzTmFtZT0gb0NsYXNzZXMuc1BhZ2VCdXR0b24rIiAiK29DbGFzc2VzLnNQYWdlTmV4dDsKCQkJCW5MYXN0LmNsYXNzTmFtZSA9IG9DbGFzc2VzLnNQYWdlQnV0dG9uKyIgIitvQ2xhc3Nlcy5zUGFnZUxhc3Q7CgkJCQkKCQkJCW5QYWdpbmcuYXBwZW5kQ2hpbGQoIG5GaXJzdCApOwoJCQkJblBhZ2luZy5hcHBlbmRDaGlsZCggblByZXZpb3VzICk7CgkJCQluUGFnaW5nLmFwcGVuZENoaWxkKCBuTGlzdCApOwoJCQkJblBhZ2luZy5hcHBlbmRDaGlsZCggbk5leHQgKTsKCQkJCW5QYWdpbmcuYXBwZW5kQ2hpbGQoIG5MYXN0ICk7CgkJCQkKCQkJCSQobkZpcnN0KS5jbGljayggZnVuY3Rpb24gKCkgewoJCQkJCWlmICggb1NldHRpbmdzLm9BcGkuX2ZuUGFnZUNoYW5nZSggb1NldHRpbmdzLCAiZmlyc3QiICkgKQoJCQkJCXsKCQkJCQkJZm5DYWxsYmFja0RyYXcoIG9TZXR0aW5ncyApOwoJCQkJCX0KCQkJCX0gKTsKCQkJCQoJCQkJJChuUHJldmlvdXMpLmNsaWNrKCBmdW5jdGlvbigpIHsKCQkJCQlpZiAoIG9TZXR0aW5ncy5vQXBpLl9mblBhZ2VDaGFuZ2UoIG9TZXR0aW5ncywgInByZXZpb3VzIiApICkKCQkJCQl7CgkJCQkJCWZuQ2FsbGJhY2tEcmF3KCBvU2V0dGluZ3MgKTsKCQkJCQl9CgkJCQl9ICk7CgkJCQkKCQkJCSQobk5leHQpLmNsaWNrKCBmdW5jdGlvbigpIHsKCQkJCQlpZiAoIG9TZXR0aW5ncy5vQXBpLl9mblBhZ2VDaGFuZ2UoIG9TZXR0aW5ncywgIm5leHQiICkgKQoJCQkJCXsKCQkJCQkJZm5DYWxsYmFja0RyYXcoIG9TZXR0aW5ncyApOwoJCQkJCX0KCQkJCX0gKTsKCQkJCQoJCQkJJChuTGFzdCkuY2xpY2soIGZ1bmN0aW9uKCkgewoJCQkJCWlmICggb1NldHRpbmdzLm9BcGkuX2ZuUGFnZUNoYW5nZSggb1NldHRpbmdzLCAibGFzdCIgKSApCgkJCQkJewoJCQkJCQlmbkNhbGxiYWNrRHJhdyggb1NldHRpbmdzICk7CgkJCQkJfQoJCQkJfSApOwoJCQkJCgkJCQkvKiBUYWtlIHRoZSBicnV0YWwgYXBwcm9hY2ggdG8gY2FuY2VsbGluZyB0ZXh0IHNlbGVjdGlvbiAqLwoJCQkJJCgnc3BhbicsIG5QYWdpbmcpCgkJCQkJLmJpbmQoICdtb3VzZWRvd24nLCBmdW5jdGlvbiAoKSB7IHJldHVybiBmYWxzZTsgfSApCgkJCQkJLmJpbmQoICdzZWxlY3RzdGFydCcsIGZ1bmN0aW9uICgpIHsgcmV0dXJuIGZhbHNlOyB9ICk7CgkJCQkKCQkJCS8qIElEIHRoZSBmaXJzdCBlbGVtZW50cyBvbmx5ICovCgkJCQlpZiAoIG9TZXR0aW5ncy5zVGFibGVJZCAhPT0gJycgJiYgdHlwZW9mIG9TZXR0aW5ncy5hYW5GZWF0dXJlcy5wID09ICJ1bmRlZmluZWQiICkKCQkJCXsKCQkJCQluUGFnaW5nLnNldEF0dHJpYnV0ZSggJ2lkJywgb1NldHRpbmdzLnNUYWJsZUlkKydfcGFnaW5hdGUnICk7CgkJCQkJbkZpcnN0LnNldEF0dHJpYnV0ZSggJ2lkJywgb1NldHRpbmdzLnNUYWJsZUlkKydfZmlyc3QnICk7CgkJCQkJblByZXZpb3VzLnNldEF0dHJpYnV0ZSggJ2lkJywgb1NldHRpbmdzLnNUYWJsZUlkKydfcHJldmlvdXMnICk7CgkJCQkJbk5leHQuc2V0QXR0cmlidXRlKCAnaWQnLCBvU2V0dGluZ3Muc1RhYmxlSWQrJ19uZXh0JyApOwoJCQkJCW5MYXN0LnNldEF0dHJpYnV0ZSggJ2lkJywgb1NldHRpbmdzLnNUYWJsZUlkKydfbGFzdCcgKTsKCQkJCX0KCQkJfSwKCQkJCgkJCS8qCgkJCSAqIEZ1bmN0aW9uOiBvUGFnaW5hdGlvbi5mdWxsX251bWJlcnMuZm5VcGRhdGUKCQkJICogUHVycG9zZTogIFVwZGF0ZSB0aGUgbGlzdCBvZiBwYWdlIGJ1dHRvbnMgc2hvd3MKCQkJICogUmV0dXJuczogIC0KCSAJCSAqIElucHV0czogICBvYmplY3Q6b1NldHRpbmdzIC0gZGF0YVRhYmxlcyBzZXR0aW5ncyBvYmplY3QKCQkJICogICAgICAgICAgIGZ1bmN0aW9uOmZuQ2FsbGJhY2tEcmF3IC0gZHJhdyBmdW5jdGlvbiB0byBjYWxsIG9uIHBhZ2UgY2hhbmdlCgkJCSAqLwoJCQkiZm5VcGRhdGUiOiBmdW5jdGlvbiAoIG9TZXR0aW5ncywgZm5DYWxsYmFja0RyYXcgKQoJCQl7CgkJCQlpZiAoICFvU2V0dGluZ3MuYWFuRmVhdHVyZXMucCApCgkJCQl7CgkJCQkJcmV0dXJuOwoJCQkJfQoJCQkJCgkJCQl2YXIgaVBhZ2VDb3VudCA9IF9vRXh0Lm9QYWdpbmF0aW9uLmlGdWxsTnVtYmVyc1Nob3dQYWdlczsKCQkJCXZhciBpUGFnZUNvdW50SGFsZiA9IE1hdGguZmxvb3IoaVBhZ2VDb3VudCAvIDIpOwoJCQkJdmFyIGlQYWdlcyA9IE1hdGguY2VpbCgob1NldHRpbmdzLmZuUmVjb3Jkc0Rpc3BsYXkoKSkgLyBvU2V0dGluZ3MuX2lEaXNwbGF5TGVuZ3RoKTsKCQkJCXZhciBpQ3VycmVudFBhZ2UgPSBNYXRoLmNlaWwob1NldHRpbmdzLl9pRGlzcGxheVN0YXJ0IC8gb1NldHRpbmdzLl9pRGlzcGxheUxlbmd0aCkgKyAxOwoJCQkJdmFyIHNMaXN0ID0gIiI7CgkJCQl2YXIgaVN0YXJ0QnV0dG9uLCBpRW5kQnV0dG9uLCBpLCBpTGVuOwoJCQkJdmFyIG9DbGFzc2VzID0gb1NldHRpbmdzLm9DbGFzc2VzOwoJCQkJCgkJCQkvKiBQYWdlcyBjYWxjdWxhdGlvbiAqLwoJCQkJaWYgKGlQYWdlcyA8IGlQYWdlQ291bnQpCgkJCQl7CgkJCQkJaVN0YXJ0QnV0dG9uID0gMTsKCQkJCQlpRW5kQnV0dG9uID0gaVBhZ2VzOwoJCQkJfQoJCQkJZWxzZQoJCQkJewoJCQkJCWlmIChpQ3VycmVudFBhZ2UgPD0gaVBhZ2VDb3VudEhhbGYpCgkJCQkJewoJCQkJCQlpU3RhcnRCdXR0b24gPSAxOwoJCQkJCQlpRW5kQnV0dG9uID0gaVBhZ2VDb3VudDsKCQkJCQl9CgkJCQkJZWxzZQoJCQkJCXsKCQkJCQkJaWYgKGlDdXJyZW50UGFnZSA+PSAoaVBhZ2VzIC0gaVBhZ2VDb3VudEhhbGYpKQoJCQkJCQl7CgkJCQkJCQlpU3RhcnRCdXR0b24gPSBpUGFnZXMgLSBpUGFnZUNvdW50ICsgMTsKCQkJCQkJCWlFbmRCdXR0b24gPSBpUGFnZXM7CgkJCQkJCX0KCQkJCQkJZWxzZQoJCQkJCQl7CgkJCQkJCQlpU3RhcnRCdXR0b24gPSBpQ3VycmVudFBhZ2UgLSBNYXRoLmNlaWwoaVBhZ2VDb3VudCAvIDIpICsgMTsKCQkJCQkJCWlFbmRCdXR0b24gPSBpU3RhcnRCdXR0b24gKyBpUGFnZUNvdW50IC0gMTsKCQkJCQkJfQoJCQkJCX0KCQkJCX0KCQkJCQoJCQkJLyogQnVpbGQgdGhlIGR5bmFtaWMgbGlzdCAqLwoJCQkJZm9yICggaT1pU3RhcnRCdXR0b24gOyBpPD1pRW5kQnV0dG9uIDsgaSsrICkKCQkJCXsKCQkJCQlpZiAoIGlDdXJyZW50UGFnZSAhPSBpICkKCQkJCQl7CgkJCQkJCXNMaXN0ICs9ICc8c3BhbiBjbGFzcz0iJytvQ2xhc3Nlcy5zUGFnZUJ1dHRvbisnIj4nK2krJzwvc3Bhbj4nOwoJCQkJCX0KCQkJCQllbHNlCgkJCQkJewoJCQkJCQlzTGlzdCArPSAnPHNwYW4gY2xhc3M9Iicrb0NsYXNzZXMuc1BhZ2VCdXR0b25BY3RpdmUrJyI+JytpKyc8L3NwYW4+JzsKCQkJCQl9CgkJCQl9CgkJCQkKCQkJCS8qIExvb3Agb3ZlciBlYWNoIGluc3RhbmNlIG9mIHRoZSBwYWdlciAqLwoJCQkJdmFyIGFuID0gb1NldHRpbmdzLmFhbkZlYXR1cmVzLnA7CgkJCQl2YXIgYW5CdXR0b25zLCBhblN0YXRpYywgblBhZ2luYXRlTGlzdDsKCQkJCXZhciBmbkNsaWNrID0gZnVuY3Rpb24oKSB7CgkJCQkJLyogVXNlIHRoZSBpbmZvcm1hdGlvbiBpbiB0aGUgZWxlbWVudCB0byBqdW1wIHRvIHRoZSByZXF1aXJlZCBwYWdlICovCgkJCQkJdmFyIGlUYXJnZXQgPSAodGhpcy5pbm5lckhUTUwgKiAxKSAtIDE7CgkJCQkJb1NldHRpbmdzLl9pRGlzcGxheVN0YXJ0ID0gaVRhcmdldCAqIG9TZXR0aW5ncy5faURpc3BsYXlMZW5ndGg7CgkJCQkJZm5DYWxsYmFja0RyYXcoIG9TZXR0aW5ncyApOwoJCQkJCXJldHVybiBmYWxzZTsKCQkJCX07CgkJCQl2YXIgZm5GYWxzZSA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIGZhbHNlOyB9OwoJCQkJCgkJCQlmb3IgKCBpPTAsIGlMZW49YW4ubGVuZ3RoIDsgaTxpTGVuIDsgaSsrICkKCQkJCXsKCQkJCQlpZiAoIGFuW2ldLmNoaWxkTm9kZXMubGVuZ3RoID09PSAwICkKCQkJCQl7CgkJCQkJCWNvbnRpbnVlOwoJCQkJCX0KCQkJCQkKCQkJCQkvKiBCdWlsZCB1cCB0aGUgZHluYW1pYyBsaXN0IGZvcnN0IC0gaHRtbCBhbmQgbGlzdGVuZXJzICovCgkJCQkJdmFyIHFqUGFnaW5hdGVMaXN0ID0gJCgnc3BhbjplcSgyKScsIGFuW2ldKTsKCQkJCQlxalBhZ2luYXRlTGlzdC5odG1sKCBzTGlzdCApOwoJCQkJCSQoJ3NwYW4nLCBxalBhZ2luYXRlTGlzdCkuY2xpY2soIGZuQ2xpY2sgKS5iaW5kKCAnbW91c2Vkb3duJywgZm5GYWxzZSApCgkJCQkJCS5iaW5kKCAnc2VsZWN0c3RhcnQnLCBmbkZhbHNlICk7CgkJCQkJCgkJCQkJLyogVXBkYXRlIHRoZSAncHJlbWFuZW50IGJvdHRvbidzIGNsYXNzZXMgKi8KCQkJCQlhbkJ1dHRvbnMgPSBhbltpXS5nZXRFbGVtZW50c0J5VGFnTmFtZSgnc3BhbicpOwoJCQkJCWFuU3RhdGljID0gWwoJCQkJCQlhbkJ1dHRvbnNbMF0sIGFuQnV0dG9uc1sxXSwgCgkJCQkJCWFuQnV0dG9uc1thbkJ1dHRvbnMubGVuZ3RoLTJdLCBhbkJ1dHRvbnNbYW5CdXR0b25zLmxlbmd0aC0xXQoJCQkJCV07CgkJCQkJJChhblN0YXRpYykucmVtb3ZlQ2xhc3MoIG9DbGFzc2VzLnNQYWdlQnV0dG9uKyIgIitvQ2xhc3Nlcy5zUGFnZUJ1dHRvbkFjdGl2ZSsiICIrb0NsYXNzZXMuc1BhZ2VCdXR0b25TdGF0aWNEaXNhYmxlZCApOwoJCQkJCWlmICggaUN1cnJlbnRQYWdlID09IDEgKQoJCQkJCXsKCQkJCQkJYW5TdGF0aWNbMF0uY2xhc3NOYW1lICs9ICIgIitvQ2xhc3Nlcy5zUGFnZUJ1dHRvblN0YXRpY0Rpc2FibGVkOwoJCQkJCQlhblN0YXRpY1sxXS5jbGFzc05hbWUgKz0gIiAiK29DbGFzc2VzLnNQYWdlQnV0dG9uU3RhdGljRGlzYWJsZWQ7CgkJCQkJfQoJCQkJCWVsc2UKCQkJCQl7CgkJCQkJCWFuU3RhdGljWzBdLmNsYXNzTmFtZSArPSAiICIrb0NsYXNzZXMuc1BhZ2VCdXR0b247CgkJCQkJCWFuU3RhdGljWzFdLmNsYXNzTmFtZSArPSAiICIrb0NsYXNzZXMuc1BhZ2VCdXR0b247CgkJCQkJfQoJCQkJCQoJCQkJCWlmICggaVBhZ2VzID09PSAwIHx8IGlDdXJyZW50UGFnZSA9PSBpUGFnZXMgfHwgb1NldHRpbmdzLl9pRGlzcGxheUxlbmd0aCA9PSAtMSApCgkJCQkJewoJCQkJCQlhblN0YXRpY1syXS5jbGFzc05hbWUgKz0gIiAiK29DbGFzc2VzLnNQYWdlQnV0dG9uU3RhdGljRGlzYWJsZWQ7CgkJCQkJCWFuU3RhdGljWzNdLmNsYXNzTmFtZSArPSAiICIrb0NsYXNzZXMuc1BhZ2VCdXR0b25TdGF0aWNEaXNhYmxlZDsKCQkJCQl9CgkJCQkJZWxzZQoJCQkJCXsKCQkJCQkJYW5TdGF0aWNbMl0uY2xhc3NOYW1lICs9ICIgIitvQ2xhc3Nlcy5zUGFnZUJ1dHRvbjsKCQkJCQkJYW5TdGF0aWNbM10uY2xhc3NOYW1lICs9ICIgIitvQ2xhc3Nlcy5zUGFnZUJ1dHRvbjsKCQkJCQl9CgkJCQl9CgkJCX0KCQl9Cgl9OwoJCgkvKgoJICogVmFyaWFibGU6IG9Tb3J0CgkgKiBQdXJwb3NlOiAgV3JhcHBlciBmb3IgdGhlIHNvcnRpbmcgZnVuY3Rpb25zIHRoYXQgY2FuIGJlIHVzZWQgaW4gRGF0YVRhYmxlcwoJICogU2NvcGU6ICAgIGpRdWVyeS5mbi5kYXRhVGFibGVFeHQKCSAqIE5vdGVzOiAgICBUaGUgZnVuY3Rpb25zIHByb3ZpZGVkIGluIHRoaXMgb2JqZWN0IGFyZSBiYXNpY2FsbHkgc3RhbmRhcmQgamF2YXNjcmlwdCBzb3J0CgkgKiAgIGZ1bmN0aW9ucyAtIHRoZXkgZXhwZWN0IHR3byBpbnB1dHMgd2hpY2ggdGhleSB0aGVuIGNvbXBhcmUgYW5kIHRoZW4gcmV0dXJuIGEgcHJpb3JpdHkKCSAqICAgcmVzdWx0LiBGb3IgZWFjaCBzb3J0IG1ldGhvZCBhZGRlZCwgdHdvIGZ1bmN0aW9ucyBuZWVkIHRvIGJlIGRlZmluZWQsIGFuIGFzY2VuZGluZyBzb3J0IGFuZAoJICogICBhIGRlc2NlbmRpbmcgc29ydC4KCSAqLwoJX29FeHQub1NvcnQgPSB7CgkJLyoKCQkgKiB0ZXh0IHNvcnRpbmcKCQkgKi8KCQkic3RyaW5nLWFzYyI6IGZ1bmN0aW9uICggYSwgYiApCgkJewoJCQl2YXIgeCA9IGEudG9Mb3dlckNhc2UoKTsKCQkJdmFyIHkgPSBiLnRvTG93ZXJDYXNlKCk7CgkJCXJldHVybiAoKHggPCB5KSA/IC0xIDogKCh4ID4geSkgPyAxIDogMCkpOwoJCX0sCgkJCgkJInN0cmluZy1kZXNjIjogZnVuY3Rpb24gKCBhLCBiICkKCQl7CgkJCXZhciB4ID0gYS50b0xvd2VyQ2FzZSgpOwoJCQl2YXIgeSA9IGIudG9Mb3dlckNhc2UoKTsKCQkJcmV0dXJuICgoeCA8IHkpID8gMSA6ICgoeCA+IHkpID8gLTEgOiAwKSk7CgkJfSwKCQkKCQkKCQkvKgoJCSAqIGh0bWwgc29ydGluZyAoaWdub3JlIGh0bWwgdGFncykKCQkgKi8KCQkiaHRtbC1hc2MiOiBmdW5jdGlvbiAoIGEsIGIgKQoJCXsKCQkJdmFyIHggPSBhLnJlcGxhY2UoIC88Lio/Pi9nLCAiIiApLnRvTG93ZXJDYXNlKCk7CgkJCXZhciB5ID0gYi5yZXBsYWNlKCAvPC4qPz4vZywgIiIgKS50b0xvd2VyQ2FzZSgpOwoJCQlyZXR1cm4gKCh4IDwgeSkgPyAtMSA6ICgoeCA+IHkpID8gMSA6IDApKTsKCQl9LAoJCQoJCSJodG1sLWRlc2MiOiBmdW5jdGlvbiAoIGEsIGIgKQoJCXsKCQkJdmFyIHggPSBhLnJlcGxhY2UoIC88Lio/Pi9nLCAiIiApLnRvTG93ZXJDYXNlKCk7CgkJCXZhciB5ID0gYi5yZXBsYWNlKCAvPC4qPz4vZywgIiIgKS50b0xvd2VyQ2FzZSgpOwoJCQlyZXR1cm4gKCh4IDwgeSkgPyAxIDogKCh4ID4geSkgPyAtMSA6IDApKTsKCQl9LAoJCQoJCQoJCS8qCgkJICogZGF0ZSBzb3J0aW5nCgkJICovCgkJImRhdGUtYXNjIjogZnVuY3Rpb24gKCBhLCBiICkKCQl7CgkJCXZhciB4ID0gRGF0ZS5wYXJzZSggYSApOwoJCQl2YXIgeSA9IERhdGUucGFyc2UoIGIgKTsKCQkJCgkJCWlmICggaXNOYU4oeCkgfHwgeD09PSIiICkKCQkJewogICAgCQl4ID0gRGF0ZS5wYXJzZSggIjAxLzAxLzE5NzAgMDA6MDA6MDAiICk7CgkJCX0KCQkJaWYgKCBpc05hTih5KSB8fCB5PT09IiIgKQoJCQl7CgkJCQl5ID0JRGF0ZS5wYXJzZSggIjAxLzAxLzE5NzAgMDA6MDA6MDAiICk7CgkJCX0KCQkJCgkJCXJldHVybiB4IC0geTsKCQl9LAoJCQoJCSJkYXRlLWRlc2MiOiBmdW5jdGlvbiAoIGEsIGIgKQoJCXsKCQkJdmFyIHggPSBEYXRlLnBhcnNlKCBhICk7CgkJCXZhciB5ID0gRGF0ZS5wYXJzZSggYiApOwoJCQkKCQkJaWYgKCBpc05hTih4KSB8fCB4PT09IiIgKQoJCQl7CiAgICAJCXggPSBEYXRlLnBhcnNlKCAiMDEvMDEvMTk3MCAwMDowMDowMCIgKTsKCQkJfQoJCQlpZiAoIGlzTmFOKHkpIHx8IHk9PT0iIiApCgkJCXsKCQkJCXkgPQlEYXRlLnBhcnNlKCAiMDEvMDEvMTk3MCAwMDowMDowMCIgKTsKCQkJfQoJCQkKCQkJcmV0dXJuIHkgLSB4OwoJCX0sCgkJCgkJCgkJLyoKCQkgKiBudW1lcmljYWwgc29ydGluZwoJCSAqLwoJCSJudW1lcmljLWFzYyI6IGZ1bmN0aW9uICggYSwgYiApCgkJewoJCQl2YXIgeCA9IChhPT0iLSIgfHwgYT09PSIiKSA/IDAgOiBhKjE7CgkJCXZhciB5ID0gKGI9PSItIiB8fCBiPT09IiIpID8gMCA6IGIqMTsKCQkJcmV0dXJuIHggLSB5OwoJCX0sCgkJCgkJIm51bWVyaWMtZGVzYyI6IGZ1bmN0aW9uICggYSwgYiApCgkJewoJCQl2YXIgeCA9IChhPT0iLSIgfHwgYT09PSIiKSA/IDAgOiBhKjE7CgkJCXZhciB5ID0gKGI9PSItIiB8fCBiPT09IiIpID8gMCA6IGIqMTsKCQkJcmV0dXJuIHkgLSB4OwoJCX0KCX07CgkKCQoJLyoKCSAqIFZhcmlhYmxlOiBhVHlwZXMKCSAqIFB1cnBvc2U6ICBDb250YWluZXIgZm9yIHRoZSB2YXJpb3VzIHR5cGUgb2YgdHlwZSBkZXRlY3Rpb24gdGhhdCBkYXRhVGFibGVzIHN1cHBvcnRzCgkgKiBTY29wZTogICAgalF1ZXJ5LmZuLmRhdGFUYWJsZUV4dAoJICogTm90ZXM6ICAgIFRoZSBmdW5jdGlvbnMgaW4gdGhpcyBhcnJheSBhcmUgZXhwZWN0ZWQgdG8gcGFyc2UgYSBzdHJpbmcgdG8gc2VlIGlmIGl0IGlzIGEgZGF0YQoJICogICB0eXBlIHRoYXQgaXQgcmVjb2duaXNlcy4gSWYgc28gdGhlbiB0aGUgZnVuY3Rpb24gc2hvdWxkIHJldHVybiB0aGUgbmFtZSBvZiB0aGUgdHlwZSAoYQoJICogICBjb3JyZXNwb25kaW5nIHNvcnQgZnVuY3Rpb24gc2hvdWxkIGJlIGRlZmluZWQhKSwgaWYgdGhlIHR5cGUgaXMgbm90IHJlY29nbmlzZWQgdGhlbiB0aGUKCSAqICAgZnVuY3Rpb24gc2hvdWxkIHJldHVybiBudWxsIHN1Y2ggdGhhdCB0aGUgcGFyc2VyIGFuZCBtb3ZlIG9uIHRvIGNoZWNrIHRoZSBuZXh0IHR5cGUuCgkgKiAgIE5vdGUgdGhhdCBvcmRlcmluZyBpcyBpbXBvcnRhbnQgaW4gdGhpcyBhcnJheSAtIHRoZSBmdW5jdGlvbnMgYXJlIHByb2Nlc3NlZCBsaW5lYXJseSwKCSAqICAgc3RhcnRpbmcgYXQgaW5kZXggMC4KCSAqICAgTm90ZSB0aGF0IHRoZSBpbnB1dCBmb3IgdGhlc2UgZnVuY3Rpb25zIGlzIGFsd2F5cyBhIHN0cmluZyEgSXQgY2Fubm90IGJlIGFueSBvdGhlciBkYXRhCgkgKiAgIHR5cGUKCSAqLwoJX29FeHQuYVR5cGVzID0gWwoJCS8qCgkJICogRnVuY3Rpb246IC0KCQkgKiBQdXJwb3NlOiAgQ2hlY2sgdG8gc2VlIGlmIGEgc3RyaW5nIGlzIG51bWVyaWMKCQkgKiBSZXR1cm5zOiAgc3RyaW5nOidudW1lcmljJyBvciBudWxsCgkJICogSW5wdXRzOiAgIHN0cmluZzpzVGV4dCAtIHN0cmluZyB0byBjaGVjawoJCSAqLwoJCWZ1bmN0aW9uICggc0RhdGEgKQoJCXsKCQkJLyogQWxsb3cgemVybyBsZW5ndGggc3RyaW5ncyBhcyBhIG51bWJlciAqLwoJCQlpZiAoIHNEYXRhLmxlbmd0aCA9PT0gMCApCgkJCXsKCQkJCXJldHVybiAnbnVtZXJpYyc7CgkJCX0KCQkJCgkJCXZhciBzVmFsaWRGaXJzdENoYXJzID0gIjAxMjM0NTY3ODktIjsKCQkJdmFyIHNWYWxpZENoYXJzID0gIjAxMjM0NTY3ODkuIjsKCQkJdmFyIENoYXI7CgkJCXZhciBiRGVjaW1hbCA9IGZhbHNlOwoJCQkKCQkJLyogQ2hlY2sgZm9yIGEgdmFsaWQgZmlyc3QgY2hhciAobm8gcGVyaW9kIGFuZCBhbGxvdyBuZWdhdGl2ZXMpICovCgkJCUNoYXIgPSBzRGF0YS5jaGFyQXQoMCk7IAoJCQlpZiAoc1ZhbGlkRmlyc3RDaGFycy5pbmRleE9mKENoYXIpID09IC0xKSAKCQkJewoJCQkJcmV0dXJuIG51bGw7CgkJCX0KCQkJCgkJCS8qIENoZWNrIGFsbCB0aGUgb3RoZXIgY2hhcmFjdGVycyBhcmUgdmFsaWQgKi8KCQkJZm9yICggdmFyIGk9MSA7IGk8c0RhdGEubGVuZ3RoIDsgaSsrICkgCgkJCXsKCQkJCUNoYXIgPSBzRGF0YS5jaGFyQXQoaSk7IAoJCQkJaWYgKHNWYWxpZENoYXJzLmluZGV4T2YoQ2hhcikgPT0gLTEpIAoJCQkJewoJCQkJCXJldHVybiBudWxsOwoJCQkJfQoJCQkJCgkJCQkvKiBPbmx5IGFsbG93ZWQgb25lIGRlY2ltYWwgcGxhY2UuLi4gKi8KCQkJCWlmICggQ2hhciA9PSAiLiIgKQoJCQkJewoJCQkJCWlmICggYkRlY2ltYWwgKQoJCQkJCXsKCQkJCQkJcmV0dXJuIG51bGw7CgkJCQkJfQoJCQkJCWJEZWNpbWFsID0gdHJ1ZTsKCQkJCX0KCQkJfQoJCQkKCQkJcmV0dXJuICdudW1lcmljJzsKCQl9LAoJCQoJCS8qCgkJICogRnVuY3Rpb246IC0KCQkgKiBQdXJwb3NlOiAgQ2hlY2sgdG8gc2VlIGlmIGEgc3RyaW5nIGlzIGFjdHVhbGx5IGEgZm9ybWF0dGVkIGRhdGUKCQkgKiBSZXR1cm5zOiAgc3RyaW5nOidkYXRlJyBvciBudWxsCgkJICogSW5wdXRzOiAgIHN0cmluZzpzVGV4dCAtIHN0cmluZyB0byBjaGVjawoJCSAqLwoJCWZ1bmN0aW9uICggc0RhdGEgKQoJCXsKCQkJdmFyIGlQYXJzZSA9IERhdGUucGFyc2Uoc0RhdGEpOwoJCQlpZiAoIChpUGFyc2UgIT09IG51bGwgJiYgIWlzTmFOKGlQYXJzZSkpIHx8IHNEYXRhLmxlbmd0aCA9PT0gMCApCgkJCXsKCQkJCXJldHVybiAnZGF0ZSc7CgkJCX0KCQkJcmV0dXJuIG51bGw7CgkJfSwKCQkKCQkvKgoJCSAqIEZ1bmN0aW9uOiAtCgkJICogUHVycG9zZTogIENoZWNrIHRvIHNlZSBpZiBhIHN0cmluZyBzaG91bGQgYmUgdHJlYXRlZCBhcyBhbiBIVE1MIHN0cmluZwoJCSAqIFJldHVybnM6ICBzdHJpbmc6J2h0bWwnIG9yIG51bGwKCQkgKiBJbnB1dHM6ICAgc3RyaW5nOnNUZXh0IC0gc3RyaW5nIHRvIGNoZWNrCgkJICovCgkJZnVuY3Rpb24gKCBzRGF0YSApCgkJewoJCQlpZiAoIHNEYXRhLmluZGV4T2YoJzwnKSAhPSAtMSAmJiBzRGF0YS5pbmRleE9mKCc+JykgIT0gLTEgKQoJCQl7CgkJCQlyZXR1cm4gJ2h0bWwnOwoJCQl9CgkJCXJldHVybiBudWxsOwoJCX0KCV07CgkKCS8qCgkgKiBGdW5jdGlvbjogZm5WZXJzaW9uQ2hlY2sKCSAqIFB1cnBvc2U6ICBDaGVjayBhIHZlcnNpb24gc3RyaW5nIGFnYWluc3QgdGhpcyB2ZXJzaW9uIG9mIERhdGFUYWJsZXMuIFVzZWZ1bCBmb3IgcGx1Zy1pbnMKCSAqIFJldHVybnM6ICBib29sOnRydWUgLXRoaXMgdmVyc2lvbiBvZiBEYXRhVGFibGVzIGlzIGdyZWF0ZXIgb3IgZXF1YWwgdG8gdGhlIHJlcXVpcmVkIHZlcnNpb24KCSAqICAgICAgICAgICAgICAgIGZhbHNlIC10aGlzIHZlcnNpb24gb2YgRGF0YVRhbGVzIGlzIG5vdCBzdWl0YWJsZQoJICogSW5wdXRzOiAgIHN0cmluZzpzVmVyc2lvbiAtIHRoZSB2ZXJzaW9uIHRvIGNoZWNrIGFnYWluc3QuIE1heSBiZSBpbiB0aGUgZm9sbG93aW5nIGZvcm1hdHM6CgkgKiAgICAgICAgICAgICAiYSIsICJhLmIiIG9yICJhLmIuYyIKCSAqIE5vdGVzOiAgICBUaGlzIGZ1bmN0aW9uIHdpbGwgb25seSBjaGVjayB0aGUgZmlyc3QgdGhyZWUgcGFydHMgb2YgYSB2ZXJzaW9uIHN0cmluZy4gSXQgaXMKCSAqICAgYXNzdW1lZCB0aGF0IGJldGEgYW5kIGRldiB2ZXJzaW9ucyB3aWxsIG1lZXQgdGhlIHJlcXVpcmVtZW50cy4gVGhpcyBtaWdodCBjaGFuZ2UgaW4gZnV0dXJlCgkgKi8KCV9vRXh0LmZuVmVyc2lvbkNoZWNrID0gZnVuY3Rpb24oIHNWZXJzaW9uICkKCXsKCQkvKiBUaGlzIGlzIGNoZWFwLCBidXQgdmVyeSBlZmZlY3RpdmUgKi8KCQl2YXIgZm5aUGFkID0gZnVuY3Rpb24gKFpwYWQsIGNvdW50KQoJCXsKCQkJd2hpbGUoWnBhZC5sZW5ndGggPCBjb3VudCkgewoJCQkJWnBhZCArPSAnMCc7CgkJCX0KCQkJcmV0dXJuIFpwYWQ7CgkJfTsKCQl2YXIgYVRoaXMgPSBfb0V4dC5zVmVyc2lvbi5zcGxpdCgnLicpOwoJCXZhciBhVGhhdCA9IHNWZXJzaW9uLnNwbGl0KCcuJyk7CgkJdmFyIHNUaGlzID0gJycsIHNUaGF0ID0gJyc7CgkJCgkJZm9yICggdmFyIGk9MCwgaUxlbj1hVGhhdC5sZW5ndGggOyBpPGlMZW4gOyBpKysgKQoJCXsKCQkJc1RoaXMgKz0gZm5aUGFkKCBhVGhpc1tpXSwgMyApOwoJCQlzVGhhdCArPSBmblpQYWQoIGFUaGF0W2ldLCAzICk7CgkJfQoJCQoJCXJldHVybiBwYXJzZUludChzVGhpcywgMTApID49IHBhcnNlSW50KHNUaGF0LCAxMCk7Cgl9OwoJCgkvKgoJICogVmFyaWFibGU6IF9vRXh0ZXJuQ29uZmlnCgkgKiBQdXJwb3NlOiAgU3RvcmUgaW5mb3JtYXRpb24gZm9yIERhdGFUYWJsZXMgdG8gYWNjZXNzIGdsb2JhbGx5IGFib3V0IG90aGVyIGluc3RhbmNlcwoJICogU2NvcGU6ICAgIGpRdWVyeS5mbi5kYXRhVGFibGVFeHQKCSAqLwoJX29FeHQuX29FeHRlcm5Db25maWcgPSB7CgkJLyogaW50OmlOZXh0VW5pcXVlIC0gbmV4dCB1bmlxdWUgbnVtYmVyIGZvciBhbiBpbnN0YW5jZSAqLwoJCSJpTmV4dFVuaXF1ZSI6IDAKCX07CgkKCQoJLyogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKgoJICogU2VjdGlvbiAtIERhdGFUYWJsZXMgcHJvdG90eXBlCgkgKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqLwoJCgkvKgoJICogRnVuY3Rpb246IGRhdGFUYWJsZQoJICogUHVycG9zZTogIERhdGFUYWJsZXMgaW5mb3JtYXRpb24KCSAqIFJldHVybnM6ICAtCgkgKiBJbnB1dHM6ICAgb2JqZWN0Om9Jbml0IC0gaW5pdGFsaXNhdGlvbiBvcHRpb25zIGZvciB0aGUgdGFibGUKCSAqLwoJJC5mbi5kYXRhVGFibGUgPSBmdW5jdGlvbiggb0luaXQgKQoJewoJCS8qCgkJICogRnVuY3Rpb246IGNsYXNzU2V0dGluZ3MKCQkgKiBQdXJwb3NlOiAgU2V0dGluZ3MgY29udGFpbmVyIGZ1bmN0aW9uIGZvciBhbGwgJ2NsYXNzJyBwcm9wZXJ0aWVzIHdoaWNoIGFyZSByZXF1aXJlZAoJCSAqICAgYnkgZGF0YVRhYmxlcwoJCSAqIFJldHVybnM6ICAtCgkJICogSW5wdXRzOiAgIC0KCQkgKi8KCQlmdW5jdGlvbiBjbGFzc1NldHRpbmdzICgpCgkJewoJCQl0aGlzLmZuUmVjb3Jkc1RvdGFsID0gZnVuY3Rpb24gKCkKCQkJewoJCQkJaWYgKCB0aGlzLm9GZWF0dXJlcy5iU2VydmVyU2lkZSApIHsKCQkJCQlyZXR1cm4gcGFyc2VJbnQodGhpcy5faVJlY29yZHNUb3RhbCwgMTApOwoJCQkJfSBlbHNlIHsKCQkJCQlyZXR1cm4gdGhpcy5haURpc3BsYXlNYXN0ZXIubGVuZ3RoOwoJCQkJfQoJCQl9OwoJCQkKCQkJdGhpcy5mblJlY29yZHNEaXNwbGF5ID0gZnVuY3Rpb24gKCkKCQkJewoJCQkJaWYgKCB0aGlzLm9GZWF0dXJlcy5iU2VydmVyU2lkZSApIHsKCQkJCQlyZXR1cm4gcGFyc2VJbnQodGhpcy5faVJlY29yZHNEaXNwbGF5LCAxMCk7CgkJCQl9IGVsc2UgewoJCQkJCXJldHVybiB0aGlzLmFpRGlzcGxheS5sZW5ndGg7CgkJCQl9CgkJCX07CgkJCQoJCQl0aGlzLmZuRGlzcGxheUVuZCA9IGZ1bmN0aW9uICgpCgkJCXsKCQkJCWlmICggdGhpcy5vRmVhdHVyZXMuYlNlcnZlclNpZGUgKSB7CgkJCQkJaWYgKCB0aGlzLm9GZWF0dXJlcy5iUGFnaW5hdGUgPT09IGZhbHNlIHx8IHRoaXMuX2lEaXNwbGF5TGVuZ3RoID09IC0xICkgewoJCQkJCQlyZXR1cm4gdGhpcy5faURpc3BsYXlTdGFydCt0aGlzLmFpRGlzcGxheS5sZW5ndGg7CgkJCQkJfSBlbHNlIHsKCQkJCQkJcmV0dXJuIE1hdGgubWluKCB0aGlzLl9pRGlzcGxheVN0YXJ0K3RoaXMuX2lEaXNwbGF5TGVuZ3RoLCAKCQkJCQkJCXRoaXMuX2lSZWNvcmRzRGlzcGxheSApOwoJCQkJCX0KCQkJCX0gZWxzZSB7CgkJCQkJcmV0dXJuIHRoaXMuX2lEaXNwbGF5RW5kOwoJCQkJfQoJCQl9OwoJCQkKCQkJLyoKCQkJICogVmFyaWFibGU6IG9JbnN0YW5jZQoJCQkgKiBQdXJwb3NlOiAgVGhlIERhdGFUYWJsZXMgb2JqZWN0IGZvciB0aGlzIHRhYmxlCgkJCSAqIFNjb3BlOiAgICBqUXVlcnkuZGF0YVRhYmxlLmNsYXNzU2V0dGluZ3MgCgkJCSAqLwoJCQl0aGlzLm9JbnN0YW5jZSA9IG51bGw7CgkJCQoJCQkvKgoJCQkgKiBWYXJpYWJsZTogc0luc3RhbmNlCgkJCSAqIFB1cnBvc2U6ICBVbmlxdWUgaWRlbmRpZmllciBmb3IgZWFjaCBpbnN0YW5jZSBvZiB0aGUgRGF0YVRhYmxlcyBvYmplY3QKCQkJICogU2NvcGU6ICAgIGpRdWVyeS5kYXRhVGFibGUuY2xhc3NTZXR0aW5ncyAKCQkJICovCgkJCXRoaXMuc0luc3RhbmNlID0gbnVsbDsKCQkJCgkJCS8qCgkJCSAqIFZhcmlhYmxlOiBvRmVhdHVyZXMKCQkJICogUHVycG9zZTogIEluZGljYXRlIHRoZSBlbmFibGVtZW50IG9mIGtleSBkYXRhVGFibGUgZmVhdHVyZXMKCQkJICogU2NvcGU6ICAgIGpRdWVyeS5kYXRhVGFibGUuY2xhc3NTZXR0aW5ncyAKCQkJICovCgkJCXRoaXMub0ZlYXR1cmVzID0gewoJCQkJImJQYWdpbmF0ZSI6IHRydWUsCgkJCQkiYkxlbmd0aENoYW5nZSI6IHRydWUsCgkJCQkiYkZpbHRlciI6IHRydWUsCgkJCQkiYlNvcnQiOiB0cnVlLAoJCQkJImJJbmZvIjogdHJ1ZSwKCQkJCSJiQXV0b1dpZHRoIjogdHJ1ZSwKCQkJCSJiUHJvY2Vzc2luZyI6IGZhbHNlLAoJCQkJImJTb3J0Q2xhc3NlcyI6IHRydWUsCgkJCQkiYlN0YXRlU2F2ZSI6IGZhbHNlLAoJCQkJImJTZXJ2ZXJTaWRlIjogZmFsc2UKCQkJfTsKCQkJCgkJCS8qCgkJCSAqIFZhcmlhYmxlOiBvU2Nyb2xsCgkJCSAqIFB1cnBvc2U6ICBDb250YWluZXIgZm9yIHNjcm9sbGluZyBvcHRpb25zCgkJCSAqIFNjb3BlOiAgICBqUXVlcnkuZGF0YVRhYmxlLmNsYXNzU2V0dGluZ3MgCgkJCSAqLwoJCQl0aGlzLm9TY3JvbGwgPSB7CgkJCQkic1giOiAiIiwKCQkJCSJzWElubmVyIjogIiIsCgkJCQkic1kiOiAiIiwKCQkJCSJiQ29sbGFwc2UiOiBmYWxzZSwKCQkJCSJiSW5maW5pdGUiOiBmYWxzZSwKCQkJCSJpTG9hZEdhcCI6IDEwMCwKCQkJCSJpQmFyV2lkdGgiOiAwCgkJCX07CgkJCQoJCQkvKgoJCQkgKiBWYXJpYWJsZTogYWFuRmVhdHVyZXMKCQkJICogUHVycG9zZTogIEFycmF5IHJlZmVyZW5jaW5nIHRoZSBub2RlcyB3aGljaCBhcmUgdXNlZCBmb3IgdGhlIGZlYXR1cmVzCgkJCSAqIFNjb3BlOiAgICBqUXVlcnkuZGF0YVRhYmxlLmNsYXNzU2V0dGluZ3MgCgkJCSAqIE5vdGVzOiAgICBUaGUgcGFyYW1ldGVycyBvZiB0aGlzIG9iamVjdCBtYXRjaCB3aGF0IGlzIGFsbG93ZWQgYnkgc0RvbSAtIGkuZS4KCQkJICogICAnbCcgLSBMZW5ndGggY2hhbmdpbmcKCQkJICogICAnZicgLSBGaWx0ZXJpbmcgaW5wdXQKCQkJICogICAndCcgLSBUaGUgdGFibGUhCgkJCSAqICAgJ2knIC0gSW5mb3JtYXRpb24KCQkJICogICAncCcgLSBQYWdpbmF0aW9uCgkJCSAqICAgJ3InIC0gcFJvY2Vzc2luZwoJCQkgKi8KCQkJdGhpcy5hYW5GZWF0dXJlcyA9IFtdOwoJCQkKCQkJLyoKCQkJICogVmFyaWFibGU6IG9MYW5ndWFnZQoJCQkgKiBQdXJwb3NlOiAgU3RvcmUgdGhlIGxhbmd1YWdlIHN0cmluZ3MgdXNlZCBieSBkYXRhVGFibGVzCgkJCSAqIFNjb3BlOiAgICBqUXVlcnkuZGF0YVRhYmxlLmNsYXNzU2V0dGluZ3MKCQkJICogTm90ZXM6ICAgIFRoZSB3b3JkcyBpbiB0aGUgZm9ybWF0IF9WQVJfIGFyZSB2YXJpYWJsZXMgd2hpY2ggYXJlIGR5bmFtaWNhbGx5IHJlcGxhY2VkCgkJCSAqICAgYnkgamF2YXNjcmlwdAoJCQkgKi8KCQkJdGhpcy5vTGFuZ3VhZ2UgPSB7CgkJCQkic1Byb2Nlc3NpbmciOiAiUHJvY2Vzc2luZy4uLiIsCgkJCQkic0xlbmd0aE1lbnUiOiAiU2hvdyBfTUVOVV8gZW50cmllcyIsCgkJCQkic1plcm9SZWNvcmRzIjogIk5vIG1hdGNoaW5nIHJlY29yZHMgZm91bmQiLAoJCQkJInNFbXB0eVRhYmxlIjogIk5vIGRhdGEgYXZhaWxhYmxlIGluIHRhYmxlIiwKCQkJCSJzSW5mbyI6ICJTaG93aW5nIF9TVEFSVF8gdG8gX0VORF8gb2YgX1RPVEFMXyBlbnRyaWVzIiwKCQkJCSJzSW5mb0VtcHR5IjogIlNob3dpbmcgMCB0byAwIG9mIDAgZW50cmllcyIsCgkJCQkic0luZm9GaWx0ZXJlZCI6ICIoZmlsdGVyZWQgZnJvbSBfTUFYXyB0b3RhbCBlbnRyaWVzKSIsCgkJCQkic0luZm9Qb3N0Rml4IjogIiIsCgkJCQkic1NlYXJjaCI6ICJTZWFyY2g6IiwKCQkJCSJzVXJsIjogIiIsCgkJCQkib1BhZ2luYXRlIjogewoJCQkJCSJzRmlyc3QiOiAgICAiRmlyc3QiLAoJCQkJCSJzUHJldmlvdXMiOiAiUHJldmlvdXMiLAoJCQkJCSJzTmV4dCI6ICAgICAiTmV4dCIsCgkJCQkJInNMYXN0IjogICAgICJMYXN0IgoJCQkJfSwKCQkJCSJmbkluZm9DYWxsYmFjayI6IG51bGwKCQkJfTsKCQkJCgkJCS8qCgkJCSAqIFZhcmlhYmxlOiBhb0RhdGEKCQkJICogUHVycG9zZTogIFN0b3JlIGRhdGEgaW5mb3JtYXRpb24KCQkJICogU2NvcGU6ICAgIGpRdWVyeS5kYXRhVGFibGUuY2xhc3NTZXR0aW5ncyAKCQkJICogTm90ZXM6ICAgIFRoaXMgaXMgYW4gYXJyYXkgb2Ygb2JqZWN0cyB3aXRoIHRoZSBmb2xsb3dpbmcgcGFyYW1ldGVyczoKCQkJICogICBpbnQ6IF9pSWQgLSBpbnRlcm5hbCBpZCBmb3IgdHJhY2tpbmcKCQkJICogICBhcnJheTogX2FEYXRhIC0gaW50ZXJuYWwgZGF0YSAtIHVzZWQgZm9yIHNvcnRpbmcgLyBmaWx0ZXJpbmcgZXRjCgkJCSAqICAgbm9kZTogblRyIC0gZGlzcGxheSBub2RlCgkJCSAqICAgYXJyYXkgbm9kZTogX2FuSGlkZGVuIC0gaGlkZGVuIFREIG5vZGVzCgkJCSAqICAgc3RyaW5nOiBfc1Jvd1N0cmlwZQoJCQkgKi8KCQkJdGhpcy5hb0RhdGEgPSBbXTsKCQkJCgkJCS8qCgkJCSAqIFZhcmlhYmxlOiBhaURpc3BsYXkKCQkJICogUHVycG9zZTogIEFycmF5IG9mIGluZGV4ZXMgd2hpY2ggYXJlIGluIHRoZSBjdXJyZW50IGRpc3BsYXkgKGFmdGVyIGZpbHRlcmluZyBldGMpCgkJCSAqIFNjb3BlOiAgICBqUXVlcnkuZGF0YVRhYmxlLmNsYXNzU2V0dGluZ3MKCQkJICovCgkJCXRoaXMuYWlEaXNwbGF5ID0gW107CgkJCQoJCQkvKgoJCQkgKiBWYXJpYWJsZTogYWlEaXNwbGF5TWFzdGVyCgkJCSAqIFB1cnBvc2U6ICBBcnJheSBvZiBpbmRleGVzIGZvciBkaXNwbGF5IC0gbm8gZmlsdGVyaW5nCgkJCSAqIFNjb3BlOiAgICBqUXVlcnkuZGF0YVRhYmxlLmNsYXNzU2V0dGluZ3MKCQkJICovCgkJCXRoaXMuYWlEaXNwbGF5TWFzdGVyID0gW107CgkJCQkJCQkKCQkJLyoKCQkJICogVmFyaWFibGU6IGFvQ29sdW1ucwoJCQkgKiBQdXJwb3NlOiAgU3RvcmUgaW5mb3JtYXRpb24gYWJvdXQgZWFjaCBjb2x1bW4gdGhhdCBpcyBpbiB1c2UKCQkJICogU2NvcGU6ICAgIGpRdWVyeS5kYXRhVGFibGUuY2xhc3NTZXR0aW5ncyAKCQkJICovCgkJCXRoaXMuYW9Db2x1bW5zID0gW107CgkJCQoJCQkvKgoJCQkgKiBWYXJpYWJsZTogaU5leHRJZAoJCQkgKiBQdXJwb3NlOiAgU3RvcmUgdGhlIG5leHQgdW5pcXVlIGlkIHRvIGJlIHVzZWQgZm9yIGEgbmV3IHJvdwoJCQkgKiBTY29wZTogICAgalF1ZXJ5LmRhdGFUYWJsZS5jbGFzc1NldHRpbmdzIAoJCQkgKi8KCQkJdGhpcy5pTmV4dElkID0gMDsKCQkJCgkJCS8qCgkJCSAqIFZhcmlhYmxlOiBhc0RhdGFTZWFyY2gKCQkJICogUHVycG9zZTogIFNlYXJjaCBkYXRhIGFycmF5IGZvciByZWd1bGFyIGV4cHJlc3Npb24gc2VhcmNoaW5nCgkJCSAqIFNjb3BlOiAgICBqUXVlcnkuZGF0YVRhYmxlLmNsYXNzU2V0dGluZ3MKCQkJICovCgkJCXRoaXMuYXNEYXRhU2VhcmNoID0gW107CgkJCQoJCQkvKgoJCQkgKiBWYXJpYWJsZTogb1ByZXZpb3VzU2VhcmNoCgkJCSAqIFB1cnBvc2U6ICBTdG9yZSB0aGUgcHJldmlvdXMgc2VhcmNoIGluY2FzZSB3ZSB3YW50IHRvIGZvcmNlIGEgcmUtc2VhcmNoCgkJCSAqICAgb3IgY29tcGFyZSB0aGUgb2xkIHNlYXJjaCB0byBhIG5ldyBvbmUKCQkJICogU2NvcGU6ICAgIGpRdWVyeS5kYXRhVGFibGUuY2xhc3NTZXR0aW5ncwoJCQkgKi8KCQkJdGhpcy5vUHJldmlvdXNTZWFyY2ggPSB7CgkJCQkic1NlYXJjaCI6ICIiLAoJCQkJImJSZWdleCI6IGZhbHNlLAoJCQkJImJTbWFydCI6IHRydWUKCQkJfTsKCQkJCgkJCS8qCgkJCSAqIFZhcmlhYmxlOiBhb1ByZVNlYXJjaENvbHMKCQkJICogUHVycG9zZTogIFN0b3JlIHRoZSBwcmV2aW91cyBzZWFyY2ggZm9yIGVhY2ggY29sdW1uCgkJCSAqIFNjb3BlOiAgICBqUXVlcnkuZGF0YVRhYmxlLmNsYXNzU2V0dGluZ3MKCQkJICovCgkJCXRoaXMuYW9QcmVTZWFyY2hDb2xzID0gW107CgkJCQoJCQkvKgoJCQkgKiBWYXJpYWJsZTogYWFTb3J0aW5nCgkJCSAqIFB1cnBvc2U6ICBTb3J0aW5nIGluZm9ybWF0aW9uCgkJCSAqIFNjb3BlOiAgICBqUXVlcnkuZGF0YVRhYmxlLmNsYXNzU2V0dGluZ3MKCQkJICogTm90ZXM6ICAgIEluZGV4IDAgLSBjb2x1bW4gbnVtYmVyCgkJCSAqICAgICAgICAgICBJbmRleCAxIC0gY3VycmVudCBzb3J0aW5nIGRpcmVjdGlvbgoJCQkgKiAgICAgICAgICAgSW5kZXggMiAtIGluZGV4IG9mIGFzU29ydGluZyBmb3IgdGhpcyBjb2x1bW4KCQkJICovCgkJCXRoaXMuYWFTb3J0aW5nID0gWyBbMCwgJ2FzYycsIDBdIF07CgkJCQoJCQkvKgoJCQkgKiBWYXJpYWJsZTogYWFTb3J0aW5nRml4ZWQKCQkJICogUHVycG9zZTogIFNvcnRpbmcgaW5mb3JtYXRpb24gdGhhdCBpcyBhbHdheXMgYXBwbGllZAoJCQkgKiBTY29wZTogICAgalF1ZXJ5LmRhdGFUYWJsZS5jbGFzc1NldHRpbmdzCgkJCSAqLwoJCQl0aGlzLmFhU29ydGluZ0ZpeGVkID0gbnVsbDsKCQkJCgkJCS8qCgkJCSAqIFZhcmlhYmxlOiBhc1N0cmlwQ2xhc3NlcwoJCQkgKiBQdXJwb3NlOiAgQ2xhc3NlcyB0byB1c2UgZm9yIHRoZSBzdHJpcGluZyBvZiBhIHRhYmxlCgkJCSAqIFNjb3BlOiAgICBqUXVlcnkuZGF0YVRhYmxlLmNsYXNzU2V0dGluZ3MKCQkJICovCgkJCXRoaXMuYXNTdHJpcENsYXNzZXMgPSBbXTsKCQkJCgkJCS8qCgkJCSAqIFZhcmlhYmxlOiBhc0Rlc3RvcnlTdHJpcHMKCQkJICogUHVycG9zZTogIElmIHJlc3RvcmluZyBhIHRhYmxlIC0gd2Ugc2hvdWxkIHJlc3RvcmUgaXQncyBzdHJpcGluZyBjbGFzc2VzIGFzIHdlbGwKCQkJICogU2NvcGU6ICAgIGpRdWVyeS5kYXRhVGFibGUuY2xhc3NTZXR0aW5ncwoJCQkgKi8KCQkJdGhpcy5hc0Rlc3RvcnlTdHJpcHMgPSBbXTsKCQkJCgkJCS8qCgkJCSAqIFZhcmlhYmxlOiBzRGVzdHJveVdpZHRoCgkJCSAqIFB1cnBvc2U6ICBJZiByZXN0b3JpbmcgYSB0YWJsZSAtIHdlIHNob3VsZCByZXN0b3JlIGl0J3Mgd2lkdGgKCQkJICogU2NvcGU6ICAgIGpRdWVyeS5kYXRhVGFibGUuY2xhc3NTZXR0aW5ncwoJCQkgKi8KCQkJdGhpcy5zRGVzdHJveVdpZHRoID0gMDsKCQkJCgkJCS8qCgkJCSAqIFZhcmlhYmxlOiBmblJvd0NhbGxiYWNrCgkJCSAqIFB1cnBvc2U6ICBDYWxsIHRoaXMgZnVuY3Rpb24gZXZlcnkgdGltZSBhIHJvdyBpcyBpbnNlcnRlZCAoZHJhdykKCQkJICogU2NvcGU6ICAgIGpRdWVyeS5kYXRhVGFibGUuY2xhc3NTZXR0aW5ncwoJCQkgKi8KCQkJdGhpcy5mblJvd0NhbGxiYWNrID0gbnVsbDsKCQkJCgkJCS8qCgkJCSAqIFZhcmlhYmxlOiBmbkhlYWRlckNhbGxiYWNrCgkJCSAqIFB1cnBvc2U6ICBDYWxsYmFjayBmdW5jdGlvbiBmb3IgdGhlIGhlYWRlciBvbiBlYWNoIGRyYXcKCQkJICogU2NvcGU6ICAgIGpRdWVyeS5kYXRhVGFibGUuY2xhc3NTZXR0aW5ncwoJCQkgKi8KCQkJdGhpcy5mbkhlYWRlckNhbGxiYWNrID0gbnVsbDsKCQkJCgkJCS8qCgkJCSAqIFZhcmlhYmxlOiBmbkZvb3RlckNhbGxiYWNrCgkJCSAqIFB1cnBvc2U6ICBDYWxsYmFjayBmdW5jdGlvbiBmb3IgdGhlIGZvb3RlciBvbiBlYWNoIGRyYXcKCQkJICogU2NvcGU6ICAgIGpRdWVyeS5kYXRhVGFibGUuY2xhc3NTZXR0aW5ncwoJCQkgKi8KCQkJdGhpcy5mbkZvb3RlckNhbGxiYWNrID0gbnVsbDsKCQkJCgkJCS8qCgkJCSAqIFZhcmlhYmxlOiBhb0RyYXdDYWxsYmFjawoJCQkgKiBQdXJwb3NlOiAgQXJyYXkgb2YgY2FsbGJhY2sgZnVuY3Rpb25zIGZvciBkcmF3IGNhbGxiYWNrIGZ1bmN0aW9ucwoJCQkgKiBTY29wZTogICAgalF1ZXJ5LmRhdGFUYWJsZS5jbGFzc1NldHRpbmdzCgkJCSAqIE5vdGVzOiAgICBFYWNoIGFycmF5IGVsZW1lbnQgaXMgYW4gb2JqZWN0IHdpdGggdGhlIGZvbGxvd2luZyBwYXJhbWV0ZXJzOgoJCQkgKiAgIGZ1bmN0aW9uOmZuIC0gZnVuY3Rpb24gdG8gY2FsbAoJCQkgKiAgIHN0cmluZzpzTmFtZSAtIG5hbWUgY2FsbGJhY2sgKGZlYXR1cmUpLiB1c2VmdWwgZm9yIGFycmFuZ2luZyBhcnJheQoJCQkgKi8KCQkJdGhpcy5hb0RyYXdDYWxsYmFjayA9IFtdOwoJCQkKCQkJLyoKCQkJICogVmFyaWFibGU6IGZuSW5pdENvbXBsZXRlCgkJCSAqIFB1cnBvc2U6ICBDYWxsYmFjayBmdW5jdGlvbiBmb3Igd2hlbiB0aGUgdGFibGUgaGFzIGJlZW4gaW5pdGFsaXNlZAoJCQkgKiBTY29wZTogICAgalF1ZXJ5LmRhdGFUYWJsZS5jbGFzc1NldHRpbmdzCgkJCSAqLwoJCQl0aGlzLmZuSW5pdENvbXBsZXRlID0gbnVsbDsKCQkJCgkJCS8qCgkJCSAqIFZhcmlhYmxlOiBzVGFibGVJZAoJCQkgKiBQdXJwb3NlOiAgQ2FjaGUgdGhlIHRhYmxlIElEIGZvciBxdWljayBhY2Nlc3MKCQkJICogU2NvcGU6ICAgIGpRdWVyeS5kYXRhVGFibGUuY2xhc3NTZXR0aW5ncwoJCQkgKi8KCQkJdGhpcy5zVGFibGVJZCA9ICIiOwoJCQkKCQkJLyoKCQkJICogVmFyaWFibGU6IG5UYWJsZQoJCQkgKiBQdXJwb3NlOiAgQ2FjaGUgdGhlIHRhYmxlIG5vZGUgZm9yIHF1aWNrIGFjY2VzcwoJCQkgKiBTY29wZTogICAgalF1ZXJ5LmRhdGFUYWJsZS5jbGFzc1NldHRpbmdzCgkJCSAqLwoJCQl0aGlzLm5UYWJsZSA9IG51bGw7CgkJCQoJCQkvKgoJCQkgKiBWYXJpYWJsZTogblRIZWFkCgkJCSAqIFB1cnBvc2U6ICBQZXJtYW5lbnQgcmVmIHRvIHRoZSB0aGVhZCBlbGVtZW50CgkJCSAqIFNjb3BlOiAgICBqUXVlcnkuZGF0YVRhYmxlLmNsYXNzU2V0dGluZ3MKCQkJICovCgkJCXRoaXMublRIZWFkID0gbnVsbDsKCQkJCgkJCS8qCgkJCSAqIFZhcmlhYmxlOiBuVEZvb3QKCQkJICogUHVycG9zZTogIFBlcm1hbmVudCByZWYgdG8gdGhlIHRmb290IGVsZW1lbnQgLSBpZiBpdCBleGlzdHMKCQkJICogU2NvcGU6ICAgIGpRdWVyeS5kYXRhVGFibGUuY2xhc3NTZXR0aW5ncwoJCQkgKi8KCQkJdGhpcy5uVEZvb3QgPSBudWxsOwoJCQkKCQkJLyoKCQkJICogVmFyaWFibGU6IG5UQm9keQoJCQkgKiBQdXJwb3NlOiAgUGVybWFuZW50IHJlZiB0byB0aGUgdGJvZHkgZWxlbWVudAoJCQkgKiBTY29wZTogICAgalF1ZXJ5LmRhdGFUYWJsZS5jbGFzc1NldHRpbmdzCgkJCSAqLwoJCQl0aGlzLm5UQm9keSA9IG51bGw7CgkJCQoJCQkvKgoJCQkgKiBWYXJpYWJsZTogblRhYmxlV3JhcHBlcgoJCQkgKiBQdXJwb3NlOiAgQ2FjaGUgdGhlIHdyYXBwZXIgbm9kZSAoY29udGFpbnMgYWxsIERhdGFUYWJsZXMgY29udHJvbGxlZCBlbGVtZW50cykKCQkJICogU2NvcGU6ICAgIGpRdWVyeS5kYXRhVGFibGUuY2xhc3NTZXR0aW5ncwoJCQkgKi8KCQkJdGhpcy5uVGFibGVXcmFwcGVyID0gbnVsbDsKCQkJCgkJCS8qCgkJCSAqIFZhcmlhYmxlOiBiSW5pdGlhbGlzZWQKCQkJICogUHVycG9zZTogIEluZGljYXRlIGlmIGFsbCByZXF1aXJlZCBpbmZvcm1hdGlvbiBoYXMgYmVlbiByZWFkIGluCgkJCSAqIFNjb3BlOiAgICBqUXVlcnkuZGF0YVRhYmxlLmNsYXNzU2V0dGluZ3MKCQkJICovCgkJCXRoaXMuYkluaXRpYWxpc2VkID0gZmFsc2U7CgkJCQoJCQkvKgoJCQkgKiBWYXJpYWJsZTogYW9PcGVuUm93cwoJCQkgKiBQdXJwb3NlOiAgSW5mb3JtYXRpb24gYWJvdXQgb3BlbiByb3dzCgkJCSAqIFNjb3BlOiAgICBqUXVlcnkuZGF0YVRhYmxlLmNsYXNzU2V0dGluZ3MKCQkJICogTm90ZXM6ICAgIEhhcyB0aGUgcGFyYW1ldGVycyAnblRyJyBhbmQgJ25QYXJlbnQnCgkJCSAqLwoJCQl0aGlzLmFvT3BlblJvd3MgPSBbXTsKCQkJCgkJCS8qCgkJCSAqIFZhcmlhYmxlOiBzRG9tCgkJCSAqIFB1cnBvc2U6ICBEaWN0YXRlIHRoZSBwb3NpdGlvbmluZyB0aGF0IHRoZSBjcmVhdGVkIGVsZW1lbnRzIHdpbGwgdGFrZQoJCQkgKiBTY29wZTogICAgalF1ZXJ5LmRhdGFUYWJsZS5jbGFzc1NldHRpbmdzCgkJCSAqIE5vdGVzOiAgICAKCQkJICogICBUaGUgZm9sbG93aW5nIG9wdGlvbnMgYXJlIGFsbG93ZWQ6CgkJCSAqICAgICAnbCcgLSBMZW5ndGggY2hhbmdpbmcKCQkJICogICAgICdmJyAtIEZpbHRlcmluZyBpbnB1dAoJCQkgKiAgICAgJ3QnIC0gVGhlIHRhYmxlIQoJCQkgKiAgICAgJ2knIC0gSW5mb3JtYXRpb24KCQkJICogICAgICdwJyAtIFBhZ2luYXRpb24KCQkJICogICAgICdyJyAtIHBSb2Nlc3NpbmcKCQkJICogICBUaGUgZm9sbG93aW5nIGNvbnN0YW50cyBhcmUgYWxsb3dlZDoKCQkJICogICAgICdIJyAtIGpRdWVyeVVJIHRoZW1lICJoZWFkZXIiIGNsYXNzZXMKCQkJICogICAgICdGJyAtIGpRdWVyeVVJIHRoZW1lICJmb290ZXIiIGNsYXNzZXMKCQkJICogICBUaGUgZm9sbG93aW5nIHN5bnRheCBpcyBleHBlY3RlZDoKCQkJICogICAgICc8JyBhbmQgJz4nIC0gZGl2IGVsZW1lbnRzCgkJCSAqICAgICAnPCJjbGFzcyIgYW5kICc+JyAtIGRpdiB3aXRoIGEgY2xhc3MKCQkJICogICBFeGFtcGxlczoKCQkJICogICAgICc8IndyYXBwZXIiZmxpcHQ+JywgJzxsZjx0PmlwPicKCQkJICovCgkJCXRoaXMuc0RvbSA9ICdsZnJ0aXAnOwoJCQkKCQkJLyoKCQkJICogVmFyaWFibGU6IHNQYWdpbmF0aW9uVHlwZQoJCQkgKiBQdXJwb3NlOiAgTm90ZSB3aGljaCB0eXBlIG9mIHNvcnRpbmcgc2hvdWxkIGJlIHVzZWQKCQkJICogU2NvcGU6ICAgIGpRdWVyeS5kYXRhVGFibGUuY2xhc3NTZXR0aW5ncwoJCQkgKi8KCQkJdGhpcy5zUGFnaW5hdGlvblR5cGUgPSAidHdvX2J1dHRvbiI7CgkJCQoJCQkvKgoJCQkgKiBWYXJpYWJsZTogaUNvb2tpZUR1cmF0aW9uCgkJCSAqIFB1cnBvc2U6ICBUaGUgY29va2llIGR1cmF0aW9uIChmb3IgYlN0YXRlU2F2ZSkgaW4gc2Vjb25kcyAtIGRlZmF1bHQgMiBob3VycwoJCQkgKiBTY29wZTogICAgalF1ZXJ5LmRhdGFUYWJsZS5jbGFzc1NldHRpbmdzCgkJCSAqLwoJCQl0aGlzLmlDb29raWVEdXJhdGlvbiA9IDYwICogNjAgKiAyOwoJCQkKCQkJLyoKCQkJICogVmFyaWFibGU6IHNDb29raWVQcmVmaXgKCQkJICogUHVycG9zZTogIFRoZSBjb29raWUgbmFtZSBwcmVmaXgKCQkJICogU2NvcGU6ICAgIGpRdWVyeS5kYXRhVGFibGUuY2xhc3NTZXR0aW5ncwoJCQkgKi8KCQkJdGhpcy5zQ29va2llUHJlZml4ID0gIlNwcnlNZWRpYV9EYXRhVGFibGVzXyI7CgkJCQoJCQkvKgoJCQkgKiBWYXJpYWJsZTogZm5Db29raWVDYWxsYmFjawoJCQkgKiBQdXJwb3NlOiAgQ2FsbGJhY2sgZnVuY3Rpb24gZm9yIGNvb2tpZSBjcmVhdGlvbgoJCQkgKiBTY29wZTogICAgalF1ZXJ5LmRhdGFUYWJsZS5jbGFzc1NldHRpbmdzCgkJCSAqLwoJCQl0aGlzLmZuQ29va2llQ2FsbGJhY2sgPSBudWxsOwoJCQkKCQkJLyoKCQkJICogVmFyaWFibGU6IGFvU3RhdGVTYXZlCgkJCSAqIFB1cnBvc2U6ICBBcnJheSBvZiBjYWxsYmFjayBmdW5jdGlvbnMgZm9yIHN0YXRlIHNhdmluZwoJCQkgKiBTY29wZTogICAgalF1ZXJ5LmRhdGFUYWJsZS5jbGFzc1NldHRpbmdzCgkJCSAqIE5vdGVzOiAgICBFYWNoIGFycmF5IGVsZW1lbnQgaXMgYW4gb2JqZWN0IHdpdGggdGhlIGZvbGxvd2luZyBwYXJhbWV0ZXJzOgoJCQkgKiAgIGZ1bmN0aW9uOmZuIC0gZnVuY3Rpb24gdG8gY2FsbC4gVGFrZXMgdHdvIHBhcmFtZXRlcnMsIG9TZXR0aW5ncyBhbmQgdGhlIEpTT04gc3RyaW5nIHRvCgkJCSAqICAgICBzYXZlIHRoYXQgaGFzIGJlZW4gdGh1cyBmYXIgY3JlYXRlZC4gUmV0dXJucyBhIEpTT04gc3RyaW5nIHRvIGJlIGluc2VydGVkIGludG8gYSAKCQkJICogICAgIGpzb24gb2JqZWN0IChpLmUuICcicGFyYW0iOiBbIDAsIDEsIDJdJykKCQkJICogICBzdHJpbmc6c05hbWUgLSBuYW1lIG9mIGNhbGxiYWNrCgkJCSAqLwoJCQl0aGlzLmFvU3RhdGVTYXZlID0gW107CgkJCQoJCQkvKgoJCQkgKiBWYXJpYWJsZTogYW9TdGF0ZUxvYWQKCQkJICogUHVycG9zZTogIEFycmF5IG9mIGNhbGxiYWNrIGZ1bmN0aW9ucyBmb3Igc3RhdGUgbG9hZGluZwoJCQkgKiBTY29wZTogICAgalF1ZXJ5LmRhdGFUYWJsZS5jbGFzc1NldHRpbmdzCgkJCSAqIE5vdGVzOiAgICBFYWNoIGFycmF5IGVsZW1lbnQgaXMgYW4gb2JqZWN0IHdpdGggdGhlIGZvbGxvd2luZyBwYXJhbWV0ZXJzOgoJCQkgKiAgIGZ1bmN0aW9uOmZuIC0gZnVuY3Rpb24gdG8gY2FsbC4gVGFrZXMgdHdvIHBhcmFtZXRlcnMsIG9TZXR0aW5ncyBhbmQgdGhlIG9iamVjdCBzdG9yZWQuCgkJCSAqICAgICBNYXkgcmV0dXJuIGZhbHNlIHRvIGNhbmNlbCBzdGF0ZSBsb2FkaW5nLgoJCQkgKiAgIHN0cmluZzpzTmFtZSAtIG5hbWUgb2YgY2FsbGJhY2sKCQkJICovCgkJCXRoaXMuYW9TdGF0ZUxvYWQgPSBbXTsKCQkJCgkJCS8qCgkJCSAqIFZhcmlhYmxlOiBvTG9hZGVkU3RhdGUKCQkJICogUHVycG9zZTogIFN0YXRlIHRoYXQgd2FzIGxvYWRlZCBmcm9tIHRoZSBjb29raWUuIFVzZWZ1bCBmb3IgYmFjayByZWZlcmVuY2UKCQkJICogU2NvcGU6ICAgIGpRdWVyeS5kYXRhVGFibGUuY2xhc3NTZXR0aW5ncwoJCQkgKi8KCQkJdGhpcy5vTG9hZGVkU3RhdGUgPSBudWxsOwoJCQkKCQkJLyoKCQkJICogVmFyaWFibGU6IHNBamF4U291cmNlCgkJCSAqIFB1cnBvc2U6ICBTb3VyY2UgdXJsIGZvciBBSkFYIGRhdGEgZm9yIHRoZSB0YWJsZQoJCQkgKiBTY29wZTogICAgalF1ZXJ5LmRhdGFUYWJsZS5jbGFzc1NldHRpbmdzCgkJCSAqLwoJCQl0aGlzLnNBamF4U291cmNlID0gbnVsbDsKCQkJCgkJCS8qCgkJCSAqIFZhcmlhYmxlOiBiQWpheERhdGFHZXQKCQkJICogUHVycG9zZTogIE5vdGUgaWYgZHJhdyBzaG91bGQgYmUgYmxvY2tlZCB3aGlsZSBnZXR0aW5nIGRhdGEKCQkJICogU2NvcGU6ICAgIGpRdWVyeS5kYXRhVGFibGUuY2xhc3NTZXR0aW5ncwoJCQkgKi8KCQkJdGhpcy5iQWpheERhdGFHZXQgPSB0cnVlOwoJCQkKCQkJLyoKCQkJICogVmFyaWFibGU6IGZuU2VydmVyRGF0YQoJCQkgKiBQdXJwb3NlOiAgRnVuY3Rpb24gdG8gZ2V0IHRoZSBzZXJ2ZXItc2lkZSBkYXRhIC0gY2FuIGJlIG92ZXJydWxlZCBieSB0aGUgZGV2ZWxvcGVyCgkJCSAqIFNjb3BlOiAgICBqUXVlcnkuZGF0YVRhYmxlLmNsYXNzU2V0dGluZ3MKCQkJICovCgkJCXRoaXMuZm5TZXJ2ZXJEYXRhID0gZnVuY3Rpb24gKCB1cmwsIGRhdGEsIGNhbGxiYWNrICkgewoJCQkJJC5hamF4KCB7CgkJCQkJInVybCI6IHVybCwKCQkJCQkiZGF0YSI6IGRhdGEsCgkJCQkJInN1Y2Nlc3MiOiBjYWxsYmFjaywKCQkJCQkiZGF0YVR5cGUiOiAianNvbiIsCgkJCQkJImNhY2hlIjogZmFsc2UsCgkJCQkJImVycm9yIjogZnVuY3Rpb24gKHhociwgZXJyb3IsIHRocm93bikgewoJCQkJCQlpZiAoIGVycm9yID09ICJwYXJzZXJlcnJvciIgKSB7CgkJCQkJCQlhbGVydCggIkRhdGFUYWJsZXMgd2FybmluZzogSlNPTiBkYXRhIGZyb20gc2VydmVyIGNvdWxkIG5vdCBiZSBwYXJzZWQuICIrCgkJCQkJCQkJIlRoaXMgaXMgY2F1c2VkIGJ5IGEgSlNPTiBmb3JtYXR0aW5nIGVycm9yLiIgKTsKCQkJCQkJfQoJCQkJCX0KCQkJCX0gKTsKCQkJfTsKCQkJCgkJCS8qCgkJCSAqIFZhcmlhYmxlOiBmbkZvcm1hdE51bWJlcgoJCQkgKiBQdXJwb3NlOiAgRm9ybWF0IG51bWJlcnMgZm9yIGRpc3BsYXkKCQkJICogU2NvcGU6ICAgIGpRdWVyeS5kYXRhVGFibGUuY2xhc3NTZXR0aW5ncwoJCQkgKi8KCQkJdGhpcy5mbkZvcm1hdE51bWJlciA9IGZ1bmN0aW9uICggaUluICkKCQkJewoJCQkJaWYgKCBpSW4gPCAxMDAwICkKCQkJCXsKCQkJCQkvKiBBIHNtYWxsIG9wdGltaXNhdGlvbiBmb3Igd2hhdCBpcyBsaWtlbHkgdG8gYmUgdGhlIHZhc3QgbWFqb3JpdHkgb2YgdXNlIGNhc2VzICovCgkJCQkJcmV0dXJuIGlJbjsKCQkJCX0KCQkJCWVsc2UKCQkJCXsKCQkJCQl2YXIgcz0oaUluKyIiKSwgYT1zLnNwbGl0KCIiKSwgb3V0PSIiLCBpTGVuPXMubGVuZ3RoOwoJCQkJCQoJCQkJCWZvciAoIHZhciBpPTAgOyBpPGlMZW4gOyBpKysgKQoJCQkJCXsKCQkJCQkJaWYgKCBpJTMgPT09IDAgJiYgaSAhPT0gMCApCgkJCQkJCXsKCQkJCQkJCW91dCA9ICcsJytvdXQ7CgkJCQkJCX0KCQkJCQkJb3V0ID0gYVtpTGVuLWktMV0rb3V0OwoJCQkJCX0KCQkJCX0KCQkJCXJldHVybiBvdXQ7CgkJCX07CgkJCQoJCQkvKgoJCQkgKiBWYXJpYWJsZTogYUxlbmd0aE1lbnUKCQkJICogUHVycG9zZTogIExpc3Qgb2Ygb3B0aW9ucyB0aGF0IGNhbiBiZSB1c2VkIGZvciB0aGUgdXNlciBzZWxlY3RhYmxlIGxlbmd0aCBtZW51CgkJCSAqIFNjb3BlOiAgICBqUXVlcnkuZGF0YVRhYmxlLmNsYXNzU2V0dGluZ3MKCQkJICogTm90ZTogICAgIFRoaXMgdmFyYWlibGUgY2FuIHRha2UgZm9yIGZvcm0gb2YgYSAxRCBhcnJheSwgaW4gd2hpY2ggY2FzZSB0aGUgdmFsdWUgYW5kIHRoZSAKCQkJICogICBkaXNwbGF5ZWQgdmFsdWUgaW4gdGhlIG1lbnUgYXJlIHRoZSBzYW1lLCBvciBhIDJEIGFycmF5IGluIHdoaWNoIGNhc2UgdGhlIHZhbHVlIGNvbWVzCgkJCSAqICAgZnJvbSB0aGUgZmlyc3QgYXJyYXksIGFuZCB0aGUgZGlzcGxheWVkIHZhbHVlIHRvIHRoZSBlbmQgdXNlciBjb21lcyBmcm9tIHRoZSBzZWNvbmQKCQkJICogICBhcnJheS4gMkQgZXhhbXBsZTogWyBbIDEwLCAyNSwgNTAsIDEwMCwgLTEgXSwgWyAxMCwgMjUsIDUwLCAxMDAsICdBbGwnIF0gXTsKCQkJICovCgkJCXRoaXMuYUxlbmd0aE1lbnUgPSBbIDEwLCAyNSwgNTAsIDEwMCBdOwoJCQkKCQkJLyoKCQkJICogVmFyaWFibGU6IGlEcmF3CgkJCSAqIFB1cnBvc2U6ICBDb3VudGVyIGZvciB0aGUgZHJhd3MgdGhhdCB0aGUgdGFibGUgZG9lcy4gQWxzbyB1c2VkIGFzIGEgdHJhY2tlciBmb3IKCQkJICogICBzZXJ2ZXItc2lkZSBwcm9jZXNzaW5nCgkJCSAqIFNjb3BlOiAgICBqUXVlcnkuZGF0YVRhYmxlLmNsYXNzU2V0dGluZ3MKCQkJICovCgkJCXRoaXMuaURyYXcgPSAwOwoJCQkKCQkJLyoKCQkJICogVmFyaWFibGU6IGJEcmF3aW5nCgkJCSAqIFB1cnBvc2U6ICBJbmRpY2F0ZSBpZiBhIHJlZHJhdyBpcyBiZWluZyBkb25lIC0gdXNlZnVsIGZvciBBamF4CgkJCSAqIFNjb3BlOiAgICBqUXVlcnkuZGF0YVRhYmxlLmNsYXNzU2V0dGluZ3MKCQkJICovCgkJCXRoaXMuYkRyYXdpbmcgPSAwOwoJCQkKCQkJLyoKCQkJICogVmFyaWFibGU6IGlEcmF3RXJyb3IKCQkJICogUHVycG9zZTogIExhc3QgZHJhdyBlcnJvcgoJCQkgKiBTY29wZTogICAgalF1ZXJ5LmRhdGFUYWJsZS5jbGFzc1NldHRpbmdzCgkJCSAqLwoJCQl0aGlzLmlEcmF3RXJyb3IgPSAtMTsKCQkJCgkJCS8qCgkJCSAqIFZhcmlhYmxlOiBfaURpc3BsYXlMZW5ndGgsIF9pRGlzcGxheVN0YXJ0LCBfaURpc3BsYXlFbmQKCQkJICogUHVycG9zZTogIERpc3BsYXkgbGVuZ3RoIHZhcmlhYmxlcwoJCQkgKiBTY29wZTogICAgalF1ZXJ5LmRhdGFUYWJsZS5jbGFzc1NldHRpbmdzCgkJCSAqIE5vdGVzOiAgICBUaGVzZSB2YXJpYWJsZSBtdXN0IE5PVCBiZSB1c2VkIGV4dGVybmFsbHkgdG8gZ2V0IHRoZSBkYXRhIGxlbmd0aC4gUmF0aGVyLCB1c2UKCQkJICogICB0aGUgZm5SZWNvcmRzVG90YWwoKSAoZXRjKSBmdW5jdGlvbnMuCgkJCSAqLwoJCQl0aGlzLl9pRGlzcGxheUxlbmd0aCA9IDEwOwoJCQl0aGlzLl9pRGlzcGxheVN0YXJ0ID0gMDsKCQkJdGhpcy5faURpc3BsYXlFbmQgPSAxMDsKCQkJCgkJCS8qCgkJCSAqIFZhcmlhYmxlOiBfaVJlY29yZHNUb3RhbCwgX2lSZWNvcmRzRGlzcGxheQoJCQkgKiBQdXJwb3NlOiAgRGlzcGxheSBsZW5ndGggdmFyaWFibGVzIHVzZWQgZm9yIHNlcnZlciBzaWRlIHByb2Nlc3NpbmcKCQkJICogU2NvcGU6ICAgIGpRdWVyeS5kYXRhVGFibGUuY2xhc3NTZXR0aW5ncwoJCQkgKiBOb3RlczogICAgVGhlc2UgdmFyaWFibGUgbXVzdCBOT1QgYmUgdXNlZCBleHRlcm5hbGx5IHRvIGdldCB0aGUgZGF0YSBsZW5ndGguIFJhdGhlciwgdXNlCgkJCSAqICAgdGhlIGZuUmVjb3Jkc1RvdGFsKCkgKGV0YykgZnVuY3Rpb25zLgoJCQkgKi8KCQkJdGhpcy5faVJlY29yZHNUb3RhbCA9IDA7CgkJCXRoaXMuX2lSZWNvcmRzRGlzcGxheSA9IDA7CgkJCQoJCQkvKgoJCQkgKiBWYXJpYWJsZTogYkpVSQoJCQkgKiBQdXJwb3NlOiAgU2hvdWxkIHdlIGFkZCB0aGUgbWFya3VwIG5lZWRlZCBmb3IgalF1ZXJ5IFVJIHRoZW1pbmc/CgkJCSAqIFNjb3BlOiAgICBqUXVlcnkuZGF0YVRhYmxlLmNsYXNzU2V0dGluZ3MKCQkJICovCgkJCXRoaXMuYkpVSSA9IGZhbHNlOwoJCQkKCQkJLyoKCQkJICogVmFyaWFibGU6IGJKVUkKCQkJICogUHVycG9zZTogIFNob3VsZCB3ZSBhZGQgdGhlIG1hcmt1cCBuZWVkZWQgZm9yIGpRdWVyeSBVSSB0aGVtaW5nPwoJCQkgKiBTY29wZTogICAgalF1ZXJ5LmRhdGFUYWJsZS5jbGFzc1NldHRpbmdzCgkJCSAqLwoJCQl0aGlzLm9DbGFzc2VzID0gX29FeHQub1N0ZENsYXNzZXM7CgkJCQoJCQkvKgoJCQkgKiBWYXJpYWJsZTogYkZpbHRlcmVkIGFuZCBiU29ydGVkCgkJCSAqIFB1cnBvc2U6ICBGbGFncyB0byBhbGxvdyBjYWxsYmFjayBmdW5jdGlvbnMgdG8gc2VlIHdoYXQgYWN0aW9ucyBoYXZlIGJlZW4gcGVyZm9ybWVkCgkJCSAqIFNjb3BlOiAgICBqUXVlcnkuZGF0YVRhYmxlLmNsYXNzU2V0dGluZ3MKCQkJICovCgkJCXRoaXMuYkZpbHRlcmVkID0gZmFsc2U7CgkJCXRoaXMuYlNvcnRlZCA9IGZhbHNlOwoJCQkKCQkJLyoKCQkJICogVmFyaWFibGU6IG9Jbml0CgkJCSAqIFB1cnBvc2U6ICBJbml0aWFsaXNhdGlvbiBvYmplY3QgdGhhdCBpcyB1c2VkIGZvciB0aGUgdGFibGUKCQkJICogU2NvcGU6ICAgIGpRdWVyeS5kYXRhVGFibGUuY2xhc3NTZXR0aW5ncwoJCQkgKi8KCQkJdGhpcy5vSW5pdCA9IG51bGw7CgkJfQoJCQoJCS8qCgkJICogVmFyaWFibGU6IG9BcGkKCQkgKiBQdXJwb3NlOiAgQ29udGFpbmVyIGZvciBwdWJsaWNseSBleHBvc2VkICdwcml2YXRlJyBmdW5jdGlvbnMKCQkgKiBTY29wZTogICAgalF1ZXJ5LmRhdGFUYWJsZQoJCSAqLwoJCXRoaXMub0FwaSA9IHt9OwoJCQoJCQoJCS8qICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqCgkJICogU2VjdGlvbiAtIEFQSSBmdW5jdGlvbnMKCQkgKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKi8KCQkKCQkvKgoJCSAqIEZ1bmN0aW9uOiBmbkRyYXcKCQkgKiBQdXJwb3NlOiAgUmVkcmF3IHRoZSB0YWJsZQoJCSAqIFJldHVybnM6ICAtCgkJICogSW5wdXRzOiAgIGJvb2w6YkNvbXBsZXRlIC0gUmVmaWx0ZXIgYW5kIHJlc29ydCAoaWYgZW5hYmxlZCkgdGhlIHRhYmxlIGJlZm9yZSB0aGUgZHJhdy4KCQkgKiAgICAgICAgICAgICBPcHRpb25hbDogZGVmYXVsdCAtIHRydWUKCQkgKi8KCQl0aGlzLmZuRHJhdyA9IGZ1bmN0aW9uKCBiQ29tcGxldGUgKQoJCXsKCQkJdmFyIG9TZXR0aW5ncyA9IF9mblNldHRpbmdzRnJvbU5vZGUoIHRoaXNbX29FeHQuaUFwaUluZGV4XSApOwoJCQlpZiAoIHR5cGVvZiBiQ29tcGxldGUgIT0gJ3VuZGVmaW5lZCcgJiYgYkNvbXBsZXRlID09PSBmYWxzZSApCgkJCXsKCQkJCV9mbkNhbGN1bGF0ZUVuZCggb1NldHRpbmdzICk7CgkJCQlfZm5EcmF3KCBvU2V0dGluZ3MgKTsKCQkJfQoJCQllbHNlCgkJCXsKCQkJCV9mblJlRHJhdyggb1NldHRpbmdzICk7CgkJCX0KCQl9OwoJCQoJCS8qCgkJICogRnVuY3Rpb246IGZuRmlsdGVyCgkJICogUHVycG9zZTogIEZpbHRlciB0aGUgaW5wdXQgYmFzZWQgb24gZGF0YQoJCSAqIFJldHVybnM6ICAtCgkJICogSW5wdXRzOiAgIHN0cmluZzpzSW5wdXQgLSBzdHJpbmcgdG8gZmlsdGVyIHRoZSB0YWJsZSBvbgoJCSAqICAgICAgICAgICBpbnQ6aUNvbHVtbiAtIG9wdGlvbmFsIC0gY29sdW1uIHRvIGxpbWl0IGZpbHRlcmluZyB0bwoJCSAqICAgICAgICAgICBib29sOmJSZWdleCAtIG9wdGlvbmFsIC0gdHJlYXQgYXMgcmVndWxhciBleHByZXNzaW9uIG9yIG5vdCAtIGRlZmF1bHQgZmFsc2UKCQkgKiAgICAgICAgICAgYm9vbDpiU21hcnQgLSBvcHRpb25hbCAtIHBlcmZvcm0gc21hcnQgZmlsdGVyaW5nIG9yIG5vdCAtIGRlZmF1bHQgdHJ1ZQoJCSAqICAgICAgICAgICBib29sOmJTaG93R2xvYmFsIC0gb3B0aW9uYWwgLSBzaG93IHRoZSBpbnB1dCBnbG9iYWwgZmlsdGVyIGluIGl0J3MgaW5wdXQgYm94KGVzKQoJCSAqICAgICAgICAgICAgICAtIGRlZmF1bHQgdHJ1ZQoJCSAqLwoJCXRoaXMuZm5GaWx0ZXIgPSBmdW5jdGlvbiggc0lucHV0LCBpQ29sdW1uLCBiUmVnZXgsIGJTbWFydCwgYlNob3dHbG9iYWwgKQoJCXsKCQkJdmFyIG9TZXR0aW5ncyA9IF9mblNldHRpbmdzRnJvbU5vZGUoIHRoaXNbX29FeHQuaUFwaUluZGV4XSApOwoJCQkKCQkJaWYgKCAhb1NldHRpbmdzLm9GZWF0dXJlcy5iRmlsdGVyICkKCQkJewoJCQkJcmV0dXJuOwoJCQl9CgkJCQoJCQlpZiAoIHR5cGVvZiBiUmVnZXggPT0gJ3VuZGVmaW5lZCcgKQoJCQl7CgkJCQliUmVnZXggPSBmYWxzZTsKCQkJfQoJCQkKCQkJaWYgKCB0eXBlb2YgYlNtYXJ0ID09ICd1bmRlZmluZWQnICkKCQkJewoJCQkJYlNtYXJ0ID0gdHJ1ZTsKCQkJfQoJCQkKCQkJaWYgKCB0eXBlb2YgYlNob3dHbG9iYWwgPT0gJ3VuZGVmaW5lZCcgKQoJCQl7CgkJCQliU2hvd0dsb2JhbCA9IHRydWU7CgkJCX0KCQkJCgkJCWlmICggdHlwZW9mIGlDb2x1bW4gPT0gInVuZGVmaW5lZCIgfHwgaUNvbHVtbiA9PT0gbnVsbCApCgkJCXsKCQkJCS8qIEdsb2JhbCBmaWx0ZXIgKi8KCQkJCV9mbkZpbHRlckNvbXBsZXRlKCBvU2V0dGluZ3MsIHsKCQkJCQkic1NlYXJjaCI6c0lucHV0LAoJCQkJCSJiUmVnZXgiOiBiUmVnZXgsCgkJCQkJImJTbWFydCI6IGJTbWFydAoJCQkJfSwgMSApOwoJCQkJCgkJCQlpZiAoIGJTaG93R2xvYmFsICYmIHR5cGVvZiBvU2V0dGluZ3MuYWFuRmVhdHVyZXMuZiAhPSAndW5kZWZpbmVkJyApCgkJCQl7CgkJCQkJdmFyIG4gPSBvU2V0dGluZ3MuYWFuRmVhdHVyZXMuZjsKCQkJCQlmb3IgKCB2YXIgaT0wLCBpTGVuPW4ubGVuZ3RoIDsgaTxpTGVuIDsgaSsrICkKCQkJCQl7CgkJCQkJCSQoJ2lucHV0JywgbltpXSkudmFsKCBzSW5wdXQgKTsKCQkJCQl9CgkJCQl9CgkJCX0KCQkJZWxzZQoJCQl7CgkJCQkvKiBTaW5nbGUgY29sdW1uIGZpbHRlciAqLwoJCQkJb1NldHRpbmdzLmFvUHJlU2VhcmNoQ29sc1sgaUNvbHVtbiBdLnNTZWFyY2ggPSBzSW5wdXQ7CgkJCQlvU2V0dGluZ3MuYW9QcmVTZWFyY2hDb2xzWyBpQ29sdW1uIF0uYlJlZ2V4ID0gYlJlZ2V4OwoJCQkJb1NldHRpbmdzLmFvUHJlU2VhcmNoQ29sc1sgaUNvbHVtbiBdLmJTbWFydCA9IGJTbWFydDsKCQkJCV9mbkZpbHRlckNvbXBsZXRlKCBvU2V0dGluZ3MsIG9TZXR0aW5ncy5vUHJldmlvdXNTZWFyY2gsIDEgKTsKCQkJfQoJCX07CgkJCgkJLyoKCQkgKiBGdW5jdGlvbjogZm5TZXR0aW5ncwoJCSAqIFB1cnBvc2U6ICBHZXQgdGhlIHNldHRpbmdzIGZvciBhIHBhcnRpY3VsYXIgdGFibGUgZm9yIGV4dGVybi4gbWFuaXB1bGF0aW9uCgkJICogUmV0dXJuczogIC0KCQkgKiBJbnB1dHM6ICAgLQoJCSAqLwoJCXRoaXMuZm5TZXR0aW5ncyA9IGZ1bmN0aW9uKCBuTm9kZSAgKQoJCXsKCQkJcmV0dXJuIF9mblNldHRpbmdzRnJvbU5vZGUoIHRoaXNbX29FeHQuaUFwaUluZGV4XSApOwoJCX07CgkJCgkJLyoKCQkgKiBGdW5jdGlvbjogZm5WZXJzaW9uQ2hlY2sKCQkgKiBOb3RlczogICAgVGhlIGZ1bmN0aW9uIGlzIHRoZSBzYW1lIGFzIHRoZSAnc3RhdGljJyBmdW5jdGlvbiBwcm92aWRlZCBpbiB0aGUgZXh0IHZhcmlhYmxlCgkJICovCgkJdGhpcy5mblZlcnNpb25DaGVjayA9IF9vRXh0LmZuVmVyc2lvbkNoZWNrOwoJCQoJCS8qCgkJICogRnVuY3Rpb246IGZuU29ydAoJCSAqIFB1cnBvc2U6ICBTb3J0IHRoZSB0YWJsZSBieSBhIHBhcnRpY3VsYXIgcm93CgkJICogUmV0dXJuczogIC0KCQkgKiBJbnB1dHM6ICAgaW50OmlDb2wgLSB0aGUgZGF0YSBpbmRleCB0byBzb3J0IG9uLiBOb3RlIHRoYXQgdGhpcyB3aWxsCgkJICogICBub3QgbWF0Y2ggdGhlICdkaXNwbGF5IGluZGV4JyBpZiB5b3UgaGF2ZSBoaWRkZW4gZGF0YSBlbnRyaWVzCgkJICovCgkJdGhpcy5mblNvcnQgPSBmdW5jdGlvbiggYWFTb3J0ICkKCQl7CgkJCXZhciBvU2V0dGluZ3MgPSBfZm5TZXR0aW5nc0Zyb21Ob2RlKCB0aGlzW19vRXh0LmlBcGlJbmRleF0gKTsKCQkJb1NldHRpbmdzLmFhU29ydGluZyA9IGFhU29ydDsKCQkJX2ZuU29ydCggb1NldHRpbmdzICk7CgkJfTsKCQkKCQkvKgoJCSAqIEZ1bmN0aW9uOiBmblNvcnRMaXN0ZW5lcgoJCSAqIFB1cnBvc2U6ICBBdHRhY2ggYSBzb3J0IGxpc3RlbmVyIHRvIGFuIGVsZW1lbnQgZm9yIGEgZ2l2ZW4gY29sdW1uCgkJICogUmV0dXJuczogIC0KCQkgKiBJbnB1dHM6ICAgbm9kZTpuTm9kZSAtIHRoZSBlbGVtZW50IHRvIGF0dGFjaCB0aGUgc29ydCBsaXN0ZW5lciB0bwoJCSAqICAgICAgICAgICBpbnQ6aUNvbHVtbiAtIHRoZSBjb2x1bW4gdGhhdCBhIGNsaWNrIG9uIHRoaXMgbm9kZSB3aWxsIHNvcnQgb24KCQkgKiAgICAgICAgICAgZnVuY3Rpb246Zm5DYWxsYmFjayAtIGNhbGxiYWNrIGZ1bmN0aW9uIHdoZW4gc29ydCBpcyBydW4gLSBvcHRpb25hbAoJCSAqLwoJCXRoaXMuZm5Tb3J0TGlzdGVuZXIgPSBmdW5jdGlvbiggbk5vZGUsIGlDb2x1bW4sIGZuQ2FsbGJhY2sgKQoJCXsKCQkJX2ZuU29ydEF0dGFjaExpc3RlbmVyKCBfZm5TZXR0aW5nc0Zyb21Ob2RlKCB0aGlzW19vRXh0LmlBcGlJbmRleF0gKSwgbk5vZGUsIGlDb2x1bW4sCgkJCSAJZm5DYWxsYmFjayApOwoJCX07CgkJCgkJLyoKCQkgKiBGdW5jdGlvbjogZm5BZGREYXRhCgkJICogUHVycG9zZTogIEFkZCBuZXcgcm93KHMpIGludG8gdGhlIHRhYmxlCgkJICogUmV0dXJuczogIGFycmF5IGludDogYXJyYXkgb2YgaW5kZXhlcyAoYW9EYXRhKSB3aGljaCBoYXZlIGJlZW4gYWRkZWQgKHplcm8gbGVuZ3RoIG9uIGVycm9yKQoJCSAqIElucHV0czogICBhcnJheTptRGF0YSAtIHRoZSBkYXRhIHRvIGJlIGFkZGVkLiBUaGUgbGVuZ3RoIG11c3QgbWF0Y2gKCQkgKiAgICAgICAgICAgICAgIHRoZSBvcmlnaW5hbCBkYXRhIGZyb20gdGhlIERPTQoJCSAqICAgICAgICAgICAgIG9yCgkJICogICAgICAgICAgICAgYXJyYXkgYXJyYXk6bURhdGEgLSAyRCBhcnJheSBvZiBkYXRhIHRvIGJlIGFkZGVkCgkJICogICAgICAgICAgIGJvb2w6YlJlZHJhdyAtIHJlZHJhdyB0aGUgdGFibGUgb3Igbm90IC0gZGVmYXVsdCB0cnVlCgkJICogTm90ZXM6ICAgIFdhcm5pbmcgLSB0aGUgcmVmaWx0ZXIgaGVyZSB3aWxsIGNhdXNlIHRoZSB0YWJsZSB0byByZWRyYXcKCQkgKiAgICAgICAgICAgICBzdGFydGluZyBhdCB6ZXJvCgkJICogTm90ZXM6ICAgIFRoYW5rcyB0byBZZWtpbW92IERlbmlzIGZvciBjb250cmlidXRpbmcgdGhlIGJhc2lzIGZvciB0aGlzIGZ1bmN0aW9uIQoJCSAqLwoJCXRoaXMuZm5BZGREYXRhID0gZnVuY3Rpb24oIG1EYXRhLCBiUmVkcmF3ICkKCQl7CgkJCWlmICggbURhdGEubGVuZ3RoID09PSAwICkKCQkJewoJCQkJcmV0dXJuIFtdOwoJCQl9CgkJCQoJCQl2YXIgYWlSZXR1cm4gPSBbXTsKCQkJdmFyIGlUZXN0OwoJCQkKCQkJLyogRmluZCBzZXR0aW5ncyBmcm9tIHRhYmxlIG5vZGUgKi8KCQkJdmFyIG9TZXR0aW5ncyA9IF9mblNldHRpbmdzRnJvbU5vZGUoIHRoaXNbX29FeHQuaUFwaUluZGV4XSApOwoJCQkKCQkJLyogQ2hlY2sgaWYgd2Ugd2FudCB0byBhZGQgbXVsdGlwbGUgcm93cyBvciBub3QgKi8KCQkJaWYgKCB0eXBlb2YgbURhdGFbMF0gPT0gIm9iamVjdCIgKQoJCQl7CgkJCQlmb3IgKCB2YXIgaT0wIDsgaTxtRGF0YS5sZW5ndGggOyBpKysgKQoJCQkJewoJCQkJCWlUZXN0ID0gX2ZuQWRkRGF0YSggb1NldHRpbmdzLCBtRGF0YVtpXSApOwoJCQkJCWlmICggaVRlc3QgPT0gLTEgKQoJCQkJCXsKCQkJCQkJcmV0dXJuIGFpUmV0dXJuOwoJCQkJCX0KCQkJCQlhaVJldHVybi5wdXNoKCBpVGVzdCApOwoJCQkJfQoJCQl9CgkJCWVsc2UKCQkJewoJCQkJaVRlc3QgPSBfZm5BZGREYXRhKCBvU2V0dGluZ3MsIG1EYXRhICk7CgkJCQlpZiAoIGlUZXN0ID09IC0xICkKCQkJCXsKCQkJCQlyZXR1cm4gYWlSZXR1cm47CgkJCQl9CgkJCQlhaVJldHVybi5wdXNoKCBpVGVzdCApOwoJCQl9CgkJCQoJCQlvU2V0dGluZ3MuYWlEaXNwbGF5ID0gb1NldHRpbmdzLmFpRGlzcGxheU1hc3Rlci5zbGljZSgpOwoJCQkKCQkJaWYgKCB0eXBlb2YgYlJlZHJhdyA9PSAndW5kZWZpbmVkJyB8fCBiUmVkcmF3ICkKCQkJewoJCQkJX2ZuUmVEcmF3KCBvU2V0dGluZ3MgKTsKCQkJfQoJCQlyZXR1cm4gYWlSZXR1cm47CgkJfTsKCQkKCQkvKgoJCSAqIEZ1bmN0aW9uOiBmbkRlbGV0ZVJvdwoJCSAqIFB1cnBvc2U6ICBSZW1vdmUgYSByb3cgZm9yIHRoZSB0YWJsZQoJCSAqIFJldHVybnM6ICBhcnJheTphUmV0dXJuIC0gdGhlIHJvdyB0aGF0IHdhcyBkZWxldGVkCgkJICogSW5wdXRzOiAgIG1peGVkOm1UYXJnZXQgLSAKCQkgKiAgICAgICAgICAgICBpbnQ6IC0gaW5kZXggb2YgYW9EYXRhIHRvIGJlIGRlbGV0ZWQsIG9yCgkJICogICAgICAgICAgICAgbm9kZShUUik6IC0gVFIgZWxlbWVudCB5b3Ugd2FudCB0byBkZWxldGUKCQkgKiAgICAgICAgICAgZnVuY3Rpb246Zm5DYWxsQmFjayAtIGNhbGxiYWNrIGZ1bmN0aW9uIC0gZGVmYXVsdCBudWxsCgkJICogICAgICAgICAgIGJvb2w6YlJlZHJhdyAtIHJlZHJhdyB0aGUgdGFibGUgb3Igbm90IC0gZGVmYXVsdCB0cnVlCgkJICovCgkJdGhpcy5mbkRlbGV0ZVJvdyA9IGZ1bmN0aW9uKCBtVGFyZ2V0LCBmbkNhbGxCYWNrLCBiUmVkcmF3ICkKCQl7CgkJCS8qIEZpbmQgc2V0dGluZ3MgZnJvbSB0YWJsZSBub2RlICovCgkJCXZhciBvU2V0dGluZ3MgPSBfZm5TZXR0aW5nc0Zyb21Ob2RlKCB0aGlzW19vRXh0LmlBcGlJbmRleF0gKTsKCQkJdmFyIGksIGlBT0RhdGFJbmRleDsKCQkJCgkJCWlBT0RhdGFJbmRleCA9ICh0eXBlb2YgbVRhcmdldCA9PSAnb2JqZWN0JykgPyAKCQkJCV9mbk5vZGVUb0RhdGFJbmRleChvU2V0dGluZ3MsIG1UYXJnZXQpIDogbVRhcmdldDsKCQkJCgkJCS8qIFJldHVybiB0aGUgZGF0YSBhcnJheSBmcm9tIHRoaXMgcm93ICovCgkJCXZhciBvRGF0YSA9IG9TZXR0aW5ncy5hb0RhdGEuc3BsaWNlKCBpQU9EYXRhSW5kZXgsIDEgKTsKCQkJCgkJCS8qIFJlbW92ZSB0aGUgdGFyZ2V0IHJvdyBmcm9tIHRoZSBzZWFyY2ggYXJyYXkgKi8KCQkJdmFyIGlEaXNwbGF5SW5kZXggPSAkLmluQXJyYXkoIGlBT0RhdGFJbmRleCwgb1NldHRpbmdzLmFpRGlzcGxheSApOwoJCQlvU2V0dGluZ3MuYXNEYXRhU2VhcmNoLnNwbGljZSggaURpc3BsYXlJbmRleCwgMSApOwoJCQkKCQkJLyogRGVsZXRlIGZyb20gdGhlIGRpc3BsYXkgYXJyYXlzICovCgkJCV9mbkRlbGV0ZUluZGV4KCBvU2V0dGluZ3MuYWlEaXNwbGF5TWFzdGVyLCBpQU9EYXRhSW5kZXggKTsKCQkJX2ZuRGVsZXRlSW5kZXgoIG9TZXR0aW5ncy5haURpc3BsYXksIGlBT0RhdGFJbmRleCApOwoJCQkKCQkJLyogSWYgdGhlcmUgaXMgYSB1c2VyIGNhbGxiYWNrIGZ1bmN0aW9uIC0gY2FsbCBpdCAqLwoJCQlpZiAoIHR5cGVvZiBmbkNhbGxCYWNrID09ICJmdW5jdGlvbiIgKQoJCQl7CgkJCQlmbkNhbGxCYWNrLmNhbGwoIHRoaXMsIG9TZXR0aW5ncywgb0RhdGEgKTsKCQkJfQoJCQkKCQkJLyogQ2hlY2sgZm9yIGFuICdvdmVyZmxvdycgdGhleSBjYXNlIGZvciBkaXNsYXlpbmcgdGhlIHRhYmxlICovCgkJCWlmICggb1NldHRpbmdzLl9pRGlzcGxheVN0YXJ0ID49IG9TZXR0aW5ncy5haURpc3BsYXkubGVuZ3RoICkKCQkJewoJCQkJb1NldHRpbmdzLl9pRGlzcGxheVN0YXJ0IC09IG9TZXR0aW5ncy5faURpc3BsYXlMZW5ndGg7CgkJCQlpZiAoIG9TZXR0aW5ncy5faURpc3BsYXlTdGFydCA8IDAgKQoJCQkJewoJCQkJCW9TZXR0aW5ncy5faURpc3BsYXlTdGFydCA9IDA7CgkJCQl9CgkJCX0KCQkJCgkJCWlmICggdHlwZW9mIGJSZWRyYXcgPT0gJ3VuZGVmaW5lZCcgfHwgYlJlZHJhdyApCgkJCXsKCQkJCV9mbkNhbGN1bGF0ZUVuZCggb1NldHRpbmdzICk7CgkJCQlfZm5EcmF3KCBvU2V0dGluZ3MgKTsKCQkJfQoJCQkKCQkJcmV0dXJuIG9EYXRhOwoJCX07CgkJCgkJLyoKCQkgKiBGdW5jdGlvbjogZm5DbGVhclRhYmxlCgkJICogUHVycG9zZTogIFF1aWNrbHkgYW5kIHNpbXBseSBjbGVhciBhIHRhYmxlCgkJICogUmV0dXJuczogIC0KCQkgKiBJbnB1dHM6ICAgYm9vbDpiUmVkcmF3IC0gcmVkcmF3IHRoZSB0YWJsZSBvciBub3QgLSBkZWZhdWx0IHRydWUKCQkgKiBOb3RlczogICAgVGhhbmtzIHRvIFlla2ltb3YgRGVuaXMgZm9yIGNvbnRyaWJ1dGluZyB0aGUgYmFzaXMgZm9yIHRoaXMgZnVuY3Rpb24hCgkJICovCgkJdGhpcy5mbkNsZWFyVGFibGUgPSBmdW5jdGlvbiggYlJlZHJhdyApCgkJewoJCQkvKiBGaW5kIHNldHRpbmdzIGZyb20gdGFibGUgbm9kZSAqLwoJCQl2YXIgb1NldHRpbmdzID0gX2ZuU2V0dGluZ3NGcm9tTm9kZSggdGhpc1tfb0V4dC5pQXBpSW5kZXhdICk7CgkJCV9mbkNsZWFyVGFibGUoIG9TZXR0aW5ncyApOwoJCQkKCQkJaWYgKCB0eXBlb2YgYlJlZHJhdyA9PSAndW5kZWZpbmVkJyB8fCBiUmVkcmF3ICkKCQkJewoJCQkJX2ZuRHJhdyggb1NldHRpbmdzICk7CgkJCX0KCQl9OwoJCQoJCS8qCgkJICogRnVuY3Rpb246IGZuT3BlbgoJCSAqIFB1cnBvc2U6ICBPcGVuIGEgZGlzcGxheSByb3cgKGFwcGVuZCBhIHJvdyBhZnRlciB0aGUgcm93IGluIHF1ZXN0aW9uKQoJCSAqIFJldHVybnM6ICBub2RlOm5OZXdSb3cgLSB0aGUgcm93IG9wZW5lZAoJCSAqIElucHV0czogICBub2RlOm5UciAtIHRoZSB0YWJsZSByb3cgdG8gJ29wZW4nCgkJICogICAgICAgICAgIHN0cmluZzpzSHRtbCAtIHRoZSBIVE1MIHRvIHB1dCBpbnRvIHRoZSByb3cKCQkgKiAgICAgICAgICAgc3RyaW5nOnNDbGFzcyAtIGNsYXNzIHRvIGdpdmUgdGhlIG5ldyBURCBjZWxsCgkJICovCgkJdGhpcy5mbk9wZW4gPSBmdW5jdGlvbiggblRyLCBzSHRtbCwgc0NsYXNzICkKCQl7CgkJCS8qIEZpbmQgc2V0dGluZ3MgZnJvbSB0YWJsZSBub2RlICovCgkJCXZhciBvU2V0dGluZ3MgPSBfZm5TZXR0aW5nc0Zyb21Ob2RlKCB0aGlzW19vRXh0LmlBcGlJbmRleF0gKTsKCQkJCgkJCS8qIHRoZSBvbGQgb3BlbiBvbmUgaWYgdGhlcmUgaXMgb25lICovCgkJCXRoaXMuZm5DbG9zZSggblRyICk7CgkJCQoJCQl2YXIgbk5ld1JvdyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoInRyIik7CgkJCXZhciBuTmV3Q2VsbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoInRkIik7CgkJCW5OZXdSb3cuYXBwZW5kQ2hpbGQoIG5OZXdDZWxsICk7CgkJCW5OZXdDZWxsLmNsYXNzTmFtZSA9IHNDbGFzczsKCQkJbk5ld0NlbGwuY29sU3BhbiA9IF9mblZpc2JsZUNvbHVtbnMoIG9TZXR0aW5ncyApOwoJCQluTmV3Q2VsbC5pbm5lckhUTUwgPSBzSHRtbDsKCQkJCgkJCS8qIElmIHRoZSBuVHIgaXNuJ3Qgb24gdGhlIHBhZ2UgYXQgdGhlIG1vbWVudCAtIHRoZW4gd2UgZG9uJ3QgaW5zZXJ0IGF0IHRoZSBtb21lbnQgKi8KCQkJdmFyIG5UcnMgPSAkKCd0cicsIG9TZXR0aW5ncy5uVEJvZHkpOwoJCQlpZiAoICQuaW5BcnJheShuVHIsIG5UcnMpICE9IC0xICkKCQkJewoJCQkJJChuTmV3Um93KS5pbnNlcnRBZnRlcihuVHIpOwoJCQl9CgkJCQoJCQlvU2V0dGluZ3MuYW9PcGVuUm93cy5wdXNoKCB7CgkJCQkiblRyIjogbk5ld1JvdywKCQkJCSJuUGFyZW50IjogblRyCgkJCX0gKTsKCQkJCgkJCXJldHVybiBuTmV3Um93OwoJCX07CgkJCgkJLyoKCQkgKiBGdW5jdGlvbjogZm5DbG9zZQoJCSAqIFB1cnBvc2U6ICBDbG9zZSBhIGRpc3BsYXkgcm93CgkJICogUmV0dXJuczogIGludDogMCAoc3VjY2Vzcykgb3IgMSAoZmFpbGVkKQoJCSAqIElucHV0czogICBub2RlOm5UciAtIHRoZSB0YWJsZSByb3cgdG8gJ2Nsb3NlJwoJCSAqLwoJCXRoaXMuZm5DbG9zZSA9IGZ1bmN0aW9uKCBuVHIgKQoJCXsKCQkJLyogRmluZCBzZXR0aW5ncyBmcm9tIHRhYmxlIG5vZGUgKi8KCQkJdmFyIG9TZXR0aW5ncyA9IF9mblNldHRpbmdzRnJvbU5vZGUoIHRoaXNbX29FeHQuaUFwaUluZGV4XSApOwoJCQkKCQkJZm9yICggdmFyIGk9MCA7IGk8b1NldHRpbmdzLmFvT3BlblJvd3MubGVuZ3RoIDsgaSsrICkKCQkJewoJCQkJaWYgKCBvU2V0dGluZ3MuYW9PcGVuUm93c1tpXS5uUGFyZW50ID09IG5UciApCgkJCQl7CgkJCQkJdmFyIG5UclBhcmVudCA9IG9TZXR0aW5ncy5hb09wZW5Sb3dzW2ldLm5Uci5wYXJlbnROb2RlOwoJCQkJCWlmICggblRyUGFyZW50ICkKCQkJCQl7CgkJCQkJCS8qIFJlbW92ZSBpdCBpZiBpdCBpcyBjdXJyZW50bHkgb24gZGlzcGxheSAqLwoJCQkJCQluVHJQYXJlbnQucmVtb3ZlQ2hpbGQoIG9TZXR0aW5ncy5hb09wZW5Sb3dzW2ldLm5UciApOwoJCQkJCX0KCQkJCQlvU2V0dGluZ3MuYW9PcGVuUm93cy5zcGxpY2UoIGksIDEgKTsKCQkJCQlyZXR1cm4gMDsKCQkJCX0KCQkJfQoJCQlyZXR1cm4gMTsKCQl9OwoJCQoJCS8qCgkJICogRnVuY3Rpb246IGZuR2V0RGF0YQoJCSAqIFB1cnBvc2U6ICBSZXR1cm4gYW4gYXJyYXkgd2l0aCB0aGUgZGF0YSB3aGljaCBpcyB1c2VkIHRvIG1ha2UgdXAgdGhlIHRhYmxlCgkJICogUmV0dXJuczogIGFycmF5IGFycmF5IHN0cmluZzogMmQgZGF0YSBhcnJheSAoW3Jvd11bY29sdW1uXSkgb3IgYXJyYXkgc3RyaW5nOiAxZCBkYXRhIGFycmF5CgkJICogICAgICAgICAgIG9yCgkJICogICAgICAgICAgIGFycmF5IHN0cmluZyAoaWYgaVJvdyBzcGVjaWZpZWQpCgkJICogSW5wdXRzOiAgIG1peGVkOm1Sb3cgLSBvcHRpb25hbCAtIGlmIG5vdCBwcmVzZW50LCB0aGVuIHRoZSBmdWxsIDJEIGFycmF5IGZvciB0aGUgdGFibGUgCgkJICogICAgICAgICAgICAgaWYgZ2l2ZW4gdGhlbjoKCQkgKiAgICAgICAgICAgICAgIGludDogLSByZXR1cm4gMUQgYXJyYXkgZm9yIGFvRGF0YSBlbnRyeSBvZiB0aGlzIGluZGV4CgkJICogICAgICAgICAgICAgICBub2RlKFRSKTogLSByZXR1cm4gMUQgYXJyYXkgZm9yIHRoaXMgVFIgZWxlbWVudAoJCSAqIElucHV0czogICBpbnQ6aVJvdyAtIG9wdGlvbmFsIC0gaWYgcHJlc2VudCB0aGVuIHRoZSBhcnJheSByZXR1cm5lZCB3aWxsIGJlIHRoZSBkYXRhIGZvcgoJCSAqICAgICAgICAgICAgIHRoZSByb3cgd2l0aCB0aGUgaW5kZXggJ2lSb3cnCgkJICovCgkJdGhpcy5mbkdldERhdGEgPSBmdW5jdGlvbiggbVJvdyApCgkJewoJCQl2YXIgb1NldHRpbmdzID0gX2ZuU2V0dGluZ3NGcm9tTm9kZSggdGhpc1tfb0V4dC5pQXBpSW5kZXhdICk7CgkJCQoJCQlpZiAoIHR5cGVvZiBtUm93ICE9ICd1bmRlZmluZWQnICkKCQkJewoJCQkJdmFyIGlSb3cgPSAodHlwZW9mIG1Sb3cgPT0gJ29iamVjdCcpID8gCgkJCQkJX2ZuTm9kZVRvRGF0YUluZGV4KG9TZXR0aW5ncywgbVJvdykgOiBtUm93OwoJCQkJcmV0dXJuIG9TZXR0aW5ncy5hb0RhdGFbaVJvd10uX2FEYXRhOwoJCQl9CgkJCXJldHVybiBfZm5HZXREYXRhTWFzdGVyKCBvU2V0dGluZ3MgKTsKCQl9OwoJCQoJCS8qCgkJICogRnVuY3Rpb246IGZuR2V0Tm9kZXMKCQkgKiBQdXJwb3NlOiAgUmV0dXJuIGFuIGFycmF5IHdpdGggdGhlIFRSIG5vZGVzIHVzZWQgZm9yIGRyYXdpbmcgdGhlIHRhYmxlCgkJICogUmV0dXJuczogIGFycmF5IG5vZGU6IFRSIGVsZW1lbnRzCgkJICogICAgICAgICAgIG9yCgkJICogICAgICAgICAgIG5vZGUgKGlmIGlSb3cgc3BlY2lmaWVkKQoJCSAqIElucHV0czogICBpbnQ6aVJvdyAtIG9wdGlvbmFsIC0gaWYgcHJlc2VudCB0aGVuIHRoZSBhcnJheSByZXR1cm5lZCB3aWxsIGJlIHRoZSBub2RlIGZvcgoJCSAqICAgICAgICAgICAgIHRoZSByb3cgd2l0aCB0aGUgaW5kZXggJ2lSb3cnCgkJICovCgkJdGhpcy5mbkdldE5vZGVzID0gZnVuY3Rpb24oIGlSb3cgKQoJCXsKCQkJdmFyIG9TZXR0aW5ncyA9IF9mblNldHRpbmdzRnJvbU5vZGUoIHRoaXNbX29FeHQuaUFwaUluZGV4XSApOwoJCQkKCQkJaWYgKCB0eXBlb2YgaVJvdyAhPSAndW5kZWZpbmVkJyApCgkJCXsKCQkJCXJldHVybiBvU2V0dGluZ3MuYW9EYXRhW2lSb3ddLm5UcjsKCQkJfQoJCQlyZXR1cm4gX2ZuR2V0VHJOb2Rlcyggb1NldHRpbmdzICk7CgkJfTsKCQkKCQkvKgoJCSAqIEZ1bmN0aW9uOiBmbkdldFBvc2l0aW9uCgkJICogUHVycG9zZTogIEdldCB0aGUgYXJyYXkgaW5kZXhlcyBvZiBhIHBhcnRpY3VsYXIgY2VsbCBmcm9tIGl0J3MgRE9NIGVsZW1lbnQKCQkgKiBSZXR1cm5zOiAgaW50OiAtIHJvdyBpbmRleCwgb3IgYXJyYXlbIGludCwgaW50LCBpbnQgXTogLSByb3cgaW5kZXgsIGNvbHVtbiBpbmRleCAodmlzaWJsZSkKCQkgKiAgICAgICAgICAgICBhbmQgY29sdW1uIGluZGV4IGluY2x1ZGluZyBoaWRkZW4gY29sdW1ucwoJCSAqIElucHV0czogICBub2RlOm5Ob2RlIC0gdGhpcyBjYW4gZWl0aGVyIGJlIGEgVFIgb3IgYSBURCBpbiB0aGUgdGFibGUsIHRoZSByZXR1cm4gaXMKCQkgKiAgICAgICAgICAgICBkZXBlbmRlbnQgb24gdGhpcyBpbnB1dAoJCSAqLwoJCXRoaXMuZm5HZXRQb3NpdGlvbiA9IGZ1bmN0aW9uKCBuTm9kZSApCgkJewoJCQl2YXIgb1NldHRpbmdzID0gX2ZuU2V0dGluZ3NGcm9tTm9kZSggdGhpc1tfb0V4dC5pQXBpSW5kZXhdICk7CgkJCXZhciBpOwoJCQkKCQkJaWYgKCBuTm9kZS5ub2RlTmFtZS50b1VwcGVyQ2FzZSgpID09ICJUUiIgKQoJCQl7CgkJCQlyZXR1cm4gX2ZuTm9kZVRvRGF0YUluZGV4KG9TZXR0aW5ncywgbk5vZGUpOwoJCQl9CgkJCWVsc2UgaWYgKCBuTm9kZS5ub2RlTmFtZS50b1VwcGVyQ2FzZSgpID09ICJURCIgKQoJCQl7CgkJCQl2YXIgaURhdGFJbmRleCA9IF9mbk5vZGVUb0RhdGFJbmRleChvU2V0dGluZ3MsIG5Ob2RlLnBhcmVudE5vZGUpOwoJCQkJdmFyIGlDb3JyZWN0b3IgPSAwOwoJCQkJZm9yICggdmFyIGo9MCA7IGo8b1NldHRpbmdzLmFvQ29sdW1ucy5sZW5ndGggOyBqKysgKQoJCQkJewoJCQkJCWlmICggb1NldHRpbmdzLmFvQ29sdW1uc1tqXS5iVmlzaWJsZSApCgkJCQkJewoJCQkJCQlpZiAoIG9TZXR0aW5ncy5hb0RhdGFbaURhdGFJbmRleF0ublRyLmdldEVsZW1lbnRzQnlUYWdOYW1lKCd0ZCcpW2otaUNvcnJlY3Rvcl0gPT0gbk5vZGUgKQoJCQkJCQl7CgkJCQkJCQlyZXR1cm4gWyBpRGF0YUluZGV4LCBqLWlDb3JyZWN0b3IsIGogXTsKCQkJCQkJfQoJCQkJCX0KCQkJCQllbHNlCgkJCQkJewoJCQkJCQlpQ29ycmVjdG9yKys7CgkJCQkJfQoJCQkJfQoJCQl9CgkJCXJldHVybiBudWxsOwoJCX07CgkJCgkJLyoKCQkgKiBGdW5jdGlvbjogZm5VcGRhdGUKCQkgKiBQdXJwb3NlOiAgVXBkYXRlIGEgdGFibGUgY2VsbCBvciByb3cKCQkgKiBSZXR1cm5zOiAgaW50OiAwIG9rYXksIDEgZXJyb3IKCQkgKiBJbnB1dHM6ICAgYXJyYXkgc3RyaW5nICdvcicgc3RyaW5nOm1EYXRhIC0gZGF0YSB0byB1cGRhdGUgdGhlIGNlbGwvcm93IHdpdGgKCQkgKiAgICAgICAgICAgbWl4ZWQ6bVJvdyAtIAoJCSAqICAgICAgICAgICAgIGludDogLSBpbmRleCBvZiBhb0RhdGEgdG8gYmUgdXBkYXRlZCwgb3IKCQkgKiAgICAgICAgICAgICBub2RlKFRSKTogLSBUUiBlbGVtZW50IHlvdSB3YW50IHRvIHVwZGF0ZQoJCSAqICAgICAgICAgICBpbnQ6aUNvbHVtbiAtIHRoZSBjb2x1bW4gdG8gdXBkYXRlIC0gb3B0aW9uYWwgKG5vdCB1c2VkIG9mIG1EYXRhIGlzIDJEKQoJCSAqICAgICAgICAgICBib29sOmJSZWRyYXcgLSByZWRyYXcgdGhlIHRhYmxlIG9yIG5vdCAtIGRlZmF1bHQgdHJ1ZQoJCSAqICAgICAgICAgICBib29sOmJBY3Rpb24gLSBwZXJmb3JtIHByZWRyYXcgYWN0aW9ucyBvciBub3QgKHlvdSB3aWxsIHdhbnQgdGhpcyBhcyAndHJ1ZScgaWYKCQkgKiAgICAgICAgICAgICB5b3UgaGF2ZSBiUmVkcmF3IGFzIHRydWUpIC0gZGVmYXVsdCB0cnVlCgkJICovCgkJdGhpcy5mblVwZGF0ZSA9IGZ1bmN0aW9uKCBtRGF0YSwgbVJvdywgaUNvbHVtbiwgYlJlZHJhdywgYkFjdGlvbiApCgkJewoJCQl2YXIgb1NldHRpbmdzID0gX2ZuU2V0dGluZ3NGcm9tTm9kZSggdGhpc1tfb0V4dC5pQXBpSW5kZXhdICk7CgkJCXZhciBpVmlzaWJsZUNvbHVtbjsKCQkJdmFyIHNEaXNwbGF5OwoJCQl2YXIgaVJvdyA9ICh0eXBlb2YgbVJvdyA9PSAnb2JqZWN0JykgPyAKCQkJCV9mbk5vZGVUb0RhdGFJbmRleChvU2V0dGluZ3MsIG1Sb3cpIDogbVJvdzsKCQkJCgkJCWlmICggdHlwZW9mIG1EYXRhICE9ICdvYmplY3QnICkKCQkJewoJCQkJc0Rpc3BsYXkgPSBtRGF0YTsKCQkJCW9TZXR0aW5ncy5hb0RhdGFbaVJvd10uX2FEYXRhW2lDb2x1bW5dID0gc0Rpc3BsYXk7CgkJCQkKCQkJCWlmICggb1NldHRpbmdzLmFvQ29sdW1uc1tpQ29sdW1uXS5mblJlbmRlciAhPT0gbnVsbCApCgkJCQl7CgkJCQkJc0Rpc3BsYXkgPSBvU2V0dGluZ3MuYW9Db2x1bW5zW2lDb2x1bW5dLmZuUmVuZGVyKCB7CgkJCQkJCSJpRGF0YVJvdyI6IGlSb3csCgkJCQkJCSJpRGF0YUNvbHVtbiI6IGlDb2x1bW4sCgkJCQkJCSJhRGF0YSI6IG9TZXR0aW5ncy5hb0RhdGFbaVJvd10uX2FEYXRhLAoJCQkJCQkib1NldHRpbmdzIjogb1NldHRpbmdzCgkJCQkJfSApOwoJCQkJCQoJCQkJCWlmICggb1NldHRpbmdzLmFvQ29sdW1uc1tpQ29sdW1uXS5iVXNlUmVuZGVyZWQgKQoJCQkJCXsKCQkJCQkJb1NldHRpbmdzLmFvRGF0YVtpUm93XS5fYURhdGFbaUNvbHVtbl0gPSBzRGlzcGxheTsKCQkJCQl9CgkJCQl9CgkJCQkKCQkJCWlWaXNpYmxlQ29sdW1uID0gX2ZuQ29sdW1uSW5kZXhUb1Zpc2libGUoIG9TZXR0aW5ncywgaUNvbHVtbiApOwoJCQkJaWYgKCBpVmlzaWJsZUNvbHVtbiAhPT0gbnVsbCApCgkJCQl7CgkJCQkJb1NldHRpbmdzLmFvRGF0YVtpUm93XS5uVHIuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ3RkJylbaVZpc2libGVDb2x1bW5dLmlubmVySFRNTCA9IAoJCQkJCQlzRGlzcGxheTsKCQkJCX0KCQkJfQoJCQllbHNlCgkJCXsKCQkJCWlmICggbURhdGEubGVuZ3RoICE9IG9TZXR0aW5ncy5hb0NvbHVtbnMubGVuZ3RoICkKCQkJCXsKCQkJCQlfZm5Mb2coIG9TZXR0aW5ncywgMCwgJ0FuIGFycmF5IHBhc3NlZCB0byBmblVwZGF0ZSBtdXN0IGhhdmUgdGhlIHNhbWUgbnVtYmVyIG9mICcrCgkJCQkJCSdjb2x1bW5zIGFzIHRoZSB0YWJsZSBpbiBxdWVzdGlvbiAtIGluIHRoaXMgY2FzZSAnK29TZXR0aW5ncy5hb0NvbHVtbnMubGVuZ3RoICk7CgkJCQkJcmV0dXJuIDE7CgkJCQl9CgkJCQkKCQkJCWZvciAoIHZhciBpPTAgOyBpPG1EYXRhLmxlbmd0aCA7IGkrKyApCgkJCQl7CgkJCQkJc0Rpc3BsYXkgPSBtRGF0YVtpXTsKCQkJCQlvU2V0dGluZ3MuYW9EYXRhW2lSb3ddLl9hRGF0YVtpXSA9IHNEaXNwbGF5OwoJCQkJCQoJCQkJCWlmICggb1NldHRpbmdzLmFvQ29sdW1uc1tpXS5mblJlbmRlciAhPT0gbnVsbCApCgkJCQkJewoJCQkJCQlzRGlzcGxheSA9IG9TZXR0aW5ncy5hb0NvbHVtbnNbaV0uZm5SZW5kZXIoIHsKCQkJCQkJCSJpRGF0YVJvdyI6IGlSb3csCgkJCQkJCQkiaURhdGFDb2x1bW4iOiBpLAoJCQkJCQkJImFEYXRhIjogb1NldHRpbmdzLmFvRGF0YVtpUm93XS5fYURhdGEsCgkJCQkJCQkib1NldHRpbmdzIjogb1NldHRpbmdzCgkJCQkJCX0gKTsKCQkJCQkJCgkJCQkJCWlmICggb1NldHRpbmdzLmFvQ29sdW1uc1tpXS5iVXNlUmVuZGVyZWQgKQoJCQkJCQl7CgkJCQkJCQlvU2V0dGluZ3MuYW9EYXRhW2lSb3ddLl9hRGF0YVtpXSA9IHNEaXNwbGF5OwoJCQkJCQl9CgkJCQkJfQoJCQkJCQoJCQkJCWlWaXNpYmxlQ29sdW1uID0gX2ZuQ29sdW1uSW5kZXhUb1Zpc2libGUoIG9TZXR0aW5ncywgaSApOwoJCQkJCWlmICggaVZpc2libGVDb2x1bW4gIT09IG51bGwgKQoJCQkJCXsKCQkJCQkJb1NldHRpbmdzLmFvRGF0YVtpUm93XS5uVHIuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ3RkJylbaVZpc2libGVDb2x1bW5dLmlubmVySFRNTCA9IAoJCQkJCQkJc0Rpc3BsYXk7CgkJCQkJfQoJCQkJfQoJCQl9CgkJCQoJCQkvKiBNb2RpZnkgdGhlIHNlYXJjaCBpbmRleCBmb3IgdGhpcyByb3cgKHN0cmljdGx5IHRoaXMgaXMgbGlrZWx5IG5vdCBuZWVkZWQsIHNpbmNlIGZuUmVEcmF3CgkJCSAqIHdpbGwgcmVidWlsZCB0aGUgc2VhcmNoIGFycmF5IC0gaG93ZXZlciwgdGhlIHJlZHJhdyBtaWdodCBiZSBkaXNhYmxlZCBieSB0aGUgdXNlcikKCQkJICovCgkJCXZhciBpRGlzcGxheUluZGV4ID0gJC5pbkFycmF5KCBpUm93LCBvU2V0dGluZ3MuYWlEaXNwbGF5ICk7CgkJCW9TZXR0aW5ncy5hc0RhdGFTZWFyY2hbaURpc3BsYXlJbmRleF0gPSBfZm5CdWlsZFNlYXJjaFJvdyggb1NldHRpbmdzLCAKCQkJCW9TZXR0aW5ncy5hb0RhdGFbaVJvd10uX2FEYXRhICk7CgkJCQoJCQkvKiBQZXJmb3JtIHByZS1kcmF3IGFjdGlvbnMgKi8KCQkJaWYgKCB0eXBlb2YgYkFjdGlvbiA9PSAndW5kZWZpbmVkJyB8fCBiQWN0aW9uICkKCQkJewoJCQkJX2ZuQWp1c3RDb2x1bW5TaXppbmcoIG9TZXR0aW5ncyApOwoJCQl9CgkJCQoJCQkvKiBSZWRyYXcgdGhlIHRhYmxlICovCgkJCWlmICggdHlwZW9mIGJSZWRyYXcgPT0gJ3VuZGVmaW5lZCcgfHwgYlJlZHJhdyApCgkJCXsKCQkJCV9mblJlRHJhdyggb1NldHRpbmdzICk7CgkJCX0KCQkJcmV0dXJuIDA7CgkJfTsKCQkKCQkKCQkvKgoJCSAqIEZ1bmN0aW9uOiBmblNob3dDb2xvdW1uCgkJICogUHVycG9zZTogIFNob3cgYSBwYXJ0aWN1bGFyIGNvbHVtbgoJCSAqIFJldHVybnM6ICAtCgkJICogSW5wdXRzOiAgIGludDppQ29sIC0gdGhlIGNvbHVtbiB3aG9zZSBkaXNwbGF5IHNob3VsZCBiZSBjaGFuZ2VkCgkJICogICAgICAgICAgIGJvb2w6YlNob3cgLSBzaG93ICh0cnVlKSBvciBoaWRlIChmYWxzZSkgdGhlIGNvbHVtbgoJCSAqICAgICAgICAgICBib29sOmJSZWRyYXcgLSByZWRyYXcgdGhlIHRhYmxlIG9yIG5vdCAtIGRlZmF1bHQgdHJ1ZQoJCSAqLwoJCXRoaXMuZm5TZXRDb2x1bW5WaXMgPSBmdW5jdGlvbiAoIGlDb2wsIGJTaG93LCBiUmVkcmF3ICkKCQl7CgkJCXZhciBvU2V0dGluZ3MgPSBfZm5TZXR0aW5nc0Zyb21Ob2RlKCB0aGlzW19vRXh0LmlBcGlJbmRleF0gKTsKCQkJdmFyIGksIGlMZW47CgkJCXZhciBpQ29sdW1ucyA9IG9TZXR0aW5ncy5hb0NvbHVtbnMubGVuZ3RoOwoJCQl2YXIgblRkLCBhblRkczsKCQkJCgkJCS8qIE5vIHBvaW50IGluIGRvaW5nIGFueXRoaW5nIGlmIHdlIGFyZSByZXF1ZXN0aW5nIHdoYXQgaXMgYWxyZWFkeSB0cnVlICovCgkJCWlmICggb1NldHRpbmdzLmFvQ29sdW1uc1tpQ29sXS5iVmlzaWJsZSA9PSBiU2hvdyApCgkJCXsKCQkJCXJldHVybjsKCQkJfQoJCQkKCQkJdmFyIG5UckhlYWQgPSAkKCc+dHInLCBvU2V0dGluZ3MublRIZWFkKVswXTsKCQkJdmFyIG5UckZvb3QgPSAkKCc+dHInLCBvU2V0dGluZ3MublRGb290KVswXTsKCQkJdmFyIGFuVGhlYWRUaCA9IFtdOwoJCQl2YXIgYW5UZm9vdFRoID0gW107CgkJCWZvciAoIGk9MCA7IGk8aUNvbHVtbnMgOyBpKysgKQoJCQl7CgkJCQlhblRoZWFkVGgucHVzaCggb1NldHRpbmdzLmFvQ29sdW1uc1tpXS5uVGggKTsKCQkJCWFuVGZvb3RUaC5wdXNoKCBvU2V0dGluZ3MuYW9Db2x1bW5zW2ldLm5UZiApOwoJCQl9CgkJCQoJCQkvKiBTaG93IHRoZSBjb2x1bW4gKi8KCQkJaWYgKCBiU2hvdyApCgkJCXsKCQkJCXZhciBpSW5zZXJ0ID0gMDsKCQkJCWZvciAoIGk9MCA7IGk8aUNvbCA7IGkrKyApCgkJCQl7CgkJCQkJaWYgKCBvU2V0dGluZ3MuYW9Db2x1bW5zW2ldLmJWaXNpYmxlICkKCQkJCQl7CgkJCQkJCWlJbnNlcnQrKzsKCQkJCQl9CgkJCQl9CgkJCQkKCQkJCS8qIE5lZWQgdG8gZGVjaWRlIGlmIHdlIHNob3VsZCB1c2UgYXBwZW5kQ2hpbGQgb3IgaW5zZXJ0QmVmb3JlICovCgkJCQlpZiAoIGlJbnNlcnQgPj0gX2ZuVmlzYmxlQ29sdW1ucyggb1NldHRpbmdzICkgKQoJCQkJewoJCQkJCW5UckhlYWQuYXBwZW5kQ2hpbGQoIGFuVGhlYWRUaFtpQ29sXSApOwoJCQkJCWlmICggblRyRm9vdCApCgkJCQkJewoJCQkJCQluVHJGb290LmFwcGVuZENoaWxkKCBhblRmb290VGhbaUNvbF0gKTsKCQkJCQl9CgkJCQkJCgkJCQkJZm9yICggaT0wLCBpTGVuPW9TZXR0aW5ncy5hb0RhdGEubGVuZ3RoIDsgaTxpTGVuIDsgaSsrICkKCQkJCQl7CgkJCQkJCW5UZCA9IG9TZXR0aW5ncy5hb0RhdGFbaV0uX2FuSGlkZGVuW2lDb2xdOwoJCQkJCQlvU2V0dGluZ3MuYW9EYXRhW2ldLm5Uci5hcHBlbmRDaGlsZCggblRkICk7CgkJCQkJfQoJCQkJfQoJCQkJZWxzZQoJCQkJewoJCQkJCS8qIFdoaWNoIGNvbG91bW4gc2hvdWxkIHdlIGJlIGluc2VydGluZyBiZWZvcmU/ICovCgkJCQkJdmFyIGlCZWZvcmU7CgkJCQkJZm9yICggaT1pQ29sIDsgaTxpQ29sdW1ucyA7IGkrKyApCgkJCQkJewoJCQkJCQlpQmVmb3JlID0gX2ZuQ29sdW1uSW5kZXhUb1Zpc2libGUoIG9TZXR0aW5ncywgaSApOwoJCQkJCQlpZiAoIGlCZWZvcmUgIT09IG51bGwgKQoJCQkJCQl7CgkJCQkJCQlicmVhazsKCQkJCQkJfQoJCQkJCX0KCQkJCQkKCQkJCQluVHJIZWFkLmluc2VydEJlZm9yZSggYW5UaGVhZFRoW2lDb2xdLCBuVHJIZWFkLmdldEVsZW1lbnRzQnlUYWdOYW1lKCd0aCcpW2lCZWZvcmVdICk7CgkJCQkJaWYgKCBuVHJGb290ICkKCQkJCQl7CgkJCQkJCW5UckZvb3QuaW5zZXJ0QmVmb3JlKCBhblRmb290VGhbaUNvbF0sIG5UckZvb3QuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ3RoJylbaUJlZm9yZV0gKTsKCQkJCQl9CgkJCQkJCgkJCQkJYW5UZHMgPSBfZm5HZXRUZE5vZGVzKCBvU2V0dGluZ3MgKTsKCQkJCQlmb3IgKCBpPTAsIGlMZW49b1NldHRpbmdzLmFvRGF0YS5sZW5ndGggOyBpPGlMZW4gOyBpKysgKQoJCQkJCXsKCQkJCQkJblRkID0gb1NldHRpbmdzLmFvRGF0YVtpXS5fYW5IaWRkZW5baUNvbF07CgkJCQkJCW9TZXR0aW5ncy5hb0RhdGFbaV0ublRyLmluc2VydEJlZm9yZSggblRkLCAkKCc+dGQ6ZXEoJytpQmVmb3JlKycpJywgCgkJCQkJCQlvU2V0dGluZ3MuYW9EYXRhW2ldLm5UcilbMF0gKTsKCQkJCQl9CgkJCQl9CgkJCQkKCQkJCW9TZXR0aW5ncy5hb0NvbHVtbnNbaUNvbF0uYlZpc2libGUgPSB0cnVlOwoJCQl9CgkJCWVsc2UKCQkJewoJCQkJLyogUmVtb3ZlIGEgY29sdW1uIGZyb20gZGlzcGxheSAqLwoJCQkJblRySGVhZC5yZW1vdmVDaGlsZCggYW5UaGVhZFRoW2lDb2xdICk7CgkJCQlpZiAoIG5UckZvb3QgKQoJCQkJewoJCQkJCW5UckZvb3QucmVtb3ZlQ2hpbGQoIGFuVGZvb3RUaFtpQ29sXSApOwoJCQkJfQoJCQkJCgkJCQlhblRkcyA9IF9mbkdldFRkTm9kZXMoIG9TZXR0aW5ncyApOwoJCQkJZm9yICggaT0wLCBpTGVuPW9TZXR0aW5ncy5hb0RhdGEubGVuZ3RoIDsgaTxpTGVuIDsgaSsrICkKCQkJCXsKCQkJCQluVGQgPSBhblRkc1sgKCBpKm9TZXR0aW5ncy5hb0NvbHVtbnMubGVuZ3RoKSArIChpQ29sKjEpIF07CgkJCQkJb1NldHRpbmdzLmFvRGF0YVtpXS5fYW5IaWRkZW5baUNvbF0gPSBuVGQ7CgkJCQkJblRkLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoIG5UZCApOwoJCQkJfQoJCQkJCgkJCQlvU2V0dGluZ3MuYW9Db2x1bW5zW2lDb2xdLmJWaXNpYmxlID0gZmFsc2U7CgkJCX0KCQkJCgkJCS8qIElmIHRoZXJlIGFyZSBhbnkgJ29wZW4nIHJvd3MsIHRoZW4gd2UgbmVlZCB0byBhbHRlciB0aGUgY29sc3BhbiBmb3IgdGhpcyBjb2wgY2hhbmdlICovCgkJCWZvciAoIGk9MCwgaUxlbj1vU2V0dGluZ3MuYW9PcGVuUm93cy5sZW5ndGggOyBpPGlMZW4gOyBpKysgKQoJCQl7CgkJCQlvU2V0dGluZ3MuYW9PcGVuUm93c1tpXS5uVHIuY29sU3BhbiA9IF9mblZpc2JsZUNvbHVtbnMoIG9TZXR0aW5ncyApOwoJCQl9CgkJCQoJCQkvKiBEbyBhIHJlZHJhdyBpbmNhc2UgYW55dGhpbmcgZGVwZW5kaW5nIG9uIHRoZSB0YWJsZSBjb2x1bW5zIG5lZWRzIGl0IAoJCQkgKiAoYnVpbHQtaW46IHNjcm9sbGluZykgCgkJCSAqLwoJCQlpZiAoIHR5cGVvZiBiUmVkcmF3ID09ICd1bmRlZmluZWQnIHx8IGJSZWRyYXcgKQoJCQl7CgkJCQlfZm5BanVzdENvbHVtblNpemluZyggb1NldHRpbmdzICk7CgkJCQlfZm5EcmF3KCBvU2V0dGluZ3MgKTsKCQkJfQoJCQkKCQkJX2ZuU2F2ZVN0YXRlKCBvU2V0dGluZ3MgKTsKCQl9OwoJCQoJCS8qCgkJICogRnVuY3Rpb246IGZuUGFnZUNoYW5nZQoJCSAqIFB1cnBvc2U6ICBDaGFuZ2UgdGhlIHBhZ2luYXRpb24KCQkgKiBSZXR1cm5zOiAgLQoJCSAqIElucHV0czogICBzdHJpbmc6c0FjdGlvbiAtIHBhZ2luZyBhY3Rpb24gdG8gdGFrZTogImZpcnN0IiwgInByZXZpb3VzIiwgIm5leHQiIG9yICJsYXN0IgoJCSAqICAgICAgICAgICBib29sOmJSZWRyYXcgLSByZWRyYXcgdGhlIHRhYmxlIG9yIG5vdCAtIG9wdGlvbmFsIC0gZGVmYXVsdCB0cnVlCgkJICovCgkJdGhpcy5mblBhZ2VDaGFuZ2UgPSBmdW5jdGlvbiAoIHNBY3Rpb24sIGJSZWRyYXcgKQoJCXsKCQkJdmFyIG9TZXR0aW5ncyA9IF9mblNldHRpbmdzRnJvbU5vZGUoIHRoaXNbX29FeHQuaUFwaUluZGV4XSApOwoJCQlfZm5QYWdlQ2hhbmdlKCBvU2V0dGluZ3MsIHNBY3Rpb24gKTsKCQkJX2ZuQ2FsY3VsYXRlRW5kKCBvU2V0dGluZ3MgKTsKCQkJCgkJCWlmICggdHlwZW9mIGJSZWRyYXcgPT0gJ3VuZGVmaW5lZCcgfHwgYlJlZHJhdyApCgkJCXsKCQkJCV9mbkRyYXcoIG9TZXR0aW5ncyApOwoJCQl9CgkJfTsKCQkKCQkvKgoJCSAqIEZ1bmN0aW9uOiBmbkRlc3Ryb3kKCQkgKiBQdXJwb3NlOiAgRGVzdHJ1Y3RvciBmb3IgdGhlIERhdGFUYWJsZQoJCSAqIFJldHVybnM6ICAtCgkJICogSW5wdXRzOiAgIC0KCQkgKi8KCQl0aGlzLmZuRGVzdHJveSA9IGZ1bmN0aW9uICggKQoJCXsKCQkJdmFyIG9TZXR0aW5ncyA9IF9mblNldHRpbmdzRnJvbU5vZGUoIHRoaXNbX29FeHQuaUFwaUluZGV4XSApOwoJCQl2YXIgbk9yaWcgPSBvU2V0dGluZ3MublRhYmxlV3JhcHBlci5wYXJlbnROb2RlOwoJCQl2YXIgbkJvZHkgPSBvU2V0dGluZ3MublRCb2R5OwoJCQl2YXIgaSwgaUxlbjsKCQkJCgkJCS8qIEZsYWcgdG8gbm90ZSB0aGF0IHRoZSB0YWJsZSBpcyBjdXJyZW50bHkgYmVpbmcgZGVzdG9yeWVkIC0gbm8gYWN0aW9uIHNob3VsZCBiZSB0YWtlbiAqLwoJCQlvU2V0dGluZ3MuYkRlc3Ryb3lpbmcgPSB0cnVlOwoJCQkKCQkJLyogUmVzdG9yZSBoaWRkZW4gY29sdW1ucyAqLwoJCQlmb3IgKCBpPTAsIGlMZW49b1NldHRpbmdzLmFvQ29sdW1ucy5sZW5ndGggOyBpPGlMZW4gOyBpKysgKQoJCQl7CgkJCQlpZiAoIG9TZXR0aW5ncy5hb0NvbHVtbnNbaV0uYlZpc2libGUgPT09IGZhbHNlICkKCQkJCXsKCQkJCQl0aGlzLmZuU2V0Q29sdW1uVmlzKCBpLCB0cnVlICk7CgkJCQl9CgkJCX0KCQkJCgkJCS8qIElmIHRoZXJlIGlzIGFuICdlbXB0eScgaW5kaWNhdG9yIHJvdywgcmVtb3ZlIGl0ICovCgkJCSQoJ3Rib2R5PnRyPnRkLicrb1NldHRpbmdzLm9DbGFzc2VzLnNSb3dFbXB0eSwgb1NldHRpbmdzLm5UYWJsZSkucGFyZW50KCkucmVtb3ZlKCk7CgkJCQoJCQkvKiBXaGVuIHNjcm9sbGluZyB3ZSBoYWQgdG8gYnJlYWsgdGhlIHRhYmxlIHVwIC0gcmVzdG9yZSBpdCAqLwoJCQlpZiAoIG9TZXR0aW5ncy5uVGFibGUgIT0gb1NldHRpbmdzLm5USGVhZC5wYXJlbnROb2RlICkKCQkJewoJCQkJJCgnPnRoZWFkJywgb1NldHRpbmdzLm5UYWJsZSkucmVtb3ZlKCk7CgkJCQlvU2V0dGluZ3MublRhYmxlLmFwcGVuZENoaWxkKCBvU2V0dGluZ3MublRIZWFkICk7CgkJCX0KCQkJCgkJCWlmICggb1NldHRpbmdzLm5URm9vdCAmJiBvU2V0dGluZ3MublRhYmxlICE9IG9TZXR0aW5ncy5uVEZvb3QucGFyZW50Tm9kZSApCgkJCXsKCQkJCSQoJz50Zm9vdCcsIG9TZXR0aW5ncy5uVGFibGUpLnJlbW92ZSgpOwoJCQkJb1NldHRpbmdzLm5UYWJsZS5hcHBlbmRDaGlsZCggb1NldHRpbmdzLm5URm9vdCApOwoJCQl9CgkJCQoJCQkvKiBSZW1vdmUgdGhlIERhdGFUYWJsZXMgZ2VuZXJhdGVkIG5vZGVzLCBldmVudHMgYW5kIGNsYXNzZXMgKi8KCQkJb1NldHRpbmdzLm5UYWJsZS5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKCBvU2V0dGluZ3MublRhYmxlICk7CgkJCSQob1NldHRpbmdzLm5UYWJsZVdyYXBwZXIpLnJlbW92ZSgpOwoJCQkKCQkJb1NldHRpbmdzLmFhU29ydGluZyA9IFtdOwoJCQlvU2V0dGluZ3MuYWFTb3J0aW5nRml4ZWQgPSBbXTsKCQkJX2ZuU29ydGluZ0NsYXNzZXMoIG9TZXR0aW5ncyApOwoJCQkKCQkJJChfZm5HZXRUck5vZGVzKCBvU2V0dGluZ3MgKSkucmVtb3ZlQ2xhc3MoIG9TZXR0aW5ncy5hc1N0cmlwQ2xhc3Nlcy5qb2luKCcgJykgKTsKCQkJCgkJCWlmICggIW9TZXR0aW5ncy5iSlVJICkKCQkJewoJCQkJJCgndGgnLCBvU2V0dGluZ3MublRIZWFkKS5yZW1vdmVDbGFzcyggWyBfb0V4dC5vU3RkQ2xhc3Nlcy5zU29ydGFibGUsCgkJCQkJX29FeHQub1N0ZENsYXNzZXMuc1NvcnRhYmxlQXNjLAoJCQkJCV9vRXh0Lm9TdGRDbGFzc2VzLnNTb3J0YWJsZURlc2MsCgkJCQkJX29FeHQub1N0ZENsYXNzZXMuc1NvcnRhYmxlTm9uZSBdLmpvaW4oJyAnKQoJCQkJKTsKCQkJfQoJCQllbHNlCgkJCXsKCQkJCSQoJ3RoJywgb1NldHRpbmdzLm5USGVhZCkucmVtb3ZlQ2xhc3MoIFsgX29FeHQub1N0ZENsYXNzZXMuc1NvcnRhYmxlLAoJCQkJCV9vRXh0Lm9KVUlDbGFzc2VzLnNTb3J0YWJsZUFzYywKCQkJCQlfb0V4dC5vSlVJQ2xhc3Nlcy5zU29ydGFibGVEZXNjLAoJCQkJCV9vRXh0Lm9KVUlDbGFzc2VzLnNTb3J0YWJsZU5vbmUgXS5qb2luKCcgJykKCQkJCSk7CgkJCQkkKCd0aCBzcGFuJywgb1NldHRpbmdzLm5USGVhZCkucmVtb3ZlKCk7CgkJCX0KCQkJCgkJCS8qIEFkZCB0aGUgVFIgZWxlbWVudHMgYmFjayBpbnRvIHRoZSB0YWJsZSBpbiB0aGVpciBvcmlnaW5hbCBvcmRlciAqLwoJCQluT3JpZy5hcHBlbmRDaGlsZCggb1NldHRpbmdzLm5UYWJsZSApOwoJCQlmb3IgKCBpPTAsIGlMZW49b1NldHRpbmdzLmFvRGF0YS5sZW5ndGggOyBpPGlMZW4gOyBpKysgKQoJCQl7CgkJCQluQm9keS5hcHBlbmRDaGlsZCggb1NldHRpbmdzLmFvRGF0YVtpXS5uVHIgKTsKCQkJfQoJCQkKCQkJLyogUmVzdG9yZSB0aGUgd2lkdGggb2YgdGhlIG9yaWdpbmFsIHRhYmxlICovCgkJCW9TZXR0aW5ncy5uVGFibGUuc3R5bGUud2lkdGggPSBfZm5TdHJpbmdUb0NzcyhvU2V0dGluZ3Muc0Rlc3Ryb3lXaWR0aCk7CgkJCQoJCQkvKiBJZiB0aGUgd2VyZSBvcmlnaW5hbGx5IG9kZC9ldmVuIHR5cGUgY2xhc3NlcyAtIHRoZW4gd2UgYWRkIHRoZW0gYmFjayBoZXJlLiBOb3RlCgkJCSAqIHRoaXMgaXMgbm90IGZvb2wgcHJvb2YgKGZvciBleGFtcGxlIGlmIG5vdCBhbGwgcm93cyBhcyBvZGQvZXZlbiBjbGFzc2VzIC0gYnV0IAoJCQkgKiBpdCdzIGEgZ29vZCBlZmZvcnQgd2l0aG91dCBnZXR0aW5nIGNhcnJpZWQgYXdheQoJCQkgKi8KCQkJJCgnPnRyOmV2ZW4nLCBuQm9keSkuYWRkQ2xhc3MoIG9TZXR0aW5ncy5hc0Rlc3RvcnlTdHJpcHNbMF0gKTsKCQkJJCgnPnRyOm9kZCcsIG5Cb2R5KS5hZGRDbGFzcyggb1NldHRpbmdzLmFzRGVzdG9yeVN0cmlwc1sxXSApOwoJCQkKCQkJLyogUmVtb3ZlIHRoZSBzZXR0aW5ncyBvYmplY3QgZnJvbSB0aGUgc2V0dGluZ3MgYXJyYXkgKi8KCQkJZm9yICggaT0wLCBpTGVuPV9hb1NldHRpbmdzLmxlbmd0aCA7IGk8aUxlbiA7IGkrKyApCgkJCXsKCQkJCWlmICggX2FvU2V0dGluZ3NbaV0gPT0gb1NldHRpbmdzICkKCQkJCXsKCQkJCQlfYW9TZXR0aW5ncy5zcGxpY2UoIGksIDEgKTsKCQkJCX0KCQkJfQoJCQkKCQkJLyogRW5kIGl0IGFsbCAqLwoJCQlvU2V0dGluZ3MgPSBudWxsOwoJCX07CgkJCgkJLyoKCQkgKiBGdW5jdGlvbjogX2ZuQWp1c3RDb2x1bW5TaXppbmcKCQkgKiBQdXJwb3NlOiAgVXBkYXRlIHRhbGUgc2l6aW5nIGJhc2VkIG9uIGNvbnRlbnQuIFRoaXMgd291bGQgbW9zdCBsaWtlbHkgYmUgdXNlZCBmb3Igc2Nyb2xsaW5nCgkJICogICBhbmQgd2lsbCB0eXBpY2FsbHkgbmVlZCBhIHJlZHJhdyBhZnRlciBpdC4KCQkgKiBSZXR1cm5zOiAgLQoJCSAqIElucHV0czogICBib29sOmJSZWRyYXcgLSByZWRyYXcgdGhlIHRhYmxlIG9yIG5vdCwgeW91IHdpbGwgdHlwaWNhbGx5IHdhbnQgdG8gLSBkZWZhdWx0IHRydWUKCQkgKi8KCQl0aGlzLmZuQWRqdXN0Q29sdW1uU2l6aW5nID0gZnVuY3Rpb24gKCBiUmVkcmF3ICkKCQl7CgkJCV9mbkFqdXN0Q29sdW1uU2l6aW5nKCBfZm5TZXR0aW5nc0Zyb21Ob2RlKCB0aGlzW19vRXh0LmlBcGlJbmRleF0gKSApOwoJCQkKCQkJaWYgKCB0eXBlb2YgYlJlZHJhdyA9PSAndW5kZWZpbmVkJyB8fCBiUmVkcmF3ICkKCQkJewoJCQkJdGhpcy5mbkRyYXcoIGZhbHNlICk7CgkJCX0KCQl9OwoJCQoJCS8qCgkJICogUGx1Z2luIEFQSSBmdW5jdGlvbnMKCQkgKiAKCQkgKiBUaGlzIGNhbGwgd2lsbCBhZGQgdGhlIGZ1bmN0aW9ucyB3aGljaCBhcmUgZGVmaW5lZCBpbiBfb0V4dC5vQXBpIHRvIHRoZQoJCSAqIERhdGFUYWJsZXMgb2JqZWN0LCBwcm92aWRpbmcgYSByYXRoZXIgbmljZSB3YXkgdG8gYWxsb3cgcGx1Zy1pbiBBUEkgZnVuY3Rpb25zLiBOb3RlIHRoYXQKCQkgKiB0aGlzIGlzIGRvbmUgaGVyZSwgc28gdGhhdCBBUEkgZnVuY3Rpb24gY2FuIGFjdHVhbGx5IG92ZXJyaWRlIHRoZSBidWlsdCBpbiBBUEkgZnVuY3Rpb25zIGlmCgkJICogcmVxdWlyZWQgZm9yIGEgcGFydGljdWxhciBwdXJwb3NlLgoJCSAqLwoJCQoJCS8qCgkJICogRnVuY3Rpb246IF9mbkV4dGVybkFwaUZ1bmMKCQkgKiBQdXJwb3NlOiAgQ3JlYXRlIGEgd3JhcHBlciBmdW5jdGlvbiBmb3IgZXhwb3J0aW5nIGFuIGludGVybmFsIGZ1bmMgdG8gYW4gZXh0ZXJuYWwgQVBJIGZ1bmMKCQkgKiBSZXR1cm5zOiAgZnVuY3Rpb246IC0gd3JhcHBlZCBmdW5jdGlvbgoJCSAqIElucHV0czogICBzdHJpbmc6c0Z1bmMgLSBBUEkgZnVuY3Rpb24gbmFtZQoJCSAqLwoJCWZ1bmN0aW9uIF9mbkV4dGVybkFwaUZ1bmMgKHNGdW5jKQoJCXsKCQkJcmV0dXJuIGZ1bmN0aW9uKCkgewoJCQkJCXZhciBhQXJncyA9IFtfZm5TZXR0aW5nc0Zyb21Ob2RlKHRoaXNbX29FeHQuaUFwaUluZGV4XSldLmNvbmNhdCggCgkJCQkJCUFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cykgKTsKCQkJCQlyZXR1cm4gX29FeHQub0FwaVtzRnVuY10uYXBwbHkoIHRoaXMsIGFBcmdzICk7CgkJCQl9OwoJCX0KCQkKCQlmb3IgKCB2YXIgc0Z1bmMgaW4gX29FeHQub0FwaSApCgkJewoJCQlpZiAoIHNGdW5jICkKCQkJewoJCQkJLyoKCQkJCSAqIEZ1bmN0aW9uOiBhbm9uCgkJCQkgKiBQdXJwb3NlOiAgV3JhcCB0aGUgcGx1Zy1pbiBBUEkgZnVuY3Rpb25zIGluIG9yZGVyIHRvIHByb3ZpZGUgdGhlIHNldHRpbmdzIGFzIDFzdCBhcmcgCgkJCQkgKiAgIGFuZCBleGVjdXRlIGluIHRoaXMgc2NvcGUKCQkJCSAqIFJldHVybnM6ICAtCgkJCQkgKiBJbnB1dHM6ICAgLQoJCQkJICovCgkJCQl0aGlzW3NGdW5jXSA9IF9mbkV4dGVybkFwaUZ1bmMoc0Z1bmMpOwoJCQl9CgkJfQoJCQoJCQoJCQoJCS8qICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqCgkJICogU2VjdGlvbiAtIExvY2FsIGZ1bmN0aW9ucwoJCSAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqLwoJCQoJCS8qICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqCgkJICogU2VjdGlvbiAtIEluaXRhbGlzYXRpb24KCQkgKi8KCQkKCQkvKgoJCSAqIEZ1bmN0aW9uOiBfZm5Jbml0YWxpc2UKCQkgKiBQdXJwb3NlOiAgRHJhdyB0aGUgdGFibGUgZm9yIHRoZSBmaXJzdCB0aW1lLCBhZGRpbmcgYWxsIHJlcXVpcmVkIGZlYXR1cmVzCgkJICogUmV0dXJuczogIC0KCQkgKiBJbnB1dHM6ICAgb2JqZWN0Om9TZXR0aW5ncyAtIGRhdGFUYWJsZXMgc2V0dGluZ3Mgb2JqZWN0CgkJICovCgkJZnVuY3Rpb24gX2ZuSW5pdGFsaXNlICggb1NldHRpbmdzICkKCQl7CgkJCXZhciBpLCBpTGVuOwoJCQkKCQkJLyogRW5zdXJlIHRoYXQgdGhlIHRhYmxlIGRhdGEgaXMgZnVsbHkgaW5pdGlhbGlzZWQgKi8KCQkJaWYgKCBvU2V0dGluZ3MuYkluaXRpYWxpc2VkID09PSBmYWxzZSApCgkJCXsKCQkJCXNldFRpbWVvdXQoIGZ1bmN0aW9uKCl7IF9mbkluaXRhbGlzZSggb1NldHRpbmdzICk7IH0sIDIwMCApOwoJCQkJcmV0dXJuOwoJCQl9CgkJCQoJCQkvKiBTaG93IHRoZSBkaXNwbGF5IEhUTUwgb3B0aW9ucyAqLwoJCQlfZm5BZGRPcHRpb25zSHRtbCggb1NldHRpbmdzICk7CgkJCQoJCQkvKiBEcmF3IHRoZSBoZWFkZXJzIGZvciB0aGUgdGFibGUgKi8KCQkJX2ZuRHJhd0hlYWQoIG9TZXR0aW5ncyApOwoJCQkKCQkJLyogT2theSB0byBzaG93IHRoYXQgc29tZXRoaW5nIGlzIGdvaW5nIG9uIG5vdyAqLwoJCQlfZm5Qcm9jZXNzaW5nRGlzcGxheSggb1NldHRpbmdzLCB0cnVlICk7CgkJCQoJCQkvKiBDYWxjdWxhdGUgc2l6ZXMgZm9yIGNvbHVtbnMgKi8KCQkJaWYgKCBvU2V0dGluZ3Mub0ZlYXR1cmVzLmJBdXRvV2lkdGggKQoJCQl7CgkJCQlfZm5DYWxjdWxhdGVDb2x1bW5XaWR0aHMoIG9TZXR0aW5ncyApOwoJCQl9CgkJCQoJCQlmb3IgKCBpPTAsIGlMZW49b1NldHRpbmdzLmFvQ29sdW1ucy5sZW5ndGggOyBpPGlMZW4gOyBpKysgKQoJCQl7CgkJCQlpZiAoIG9TZXR0aW5ncy5hb0NvbHVtbnNbaV0uc1dpZHRoICE9PSBudWxsICkKCQkJCXsKCQkJCQlvU2V0dGluZ3MuYW9Db2x1bW5zW2ldLm5UaC5zdHlsZS53aWR0aCA9IF9mblN0cmluZ1RvQ3NzKCBvU2V0dGluZ3MuYW9Db2x1bW5zW2ldLnNXaWR0aCApOwoJCQkJfQoJCQl9CgkJCQoJCQkvKiBJZiB0aGVyZSBpcyBkZWZhdWx0IHNvcnRpbmcgcmVxdWlyZWQgLSBsZXQncyBkbyBpdC4gVGhlIHNvcnQgZnVuY3Rpb24KCQkJICogd2lsbCBkbyB0aGUgZHJhd2luZyBmb3IgdXMuIE90aGVyd2lzZSB3ZSBkcmF3IHRoZSB0YWJsZQoJCQkgKi8KCQkJaWYgKCBvU2V0dGluZ3Mub0ZlYXR1cmVzLmJTb3J0ICkKCQkJewoJCQkJX2ZuU29ydCggb1NldHRpbmdzICk7CgkJCX0KCQkJZWxzZQoJCQl7CgkJCQlvU2V0dGluZ3MuYWlEaXNwbGF5ID0gb1NldHRpbmdzLmFpRGlzcGxheU1hc3Rlci5zbGljZSgpOwoJCQkJX2ZuQ2FsY3VsYXRlRW5kKCBvU2V0dGluZ3MgKTsKCQkJCV9mbkRyYXcoIG9TZXR0aW5ncyApOwoJCQl9CgkJCQoJCQkvKiBpZiB0aGVyZSBpcyBhbiBhamF4IHNvdXJjZSAqLwoJCQlpZiAoIG9TZXR0aW5ncy5zQWpheFNvdXJjZSAhPT0gbnVsbCAmJiAhb1NldHRpbmdzLm9GZWF0dXJlcy5iU2VydmVyU2lkZSApCgkJCXsKCQkJCW9TZXR0aW5ncy5mblNlcnZlckRhdGEuY2FsbCggb1NldHRpbmdzLm9JbnN0YW5jZSwgb1NldHRpbmdzLnNBamF4U291cmNlLCBbXSwgZnVuY3Rpb24oanNvbikgewoJCQkJCS8qIEdvdCB0aGUgZGF0YSAtIGFkZCBpdCB0byB0aGUgdGFibGUgKi8KCQkJCQlmb3IgKCBpPTAgOyBpPGpzb24uYWFEYXRhLmxlbmd0aCA7IGkrKyApCgkJCQkJewoJCQkJCQlfZm5BZGREYXRhKCBvU2V0dGluZ3MsIGpzb24uYWFEYXRhW2ldICk7CgkJCQkJfQoJCQkJCQoJCQkJCS8qIFJlc2V0IHRoZSBpbml0IGRpc3BsYXkgZm9yIGNvb2tpZSBzYXZpbmcuIFdlJ3ZlIGFscmVhZHkgZG9uZSBhIGZpbHRlciwgYW5kCgkJCQkJICogdGhlcmVmb3JlIGNsZWFyZWQgaXQgYmVmb3JlLiBTbyB3ZSBuZWVkIHRvIG1ha2UgaXQgYXBwZWFyICdmcmVzaCcKCQkJCQkgKi8KCQkJCQlvU2V0dGluZ3MuaUluaXREaXNwbGF5U3RhcnQgPSBvU2V0dGluZ3MuX2lEaXNwbGF5U3RhcnQ7CgkJCQkJCgkJCQkJaWYgKCBvU2V0dGluZ3Mub0ZlYXR1cmVzLmJTb3J0ICkKCQkJCQl7CgkJCQkJCV9mblNvcnQoIG9TZXR0aW5ncyApOwoJCQkJCX0KCQkJCQllbHNlCgkJCQkJewoJCQkJCQlvU2V0dGluZ3MuYWlEaXNwbGF5ID0gb1NldHRpbmdzLmFpRGlzcGxheU1hc3Rlci5zbGljZSgpOwoJCQkJCQlfZm5DYWxjdWxhdGVFbmQoIG9TZXR0aW5ncyApOwoJCQkJCQlfZm5EcmF3KCBvU2V0dGluZ3MgKTsKCQkJCQl9CgkJCQkJCgkJCQkJX2ZuUHJvY2Vzc2luZ0Rpc3BsYXkoIG9TZXR0aW5ncywgZmFsc2UgKTsKCQkJCQkKCQkJCQkvKiBSdW4gdGhlIGluaXQgY2FsbGJhY2sgaWYgdGhlcmUgaXMgb25lIC0gZG9uZSBoZXJlIGZvciBhamF4IHNvdXJjZSBmb3IganNvbiBvYmogKi8KCQkJCQlpZiAoIHR5cGVvZiBvU2V0dGluZ3MuZm5Jbml0Q29tcGxldGUgPT0gJ2Z1bmN0aW9uJyApCgkJCQkJewoJCQkJCQlvU2V0dGluZ3MuZm5Jbml0Q29tcGxldGUuY2FsbCggb1NldHRpbmdzLm9JbnN0YW5jZSwgb1NldHRpbmdzLCBqc29uICk7CgkJCQkJfQoJCQkJfSApOwoJCQkJcmV0dXJuOwoJCQl9CgkJCQoJCQlpZiAoICFvU2V0dGluZ3Mub0ZlYXR1cmVzLmJTZXJ2ZXJTaWRlICkKCQkJewoJCQkJX2ZuUHJvY2Vzc2luZ0Rpc3BsYXkoIG9TZXR0aW5ncywgZmFsc2UgKTsKCQkJfQoJCX0KCQkKCQkvKgoJCSAqIEZ1bmN0aW9uOiBfZm5MYW5ndWFnZVByb2Nlc3MKCQkgKiBQdXJwb3NlOiAgQ29weSBsYW5ndWFnZSB2YXJpYWJsZXMgZnJvbSByZW1vdGUgb2JqZWN0IHRvIGEgbG9jYWwgb25lCgkJICogUmV0dXJuczogIC0KCQkgKiBJbnB1dHM6ICAgb2JqZWN0Om9TZXR0aW5ncyAtIGRhdGFUYWJsZXMgc2V0dGluZ3Mgb2JqZWN0CgkJICogICAgICAgICAgIG9iamVjdDpvTGFuZ3VhZ2UgLSBMYW5ndWFnZSBpbmZvcm1hdGlvbgoJCSAqICAgICAgICAgICBib29sOmJJbml0IC0gaW5pdCBvbmNlIGNvbXBsZXRlCgkJICovCgkJZnVuY3Rpb24gX2ZuTGFuZ3VhZ2VQcm9jZXNzKCBvU2V0dGluZ3MsIG9MYW5ndWFnZSwgYkluaXQgKQoJCXsKCQkJX2ZuTWFwKCBvU2V0dGluZ3Mub0xhbmd1YWdlLCBvTGFuZ3VhZ2UsICdzUHJvY2Vzc2luZycgKTsKCQkJX2ZuTWFwKCBvU2V0dGluZ3Mub0xhbmd1YWdlLCBvTGFuZ3VhZ2UsICdzTGVuZ3RoTWVudScgKTsKCQkJX2ZuTWFwKCBvU2V0dGluZ3Mub0xhbmd1YWdlLCBvTGFuZ3VhZ2UsICdzRW1wdHlUYWJsZScgKTsKCQkJX2ZuTWFwKCBvU2V0dGluZ3Mub0xhbmd1YWdlLCBvTGFuZ3VhZ2UsICdzWmVyb1JlY29yZHMnICk7CgkJCV9mbk1hcCggb1NldHRpbmdzLm9MYW5ndWFnZSwgb0xhbmd1YWdlLCAnc0luZm8nICk7CgkJCV9mbk1hcCggb1NldHRpbmdzLm9MYW5ndWFnZSwgb0xhbmd1YWdlLCAnc0luZm9FbXB0eScgKTsKCQkJX2ZuTWFwKCBvU2V0dGluZ3Mub0xhbmd1YWdlLCBvTGFuZ3VhZ2UsICdzSW5mb0ZpbHRlcmVkJyApOwoJCQlfZm5NYXAoIG9TZXR0aW5ncy5vTGFuZ3VhZ2UsIG9MYW5ndWFnZSwgJ3NJbmZvUG9zdEZpeCcgKTsKCQkJX2ZuTWFwKCBvU2V0dGluZ3Mub0xhbmd1YWdlLCBvTGFuZ3VhZ2UsICdzU2VhcmNoJyApOwoJCQkKCQkJaWYgKCB0eXBlb2Ygb0xhbmd1YWdlLm9QYWdpbmF0ZSAhPSAndW5kZWZpbmVkJyApCgkJCXsKCQkJCV9mbk1hcCggb1NldHRpbmdzLm9MYW5ndWFnZS5vUGFnaW5hdGUsIG9MYW5ndWFnZS5vUGFnaW5hdGUsICdzRmlyc3QnICk7CgkJCQlfZm5NYXAoIG9TZXR0aW5ncy5vTGFuZ3VhZ2Uub1BhZ2luYXRlLCBvTGFuZ3VhZ2Uub1BhZ2luYXRlLCAnc1ByZXZpb3VzJyApOwoJCQkJX2ZuTWFwKCBvU2V0dGluZ3Mub0xhbmd1YWdlLm9QYWdpbmF0ZSwgb0xhbmd1YWdlLm9QYWdpbmF0ZSwgJ3NOZXh0JyApOwoJCQkJX2ZuTWFwKCBvU2V0dGluZ3Mub0xhbmd1YWdlLm9QYWdpbmF0ZSwgb0xhbmd1YWdlLm9QYWdpbmF0ZSwgJ3NMYXN0JyApOwoJCQl9CgkJCQoJCQkvKiBCYWNrd2FyZHMgY29tcGF0aWJpbGl0eSAtIGlmIHRoZXJlIGlzIG5vIHNFbXB0eVRhYmxlIGdpdmVuLCB0aGVuIHVzZSB0aGUgc2FtZSBhcwoJCQkgKiBzWmVyb1JlY29yZHMgLSBhc3N1bWluZyB0aGF0IGlzIGdpdmVuLgoJCQkgKi8KCQkJaWYgKCB0eXBlb2Ygb0xhbmd1YWdlLnNFbXB0eVRhYmxlID09ICd1bmRlZmluZWQnICYmIAoJCQkgICAgIHR5cGVvZiBvTGFuZ3VhZ2Uuc1plcm9SZWNvcmRzICE9ICd1bmRlZmluZWQnICkKCQkJewoJCQkJX2ZuTWFwKCBvU2V0dGluZ3Mub0xhbmd1YWdlLCBvTGFuZ3VhZ2UsICdzWmVyb1JlY29yZHMnLCAnc0VtcHR5VGFibGUnICk7CgkJCX0KCQkJCgkJCWlmICggYkluaXQgKQoJCQl7CgkJCQlfZm5Jbml0YWxpc2UoIG9TZXR0aW5ncyApOwoJCQl9CgkJfQoJCQoJCS8qCgkJICogRnVuY3Rpb246IF9mbkFkZENvbHVtbgoJCSAqIFB1cnBvc2U6ICBBZGQgYSBjb2x1bW4gdG8gdGhlIGxpc3QgdXNlZCBmb3IgdGhlIHRhYmxlIHdpdGggZGVmYXVsdCB2YWx1ZXMKCQkgKiBSZXR1cm5zOiAgLQoJCSAqIElucHV0czogICBvYmplY3Q6b1NldHRpbmdzIC0gZGF0YVRhYmxlcyBzZXR0aW5ncyBvYmplY3QKCQkgKiAgICAgICAgICAgbm9kZTpuVGggLSB0aGUgdGggZWxlbWVudCBmb3IgdGhpcyBjb2x1bW4KCQkgKi8KCQlmdW5jdGlvbiBfZm5BZGRDb2x1bW4oIG9TZXR0aW5ncywgblRoICkKCQl7CgkJCW9TZXR0aW5ncy5hb0NvbHVtbnNbIG9TZXR0aW5ncy5hb0NvbHVtbnMubGVuZ3RoKysgXSA9IHsKCQkJCSJzVHlwZSI6IG51bGwsCgkJCQkiX2JBdXRvVHlwZSI6IHRydWUsCgkJCQkiYlZpc2libGUiOiB0cnVlLAoJCQkJImJTZWFyY2hhYmxlIjogdHJ1ZSwKCQkJCSJiU29ydGFibGUiOiB0cnVlLAoJCQkJImFzU29ydGluZyI6IFsgJ2FzYycsICdkZXNjJyBdLAoJCQkJInNTb3J0aW5nQ2xhc3MiOiBvU2V0dGluZ3Mub0NsYXNzZXMuc1NvcnRhYmxlLAoJCQkJInNTb3J0aW5nQ2xhc3NKVUkiOiBvU2V0dGluZ3Mub0NsYXNzZXMuc1NvcnRKVUksCgkJCQkic1RpdGxlIjogblRoID8gblRoLmlubmVySFRNTCA6ICcnLAoJCQkJInNOYW1lIjogJycsCgkJCQkic1dpZHRoIjogbnVsbCwKCQkJCSJzV2lkdGhPcmlnIjogbnVsbCwKCQkJCSJzQ2xhc3MiOiBudWxsLAoJCQkJImZuUmVuZGVyIjogbnVsbCwKCQkJCSJiVXNlUmVuZGVyZWQiOiB0cnVlLAoJCQkJImlEYXRhU29ydCI6IG9TZXR0aW5ncy5hb0NvbHVtbnMubGVuZ3RoLTEsCgkJCQkic1NvcnREYXRhVHlwZSI6ICdzdGQnLAoJCQkJIm5UaCI6IG5UaCA/IG5UaCA6IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3RoJyksCgkJCQkiblRmIjogbnVsbAoJCQl9OwoJCQkKCQkJdmFyIGlDb2wgPSBvU2V0dGluZ3MuYW9Db2x1bW5zLmxlbmd0aC0xOwoJCQl2YXIgb0NvbCA9IG9TZXR0aW5ncy5hb0NvbHVtbnNbIGlDb2wgXTsKCQkJCgkJCS8qIEFkZCBhIGNvbHVtbiBzcGVjaWZpYyBmaWx0ZXIgKi8KCQkJaWYgKCB0eXBlb2Ygb1NldHRpbmdzLmFvUHJlU2VhcmNoQ29sc1sgaUNvbCBdID09ICd1bmRlZmluZWQnIHx8CgkJCSAgICAgb1NldHRpbmdzLmFvUHJlU2VhcmNoQ29sc1sgaUNvbCBdID09PSBudWxsICkKCQkJewoJCQkJb1NldHRpbmdzLmFvUHJlU2VhcmNoQ29sc1sgaUNvbCBdID0gewoJCQkJCSJzU2VhcmNoIjogIiIsCgkJCQkJImJSZWdleCI6IGZhbHNlLAoJCQkJCSJiU21hcnQiOiB0cnVlCgkJCQl9OwoJCQl9CgkJCWVsc2UKCQkJewoJCQkJLyogRG9uJ3QgcmVxdWlyZSB0aGF0IHRoZSB1c2VyIG11c3Qgc3BlY2lmeSBiUmVnZXggYW5kIC8gb3IgYlNtYXJ0ICovCgkJCQlpZiAoIHR5cGVvZiBvU2V0dGluZ3MuYW9QcmVTZWFyY2hDb2xzWyBpQ29sIF0uYlJlZ2V4ID09ICd1bmRlZmluZWQnICkKCQkJCXsKCQkJCQlvU2V0dGluZ3MuYW9QcmVTZWFyY2hDb2xzWyBpQ29sIF0uYlJlZ2V4ID0gdHJ1ZTsKCQkJCX0KCQkJCQoJCQkJaWYgKCB0eXBlb2Ygb1NldHRpbmdzLmFvUHJlU2VhcmNoQ29sc1sgaUNvbCBdLmJTbWFydCA9PSAndW5kZWZpbmVkJyApCgkJCQl7CgkJCQkJb1NldHRpbmdzLmFvUHJlU2VhcmNoQ29sc1sgaUNvbCBdLmJTbWFydCA9IHRydWU7CgkJCQl9CgkJCX0gCgkJCQoJCQkvKiBVc2UgdGhlIGNvbHVtbiBvcHRpb25zIGZ1bmN0aW9uIHRvIGluaXRpYWxpc2UgY2xhc3NlcyBldGMgKi8KCQkJX2ZuQ29sdW1uT3B0aW9ucyggb1NldHRpbmdzLCBpQ29sLCBudWxsICk7CgkJfQoJCQoJCS8qCgkJICogRnVuY3Rpb246IF9mbkNvbHVtbk9wdGlvbnMKCQkgKiBQdXJwb3NlOiAgQXBwbHkgb3B0aW9ucyBmb3IgYSBjb2x1bW4KCQkgKiBSZXR1cm5zOiAgLQoJCSAqIElucHV0czogICBvYmplY3Q6b1NldHRpbmdzIC0gZGF0YVRhYmxlcyBzZXR0aW5ncyBvYmplY3QKCQkgKiAgICAgICAgICAgaW50OmlDb2wgLSBjb2x1bW4gaW5kZXggdG8gY29uc2lkZXIKCQkgKiAgICAgICAgICAgb2JqZWN0Om9PcHRpb25zIC0gb2JqZWN0IHdpdGggc1R5cGUsIGJWaXNpYmxlIGFuZCBiU2VhcmNoYWJsZQoJCSAqLwoJCWZ1bmN0aW9uIF9mbkNvbHVtbk9wdGlvbnMoIG9TZXR0aW5ncywgaUNvbCwgb09wdGlvbnMgKQoJCXsKCQkJdmFyIG9Db2wgPSBvU2V0dGluZ3MuYW9Db2x1bW5zWyBpQ29sIF07CgkJCQoJCQkvKiBVc2VyIHNwZWNpZmllZCBjb2x1bW4gb3B0aW9ucyAqLwoJCQlpZiAoIHR5cGVvZiBvT3B0aW9ucyAhPSAndW5kZWZpbmVkJyAmJiBvT3B0aW9ucyAhPT0gbnVsbCApCgkJCXsKCQkJCWlmICggdHlwZW9mIG9PcHRpb25zLnNUeXBlICE9ICd1bmRlZmluZWQnICkKCQkJCXsKCQkJCQlvQ29sLnNUeXBlID0gb09wdGlvbnMuc1R5cGU7CgkJCQkJb0NvbC5fYkF1dG9UeXBlID0gZmFsc2U7CgkJCQl9CgkJCQkKCQkJCV9mbk1hcCggb0NvbCwgb09wdGlvbnMsICJiVmlzaWJsZSIgKTsKCQkJCV9mbk1hcCggb0NvbCwgb09wdGlvbnMsICJiU2VhcmNoYWJsZSIgKTsKCQkJCV9mbk1hcCggb0NvbCwgb09wdGlvbnMsICJiU29ydGFibGUiICk7CgkJCQlfZm5NYXAoIG9Db2wsIG9PcHRpb25zLCAic1RpdGxlIiApOwoJCQkJX2ZuTWFwKCBvQ29sLCBvT3B0aW9ucywgInNOYW1lIiApOwoJCQkJX2ZuTWFwKCBvQ29sLCBvT3B0aW9ucywgInNXaWR0aCIgKTsKCQkJCV9mbk1hcCggb0NvbCwgb09wdGlvbnMsICJzV2lkdGgiLCAic1dpZHRoT3JpZyIgKTsKCQkJCV9mbk1hcCggb0NvbCwgb09wdGlvbnMsICJzQ2xhc3MiICk7CgkJCQlfZm5NYXAoIG9Db2wsIG9PcHRpb25zLCAiZm5SZW5kZXIiICk7CgkJCQlfZm5NYXAoIG9Db2wsIG9PcHRpb25zLCAiYlVzZVJlbmRlcmVkIiApOwoJCQkJX2ZuTWFwKCBvQ29sLCBvT3B0aW9ucywgImlEYXRhU29ydCIgKTsKCQkJCV9mbk1hcCggb0NvbCwgb09wdGlvbnMsICJhc1NvcnRpbmciICk7CgkJCQlfZm5NYXAoIG9Db2wsIG9PcHRpb25zLCAic1NvcnREYXRhVHlwZSIgKTsKCQkJfQoJCQkKCQkJLyogRmVhdHVyZSBzb3J0aW5nIG92ZXJyaWRlcyBjb2x1bW4gc3BlY2lmaWMgd2hlbiBvZmYgKi8KCQkJaWYgKCAhb1NldHRpbmdzLm9GZWF0dXJlcy5iU29ydCApCgkJCXsKCQkJCW9Db2wuYlNvcnRhYmxlID0gZmFsc2U7CgkJCX0KCQkJCgkJCS8qIENoZWNrIHRoYXQgdGhlIGNsYXNzIGFzc2lnbm1lbnQgaXMgY29ycmVjdCBmb3Igc29ydGluZyAqLwoJCQlpZiAoICFvQ29sLmJTb3J0YWJsZSB8fAoJCQkJCSAoJC5pbkFycmF5KCdhc2MnLCBvQ29sLmFzU29ydGluZykgPT0gLTEgJiYgJC5pbkFycmF5KCdkZXNjJywgb0NvbC5hc1NvcnRpbmcpID09IC0xKSApCgkJCXsKCQkJCW9Db2wuc1NvcnRpbmdDbGFzcyA9IG9TZXR0aW5ncy5vQ2xhc3Nlcy5zU29ydGFibGVOb25lOwoJCQkJb0NvbC5zU29ydGluZ0NsYXNzSlVJID0gIiI7CgkJCX0KCQkJZWxzZSBpZiAoICQuaW5BcnJheSgnYXNjJywgb0NvbC5hc1NvcnRpbmcpICE9IC0xICYmICQuaW5BcnJheSgnZGVzYycsIG9Db2wuYXNTb3J0aW5nKSA9PSAtMSApCgkJCXsKCQkJCW9Db2wuc1NvcnRpbmdDbGFzcyA9IG9TZXR0aW5ncy5vQ2xhc3Nlcy5zU29ydGFibGVBc2M7CgkJCQlvQ29sLnNTb3J0aW5nQ2xhc3NKVUkgPSBvU2V0dGluZ3Mub0NsYXNzZXMuc1NvcnRKVUlBc2NBbGxvd2VkOwoJCQl9CgkJCWVsc2UgaWYgKCAkLmluQXJyYXkoJ2FzYycsIG9Db2wuYXNTb3J0aW5nKSA9PSAtMSAmJiAkLmluQXJyYXkoJ2Rlc2MnLCBvQ29sLmFzU29ydGluZykgIT0gLTEgKQoJCQl7CgkJCQlvQ29sLnNTb3J0aW5nQ2xhc3MgPSBvU2V0dGluZ3Mub0NsYXNzZXMuc1NvcnRhYmxlRGVzYzsKCQkJCW9Db2wuc1NvcnRpbmdDbGFzc0pVSSA9IG9TZXR0aW5ncy5vQ2xhc3Nlcy5zU29ydEpVSURlc2NBbGxvd2VkOwoJCQl9CgkJfQoJCQoJCS8qCgkJICogRnVuY3Rpb246IF9mbkFkZERhdGEKCQkgKiBQdXJwb3NlOiAgQWRkIGEgZGF0YSBhcnJheSB0byB0aGUgdGFibGUsIGNyZWF0aW5nIERPTSBub2RlIGV0YwoJCSAqIFJldHVybnM6ICBpbnQ6IC0gPj0wIGlmIHN1Y2Nlc3NmdWwgKGluZGV4IG9mIG5ldyBhb0RhdGEgZW50cnkpLCAtMSBpZiBmYWlsZWQKCQkgKiBJbnB1dHM6ICAgb2JqZWN0Om9TZXR0aW5ncyAtIGRhdGFUYWJsZXMgc2V0dGluZ3Mgb2JqZWN0CgkJICogICAgICAgICAgIGFycmF5OmFEYXRhIC0gZGF0YSBhcnJheSB0byBiZSBhZGRlZAoJCSAqIE5vdGVzOiAgICBUaGVyZSBhcmUgdHdvIGJhc2ljIG1ldGhvZHMgZm9yIERhdGFUYWJsZXMgdG8gZ2V0IGRhdGEgdG8gZGlzcGxheSAtIGEgSlMgYXJyYXkKCQkgKiAgICh3aGljaCBpcyBkZWFsdCB3aXRoIGJ5IHRoaXMgZnVuY3Rpb24pLCBhbmQgdGhlIERPTSwgd2hpY2ggaGFzIGl0J3Mgb3duIG9wdGltaXNlZAoJCSAqICAgZnVuY3Rpb24gKF9mbkdhdGhlckRhdGEpLiBCZSBjYXJlZnVsIHRvIG1ha2UgdGhlIHNhbWUgY2hhbmdlcyBoZXJlIGFzIHRoZXJlIGFuZCB2aWNlLXZlcnNhCgkJICovCgkJZnVuY3Rpb24gX2ZuQWRkRGF0YSAoIG9TZXR0aW5ncywgYURhdGFTdXBwbGllZCApCgkJewoJCQkvKiBTYW5pdHkgY2hlY2sgdGhlIGxlbmd0aCBvZiB0aGUgbmV3IGFycmF5ICovCgkJCWlmICggYURhdGFTdXBwbGllZC5sZW5ndGggIT0gb1NldHRpbmdzLmFvQ29sdW1ucy5sZW5ndGggJiYKCQkJCW9TZXR0aW5ncy5pRHJhd0Vycm9yICE9IG9TZXR0aW5ncy5pRHJhdyApCgkJCXsKCQkJCV9mbkxvZyggb1NldHRpbmdzLCAwLCAiQWRkZWQgZGF0YSAoc2l6ZSAiK2FEYXRhU3VwcGxpZWQubGVuZ3RoKyIpIGRvZXMgbm90IG1hdGNoIGtub3duICIrCgkJCQkJIm51bWJlciBvZiBjb2x1bW5zICgiK29TZXR0aW5ncy5hb0NvbHVtbnMubGVuZ3RoKyIpIiApOwoJCQkJb1NldHRpbmdzLmlEcmF3RXJyb3IgPSBvU2V0dGluZ3MuaURyYXc7CgkJCQlyZXR1cm4gLTE7CgkJCX0KCQkJCgkJCQoJCQkvKiBDcmVhdGUgdGhlIG9iamVjdCBmb3Igc3RvcmluZyBpbmZvcm1hdGlvbiBhYm91dCB0aGlzIG5ldyByb3cgKi8KCQkJdmFyIGFEYXRhID0gYURhdGFTdXBwbGllZC5zbGljZSgpOwoJCQl2YXIgaVRoaXNJbmRleCA9IG9TZXR0aW5ncy5hb0RhdGEubGVuZ3RoOwoJCQlvU2V0dGluZ3MuYW9EYXRhLnB1c2goIHsKCQkJCSJuVHIiOiBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0cicpLAoJCQkJIl9pSWQiOiBvU2V0dGluZ3MuaU5leHRJZCsrLAoJCQkJIl9hRGF0YSI6IGFEYXRhLAoJCQkJIl9hbkhpZGRlbiI6IFtdLAoJCQkJIl9zUm93U3RyaXBlIjogJycKCQkJfSApOwoJCQkKCQkJLyogQ3JlYXRlIHRoZSBjZWxscyAqLwoJCQl2YXIgblRkLCBzVGhpc1R5cGU7CgkJCWZvciAoIHZhciBpPTAgOyBpPGFEYXRhLmxlbmd0aCA7IGkrKyApCgkJCXsKCQkJCW5UZCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3RkJyk7CgkJCQkKCQkJCS8qIEFsbG93IG51bGwgZGF0YSAoZnJvbSBhIGRhdGEgYXJyYXkpIC0gc2ltcGx5IGRlYWwgd2l0aCBpdCBhcyBhIGJsYW5rIHN0cmluZyAqLwoJCQkJaWYgKCBhRGF0YVtpXSA9PT0gbnVsbCApCgkJCQl7CgkJCQkJYURhdGFbaV0gPSAnJzsKCQkJCX0KCQkJCQoJCQkJaWYgKCB0eXBlb2Ygb1NldHRpbmdzLmFvQ29sdW1uc1tpXS5mblJlbmRlciA9PSAnZnVuY3Rpb24nICkKCQkJCXsKCQkJCQl2YXIgc1JlbmRlcmVkID0gb1NldHRpbmdzLmFvQ29sdW1uc1tpXS5mblJlbmRlciggewoJCQkJCQkJImlEYXRhUm93IjogaVRoaXNJbmRleCwKCQkJCQkJCSJpRGF0YUNvbHVtbiI6IGksCgkJCQkJCQkiYURhdGEiOiBhRGF0YSwKCQkJCQkJCSJvU2V0dGluZ3MiOiBvU2V0dGluZ3MKCQkJCQkJfSApOwoJCQkJCW5UZC5pbm5lckhUTUwgPSBzUmVuZGVyZWQ7CgkJCQkJaWYgKCBvU2V0dGluZ3MuYW9Db2x1bW5zW2ldLmJVc2VSZW5kZXJlZCApCgkJCQkJewoJCQkJCQkvKiBVc2UgdGhlIHJlbmRlcmVkIGRhdGEgZm9yIGZpbHRlcmluZy9zb3J0aW5nICovCgkJCQkJCW9TZXR0aW5ncy5hb0RhdGFbaVRoaXNJbmRleF0uX2FEYXRhW2ldID0gc1JlbmRlcmVkOwoJCQkJCX0KCQkJCX0KCQkJCWVsc2UKCQkJCXsKCQkJCQluVGQuaW5uZXJIVE1MID0gYURhdGFbaV07CgkJCQl9CgkJCQkKCQkJCS8qIENhc3QgZXZlcnl0aGluZyBhcyBhIHN0cmluZyAtIHNvIHdlIGNhbiB0cmVhdCBldmVyeXRoaW5nIGVxdWFsbHkgd2hlbiBzb3J0aW5nICovCgkJCQlpZiAoIHR5cGVvZiBhRGF0YVtpXSAhPSAnc3RyaW5nJyApCgkJCQl7CgkJCQkJYURhdGFbaV0gKz0gIiI7CgkJCQl9CgkJCQlhRGF0YVtpXSA9ICQudHJpbShhRGF0YVtpXSk7CgkJCQkKCQkJCS8qIEFkZCB1c2VyIGRlZmluZWQgY2xhc3MgKi8KCQkJCWlmICggb1NldHRpbmdzLmFvQ29sdW1uc1tpXS5zQ2xhc3MgIT09IG51bGwgKQoJCQkJewoJCQkJCW5UZC5jbGFzc05hbWUgPSBvU2V0dGluZ3MuYW9Db2x1bW5zW2ldLnNDbGFzczsKCQkJCX0KCQkJCQoJCQkJLyogU2VlIGlmIHdlIHNob3VsZCBhdXRvLWRldGVjdCB0aGUgY29sdW1uIHR5cGUgKi8KCQkJCWlmICggb1NldHRpbmdzLmFvQ29sdW1uc1tpXS5fYkF1dG9UeXBlICYmIG9TZXR0aW5ncy5hb0NvbHVtbnNbaV0uc1R5cGUgIT0gJ3N0cmluZycgKQoJCQkJewoJCQkJCS8qIEF0dGVtcHQgdG8gYXV0byBkZXRlY3QgdGhlIHR5cGUgLSBzYW1lIGFzIF9mbkdhdGhlckRhdGEoKSAqLwoJCQkJCXNUaGlzVHlwZSA9IF9mbkRldGVjdFR5cGUoIG9TZXR0aW5ncy5hb0RhdGFbaVRoaXNJbmRleF0uX2FEYXRhW2ldICk7CgkJCQkJaWYgKCBvU2V0dGluZ3MuYW9Db2x1bW5zW2ldLnNUeXBlID09PSBudWxsICkKCQkJCQl7CgkJCQkJCW9TZXR0aW5ncy5hb0NvbHVtbnNbaV0uc1R5cGUgPSBzVGhpc1R5cGU7CgkJCQkJfQoJCQkJCWVsc2UgaWYgKCBvU2V0dGluZ3MuYW9Db2x1bW5zW2ldLnNUeXBlICE9IHNUaGlzVHlwZSApCgkJCQkJewoJCQkJCQkvKiBTdHJpbmcgaXMgYWx3YXlzIHRoZSAnZmFsbGJhY2snIG9wdGlvbiAqLwoJCQkJCQlvU2V0dGluZ3MuYW9Db2x1bW5zW2ldLnNUeXBlID0gJ3N0cmluZyc7CgkJCQkJfQoJCQkJfQoJCQkJCQoJCQkJaWYgKCBvU2V0dGluZ3MuYW9Db2x1bW5zW2ldLmJWaXNpYmxlICkKCQkJCXsKCQkJCQlvU2V0dGluZ3MuYW9EYXRhW2lUaGlzSW5kZXhdLm5Uci5hcHBlbmRDaGlsZCggblRkICk7CgkJCQkJb1NldHRpbmdzLmFvRGF0YVtpVGhpc0luZGV4XS5fYW5IaWRkZW5baV0gPSBudWxsOwoJCQkJfQoJCQkJZWxzZQoJCQkJewoJCQkJCW9TZXR0aW5ncy5hb0RhdGFbaVRoaXNJbmRleF0uX2FuSGlkZGVuW2ldID0gblRkOwoJCQkJfQoJCQl9CgkJCQoJCQkvKiBBZGQgdG8gdGhlIGRpc3BsYXkgYXJyYXkgKi8KCQkJb1NldHRpbmdzLmFpRGlzcGxheU1hc3Rlci5wdXNoKCBpVGhpc0luZGV4ICk7CgkJCXJldHVybiBpVGhpc0luZGV4OwoJCX0KCQkKCQkvKgoJCSAqIEZ1bmN0aW9uOiBfZm5HYXRoZXJEYXRhCgkJICogUHVycG9zZTogIFJlYWQgaW4gdGhlIGRhdGEgZnJvbSB0aGUgdGFyZ2V0IHRhYmxlIGZyb20gdGhlIERPTQoJCSAqIFJldHVybnM6ICAtCgkJICogSW5wdXRzOiAgIG9iamVjdDpvU2V0dGluZ3MgLSBkYXRhVGFibGVzIHNldHRpbmdzIG9iamVjdAoJCSAqIE5vdGVzOiAgICBUaGlzIGlzIGEgb3B0aW1pc2VkIHZlcnNpb24gb2YgX2ZuQWRkRGF0YSAobW9yZSBvciBsZXNzKSBmb3IgcmVhZGluZyBpbmZvcm1hdGlvbgoJCSAqICAgZnJvbSB0aGUgRE9NLiBUaGUgYmFzaWMgYWN0aW9ucyBtdXN0IGJlIGlkZW50aWNhbCBpbiB0aGUgdHdvIGZ1bmN0aW9ucy4KCQkgKi8KCQlmdW5jdGlvbiBfZm5HYXRoZXJEYXRhKCBvU2V0dGluZ3MgKQoJCXsKCQkJdmFyIGlMb29wLCBpLCBpTGVuLCBqLCBqTGVuLCBqSW5uZXIsCgkJCSAJblRkcywgblRycywgblRkLCBhTG9jYWxEYXRhLCBpVGhpc0luZGV4LAoJCQkJaVJvdywgaVJvd3MsIGlDb2x1bW4sIGlDb2x1bW5zOwoJCQkKCQkJLyoKCQkJICogUHJvY2VzcyBieSByb3cgZmlyc3QKCQkJICogQWRkIHRoZSBkYXRhIG9iamVjdCBmb3IgdGhlIHdob2xlIHRhYmxlIC0gc3RvcmluZyB0aGUgdHIgbm9kZS4gTm90ZSAtIG5vIHBvaW50IGluIGdldHRpbmcKCQkJICogRE9NIGJhc2VkIGRhdGEgaWYgd2UgYXJlIGdvaW5nIHRvIGdvIGFuZCByZXBsYWNlIGl0IHdpdGggQWpheCBzb3VyY2UgZGF0YS4KCQkJICovCgkJCWlmICggb1NldHRpbmdzLnNBamF4U291cmNlID09PSBudWxsICkKCQkJewoJCQkJblRycyA9IG9TZXR0aW5ncy5uVEJvZHkuY2hpbGROb2RlczsKCQkJCWZvciAoIGk9MCwgaUxlbj1uVHJzLmxlbmd0aCA7IGk8aUxlbiA7IGkrKyApCgkJCQl7CgkJCQkJaWYgKCBuVHJzW2ldLm5vZGVOYW1lLnRvVXBwZXJDYXNlKCkgPT0gIlRSIiApCgkJCQkJewoJCQkJCQlpVGhpc0luZGV4ID0gb1NldHRpbmdzLmFvRGF0YS5sZW5ndGg7CgkJCQkJCW9TZXR0aW5ncy5hb0RhdGEucHVzaCggewoJCQkJCQkJIm5UciI6IG5UcnNbaV0sCgkJCQkJCQkiX2lJZCI6IG9TZXR0aW5ncy5pTmV4dElkKyssCgkJCQkJCQkiX2FEYXRhIjogW10sCgkJCQkJCQkiX2FuSGlkZGVuIjogW10sCgkJCQkJCQkiX3NSb3dTdHJpcGUiOiAnJwoJCQkJCQl9ICk7CgkJCQkJCQoJCQkJCQlvU2V0dGluZ3MuYWlEaXNwbGF5TWFzdGVyLnB1c2goIGlUaGlzSW5kZXggKTsKCQkJCQkJCgkJCQkJCWFMb2NhbERhdGEgPSBvU2V0dGluZ3MuYW9EYXRhW2lUaGlzSW5kZXhdLl9hRGF0YTsKCQkJCQkJblRkcyA9IG5UcnNbaV0uY2hpbGROb2RlczsKCQkJCQkJaklubmVyID0gMDsKCQkJCQkJCgkJCQkJCWZvciAoIGo9MCwgakxlbj1uVGRzLmxlbmd0aCA7IGo8akxlbiA7IGorKyApCgkJCQkJCXsKCQkJCQkJCWlmICggblRkc1tqXS5ub2RlTmFtZS50b1VwcGVyQ2FzZSgpID09ICJURCIgKQoJCQkJCQkJewoJCQkJCQkJCWFMb2NhbERhdGFbaklubmVyXSA9ICQudHJpbShuVGRzW2pdLmlubmVySFRNTCk7CgkJCQkJCQkJaklubmVyKys7CgkJCQkJCQl9CgkJCQkJCX0KCQkJCQl9CgkJCQl9CgkJCX0KCQkJCgkJCS8qIEdhdGhlciBpbiB0aGUgVEQgZWxlbWVudHMgb2YgdGhlIFRhYmxlIC0gbm90ZSB0aGF0IHRoaXMgaXMgYmFzaWNhbGx5IHRoZSBzYW1lIGFzCgkJCSAqIGZuR2V0VGROb2RlcywgYnV0IHRoYXQgZnVuY3Rpb24gdGFrZXMgYWNjb3VudCBvZiBoaWRkZW4gY29sdW1ucywgd2hpY2ggd2UgaGF2ZW4ndCB5ZXQKCQkJICogc2V0dXAhCgkJCSAqLwoJCQluVHJzID0gX2ZuR2V0VHJOb2Rlcyggb1NldHRpbmdzICk7CgkJCW5UZHMgPSBbXTsKCQkJZm9yICggaT0wLCBpTGVuPW5UcnMubGVuZ3RoIDsgaTxpTGVuIDsgaSsrICkKCQkJewoJCQkJZm9yICggaj0wLCBqTGVuPW5UcnNbaV0uY2hpbGROb2Rlcy5sZW5ndGggOyBqPGpMZW4gOyBqKysgKQoJCQkJewoJCQkJCW5UZCA9IG5UcnNbaV0uY2hpbGROb2Rlc1tqXTsKCQkJCQlpZiAoIG5UZC5ub2RlTmFtZS50b1VwcGVyQ2FzZSgpID09ICJURCIgKQoJCQkJCXsKCQkJCQkJblRkcy5wdXNoKCBuVGQgKTsKCQkJCQl9CgkJCQl9CgkJCX0KCQkJCgkJCS8qIFNhbml0eSBjaGVjayAqLwoJCQlpZiAoIG5UZHMubGVuZ3RoICE9IG5UcnMubGVuZ3RoICogb1NldHRpbmdzLmFvQ29sdW1ucy5sZW5ndGggKQoJCQl7CgkJCQlfZm5Mb2coIG9TZXR0aW5ncywgMSwgIlVuZXhwZWN0ZWQgbnVtYmVyIG9mIFREIGVsZW1lbnRzLiBFeHBlY3RlZCAiKwoJCQkJCShuVHJzLmxlbmd0aCAqIG9TZXR0aW5ncy5hb0NvbHVtbnMubGVuZ3RoKSsiIGFuZCBnb3QgIituVGRzLmxlbmd0aCsiLiBEYXRhVGFibGVzIGRvZXMgIisKCQkJCQkibm90IHN1cHBvcnQgcm93c3BhbiAvIGNvbHNwYW4gaW4gdGhlIHRhYmxlIGJvZHksIGFuZCB0aGVyZSBtdXN0IGJlIG9uZSBjZWxsIGZvciBlYWNoICIrCgkJCQkJInJvdy9jb2x1bW4gY29tYmluYXRpb24uIiApOwoJCQl9CgkJCQoJCQkvKiBOb3cgcHJvY2VzcyBieSBjb2x1bW4gKi8KCQkJZm9yICggaUNvbHVtbj0wLCBpQ29sdW1ucz1vU2V0dGluZ3MuYW9Db2x1bW5zLmxlbmd0aCA7IGlDb2x1bW48aUNvbHVtbnMgOyBpQ29sdW1uKysgKQoJCQl7CgkJCQkvKiBHZXQgdGhlIHRpdGxlIG9mIHRoZSBjb2x1bW4gLSB1bmxlc3MgdGhlcmUgaXMgYSB1c2VyIHNldCBvbmUgKi8KCQkJCWlmICggb1NldHRpbmdzLmFvQ29sdW1uc1tpQ29sdW1uXS5zVGl0bGUgPT09IG51bGwgKQoJCQkJewoJCQkJCW9TZXR0aW5ncy5hb0NvbHVtbnNbaUNvbHVtbl0uc1RpdGxlID0gb1NldHRpbmdzLmFvQ29sdW1uc1tpQ29sdW1uXS5uVGguaW5uZXJIVE1MOwoJCQkJfQoJCQkJCgkJCQl2YXIKCQkJCQliQXV0b1R5cGUgPSBvU2V0dGluZ3MuYW9Db2x1bW5zW2lDb2x1bW5dLl9iQXV0b1R5cGUsCgkJCQkJYlJlbmRlciA9IHR5cGVvZiBvU2V0dGluZ3MuYW9Db2x1bW5zW2lDb2x1bW5dLmZuUmVuZGVyID09ICdmdW5jdGlvbicsCgkJCQkJYkNsYXNzID0gb1NldHRpbmdzLmFvQ29sdW1uc1tpQ29sdW1uXS5zQ2xhc3MgIT09IG51bGwsCgkJCQkJYlZpc2libGUgPSBvU2V0dGluZ3MuYW9Db2x1bW5zW2lDb2x1bW5dLmJWaXNpYmxlLAoJCQkJCW5DZWxsLCBzVGhpc1R5cGUsIHNSZW5kZXJlZDsKCQkJCQoJCQkJLyogQSBzaW5nbGUgbG9vcCB0byBydWxlIHRoZW0gYWxsIChhbmQgYmUgbW9yZSBlZmZpY2llbnQpICovCgkJCQlpZiAoIGJBdXRvVHlwZSB8fCBiUmVuZGVyIHx8IGJDbGFzcyB8fCAhYlZpc2libGUgKQoJCQkJewoJCQkJCWZvciAoIGlSb3c9MCwgaVJvd3M9b1NldHRpbmdzLmFvRGF0YS5sZW5ndGggOyBpUm93PGlSb3dzIDsgaVJvdysrICkKCQkJCQl7CgkJCQkJCW5DZWxsID0gblRkc1sgKGlSb3cqaUNvbHVtbnMpICsgaUNvbHVtbiBdOwoJCQkJCQkKCQkJCQkJLyogVHlwZSBkZXRlY3Rpb24gKi8KCQkJCQkJaWYgKCBiQXV0b1R5cGUgKQoJCQkJCQl7CgkJCQkJCQlpZiAoIG9TZXR0aW5ncy5hb0NvbHVtbnNbaUNvbHVtbl0uc1R5cGUgIT0gJ3N0cmluZycgKQoJCQkJCQkJewoJCQkJCQkJCXNUaGlzVHlwZSA9IF9mbkRldGVjdFR5cGUoIG9TZXR0aW5ncy5hb0RhdGFbaVJvd10uX2FEYXRhW2lDb2x1bW5dICk7CgkJCQkJCQkJaWYgKCBvU2V0dGluZ3MuYW9Db2x1bW5zW2lDb2x1bW5dLnNUeXBlID09PSBudWxsICkKCQkJCQkJCQl7CgkJCQkJCQkJCW9TZXR0aW5ncy5hb0NvbHVtbnNbaUNvbHVtbl0uc1R5cGUgPSBzVGhpc1R5cGU7CgkJCQkJCQkJfQoJCQkJCQkJCWVsc2UgaWYgKCBvU2V0dGluZ3MuYW9Db2x1bW5zW2lDb2x1bW5dLnNUeXBlICE9IHNUaGlzVHlwZSApCgkJCQkJCQkJewoJCQkJCQkJCQkvKiBTdHJpbmcgaXMgYWx3YXlzIHRoZSAnZmFsbGJhY2snIG9wdGlvbiAqLwoJCQkJCQkJCQlvU2V0dGluZ3MuYW9Db2x1bW5zW2lDb2x1bW5dLnNUeXBlID0gJ3N0cmluZyc7CgkJCQkJCQkJfQoJCQkJCQkJfQoJCQkJCQl9CgkJCQkJCQoJCQkJCQkvKiBSZW5kZXJpbmcgKi8KCQkJCQkJaWYgKCBiUmVuZGVyICkKCQkJCQkJewoJCQkJCQkJc1JlbmRlcmVkID0gb1NldHRpbmdzLmFvQ29sdW1uc1tpQ29sdW1uXS5mblJlbmRlciggewoJCQkJCQkJCQkiaURhdGFSb3ciOiBpUm93LAoJCQkJCQkJCQkiaURhdGFDb2x1bW4iOiBpQ29sdW1uLAoJCQkJCQkJCQkiYURhdGEiOiBvU2V0dGluZ3MuYW9EYXRhW2lSb3ddLl9hRGF0YSwKCQkJCQkJCQkJIm9TZXR0aW5ncyI6IG9TZXR0aW5ncwoJCQkJCQkJCX0gKTsKCQkJCQkJCW5DZWxsLmlubmVySFRNTCA9IHNSZW5kZXJlZDsKCQkJCQkJCWlmICggb1NldHRpbmdzLmFvQ29sdW1uc1tpQ29sdW1uXS5iVXNlUmVuZGVyZWQgKQoJCQkJCQkJewoJCQkJCQkJCS8qIFVzZSB0aGUgcmVuZGVyZWQgZGF0YSBmb3IgZmlsdGVyaW5nL3NvcnRpbmcgKi8KCQkJCQkJCQlvU2V0dGluZ3MuYW9EYXRhW2lSb3ddLl9hRGF0YVtpQ29sdW1uXSA9IHNSZW5kZXJlZDsKCQkJCQkJCX0KCQkJCQkJfQoJCQkJCQkKCQkJCQkJLyogQ2xhc3NlcyAqLwoJCQkJCQlpZiAoIGJDbGFzcyApCgkJCQkJCXsKCQkJCQkJCW5DZWxsLmNsYXNzTmFtZSArPSAnICcrb1NldHRpbmdzLmFvQ29sdW1uc1tpQ29sdW1uXS5zQ2xhc3M7CgkJCQkJCX0KCQkJCQkJCgkJCQkJCS8qIENvbHVtbiB2aXNhYmlsaXR5ICovCgkJCQkJCWlmICggIWJWaXNpYmxlICkKCQkJCQkJewoJCQkJCQkJb1NldHRpbmdzLmFvRGF0YVtpUm93XS5fYW5IaWRkZW5baUNvbHVtbl0gPSBuQ2VsbDsKCQkJCQkJCW5DZWxsLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoIG5DZWxsICk7CgkJCQkJCX0KCQkJCQkJZWxzZQoJCQkJCQl7CgkJCQkJCQlvU2V0dGluZ3MuYW9EYXRhW2lSb3ddLl9hbkhpZGRlbltpQ29sdW1uXSA9IG51bGw7CgkJCQkJCX0KCQkJCQl9CgkJCQl9CgkJCX0KCQl9CgkJCgkJCgkJCgkJLyogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICoKCQkgKiBTZWN0aW9uIC0gRHJhd2luZyBmdW5jdGlvbnMKCQkgKi8KCQkKCQkvKgoJCSAqIEZ1bmN0aW9uOiBfZm5EcmF3SGVhZAoJCSAqIFB1cnBvc2U6ICBDcmVhdGUgdGhlIEhUTUwgaGVhZGVyIGZvciB0aGUgdGFibGUKCQkgKiBSZXR1cm5zOiAgLQoJCSAqIElucHV0czogICBvYmplY3Q6b1NldHRpbmdzIC0gZGF0YVRhYmxlcyBzZXR0aW5ncyBvYmplY3QKCQkgKi8KCQlmdW5jdGlvbiBfZm5EcmF3SGVhZCggb1NldHRpbmdzICkKCQl7CgkJCXZhciBpLCBuVGgsIGlMZW4sIGosIGpMZW47CgkJCXZhciBpVGhzID0gb1NldHRpbmdzLm5USGVhZC5nZXRFbGVtZW50c0J5VGFnTmFtZSgndGgnKS5sZW5ndGg7CgkJCXZhciBpQ29ycmVjdG9yID0gMDsKCQkJCgkJCS8qIElmIHRoZXJlIGlzIGEgaGVhZGVyIGluIHBsYWNlIC0gdGhlbiB1c2UgaXQgLSBvdGhlcndpc2UgaXQncyBnb2luZyB0byBnZXQgbnVrZWQuLi4gKi8KCQkJaWYgKCBpVGhzICE9PSAwICkKCQkJewoJCQkJLyogV2UndmUgZ290IGEgdGhlYWQgZnJvbSB0aGUgRE9NLCBzbyByZW1vdmUgaGlkZGVuIGNvbHVtbnMgYW5kIGFwcGx5IHdpZHRoIHRvIHZpcyBjb2xzICovCgkJCQlmb3IgKCBpPTAsIGlMZW49b1NldHRpbmdzLmFvQ29sdW1ucy5sZW5ndGggOyBpPGlMZW4gOyBpKysgKQoJCQkJewoJCQkJCW5UaCA9IG9TZXR0aW5ncy5hb0NvbHVtbnNbaV0ublRoOwoJCQkJCQoJCQkJCWlmICggb1NldHRpbmdzLmFvQ29sdW1uc1tpXS5iVmlzaWJsZSApCgkJCQkJewoJCQkJCQkvKiBTZXQgdGhlIHRpdGxlIG9mIHRoZSBjb2x1bW4gaWYgaXQgaXMgdXNlciBkZWZpbmVkIChub3Qgd2hhdCB3YXMgYXV0byBkZXRlY3RlZCkgKi8KCQkJCQkJaWYgKCBvU2V0dGluZ3MuYW9Db2x1bW5zW2ldLnNUaXRsZSAhPSBuVGguaW5uZXJIVE1MICkKCQkJCQkJewoJCQkJCQkJblRoLmlubmVySFRNTCA9IG9TZXR0aW5ncy5hb0NvbHVtbnNbaV0uc1RpdGxlOwoJCQkJCQl9CgkJCQkJfQoJCQkJCWVsc2UKCQkJCQl7CgkJCQkJCW5UaC5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKCBuVGggKTsKCQkJCQkJaUNvcnJlY3RvcisrOwoJCQkJCX0KCQkJCX0KCQkJfQoJCQllbHNlCgkJCXsKCQkJCS8qIFdlIGRvbid0IGhhdmUgYSBoZWFkZXIgaW4gdGhlIERPTSAtIHNvIHdlIGFyZSBnb2luZyB0byBoYXZlIHRvIGNyZWF0ZSBvbmUgKi8KCQkJCXZhciBuVHIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCAidHIiICk7CgkJCQkKCQkJCWZvciAoIGk9MCwgaUxlbj1vU2V0dGluZ3MuYW9Db2x1bW5zLmxlbmd0aCA7IGk8aUxlbiA7IGkrKyApCgkJCQl7CgkJCQkJblRoID0gb1NldHRpbmdzLmFvQ29sdW1uc1tpXS5uVGg7CgkJCQkJblRoLmlubmVySFRNTCA9IG9TZXR0aW5ncy5hb0NvbHVtbnNbaV0uc1RpdGxlOwoJCQkJCQoJCQkJCWlmICggb1NldHRpbmdzLmFvQ29sdW1uc1tpXS5iVmlzaWJsZSApCgkJCQkJewoJCQkJCQlpZiAoIG9TZXR0aW5ncy5hb0NvbHVtbnNbaV0uc0NsYXNzICE9PSBudWxsICkKCQkJCQkJewoJCQkJCQkJblRoLmNsYXNzTmFtZSA9IG9TZXR0aW5ncy5hb0NvbHVtbnNbaV0uc0NsYXNzOwoJCQkJCQl9CgkJCQkJCQoJCQkJCQluVHIuYXBwZW5kQ2hpbGQoIG5UaCApOwoJCQkJCX0KCQkJCX0KCQkJCSQob1NldHRpbmdzLm5USGVhZCkuaHRtbCggJycgKVswXS5hcHBlbmRDaGlsZCggblRyICk7CgkJCX0KCQkJCgkJCS8qIEFkZCB0aGUgZXh0cmEgbWFya3VwIG5lZWRlZCBieSBqUXVlcnkgVUkncyB0aGVtZXMgKi8KCQkJaWYgKCBvU2V0dGluZ3MuYkpVSSApCgkJCXsKCQkJCWZvciAoIGk9MCwgaUxlbj1vU2V0dGluZ3MuYW9Db2x1bW5zLmxlbmd0aCA7IGk8aUxlbiA7IGkrKyApCgkJCQl7CgkJCQkJblRoID0gb1NldHRpbmdzLmFvQ29sdW1uc1tpXS5uVGg7CgkJCQkJCgkJCQkJdmFyIG5EaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsKCQkJCQluRGl2LmNsYXNzTmFtZSA9IG9TZXR0aW5ncy5vQ2xhc3Nlcy5zU29ydEpVSVdyYXBwZXI7CgkJCQkJJChuVGgpLmNvbnRlbnRzKCkuYXBwZW5kVG8obkRpdik7CgkJCQkJCgkJCQkJbkRpdi5hcHBlbmRDaGlsZCggZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3BhbicpICk7CgkJCQkJblRoLmFwcGVuZENoaWxkKCBuRGl2ICk7CgkJCQl9CgkJCX0KCQkJCgkJCS8qIEFkZCBzb3J0IGxpc3RlbmVyICovCgkJCXZhciBmbk5vU2VsZWN0ID0gZnVuY3Rpb24gKGUpIHsKCQkJCXRoaXMub25zZWxlY3RzdGFydCA9IGZ1bmN0aW9uKCkgeyByZXR1cm4gZmFsc2U7IH07CgkJCQlyZXR1cm4gZmFsc2U7CgkJCX07CgkJCQoJCQlpZiAoIG9TZXR0aW5ncy5vRmVhdHVyZXMuYlNvcnQgKQoJCQl7CgkJCQlmb3IgKCBpPTAgOyBpPG9TZXR0aW5ncy5hb0NvbHVtbnMubGVuZ3RoIDsgaSsrICkKCQkJCXsKCQkJCQlpZiAoIG9TZXR0aW5ncy5hb0NvbHVtbnNbaV0uYlNvcnRhYmxlICE9PSBmYWxzZSApCgkJCQkJewoJCQkJCQlfZm5Tb3J0QXR0YWNoTGlzdGVuZXIoIG9TZXR0aW5ncywgb1NldHRpbmdzLmFvQ29sdW1uc1tpXS5uVGgsIGkgKTsKCQkJCQkJCgkJCQkJCS8qIFRha2UgdGhlIGJydXRhbCBhcHByb2FjaCB0byBjYW5jZWxsaW5nIHRleHQgc2VsZWN0aW9uIGluIGhlYWRlciAqLwoJCQkJCQkkKG9TZXR0aW5ncy5hb0NvbHVtbnNbaV0ublRoKS5tb3VzZWRvd24oIGZuTm9TZWxlY3QgKTsKCQkJCQl9CgkJCQkJZWxzZQoJCQkJCXsKCQkJCQkJJChvU2V0dGluZ3MuYW9Db2x1bW5zW2ldLm5UaCkuYWRkQ2xhc3MoIG9TZXR0aW5ncy5vQ2xhc3Nlcy5zU29ydGFibGVOb25lICk7CgkJCQkJfQoJCQkJfQoJCQl9CgkJCQoJCQkvKiBDYWNoZSB0aGUgZm9vdGVyIGVsZW1lbnRzICovCgkJCWlmICggb1NldHRpbmdzLm5URm9vdCAhPT0gbnVsbCApCgkJCXsKCQkJCWlDb3JyZWN0b3IgPSAwOwoJCQkJdmFyIG5UZnMgPSBvU2V0dGluZ3MublRGb290LmdldEVsZW1lbnRzQnlUYWdOYW1lKCd0aCcpOwoJCQkJZm9yICggaT0wLCBpTGVuPW5UZnMubGVuZ3RoIDsgaTxpTGVuIDsgaSsrICkKCQkJCXsKCQkJCQlpZiAoIHR5cGVvZiBvU2V0dGluZ3MuYW9Db2x1bW5zW2ldICE9ICd1bmRlZmluZWQnICkKCQkJCQl7CgkJCQkJCW9TZXR0aW5ncy5hb0NvbHVtbnNbaV0ublRmID0gblRmc1tpLWlDb3JyZWN0b3JdOwoJCQkJCQkKCQkJCQkJaWYgKCBvU2V0dGluZ3Mub0NsYXNzZXMuc0Zvb3RlclRIICE9PSAiIiApCgkJCQkJCXsKCQkJCQkJCW9TZXR0aW5ncy5hb0NvbHVtbnNbaV0ublRmLmNsYXNzTmFtZSArPSAiICIrb1NldHRpbmdzLm9DbGFzc2VzLnNGb290ZXJUSDsKCQkJCQkJfQoJCQkJCQkKCQkJCQkJaWYgKCAhb1NldHRpbmdzLmFvQ29sdW1uc1tpXS5iVmlzaWJsZSApCgkJCQkJCXsKCQkJCQkJCW5UZnNbaS1pQ29ycmVjdG9yXS5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKCBuVGZzW2ktaUNvcnJlY3Rvcl0gKTsKCQkJCQkJCWlDb3JyZWN0b3IrKzsKCQkJCQkJfQoJCQkJCX0KCQkJCX0KCQkJfQoJCX0KCQkKCQkvKgoJCSAqIEZ1bmN0aW9uOiBfZm5EcmF3CgkJICogUHVycG9zZTogIEluc2VydCB0aGUgcmVxdWlyZWQgVFIgbm9kZXMgaW50byB0aGUgdGFibGUgZm9yIGRpc3BsYXkKCQkgKiBSZXR1cm5zOiAgLQoJCSAqIElucHV0czogICBvYmplY3Q6b1NldHRpbmdzIC0gZGF0YVRhYmxlcyBzZXR0aW5ncyBvYmplY3QKCQkgKi8KCQlmdW5jdGlvbiBfZm5EcmF3KCBvU2V0dGluZ3MgKQoJCXsKCQkJdmFyIGksIGlMZW47CgkJCXZhciBhblJvd3MgPSBbXTsKCQkJdmFyIGlSb3dDb3VudCA9IDA7CgkJCXZhciBiUm93RXJyb3IgPSBmYWxzZTsKCQkJdmFyIGlTdHJpcHMgPSBvU2V0dGluZ3MuYXNTdHJpcENsYXNzZXMubGVuZ3RoOwoJCQl2YXIgaU9wZW5Sb3dzID0gb1NldHRpbmdzLmFvT3BlblJvd3MubGVuZ3RoOwoJCQkKCQkJb1NldHRpbmdzLmJEcmF3aW5nID0gdHJ1ZTsKCQkJCgkJCS8qIENoZWNrIGFuZCBzZWUgaWYgd2UgaGF2ZSBhbiBpbml0aWFsIGRyYXcgcG9zaXRpb24gZnJvbSBzdGF0ZSBzYXZpbmcgKi8KCQkJaWYgKCB0eXBlb2Ygb1NldHRpbmdzLmlJbml0RGlzcGxheVN0YXJ0ICE9ICd1bmRlZmluZWQnICYmIG9TZXR0aW5ncy5pSW5pdERpc3BsYXlTdGFydCAhPSAtMSApCgkJCXsKCQkJCWlmICggb1NldHRpbmdzLm9GZWF0dXJlcy5iU2VydmVyU2lkZSApCgkJCQl7CgkJCQkJb1NldHRpbmdzLl9pRGlzcGxheVN0YXJ0ID0gb1NldHRpbmdzLmlJbml0RGlzcGxheVN0YXJ0OwoJCQkJfQoJCQkJZWxzZQoJCQkJewoJCQkJCW9TZXR0aW5ncy5faURpc3BsYXlTdGFydCA9IChvU2V0dGluZ3MuaUluaXREaXNwbGF5U3RhcnQgPj0gb1NldHRpbmdzLmZuUmVjb3Jkc0Rpc3BsYXkoKSkgPwoJCQkJCQkwIDogb1NldHRpbmdzLmlJbml0RGlzcGxheVN0YXJ0OwoJCQkJfQoJCQkJb1NldHRpbmdzLmlJbml0RGlzcGxheVN0YXJ0ID0gLTE7CgkJCQlfZm5DYWxjdWxhdGVFbmQoIG9TZXR0aW5ncyApOwoJCQl9CgkJCQoJCQkvKiBJZiB3ZSBhcmUgZGVhbGluZyB3aXRoIEFqYXggLSBkbyBpdCBoZXJlICovCgkJCWlmICggb1NldHRpbmdzLm9GZWF0dXJlcy5iU2VydmVyU2lkZSAmJiAKCQkJICAgICAhX2ZuQWpheFVwZGF0ZSggb1NldHRpbmdzICkgKQoJCQl7CgkJCQlyZXR1cm47CgkJCX0KCQkJZWxzZSBpZiAoICFvU2V0dGluZ3Mub0ZlYXR1cmVzLmJTZXJ2ZXJTaWRlICkKCQkJewoJCQkJb1NldHRpbmdzLmlEcmF3Kys7CgkJCX0KCQkJCgkJCWlmICggb1NldHRpbmdzLmFpRGlzcGxheS5sZW5ndGggIT09IDAgKQoJCQl7CgkJCQl2YXIgaVN0YXJ0ID0gb1NldHRpbmdzLl9pRGlzcGxheVN0YXJ0OwoJCQkJdmFyIGlFbmQgPSBvU2V0dGluZ3MuX2lEaXNwbGF5RW5kOwoJCQkJCgkJCQlpZiAoIG9TZXR0aW5ncy5vRmVhdHVyZXMuYlNlcnZlclNpZGUgKQoJCQkJewoJCQkJCWlTdGFydCA9IDA7CgkJCQkJaUVuZCA9IG9TZXR0aW5ncy5hb0RhdGEubGVuZ3RoOwoJCQkJfQoJCQkJCgkJCQlmb3IgKCB2YXIgaj1pU3RhcnQgOyBqPGlFbmQgOyBqKysgKQoJCQkJewoJCQkJCXZhciBhb0RhdGEgPSBvU2V0dGluZ3MuYW9EYXRhWyBvU2V0dGluZ3MuYWlEaXNwbGF5W2pdIF07CgkJCQkJdmFyIG5Sb3cgPSBhb0RhdGEublRyOwoJCQkJCQoJCQkJCS8qIFJlbW92ZSB0aGUgb2xkIHN0cmlwcGluZyBjbGFzc2VzIGFuZCB0aGVuIGFkZCB0aGUgbmV3IG9uZSAqLwoJCQkJCWlmICggaVN0cmlwcyAhPT0gMCApCgkJCQkJewoJCQkJCQl2YXIgc1N0cmlwID0gb1NldHRpbmdzLmFzU3RyaXBDbGFzc2VzWyBpUm93Q291bnQgJSBpU3RyaXBzIF07CgkJCQkJCWlmICggYW9EYXRhLl9zUm93U3RyaXBlICE9IHNTdHJpcCApCgkJCQkJCXsKCQkJCQkJCSQoblJvdykucmVtb3ZlQ2xhc3MoIGFvRGF0YS5fc1Jvd1N0cmlwZSApLmFkZENsYXNzKCBzU3RyaXAgKTsKCQkJCQkJCWFvRGF0YS5fc1Jvd1N0cmlwZSA9IHNTdHJpcDsKCQkJCQkJfQoJCQkJCX0KCQkJCQkKCQkJCQkvKiBDdXN0b20gcm93IGNhbGxiYWNrIGZ1bmN0aW9uIC0gbWlnaHQgd2FudCB0byBtYW5pcHVsZSB0aGUgcm93ICovCgkJCQkJaWYgKCB0eXBlb2Ygb1NldHRpbmdzLmZuUm93Q2FsbGJhY2sgPT0gImZ1bmN0aW9uIiApCgkJCQkJewoJCQkJCQluUm93ID0gb1NldHRpbmdzLmZuUm93Q2FsbGJhY2suY2FsbCggb1NldHRpbmdzLm9JbnN0YW5jZSwgblJvdywgCgkJCQkJCQlvU2V0dGluZ3MuYW9EYXRhWyBvU2V0dGluZ3MuYWlEaXNwbGF5W2pdIF0uX2FEYXRhLCBpUm93Q291bnQsIGogKTsKCQkJCQkJaWYgKCAhblJvdyAmJiAhYlJvd0Vycm9yICkKCQkJCQkJewoJCQkJCQkJX2ZuTG9nKCBvU2V0dGluZ3MsIDAsICJBIG5vZGUgd2FzIG5vdCByZXR1cm5lZCBieSBmblJvd0NhbGxiYWNrIiApOwoJCQkJCQkJYlJvd0Vycm9yID0gdHJ1ZTsKCQkJCQkJfQoJCQkJCX0KCQkJCQkKCQkJCQlhblJvd3MucHVzaCggblJvdyApOwoJCQkJCWlSb3dDb3VudCsrOwoJCQkJCQoJCQkJCS8qIElmIHRoZXJlIGlzIGFuIG9wZW4gcm93IC0gYW5kIGl0IGlzIGF0dGFjaGVkIHRvIHRoaXMgcGFyZW50IC0gYXR0YWNoIGl0IG9uIHJlZHJhdyAqLwoJCQkJCWlmICggaU9wZW5Sb3dzICE9PSAwICkKCQkJCQl7CgkJCQkJCWZvciAoIHZhciBrPTAgOyBrPGlPcGVuUm93cyA7IGsrKyApCgkJCQkJCXsKCQkJCQkJCWlmICggblJvdyA9PSBvU2V0dGluZ3MuYW9PcGVuUm93c1trXS5uUGFyZW50ICkKCQkJCQkJCXsKCQkJCQkJCQlhblJvd3MucHVzaCggb1NldHRpbmdzLmFvT3BlblJvd3Nba10ublRyICk7CgkJCQkJCQl9CgkJCQkJCX0KCQkJCQl9CgkJCQl9CgkJCX0KCQkJZWxzZQoJCQl7CgkJCQkvKiBUYWJsZSBpcyBlbXB0eSAtIGNyZWF0ZSBhIHJvdyB3aXRoIGFuIGVtcHR5IG1lc3NhZ2UgaW4gaXQgKi8KCQkJCWFuUm93c1sgMCBdID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCggJ3RyJyApOwoJCQkJCgkJCQlpZiAoIHR5cGVvZiBvU2V0dGluZ3MuYXNTdHJpcENsYXNzZXNbMF0gIT0gJ3VuZGVmaW5lZCcgKQoJCQkJewoJCQkJCWFuUm93c1sgMCBdLmNsYXNzTmFtZSA9IG9TZXR0aW5ncy5hc1N0cmlwQ2xhc3Nlc1swXTsKCQkJCX0KCQkJCQoJCQkJdmFyIG5UZCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoICd0ZCcgKTsKCQkJCW5UZC5zZXRBdHRyaWJ1dGUoICd2YWxpZ24nLCAidG9wIiApOwoJCQkJblRkLmNvbFNwYW4gPSBfZm5WaXNibGVDb2x1bW5zKCBvU2V0dGluZ3MgKTsKCQkJCW5UZC5jbGFzc05hbWUgPSBvU2V0dGluZ3Mub0NsYXNzZXMuc1Jvd0VtcHR5OwoJCQkJaWYgKCB0eXBlb2Ygb1NldHRpbmdzLm9MYW5ndWFnZS5zRW1wdHlUYWJsZSAhPSAndW5kZWZpbmVkJyAmJgoJCQkJICAgICBvU2V0dGluZ3MuZm5SZWNvcmRzVG90YWwoKSA9PT0gMCApCgkJCQl7CgkJCQkJblRkLmlubmVySFRNTCA9IG9TZXR0aW5ncy5vTGFuZ3VhZ2Uuc0VtcHR5VGFibGU7CgkJCQl9CgkJCQllbHNlCgkJCQl7CgkJCQkJblRkLmlubmVySFRNTCA9IG9TZXR0aW5ncy5vTGFuZ3VhZ2Uuc1plcm9SZWNvcmRzLnJlcGxhY2UoCgkJCQkJCSdfTUFYXycsIG9TZXR0aW5ncy5mbkZvcm1hdE51bWJlcihvU2V0dGluZ3MuZm5SZWNvcmRzVG90YWwoKSkgKTsKCQkJCX0KCQkJCQoJCQkJYW5Sb3dzWyBpUm93Q291bnQgXS5hcHBlbmRDaGlsZCggblRkICk7CgkJCX0KCQkJCgkJCS8qIENhbGxiYWNrIHRoZSBoZWFkZXIgYW5kIGZvb3RlciBjdXN0b20gZnVuY2F0aW9uIGlmIHRoZXJlIGlzIG9uZSAqLwoJCQlpZiAoIHR5cGVvZiBvU2V0dGluZ3MuZm5IZWFkZXJDYWxsYmFjayA9PSAnZnVuY3Rpb24nICkKCQkJewoJCQkJb1NldHRpbmdzLmZuSGVhZGVyQ2FsbGJhY2suY2FsbCggb1NldHRpbmdzLm9JbnN0YW5jZSwgJCgnPnRyJywgb1NldHRpbmdzLm5USGVhZClbMF0sIAoJCQkJCV9mbkdldERhdGFNYXN0ZXIoIG9TZXR0aW5ncyApLCBvU2V0dGluZ3MuX2lEaXNwbGF5U3RhcnQsIG9TZXR0aW5ncy5mbkRpc3BsYXlFbmQoKSwKCQkJCQlvU2V0dGluZ3MuYWlEaXNwbGF5ICk7CgkJCX0KCQkJCgkJCWlmICggdHlwZW9mIG9TZXR0aW5ncy5mbkZvb3RlckNhbGxiYWNrID09ICdmdW5jdGlvbicgKQoJCQl7CgkJCQlvU2V0dGluZ3MuZm5Gb290ZXJDYWxsYmFjay5jYWxsKCBvU2V0dGluZ3Mub0luc3RhbmNlLCAkKCc+dHInLCBvU2V0dGluZ3MublRGb290KVswXSwgCgkJCQkJX2ZuR2V0RGF0YU1hc3Rlciggb1NldHRpbmdzICksIG9TZXR0aW5ncy5faURpc3BsYXlTdGFydCwgb1NldHRpbmdzLmZuRGlzcGxheUVuZCgpLAoJCQkJCW9TZXR0aW5ncy5haURpc3BsYXkgKTsKCQkJfQoJCQkKCQkJLyogCgkJCSAqIE5lZWQgdG8gcmVtb3ZlIGFueSBvbGQgcm93IGZyb20gdGhlIGRpc3BsYXkgLSBub3RlIHdlIGNhbid0IGp1c3QgZW1wdHkgdGhlIHRib2R5IHVzaW5nCgkJCSAqICQoKS5odG1sKCcnKSBzaW5jZSB0aGlzIHdpbGwgdW5iaW5kIHRoZSBqUXVlcnkgZXZlbnQgaGFuZGxlcnMgKGV2ZW4gYWx0aG91Z2ggdGhlIG5vZGUgCgkJCSAqIHN0aWxsIGV4aXN0cyEpIC0gZXF1YWxseSB3ZSBjYW4ndCB1c2UgaW5uZXJIVE1MLCBzaW5jZSBJRSB0aHJvd3MgYW4gZXhjZXB0aW9uLgoJCQkgKi8KCQkJdmFyCgkJCQluQWRkRnJhZyA9IGRvY3VtZW50LmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKSwKCQkJCW5SZW1vdmVGcmFnID0gZG9jdW1lbnQuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpLAoJCQkJbkJvZHlQYXIsIG5UcnM7CgkJCQoJCQlpZiAoIG9TZXR0aW5ncy5uVEJvZHkgKQoJCQl7CgkJCQluQm9keVBhciA9IG9TZXR0aW5ncy5uVEJvZHkucGFyZW50Tm9kZTsKCQkJCW5SZW1vdmVGcmFnLmFwcGVuZENoaWxkKCBvU2V0dGluZ3MublRCb2R5ICk7CgkJCQkKCQkJCS8qIFdoZW4gZG9pbmcgaW5maW5pdGUgc2Nyb2xsaW5nLCBvbmx5IHJlbW92ZSBjaGlsZCByb3dzIHdoZW4gc29ydGluZywgZmlsdGVyaW5nIG9yIHN0YXJ0CgkJCQkgKiB1cC4gV2hlbiBub3QgaW5maW5pdGUgc2Nyb2xsLCBhbHdheXMgZG8gaXQuCgkJCQkgKi8KCQkJCWlmICggIW9TZXR0aW5ncy5vU2Nyb2xsLmJJbmZpbml0ZSB8fCAhb1NldHRpbmdzLl9iSW5pdENvbXBsZXRlIHx8CgkJCQkgCW9TZXR0aW5ncy5iU29ydGVkIHx8IG9TZXR0aW5ncy5iRmlsdGVyZWQgKQoJCQkJewoJCQkJCW5UcnMgPSBvU2V0dGluZ3MublRCb2R5LmNoaWxkTm9kZXM7CgkJCQkJZm9yICggaT1uVHJzLmxlbmd0aC0xIDsgaT49MCA7IGktLSApCgkJCQkJewoJCQkJCQluVHJzW2ldLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoIG5UcnNbaV0gKTsKCQkJCQl9CgkJCQl9CgkJCQkKCQkJCS8qIFB1dCB0aGUgZHJhdyB0YWJsZSBpbnRvIHRoZSBkb20gKi8KCQkJCWZvciAoIGk9MCwgaUxlbj1hblJvd3MubGVuZ3RoIDsgaTxpTGVuIDsgaSsrICkKCQkJCXsKCQkJCQluQWRkRnJhZy5hcHBlbmRDaGlsZCggYW5Sb3dzW2ldICk7CgkJCQl9CgkJCQkKCQkJCW9TZXR0aW5ncy5uVEJvZHkuYXBwZW5kQ2hpbGQoIG5BZGRGcmFnICk7CgkJCQlpZiAoIG5Cb2R5UGFyICE9PSBudWxsICkKCQkJCXsKCQkJCQluQm9keVBhci5hcHBlbmRDaGlsZCggb1NldHRpbmdzLm5UQm9keSApOwoJCQkJfQoJCQl9CgkJCQoJCQkvKiBDYWxsIGFsbCByZXF1aXJlZCBjYWxsYmFjayBmdW5jdGlvbnMgZm9yIHRoZSBlbmQgb2YgYSBkcmF3ICovCgkJCWZvciAoIGk9MCwgaUxlbj1vU2V0dGluZ3MuYW9EcmF3Q2FsbGJhY2subGVuZ3RoIDsgaTxpTGVuIDsgaSsrICkKCQkJewoJCQkJb1NldHRpbmdzLmFvRHJhd0NhbGxiYWNrW2ldLmZuLmNhbGwoIG9TZXR0aW5ncy5vSW5zdGFuY2UsIG9TZXR0aW5ncyApOwoJCQl9CgkJCQoJCQkvKiBEcmF3IGlzIGNvbXBsZXRlLCBzb3J0aW5nIGFuZCBmaWx0ZXJpbmcgbXVzdCBiZSBhcyB3ZWxsICovCgkJCW9TZXR0aW5ncy5iU29ydGVkID0gZmFsc2U7CgkJCW9TZXR0aW5ncy5iRmlsdGVyZWQgPSBmYWxzZTsKCQkJb1NldHRpbmdzLmJEcmF3aW5nID0gZmFsc2U7CgkJCQkKCQkJLyogT24gZmlyc3QgZHJhdywgaW5pdGlsYWlzYXRpb24gaXMgbm93IGNvbXBsZXRlICovCgkJCWlmICggdHlwZW9mIG9TZXR0aW5ncy5fYkluaXRDb21wbGV0ZSA9PSAidW5kZWZpbmVkIiApCgkJCXsKCQkJCW9TZXR0aW5ncy5fYkluaXRDb21wbGV0ZSA9IHRydWU7CgkJCQkKCQkJCWlmICggdHlwZW9mIG9TZXR0aW5ncy5mbkluaXRDb21wbGV0ZSA9PSAnZnVuY3Rpb24nICYmCgkJCQkJICAgKG9TZXR0aW5ncy5vRmVhdHVyZXMuYlNlcnZlclNpZGUgfHwgb1NldHRpbmdzLnNBamF4U291cmNlID09PSBudWxsKSApCgkJCQl7CgkJCQkJb1NldHRpbmdzLmZuSW5pdENvbXBsZXRlLmNhbGwoIG9TZXR0aW5ncy5vSW5zdGFuY2UsIG9TZXR0aW5ncyApOwoJCQkJfQoJCQl9CgkJfQoJCQoJCS8qCgkJICogRnVuY3Rpb246IF9mblJlRHJhdwoJCSAqIFB1cnBvc2U6ICBSZWRyYXcgdGhlIHRhYmxlIC0gdGFraW5nIGFjY291bnQgb2YgdGhlIHZhcmlvdXMgZmVhdHVyZXMgd2hpY2ggYXJlIGVuYWJsZWQKCQkgKiBSZXR1cm5zOiAgLQoJCSAqIElucHV0czogICBvYmplY3Q6b1NldHRpbmdzIC0gZGF0YVRhYmxlcyBzZXR0aW5ncyBvYmplY3QKCQkgKi8KCQlmdW5jdGlvbiBfZm5SZURyYXcoIG9TZXR0aW5ncyApCgkJewoJCQlpZiAoIG9TZXR0aW5ncy5vRmVhdHVyZXMuYlNvcnQgKQoJCQl7CgkJCQkvKiBTb3J0aW5nIHdpbGwgcmVmaWx0ZXIgYW5kIGRyYXcgZm9yIHVzICovCgkJCQlfZm5Tb3J0KCBvU2V0dGluZ3MsIG9TZXR0aW5ncy5vUHJldmlvdXNTZWFyY2ggKTsKCQkJfQoJCQllbHNlIGlmICggb1NldHRpbmdzLm9GZWF0dXJlcy5iRmlsdGVyICkKCQkJewoJCQkJLyogRmlsdGVyaW5nIHdpbGwgcmVkcmF3IGZvciB1cyAqLwoJCQkJX2ZuRmlsdGVyQ29tcGxldGUoIG9TZXR0aW5ncywgb1NldHRpbmdzLm9QcmV2aW91c1NlYXJjaCApOwoJCQl9CgkJCWVsc2UKCQkJewoJCQkJX2ZuQ2FsY3VsYXRlRW5kKCBvU2V0dGluZ3MgKTsKCQkJCV9mbkRyYXcoIG9TZXR0aW5ncyApOwoJCQl9CgkJfQoJCQoJCS8qCgkJICogRnVuY3Rpb246IF9mbkFqYXhVcGRhdGUKCQkgKiBQdXJwb3NlOiAgVXBkYXRlIHRoZSB0YWJsZSB1c2luZyBhbiBBamF4IGNhbGwKCQkgKiBSZXR1cm5zOiAgYm9vbDogYmxvY2sgdGhlIHRhYmxlIGRyYXdpbmcgb3Igbm90CgkJICogSW5wdXRzOiAgIG9iamVjdDpvU2V0dGluZ3MgLSBkYXRhVGFibGVzIHNldHRpbmdzIG9iamVjdAoJCSAqLwoJCWZ1bmN0aW9uIF9mbkFqYXhVcGRhdGUoIG9TZXR0aW5ncyApCgkJewoJCQlpZiAoIG9TZXR0aW5ncy5iQWpheERhdGFHZXQgKQoJCQl7CgkJCQlfZm5Qcm9jZXNzaW5nRGlzcGxheSggb1NldHRpbmdzLCB0cnVlICk7CgkJCQl2YXIgaUNvbHVtbnMgPSBvU2V0dGluZ3MuYW9Db2x1bW5zLmxlbmd0aDsKCQkJCXZhciBhb0RhdGEgPSBbXTsKCQkJCXZhciBpOwoJCQkJCgkJCQkvKiBQYWdpbmcgYW5kIGdlbmVyYWwgKi8KCQkJCW9TZXR0aW5ncy5pRHJhdysrOwoJCQkJYW9EYXRhLnB1c2goIHsgIm5hbWUiOiAic0VjaG8iLCAgICAgICAgICAidmFsdWUiOiBvU2V0dGluZ3MuaURyYXcgfSApOwoJCQkJYW9EYXRhLnB1c2goIHsgIm5hbWUiOiAiaUNvbHVtbnMiLCAgICAgICAidmFsdWUiOiBpQ29sdW1ucyB9ICk7CgkJCQlhb0RhdGEucHVzaCggeyAibmFtZSI6ICJzQ29sdW1ucyIsICAgICAgICJ2YWx1ZSI6IF9mbkNvbHVtbk9yZGVyaW5nKG9TZXR0aW5ncykgfSApOwoJCQkJYW9EYXRhLnB1c2goIHsgIm5hbWUiOiAiaURpc3BsYXlTdGFydCIsICAidmFsdWUiOiBvU2V0dGluZ3MuX2lEaXNwbGF5U3RhcnQgfSApOwoJCQkJYW9EYXRhLnB1c2goIHsgIm5hbWUiOiAiaURpc3BsYXlMZW5ndGgiLCAidmFsdWUiOiBvU2V0dGluZ3Mub0ZlYXR1cmVzLmJQYWdpbmF0ZSAhPT0gZmFsc2UgPwoJCQkJCW9TZXR0aW5ncy5faURpc3BsYXlMZW5ndGggOiAtMSB9ICk7CgkJCQkKCQkJCS8qIENvbHVtbiBuYW1lcyAqLwoJCQkJdmFyIGFOYW1lcyA9IFtdOwoJCQkJZm9yICggaT0wIDsgaTxpQ29sdW1ucyA7IGkrKyApCgkJCQl7CgkJCQkJYU5hbWVzLnB1c2goIG9TZXR0aW5ncy5hb0NvbHVtbnNbaV0uc05hbWUgKTsKCQkJCX0KCQkJCWFvRGF0YS5wdXNoKCB7ICJuYW1lIjogInNOYW1lcyIsICJ2YWx1ZSI6IGFOYW1lcy5qb2luKCcsJykgfSApOwoJCQkJCgkJCQkvKiBGaWx0ZXJpbmcgKi8KCQkJCWlmICggb1NldHRpbmdzLm9GZWF0dXJlcy5iRmlsdGVyICE9PSBmYWxzZSApCgkJCQl7CgkJCQkJYW9EYXRhLnB1c2goIHsgIm5hbWUiOiAic1NlYXJjaCIsICJ2YWx1ZSI6IG9TZXR0aW5ncy5vUHJldmlvdXNTZWFyY2guc1NlYXJjaCB9ICk7CgkJCQkJYW9EYXRhLnB1c2goIHsgIm5hbWUiOiAiYlJlZ2V4IiwgICJ2YWx1ZSI6IG9TZXR0aW5ncy5vUHJldmlvdXNTZWFyY2guYlJlZ2V4IH0gKTsKCQkJCQlmb3IgKCBpPTAgOyBpPGlDb2x1bW5zIDsgaSsrICkKCQkJCQl7CgkJCQkJCWFvRGF0YS5wdXNoKCB7ICJuYW1lIjogInNTZWFyY2hfIitpLCAgICAgInZhbHVlIjogb1NldHRpbmdzLmFvUHJlU2VhcmNoQ29sc1tpXS5zU2VhcmNoIH0gKTsKCQkJCQkJYW9EYXRhLnB1c2goIHsgIm5hbWUiOiAiYlJlZ2V4XyIraSwgICAgICAidmFsdWUiOiBvU2V0dGluZ3MuYW9QcmVTZWFyY2hDb2xzW2ldLmJSZWdleCB9ICk7CgkJCQkJCWFvRGF0YS5wdXNoKCB7ICJuYW1lIjogImJTZWFyY2hhYmxlXyIraSwgInZhbHVlIjogb1NldHRpbmdzLmFvQ29sdW1uc1tpXS5iU2VhcmNoYWJsZSB9ICk7CgkJCQkJfQoJCQkJfQoJCQkJCgkJCQkvKiBTb3J0aW5nICovCgkJCQlpZiAoIG9TZXR0aW5ncy5vRmVhdHVyZXMuYlNvcnQgIT09IGZhbHNlICkKCQkJCXsKCQkJCQl2YXIgaUZpeGVkID0gb1NldHRpbmdzLmFhU29ydGluZ0ZpeGVkICE9PSBudWxsID8gb1NldHRpbmdzLmFhU29ydGluZ0ZpeGVkLmxlbmd0aCA6IDA7CgkJCQkJdmFyIGlVc2VyID0gb1NldHRpbmdzLmFhU29ydGluZy5sZW5ndGg7CgkJCQkJYW9EYXRhLnB1c2goIHsgIm5hbWUiOiAiaVNvcnRpbmdDb2xzIiwgICAidmFsdWUiOiBpRml4ZWQraVVzZXIgfSApOwoJCQkJCWZvciAoIGk9MCA7IGk8aUZpeGVkIDsgaSsrICkKCQkJCQl7CgkJCQkJCWFvRGF0YS5wdXNoKCB7ICJuYW1lIjogImlTb3J0Q29sXyIraSwgICJ2YWx1ZSI6IG9TZXR0aW5ncy5hYVNvcnRpbmdGaXhlZFtpXVswXSB9ICk7CgkJCQkJCWFvRGF0YS5wdXNoKCB7ICJuYW1lIjogInNTb3J0RGlyXyIraSwgICJ2YWx1ZSI6IG9TZXR0aW5ncy5hYVNvcnRpbmdGaXhlZFtpXVsxXSB9ICk7CgkJCQkJfQoJCQkJCQoJCQkJCWZvciAoIGk9MCA7IGk8aVVzZXIgOyBpKysgKQoJCQkJCXsKCQkJCQkJYW9EYXRhLnB1c2goIHsgIm5hbWUiOiAiaVNvcnRDb2xfIisoaStpRml4ZWQpLCAgInZhbHVlIjogb1NldHRpbmdzLmFhU29ydGluZ1tpXVswXSB9ICk7CgkJCQkJCWFvRGF0YS5wdXNoKCB7ICJuYW1lIjogInNTb3J0RGlyXyIrKGkraUZpeGVkKSwgICJ2YWx1ZSI6IG9TZXR0aW5ncy5hYVNvcnRpbmdbaV1bMV0gfSApOwoJCQkJCX0KCQkJCQkKCQkJCQlmb3IgKCBpPTAgOyBpPGlDb2x1bW5zIDsgaSsrICkKCQkJCQl7CgkJCQkJCWFvRGF0YS5wdXNoKCB7ICJuYW1lIjogImJTb3J0YWJsZV8iK2ksICAidmFsdWUiOiBvU2V0dGluZ3MuYW9Db2x1bW5zW2ldLmJTb3J0YWJsZSB9ICk7CgkJCQkJfQoJCQkJfQoJCQkJCgkJCQlvU2V0dGluZ3MuZm5TZXJ2ZXJEYXRhLmNhbGwoIG9TZXR0aW5ncy5vSW5zdGFuY2UsIG9TZXR0aW5ncy5zQWpheFNvdXJjZSwgYW9EYXRhLAoJCQkJCWZ1bmN0aW9uKGpzb24pIHsKCQkJCQkJX2ZuQWpheFVwZGF0ZURyYXcoIG9TZXR0aW5ncywganNvbiApOwoJCQkJCX0gKTsKCQkJCXJldHVybiBmYWxzZTsKCQkJfQoJCQllbHNlCgkJCXsKCQkJCXJldHVybiB0cnVlOwoJCQl9CgkJfQoJCQoJCS8qCgkJICogRnVuY3Rpb246IF9mbkFqYXhVcGRhdGVEcmF3CgkJICogUHVycG9zZTogIERhdGEgdGhlIGRhdGEgZnJvbSB0aGUgc2VydmVyIChudWtpbmcgdGhlIG9sZCkgYW5kIHJlZHJhdyB0aGUgdGFibGUKCQkgKiBSZXR1cm5zOiAgLQoJCSAqIElucHV0czogICBvYmplY3Q6b1NldHRpbmdzIC0gZGF0YVRhYmxlcyBzZXR0aW5ncyBvYmplY3QKCQkgKiAgICAgICAgICAgb2JqZWN0Ompzb24gLSBqc29uIGRhdGEgcmV0dXJuIGZyb20gdGhlIHNlcnZlci4KCQkgKiAgICAgICAgICAgICBUaGUgZm9sbG93aW5nIG11c3QgYmUgZGVmaW5lZDoKCQkgKiAgICAgICAgICAgICAgIGlUb3RhbFJlY29yZHMsIGlUb3RhbERpc3BsYXlSZWNvcmRzLCBhYURhdGEKCQkgKiAgICAgICAgICAgICBUaGUgZm9sbG93aW5nIG1heSBiZSBkZWZpbmVkOgoJCSAqICAgICAgICAgICAgICAgc0NvbHVtbnMKCQkgKi8KCQlmdW5jdGlvbiBfZm5BamF4VXBkYXRlRHJhdyAoIG9TZXR0aW5ncywganNvbiApCgkJewoJCQlpZiAoIHR5cGVvZiBqc29uLnNFY2hvICE9ICd1bmRlZmluZWQnICkKCQkJewoJCQkJLyogUHJvdGVjdCBhZ2FpbnN0IG9sZCByZXR1cm5zIG92ZXItd3JpdGluZyBhIG5ldyBvbmUuIFBvc3NpYmxlIHdoZW4geW91IGdldAoJCQkJICogdmVyeSBmYXN0IGludGVyYWN0aW9uLCBhbmQgbGF0ZXIgcXVlaXJlcyBhcmUgY29tcGxldGVkIG11Y2ggZmFzdGVyCgkJCQkgKi8KCQkJCWlmICgganNvbi5zRWNobyoxIDwgb1NldHRpbmdzLmlEcmF3ICkKCQkJCXsKCQkJCQlyZXR1cm47CgkJCQl9CgkJCQllbHNlCgkJCQl7CgkJCQkJb1NldHRpbmdzLmlEcmF3ID0ganNvbi5zRWNobyAqIDE7CgkJCQl9CgkJCX0KCQkJCgkJCWlmICggIW9TZXR0aW5ncy5vU2Nyb2xsLmJJbmZpbml0ZSB8fAoJCQkJICAgKG9TZXR0aW5ncy5vU2Nyb2xsLmJJbmZpbml0ZSAmJiAob1NldHRpbmdzLmJTb3J0ZWQgfHwgb1NldHRpbmdzLmJGaWx0ZXJlZCkpICkKCQkJewoJCQkJX2ZuQ2xlYXJUYWJsZSggb1NldHRpbmdzICk7CgkJCX0KCQkJb1NldHRpbmdzLl9pUmVjb3Jkc1RvdGFsID0ganNvbi5pVG90YWxSZWNvcmRzOwoJCQlvU2V0dGluZ3MuX2lSZWNvcmRzRGlzcGxheSA9IGpzb24uaVRvdGFsRGlzcGxheVJlY29yZHM7CgkJCQoJCQkvKiBEZXRlcm1pbmUgaWYgcmVvcmRlcmluZyBpcyByZXF1aXJlZCAqLwoJCQl2YXIgc09yZGVyaW5nID0gX2ZuQ29sdW1uT3JkZXJpbmcob1NldHRpbmdzKTsKCQkJdmFyIGJSZU9yZGVyID0gKHR5cGVvZiBqc29uLnNDb2x1bW5zICE9ICd1bmRlZmluZWQnICYmIHNPcmRlcmluZyAhPT0gIiIgJiYganNvbi5zQ29sdW1ucyAhPSBzT3JkZXJpbmcgKTsKCQkJaWYgKCBiUmVPcmRlciApCgkJCXsKCQkJCXZhciBhaUluZGV4ID0gX2ZuUmVPcmRlckluZGV4KCBvU2V0dGluZ3MsIGpzb24uc0NvbHVtbnMgKTsKCQkJfQoJCQkKCQkJZm9yICggdmFyIGk9MCwgaUxlbj1qc29uLmFhRGF0YS5sZW5ndGggOyBpPGlMZW4gOyBpKysgKQoJCQl7CgkJCQlpZiAoIGJSZU9yZGVyICkKCQkJCXsKCQkJCQkvKiBJZiB3ZSBuZWVkIHRvIHJlLW9yZGVyLCB0aGVuIGNyZWF0ZSBhIG5ldyBhcnJheSB3aXRoIHRoZSBjb3JyZWN0IG9yZGVyIGFuZCBhZGQgaXQgKi8KCQkJCQl2YXIgYURhdGEgPSBbXTsKCQkJCQlmb3IgKCB2YXIgaj0wLCBqTGVuPW9TZXR0aW5ncy5hb0NvbHVtbnMubGVuZ3RoIDsgajxqTGVuIDsgaisrICkKCQkJCQl7CgkJCQkJCWFEYXRhLnB1c2goIGpzb24uYWFEYXRhW2ldWyBhaUluZGV4W2pdIF0gKTsKCQkJCQl9CgkJCQkJX2ZuQWRkRGF0YSggb1NldHRpbmdzLCBhRGF0YSApOwoJCQkJfQoJCQkJZWxzZQoJCQkJewoJCQkJCS8qIE5vIHJlLW9yZGVyIHJlcXVpcmVkLCBzZXZlciBnb3QgaXQgInJpZ2h0IiAtIGp1c3Qgc3RyYWlnaHQgYWRkICovCgkJCQkJX2ZuQWRkRGF0YSggb1NldHRpbmdzLCBqc29uLmFhRGF0YVtpXSApOwoJCQkJfQoJCQl9CgkJCW9TZXR0aW5ncy5haURpc3BsYXkgPSBvU2V0dGluZ3MuYWlEaXNwbGF5TWFzdGVyLnNsaWNlKCk7CgkJCQoJCQlvU2V0dGluZ3MuYkFqYXhEYXRhR2V0ID0gZmFsc2U7CgkJCV9mbkRyYXcoIG9TZXR0aW5ncyApOwoJCQlvU2V0dGluZ3MuYkFqYXhEYXRhR2V0ID0gdHJ1ZTsKCQkJX2ZuUHJvY2Vzc2luZ0Rpc3BsYXkoIG9TZXR0aW5ncywgZmFsc2UgKTsKCQl9CgkJCgkJCgkJLyogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICoKCQkgKiBTZWN0aW9uIC0gT3B0aW9ucyAoZmVhdHVyZXMpIEhUTUwKCQkgKi8KCQkKCQkvKgoJCSAqIEZ1bmN0aW9uOiBfZm5BZGRPcHRpb25zSHRtbAoJCSAqIFB1cnBvc2U6ICBBZGQgdGhlIG9wdGlvbnMgdG8gdGhlIHBhZ2UgSFRNTCBmb3IgdGhlIHRhYmxlCgkJICogUmV0dXJuczogIC0KCQkgKiBJbnB1dHM6ICAgb2JqZWN0Om9TZXR0aW5ncyAtIGRhdGFUYWJsZXMgc2V0dGluZ3Mgb2JqZWN0CgkJICovCgkJZnVuY3Rpb24gX2ZuQWRkT3B0aW9uc0h0bWwgKCBvU2V0dGluZ3MgKQoJCXsKCQkJLyoKCQkJICogQ3JlYXRlIGEgdGVtcG9yYXJ5LCBlbXB0eSwgZGl2IHdoaWNoIHdlIGNhbiBsYXRlciBvbiByZXBsYWNlIHdpdGggd2hhdCB3ZSBoYXZlIGdlbmVyYXRlZAoJCQkgKiB3ZSBkbyBpdCB0aGlzIHdheSB0byByZW5kZXJpbmcgdGhlICdvcHRpb25zJyBodG1sIG9mZmxpbmUgLSBzcGVlZCA6LSkKCQkJICovCgkJCXZhciBuSG9sZGluZyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoICdkaXYnICk7CgkJCW9TZXR0aW5ncy5uVGFibGUucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUoIG5Ib2xkaW5nLCBvU2V0dGluZ3MublRhYmxlICk7CgkJCQoJCQkvKiAKCQkJICogQWxsIERhdGFUYWJsZXMgYXJlIHdyYXBwZWQgaW4gYSBkaXYgLSB0aGlzIGlzIG5vdCBjdXJyZW50bHkgb3B0aW9uYWwgLSBiYWNrd2FyZHMgCgkJCSAqIGNvbXBhdGFiaWxpdHkuIEl0IGNhbiBiZSByZW1vdmVkIGlmIHlvdSBkb24ndCB3YW50IGl0LgoJCQkgKi8KCQkJb1NldHRpbmdzLm5UYWJsZVdyYXBwZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCAnZGl2JyApOwoJCQlvU2V0dGluZ3MublRhYmxlV3JhcHBlci5jbGFzc05hbWUgPSBvU2V0dGluZ3Mub0NsYXNzZXMuc1dyYXBwZXI7CgkJCWlmICggb1NldHRpbmdzLnNUYWJsZUlkICE9PSAnJyApCgkJCXsKCQkJCW9TZXR0aW5ncy5uVGFibGVXcmFwcGVyLnNldEF0dHJpYnV0ZSggJ2lkJywgb1NldHRpbmdzLnNUYWJsZUlkKydfd3JhcHBlcicgKTsKCQkJfQoJCQkKCQkJLyogVHJhY2sgd2hlcmUgd2Ugd2FudCB0byBpbnNlcnQgdGhlIG9wdGlvbiAqLwoJCQl2YXIgbkluc2VydE5vZGUgPSBvU2V0dGluZ3MublRhYmxlV3JhcHBlcjsKCQkJCgkJCS8qIExvb3Agb3ZlciB0aGUgdXNlciBzZXQgcG9zaXRpb25pbmcgYW5kIHBsYWNlIHRoZSBlbGVtZW50cyBhcyBuZWVkZWQgKi8KCQkJdmFyIGFEb20gPSBvU2V0dGluZ3Muc0RvbS5zcGxpdCgnJyk7CgkJCXZhciBuVG1wLCBpUHVzaEZlYXR1cmUsIGNPcHRpb24sIG5OZXdOb2RlLCBjTmV4dCwgc0F0dHIsIGo7CgkJCWZvciAoIHZhciBpPTAgOyBpPGFEb20ubGVuZ3RoIDsgaSsrICkKCQkJewoJCQkJaVB1c2hGZWF0dXJlID0gMDsKCQkJCWNPcHRpb24gPSBhRG9tW2ldOwoJCQkJCgkJCQlpZiAoIGNPcHRpb24gPT0gJzwnICkKCQkJCXsKCQkJCQkvKiBOZXcgY29udGFpbmVyIGRpdiAqLwoJCQkJCW5OZXdOb2RlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCggJ2RpdicgKTsKCQkJCQkKCQkJCQkvKiBDaGVjayB0byBzZWUgaWYgd2Ugc2hvdWxkIGFwcGVuZCBhbiBpZCBhbmQvb3IgYSBjbGFzcyBuYW1lIHRvIHRoZSBjb250YWluZXIgKi8KCQkJCQljTmV4dCA9IGFEb21baSsxXTsKCQkJCQlpZiAoIGNOZXh0ID09ICInIiB8fCBjTmV4dCA9PSAnIicgKQoJCQkJCXsKCQkJCQkJc0F0dHIgPSAiIjsKCQkJCQkJaiA9IDI7CgkJCQkJCXdoaWxlICggYURvbVtpK2pdICE9IGNOZXh0ICkKCQkJCQkJewoJCQkJCQkJc0F0dHIgKz0gYURvbVtpK2pdOwoJCQkJCQkJaisrOwoJCQkJCQl9CgkJCQkJCQoJCQkJCQkvKiBSZXBsYWNlIGpRdWVyeSBVSSBjb25zdGFudHMgKi8KCQkJCQkJaWYgKCBzQXR0ciA9PSAiSCIgKQoJCQkJCQl7CgkJCQkJCQlzQXR0ciA9ICJmZy10b29sYmFyIHVpLXRvb2xiYXIgdWktd2lkZ2V0LWhlYWRlciB1aS1jb3JuZXItdGwgdWktY29ybmVyLXRyIHVpLWhlbHBlci1jbGVhcmZpeCI7CgkJCQkJCX0KCQkJCQkJZWxzZSBpZiAoIHNBdHRyID09ICJGIiApCgkJCQkJCXsKCQkJCQkJCXNBdHRyID0gImZnLXRvb2xiYXIgdWktdG9vbGJhciB1aS13aWRnZXQtaGVhZGVyIHVpLWNvcm5lci1ibCB1aS1jb3JuZXItYnIgdWktaGVscGVyLWNsZWFyZml4IjsKCQkJCQkJfQoJCQkJCQkKCQkJCQkJLyogVGhlIGF0dHJpYnV0ZSBjYW4gYmUgaW4gdGhlIGZvcm1hdCBvZiAiI2lkLmNsYXNzIiwgIiNpZCIgb3IgImNsYXNzIiBUaGlzIGxvZ2ljCgkJCQkJCSAqIGJyZWFrcyB0aGUgc3RyaW5nIGludG8gcGFydHMgYW5kIGFwcGxpZXMgdGhlbSBhcyBuZWVkZWQKCQkJCQkJICovCgkJCQkJCWlmICggc0F0dHIuaW5kZXhPZignLicpICE9IC0xICkKCQkJCQkJewoJCQkJCQkJdmFyIGFTcGxpdCA9IHNBdHRyLnNwbGl0KCcuJyk7CgkJCQkJCQluTmV3Tm9kZS5zZXRBdHRyaWJ1dGUoJ2lkJywgYVNwbGl0WzBdLnN1YnN0cigxLCBhU3BsaXRbMF0ubGVuZ3RoLTEpICk7CgkJCQkJCQluTmV3Tm9kZS5jbGFzc05hbWUgPSBhU3BsaXRbMV07CgkJCQkJCX0KCQkJCQkJZWxzZSBpZiAoIHNBdHRyLmNoYXJBdCgwKSA9PSAiIyIgKQoJCQkJCQl7CgkJCQkJCQluTmV3Tm9kZS5zZXRBdHRyaWJ1dGUoJ2lkJywgc0F0dHIuc3Vic3RyKDEsIHNBdHRyLmxlbmd0aC0xKSApOwoJCQkJCQl9CgkJCQkJCWVsc2UKCQkJCQkJewoJCQkJCQkJbk5ld05vZGUuY2xhc3NOYW1lID0gc0F0dHI7CgkJCQkJCX0KCQkJCQkJCgkJCQkJCWkgKz0gajsgLyogTW92ZSBhbG9uZyB0aGUgcG9zaXRpb24gYXJyYXkgKi8KCQkJCQl9CgkJCQkJCgkJCQkJbkluc2VydE5vZGUuYXBwZW5kQ2hpbGQoIG5OZXdOb2RlICk7CgkJCQkJbkluc2VydE5vZGUgPSBuTmV3Tm9kZTsKCQkJCX0KCQkJCWVsc2UgaWYgKCBjT3B0aW9uID09ICc+JyApCgkJCQl7CgkJCQkJLyogRW5kIGNvbnRhaW5lciBkaXYgKi8KCQkJCQluSW5zZXJ0Tm9kZSA9IG5JbnNlcnROb2RlLnBhcmVudE5vZGU7CgkJCQl9CgkJCQllbHNlIGlmICggY09wdGlvbiA9PSAnbCcgJiYgb1NldHRpbmdzLm9GZWF0dXJlcy5iUGFnaW5hdGUgJiYgb1NldHRpbmdzLm9GZWF0dXJlcy5iTGVuZ3RoQ2hhbmdlICkKCQkJCXsKCQkJCQkvKiBMZW5ndGggKi8KCQkJCQluVG1wID0gX2ZuRmVhdHVyZUh0bWxMZW5ndGgoIG9TZXR0aW5ncyApOwoJCQkJCWlQdXNoRmVhdHVyZSA9IDE7CgkJCQl9CgkJCQllbHNlIGlmICggY09wdGlvbiA9PSAnZicgJiYgb1NldHRpbmdzLm9GZWF0dXJlcy5iRmlsdGVyICkKCQkJCXsKCQkJCQkvKiBGaWx0ZXIgKi8KCQkJCQluVG1wID0gX2ZuRmVhdHVyZUh0bWxGaWx0ZXIoIG9TZXR0aW5ncyApOwoJCQkJCWlQdXNoRmVhdHVyZSA9IDE7CgkJCQl9CgkJCQllbHNlIGlmICggY09wdGlvbiA9PSAncicgJiYgb1NldHRpbmdzLm9GZWF0dXJlcy5iUHJvY2Vzc2luZyApCgkJCQl7CgkJCQkJLyogcFJvY2Vzc2luZyAqLwoJCQkJCW5UbXAgPSBfZm5GZWF0dXJlSHRtbFByb2Nlc3NpbmcoIG9TZXR0aW5ncyApOwoJCQkJCWlQdXNoRmVhdHVyZSA9IDE7CgkJCQl9CgkJCQllbHNlIGlmICggY09wdGlvbiA9PSAndCcgKQoJCQkJewoJCQkJCS8qIFRhYmxlICovCgkJCQkJblRtcCA9IF9mbkZlYXR1cmVIdG1sVGFibGUoIG9TZXR0aW5ncyApOwoJCQkJCWlQdXNoRmVhdHVyZSA9IDE7CgkJCQl9CgkJCQllbHNlIGlmICggY09wdGlvbiA9PSAgJ2knICYmIG9TZXR0aW5ncy5vRmVhdHVyZXMuYkluZm8gKQoJCQkJewoJCQkJCS8qIEluZm8gKi8KCQkJCQluVG1wID0gX2ZuRmVhdHVyZUh0bWxJbmZvKCBvU2V0dGluZ3MgKTsKCQkJCQlpUHVzaEZlYXR1cmUgPSAxOwoJCQkJfQoJCQkJZWxzZSBpZiAoIGNPcHRpb24gPT0gJ3AnICYmIG9TZXR0aW5ncy5vRmVhdHVyZXMuYlBhZ2luYXRlICkKCQkJCXsKCQkJCQkvKiBQYWdpbmF0aW9uICovCgkJCQkJblRtcCA9IF9mbkZlYXR1cmVIdG1sUGFnaW5hdGUoIG9TZXR0aW5ncyApOwoJCQkJCWlQdXNoRmVhdHVyZSA9IDE7CgkJCQl9CgkJCQllbHNlIGlmICggX29FeHQuYW9GZWF0dXJlcy5sZW5ndGggIT09IDAgKQoJCQkJewoJCQkJCS8qIFBsdWctaW4gZmVhdHVyZXMgKi8KCQkJCQl2YXIgYW9GZWF0dXJlcyA9IF9vRXh0LmFvRmVhdHVyZXM7CgkJCQkJZm9yICggdmFyIGs9MCwga0xlbj1hb0ZlYXR1cmVzLmxlbmd0aCA7IGs8a0xlbiA7IGsrKyApCgkJCQkJewoJCQkJCQlpZiAoIGNPcHRpb24gPT0gYW9GZWF0dXJlc1trXS5jRmVhdHVyZSApCgkJCQkJCXsKCQkJCQkJCW5UbXAgPSBhb0ZlYXR1cmVzW2tdLmZuSW5pdCggb1NldHRpbmdzICk7CgkJCQkJCQlpZiAoIG5UbXAgKQoJCQkJCQkJewoJCQkJCQkJCWlQdXNoRmVhdHVyZSA9IDE7CgkJCQkJCQl9CgkJCQkJCQlicmVhazsKCQkJCQkJfQoJCQkJCX0KCQkJCX0KCQkJCQoJCQkJLyogQWRkIHRvIHRoZSAyRCBmZWF0dXJlcyBhcnJheSAqLwoJCQkJaWYgKCBpUHVzaEZlYXR1cmUgPT0gMSAmJiBuVG1wICE9PSBudWxsICkKCQkJCXsKCQkJCQlpZiAoIHR5cGVvZiBvU2V0dGluZ3MuYWFuRmVhdHVyZXNbY09wdGlvbl0gIT0gJ29iamVjdCcgKQoJCQkJCXsKCQkJCQkJb1NldHRpbmdzLmFhbkZlYXR1cmVzW2NPcHRpb25dID0gW107CgkJCQkJfQoJCQkJCW9TZXR0aW5ncy5hYW5GZWF0dXJlc1tjT3B0aW9uXS5wdXNoKCBuVG1wICk7CgkJCQkJbkluc2VydE5vZGUuYXBwZW5kQ2hpbGQoIG5UbXAgKTsKCQkJCX0KCQkJfQoJCQkKCQkJLyogQnVpbHQgb3VyIERPTSBzdHJ1Y3R1cmUgLSByZXBsYWNlIHRoZSBob2xkaW5nIGRpdiB3aXRoIHdoYXQgd2Ugd2FudCAqLwoJCQluSG9sZGluZy5wYXJlbnROb2RlLnJlcGxhY2VDaGlsZCggb1NldHRpbmdzLm5UYWJsZVdyYXBwZXIsIG5Ib2xkaW5nICk7CgkJfQoJCQoJCQoJCS8qICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqCgkJICogU2VjdGlvbiAtIEZlYXR1cmU6IEZpbHRlcmluZwoJCSAqLwoJCQoJCS8qCgkJICogRnVuY3Rpb246IF9mbkZlYXR1cmVIdG1sVGFibGUKCQkgKiBQdXJwb3NlOiAgQWRkIGFueSBjb250cm9sIGVsZW1lbnRzIGZvciB0aGUgdGFibGUgLSBzcGVjaWZpY2FsbHkgc2Nyb2xsaW5nCgkJICogUmV0dXJuczogIG5vZGU6IC0gTm9kZSB0byBhZGQgdG8gdGhlIERPTQoJCSAqIElucHV0czogICBvYmplY3Q6b1NldHRpbmdzIC0gZGF0YVRhYmxlcyBzZXR0aW5ncyBvYmplY3QKCQkgKi8KCQlmdW5jdGlvbiBfZm5GZWF0dXJlSHRtbFRhYmxlICggb1NldHRpbmdzICkKCQl7CgkJCS8qIENoYWNrIGlmIHNjcm9sbGluZyBpcyBlbmFibGVkIG9yIG5vdCAtIGlmIG5vdCB0aGVuIGxlYXZlIHRoZSBET00gdW5hbHRlcmVkICovCgkJCWlmICggb1NldHRpbmdzLm9TY3JvbGwuc1ggPT09ICIiICYmIG9TZXR0aW5ncy5vU2Nyb2xsLnNZID09PSAiIiApCgkJCXsKCQkJCXJldHVybiBvU2V0dGluZ3MublRhYmxlOwoJCQl9CgkJCQoJCQkvKgoJCQkgKiBUaGUgSFRNTCBzdHJ1Y3R1cmUgdGhhdCB3ZSB3YW50IHRvIGdlbmVyYXRlIGluIHRoaXMgZnVuY3Rpb24gaXM6CgkJCSAqICBkaXYgLSBuU2Nyb2xsZXIKCQkJICogICAgZGl2IC0gblNjcm9sbEhlYWQKCQkJICogICAgICBkaXYgLSBuU2Nyb2xsSGVhZElubmVyCgkJCSAqICAgICAgICB0YWJsZSAtIG5TY3JvbGxIZWFkVGFibGUKCQkJICogICAgICAgICAgdGhlYWQgLSBuVGhlYWQKCQkJICogICAgZGl2IC0gblNjcm9sbEJvZHkKCQkJICogICAgICB0YWJsZSAtIG9TZXR0aW5ncy5uVGFibGUKCQkJICogICAgICAgIHRoZWFkIC0gblRoZWFkU2l6ZQoJCQkgKiAgICAgICAgdGJvZHkgLSBuVGJvZHkKCQkJICogICAgZGl2IC0gblNjcm9sbEZvb3QKCQkJICogICAgICBkaXYgLSBuU2Nyb2xsRm9vdElubmVyCgkJCSAqICAgICAgICB0YWJsZSAtIG5TY3JvbGxGb290VGFibGUKCQkJICogICAgICAgICAgdGZvb3QgLSBuVGZvb3QKCQkJICovCgkJCXZhcgoJCQkgCW5TY3JvbGxlciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpLAoJCQkgCW5TY3JvbGxIZWFkID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2JyksCgkJCSAJblNjcm9sbEhlYWRJbm5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpLAoJCQkgCW5TY3JvbGxCb2R5ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2JyksCgkJCSAJblNjcm9sbEZvb3QgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKSwKCQkJIAluU2Nyb2xsRm9vdElubmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2JyksCgkJCSAJblNjcm9sbEhlYWRUYWJsZSA9IG9TZXR0aW5ncy5uVGFibGUuY2xvbmVOb2RlKGZhbHNlKSwKCQkJIAluU2Nyb2xsRm9vdFRhYmxlID0gb1NldHRpbmdzLm5UYWJsZS5jbG9uZU5vZGUoZmFsc2UpLAoJCQkJblRoZWFkID0gb1NldHRpbmdzLm5UYWJsZS5nZXRFbGVtZW50c0J5VGFnTmFtZSgndGhlYWQnKVswXSwKCQkJIAluVGZvb3QgPSBvU2V0dGluZ3MublRhYmxlLmdldEVsZW1lbnRzQnlUYWdOYW1lKCd0Zm9vdCcpLmxlbmd0aCA9PT0gMCA/IG51bGwgOiAKCQkJCQlvU2V0dGluZ3MublRhYmxlLmdldEVsZW1lbnRzQnlUYWdOYW1lKCd0Zm9vdCcpWzBdLAoJCQkJb0NsYXNzZXMgPSAodHlwZW9mIG9Jbml0LmJKUXVlcnlVSSAhPSAndW5kZWZpbmVkJyAmJiBvSW5pdC5iSlF1ZXJ5VUkpID8KCQkJIAkJX29FeHQub0pVSUNsYXNzZXMgOiBfb0V4dC5vU3RkQ2xhc3NlczsKCQkJCgkJCW5TY3JvbGxIZWFkLmFwcGVuZENoaWxkKCBuU2Nyb2xsSGVhZElubmVyICk7CgkJCW5TY3JvbGxGb290LmFwcGVuZENoaWxkKCBuU2Nyb2xsRm9vdElubmVyICk7CgkJCW5TY3JvbGxCb2R5LmFwcGVuZENoaWxkKCBvU2V0dGluZ3MublRhYmxlICk7CgkJCW5TY3JvbGxlci5hcHBlbmRDaGlsZCggblNjcm9sbEhlYWQgKTsKCQkJblNjcm9sbGVyLmFwcGVuZENoaWxkKCBuU2Nyb2xsQm9keSApOwoJCQluU2Nyb2xsSGVhZElubmVyLmFwcGVuZENoaWxkKCBuU2Nyb2xsSGVhZFRhYmxlICk7CgkJCW5TY3JvbGxIZWFkVGFibGUuYXBwZW5kQ2hpbGQoIG5UaGVhZCApOwoJCQlpZiAoIG5UZm9vdCAhPT0gbnVsbCApCgkJCXsKCQkJCW5TY3JvbGxlci5hcHBlbmRDaGlsZCggblNjcm9sbEZvb3QgKTsKCQkJCW5TY3JvbGxGb290SW5uZXIuYXBwZW5kQ2hpbGQoIG5TY3JvbGxGb290VGFibGUgKTsKCQkJCW5TY3JvbGxGb290VGFibGUuYXBwZW5kQ2hpbGQoIG5UZm9vdCApOwoJCQl9CgkJCQoJCQluU2Nyb2xsZXIuY2xhc3NOYW1lID0gb0NsYXNzZXMuc1Njcm9sbFdyYXBwZXI7CgkJCW5TY3JvbGxIZWFkLmNsYXNzTmFtZSA9IG9DbGFzc2VzLnNTY3JvbGxIZWFkOwoJCQluU2Nyb2xsSGVhZElubmVyLmNsYXNzTmFtZSA9IG9DbGFzc2VzLnNTY3JvbGxIZWFkSW5uZXI7CgkJCW5TY3JvbGxCb2R5LmNsYXNzTmFtZSA9IG9DbGFzc2VzLnNTY3JvbGxCb2R5OwoJCQluU2Nyb2xsRm9vdC5jbGFzc05hbWUgPSBvQ2xhc3Nlcy5zU2Nyb2xsRm9vdDsKCQkJblNjcm9sbEZvb3RJbm5lci5jbGFzc05hbWUgPSBvQ2xhc3Nlcy5zU2Nyb2xsRm9vdElubmVyOwoJCQkKCQkJblNjcm9sbEhlYWQuc3R5bGUub3ZlcmZsb3cgPSAiaGlkZGVuIjsKCQkJblNjcm9sbEhlYWQuc3R5bGUucG9zaXRpb24gPSAicmVsYXRpdmUiOwoJCQluU2Nyb2xsRm9vdC5zdHlsZS5vdmVyZmxvdyA9ICJoaWRkZW4iOwoJCQluU2Nyb2xsQm9keS5zdHlsZS5vdmVyZmxvdyA9ICJhdXRvIjsKCQkJblNjcm9sbEhlYWQuc3R5bGUuYm9yZGVyID0gIjAiOwoJCQluU2Nyb2xsRm9vdC5zdHlsZS5ib3JkZXIgPSAiMCI7CgkJCW5TY3JvbGxIZWFkSW5uZXIuc3R5bGUud2lkdGggPSAiMTUwJSI7IC8qIHdpbGwgYmUgb3ZlcndyaXR0ZW4gKi8KCQkJCgkJCS8qIE1vZGlmeSBhdHRyaWJ1dGVzIHRvIHJlc3BlY3QgdGhlIGNsb25lcyAqLwoJCQluU2Nyb2xsSGVhZFRhYmxlLnJlbW92ZUF0dHJpYnV0ZSgnaWQnKTsKCQkJblNjcm9sbEhlYWRUYWJsZS5zdHlsZS5tYXJnaW5MZWZ0ID0gIjAiOwoJCQlvU2V0dGluZ3MublRhYmxlLnN0eWxlLm1hcmdpbkxlZnQgPSAiMCI7CgkJCWlmICggblRmb290ICE9PSBudWxsICkKCQkJewoJCQkJblNjcm9sbEZvb3RUYWJsZS5yZW1vdmVBdHRyaWJ1dGUoJ2lkJyk7CgkJCQluU2Nyb2xsRm9vdFRhYmxlLnN0eWxlLm1hcmdpbkxlZnQgPSAiMCI7CgkJCX0KCQkJCgkJCS8qIE1vdmUgYW55IGNhcHRpb24gZWxlbWVudHMgZnJvbSB0aGUgYm9keSB0byB0aGUgaGVhZGVyICovCgkJCXZhciBuQ2FwdGlvbnMgPSAkKCc+Y2FwdGlvbicsIG9TZXR0aW5ncy5uVGFibGUpOwoJCQlmb3IgKCB2YXIgaT0wLCBpTGVuPW5DYXB0aW9ucy5sZW5ndGggOyBpPGlMZW4gOyBpKysgKQoJCQl7CgkJCQluU2Nyb2xsSGVhZFRhYmxlLmFwcGVuZENoaWxkKCBuQ2FwdGlvbnNbaV0gKTsKCQkJfQoJCQkKCQkJLyoKCQkJICogU2l6aW5nCgkJCSAqLwoJCQkvKiBXaGVuIHhzY3JvbGxpbmcgYWRkIHRoZSB3aWR0aCBhbmQgYSBzY3JvbGxlciB0byBtb3ZlIHRoZSBoZWFkZXIgd2l0aCB0aGUgYm9keSAqLwoJCQlpZiAoIG9TZXR0aW5ncy5vU2Nyb2xsLnNYICE9PSAiIiApCgkJCXsKCQkJCW5TY3JvbGxIZWFkLnN0eWxlLndpZHRoID0gX2ZuU3RyaW5nVG9Dc3MoIG9TZXR0aW5ncy5vU2Nyb2xsLnNYICk7CgkJCQluU2Nyb2xsQm9keS5zdHlsZS53aWR0aCA9IF9mblN0cmluZ1RvQ3NzKCBvU2V0dGluZ3Mub1Njcm9sbC5zWCApOwoJCQkJCgkJCQlpZiAoIG5UZm9vdCAhPT0gbnVsbCApCgkJCQl7CgkJCQkJblNjcm9sbEZvb3Quc3R5bGUud2lkdGggPSBfZm5TdHJpbmdUb0Nzcyggb1NldHRpbmdzLm9TY3JvbGwuc1ggKTsJCgkJCQl9CgkJCQkKCQkJCS8qIFdoZW4gdGhlIGJvZHkgaXMgc2Nyb2xsZWQsIHRoZW4gd2UgYWxzbyB3YW50IHRvIHNjcm9sbCB0aGUgaGVhZGVycyAqLwoJCQkJJChuU2Nyb2xsQm9keSkuc2Nyb2xsKCBmdW5jdGlvbiAoZSkgewoJCQkJCW5TY3JvbGxIZWFkLnNjcm9sbExlZnQgPSB0aGlzLnNjcm9sbExlZnQ7CgkJCQkJCgkJCQkJaWYgKCBuVGZvb3QgIT09IG51bGwgKQoJCQkJCXsKCQkJCQkJblNjcm9sbEZvb3Quc2Nyb2xsTGVmdCA9IHRoaXMuc2Nyb2xsTGVmdDsKCQkJCQl9CgkJCQl9ICk7CgkJCX0KCQkJCgkJCS8qIFdoZW4geXNjcm9sbGluZywgYWRkIHRoZSBoZWlnaHQgKi8KCQkJaWYgKCBvU2V0dGluZ3Mub1Njcm9sbC5zWSAhPT0gIiIgKQoJCQl7CgkJCQluU2Nyb2xsQm9keS5zdHlsZS5oZWlnaHQgPSBfZm5TdHJpbmdUb0Nzcyggb1NldHRpbmdzLm9TY3JvbGwuc1kgKTsKCQkJfQoJCQkKCQkJLyogUmVkcmF3IC0gYWxpZ24gY29sdW1ucyBhY3Jvc3MgdGhlIHRhYmxlcyAqLwoJCQlvU2V0dGluZ3MuYW9EcmF3Q2FsbGJhY2sucHVzaCggewoJCQkJImZuIjogX2ZuU2Nyb2xsRHJhdywKCQkJCSJzTmFtZSI6ICJzY3JvbGxpbmciCgkJCX0gKTsKCQkJCgkJCS8qIEluZmluaXRlIHNjcm9sbGluZyBldmVudCBoYW5kbGVycyAqLwoJCQlpZiAoIG9TZXR0aW5ncy5vU2Nyb2xsLmJJbmZpbml0ZSApCgkJCXsKCQkJCSQoblNjcm9sbEJvZHkpLnNjcm9sbCggZnVuY3Rpb24oKSB7CgkJCQkJLyogVXNlIGEgYmxvY2tlciB0byBzdG9wIHNjcm9sbGluZyBmcm9tIGxvYWRpbmcgbW9yZSBkYXRhIHdoaWxlIG90aGVyIGRhdGEgaXMgc3RpbGwgbG9hZGluZyAqLwoJCQkJCWlmICggIW9TZXR0aW5ncy5iRHJhd2luZyApCgkJCQkJewoJCQkJCQkvKiBDaGVjayBpZiB3ZSBzaG91bGQgbG9hZCB0aGUgbmV4dCBkYXRhIHNldCAqLwoJCQkJCQlpZiAoICQodGhpcykuc2Nyb2xsVG9wKCkgKyAkKHRoaXMpLmhlaWdodCgpID4gCgkJCQkJCQkkKG9TZXR0aW5ncy5uVGFibGUpLmhlaWdodCgpIC0gb1NldHRpbmdzLm9TY3JvbGwuaUxvYWRHYXAgKQoJCQkJCQl7CgkJCQkJCQkvKiBPbmx5IGRvIHRoZSByZWRyYXcgaWYgd2UgaGF2ZSB0byAtIHdlIG1pZ2h0IGJlIGF0IHRoZSBlbmQgb2YgdGhlIGRhdGEgKi8KCQkJCQkJCWlmICggb1NldHRpbmdzLmZuRGlzcGxheUVuZCgpIDwgb1NldHRpbmdzLmZuUmVjb3Jkc0Rpc3BsYXkoKSApCgkJCQkJCQl7CgkJCQkJCQkJX2ZuUGFnZUNoYW5nZSggb1NldHRpbmdzLCAnbmV4dCcgKTsKCQkJCQkJCQlfZm5DYWxjdWxhdGVFbmQoIG9TZXR0aW5ncyApOwoJCQkJCQkJCV9mbkRyYXcoIG9TZXR0aW5ncyApOwoJCQkJCQkJfQoJCQkJCQl9CgkJCQkJfQoJCQkJfSApOwoJCQl9CgkJCQoJCQlvU2V0dGluZ3MublNjcm9sbEhlYWQgPSBuU2Nyb2xsSGVhZDsKCQkJb1NldHRpbmdzLm5TY3JvbGxGb290ID0gblNjcm9sbEZvb3Q7CgkJCQoJCQlyZXR1cm4gblNjcm9sbGVyOwoJCX0KCQkKCQkvKgoJCSAqIEZ1bmN0aW9uOiBfZm5TY3JvbGxEcmF3CgkJICogUHVycG9zZTogIFVwZGF0ZSB0aGUgdmFyaW91cyB0YWJsZXMgZm9yIHJlc2l6aW5nCgkJICogUmV0dXJuczogIG5vZGU6IC0gTm9kZSB0byBhZGQgdG8gdGhlIERPTQoJCSAqIElucHV0czogICBvYmplY3Q6byAtIGRhdGFUYWJsZXMgc2V0dGluZ3Mgb2JqZWN0CgkJICogTm90ZXM6ICAgIEl0J3MgYSBiaXQgb2YgYSBwaWcgdGhpcyBmdW5jdGlvbiwgYnV0IGJhc2ljYWxseSB0aGUgaWRlYSB0bzoKCQkgKiAgIDEuIFJlLWNyZWF0ZSB0aGUgdGFibGUgaW5zaWRlIHRoZSBzY3JvbGxpbmcgZGl2CgkJICogICAyLiBUYWtlIGxpdmUgbWVhc3VyZW1lbnRzIGZyb20gdGhlIERPTQoJCSAqICAgMy4gQXBwbHkgdGhlIG1lYXN1cmVtZW50cwoJCSAqICAgNC4gQ2xlYW4gdXAKCQkgKi8KCQlmdW5jdGlvbiBfZm5TY3JvbGxEcmF3ICggbyApCgkJewoJCQl2YXIKCQkJCW5TY3JvbGxIZWFkSW5uZXIgPSBvLm5TY3JvbGxIZWFkLmdldEVsZW1lbnRzQnlUYWdOYW1lKCdkaXYnKVswXSwKCQkJCW5TY3JvbGxIZWFkVGFibGUgPSBuU2Nyb2xsSGVhZElubmVyLmdldEVsZW1lbnRzQnlUYWdOYW1lKCd0YWJsZScpWzBdLAoJCQkJblNjcm9sbEJvZHkgPSBvLm5UYWJsZS5wYXJlbnROb2RlLAoJCQkJaSwgaUxlbiwgaiwgakxlbiwgYW5IZWFkVG9TaXplLCBhbkhlYWRTaXplcnMsIGFuRm9vdFNpemVycywgYW5Gb290VG9TaXplLCBvU3R5bGUsIGlWaXMsCgkJCQlpV2lkdGgsIGFBcHBsaWVkPVtdLCBpU2FuaXR5V2lkdGg7CgkJCQoJCQkvKgoJCQkgKiAxLiBSZS1jcmVhdGUgdGhlIHRhYmxlIGluc2lkZSB0aGUgc2Nyb2xsaW5nIGRpdgoJCQkgKi8KCQkJCgkJCS8qIFJlbW92ZSB0aGUgb2xkIG1pbmltaXNlZCB0aGVhZCBhbmQgdGZvb3QgZWxlbWVudHMgaW4gdGhlIGlubmVyIHRhYmxlICovCgkJCXZhciBuVGhlYWRTaXplID0gby5uVGFibGUuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ3RoZWFkJyk7CgkJCWlmICggblRoZWFkU2l6ZS5sZW5ndGggPiAwICkKCQkJewoJCQkJby5uVGFibGUucmVtb3ZlQ2hpbGQoIG5UaGVhZFNpemVbMF0gKTsKCQkJfQoJCQkKCQkJaWYgKCBvLm5URm9vdCAhPT0gbnVsbCApCgkJCXsKCQkJCS8qIFJlbW92ZSB0aGUgb2xkIG1pbmltaXNlZCBmb290ZXIgZWxlbWVudCBpbiB0aGUgY2xvbmVkIGhlYWRlciAqLwoJCQkJdmFyIG5UZm9vdFNpemUgPSBvLm5UYWJsZS5nZXRFbGVtZW50c0J5VGFnTmFtZSgndGZvb3QnKTsKCQkJCWlmICggblRmb290U2l6ZS5sZW5ndGggPiAwICkKCQkJCXsKCQkJCQlvLm5UYWJsZS5yZW1vdmVDaGlsZCggblRmb290U2l6ZVswXSApOwoJCQkJfQoJCQl9CgkJCQoJCQkvKiBDbG9uZSB0aGUgY3VycmVudCBoZWFkZXIgYW5kIGZvb3RlciBlbGVtZW50cyBhbmQgdGhlbiBwbGFjZSBpdCBpbnRvIHRoZSBpbm5lciB0YWJsZSAqLwoJCQluVGhlYWRTaXplID0gby5uVEhlYWQuY2xvbmVOb2RlKHRydWUpOwoJCQlvLm5UYWJsZS5pbnNlcnRCZWZvcmUoIG5UaGVhZFNpemUsIG8ublRhYmxlLmNoaWxkTm9kZXNbMF0gKTsKCQkJCgkJCWlmICggby5uVEZvb3QgIT09IG51bGwgKQoJCQl7CgkJCQluVGZvb3RTaXplID0gby5uVEZvb3QuY2xvbmVOb2RlKHRydWUpOwoJCQkJby5uVGFibGUuaW5zZXJ0QmVmb3JlKCBuVGZvb3RTaXplLCBvLm5UYWJsZS5jaGlsZE5vZGVzWzFdICk7CgkJCX0KCQkJCgkJCS8qCgkJCSAqIDIuIFRha2UgbGl2ZSBtZWFzdXJlbWVudHMgZnJvbSB0aGUgRE9NIC0gZG8gbm90IGFsdGVyIHRoZSBET00gaXRzZWxmIQoJCQkgKi8KCQkJCgkJCS8qIFJlbW92ZSBvbGQgc2l6aW5nIGFuZCBhcHBseSB0aGUgY2FsY3VsYXRlZCBjb2x1bW4gd2lkdGhzCgkJCSAqIEdldCB0aGUgdW5pcXVlIGNvbHVtbiBoZWFkZXJzIGluIHRoZSBuZXdseSBjcmVhdGVkIChjbG9uZWQpIGhlYWRlci4gV2Ugd2FudCB0byBhcHBseSB0aGUKCQkJICogY2FsY2xhdGVkIHNpemVzIHRvIHRoaXMgaGVhZGVyCgkJCSAqLwoJCQl2YXIgblRocyA9IF9mbkdldFVuaXF1ZVRocyggblRoZWFkU2l6ZSApOwoJCQlmb3IgKCBpPTAsIGlMZW49blRocy5sZW5ndGggOyBpPGlMZW4gOyBpKysgKQoJCQl7CgkJCQlpVmlzID0gX2ZuVmlzaWJsZVRvQ29sdW1uSW5kZXgoIG8sIGkgKTsKCQkJCW5UaHNbaV0uc3R5bGUud2lkdGggPSBvLmFvQ29sdW1uc1tpVmlzXS5zV2lkdGg7CgkJCX0KCQkJCgkJCWlmICggby5uVEZvb3QgIT09IG51bGwgKQoJCQl7CgkJCQlfZm5BcHBseVRvQ2hpbGRyZW4oIGZ1bmN0aW9uKG4pIHsKCQkJCQluLnN0eWxlLndpZHRoID0gIiI7CgkJCQl9LCBuVGZvb3RTaXplLmdldEVsZW1lbnRzQnlUYWdOYW1lKCd0cicpICk7CgkJCX0KCQkJCgkJCS8qIFNpemUgdGhlIHRhYmxlIGFzIGEgd2hvbGUgKi8KCQkJaVNhbml0eVdpZHRoID0gJChvLm5UYWJsZSkub3V0ZXJXaWR0aCgpOwoJCQlpZiAoIG8ub1Njcm9sbC5zWCA9PT0gIiIgKQoJCQl7CgkJCQkvKiBObyB4IHNjcm9sbGluZyAqLwoJCQkJby5uVGFibGUuc3R5bGUud2lkdGggPSAiMTAwJSI7CgkJCQkKCQkJCS8qIEkga25vdyB0aGlzIGlzIHJ1YmJpc2ggLSBidXQgSUU3IHdpbGwgbWFrZSB0aGUgd2lkdGggb2YgdGhlIHRhYmxlIHdoZW4gMTAwJSBpbmNsdWRlCgkJCQkgKiB0aGUgc2Nyb2xsYmFyIC0gd2hpY2ggaXMgc2hvdWxkbid0LiBUaGlzIG5lZWRzIGZlYXR1cmUgZGV0ZWN0aW9uIGluIGZ1dHVyZSAtIHRvIGRvCgkJCQkgKi8KCQkJCWlmICggJC5icm93c2VyLm1zaWUgJiYgJC5icm93c2VyLnZlcnNpb24gPD0gNyApCgkJCQl7CgkJCQkJby5uVGFibGUuc3R5bGUud2lkdGggPSBfZm5TdHJpbmdUb0NzcyggJChvLm5UYWJsZSkub3V0ZXJXaWR0aCgpLW8ub1Njcm9sbC5pQmFyV2lkdGggKTsKCQkJCX0KCQkJfQoJCQllbHNlCgkJCXsKCQkJCWlmICggby5vU2Nyb2xsLnNYSW5uZXIgIT09ICIiICkKCQkJCXsKCQkJCQkvKiB4IHNjcm9sbCBpbm5lciBoYXMgYmVlbiBnaXZlbiAtIHVzZSBpdCAqLwoJCQkJCW8ublRhYmxlLnN0eWxlLndpZHRoID0gX2ZuU3RyaW5nVG9Dc3Moby5vU2Nyb2xsLnNYSW5uZXIpOwoJCQkJfQoJCQkJZWxzZSBpZiAoIGlTYW5pdHlXaWR0aCA9PSAkKG5TY3JvbGxCb2R5KS53aWR0aCgpICYmCgkJCQkgICAkKG5TY3JvbGxCb2R5KS5oZWlnaHQoKSA8ICQoby5uVGFibGUpLmhlaWdodCgpICkKCQkJCXsKCQkJCQkvKiBUaGVyZSBpcyB5LXNjcm9sbGluZyAtIHRyeSB0byB0YWtlIGFjY291bnQgb2YgdGhlIHkgc2Nyb2xsIGJhciAqLwoJCQkJCW8ublRhYmxlLnN0eWxlLndpZHRoID0gX2ZuU3RyaW5nVG9Dc3MoIGlTYW5pdHlXaWR0aC1vLm9TY3JvbGwuaUJhcldpZHRoICk7CgkJCQkJaWYgKCAkKG8ublRhYmxlKS5vdXRlcldpZHRoKCkgPiBpU2FuaXR5V2lkdGgtby5vU2Nyb2xsLmlCYXJXaWR0aCApCgkJCQkJewoJCQkJCQkvKiBOb3QgcG9zc2libGUgdG8gdGFrZSBhY2NvdW50IG9mIGl0ICovCgkJCQkJCW8ublRhYmxlLnN0eWxlLndpZHRoID0gX2ZuU3RyaW5nVG9Dc3MoIGlTYW5pdHlXaWR0aCApOwoJCQkJCX0KCQkJCX0KCQkJCWVsc2UKCQkJCXsKCQkJCQkvKiBBbGwgZWxzZSBmYWlscyAqLwoJCQkJCW8ublRhYmxlLnN0eWxlLndpZHRoID0gX2ZuU3RyaW5nVG9Dc3MoIGlTYW5pdHlXaWR0aCApOwoJCQkJfQoJCQl9CgkJCQoJCQkvKiBSZWNhbGN1bGF0ZSB0aGUgc2FuaXR5IHdpZHRoIC0gbm93IHRoYXQgd2UndmUgYXBwbGllZCB0aGUgcmVxdWlyZWQgd2lkdGgsIGJlZm9yZSBpdCB3YXMKCQkJICogYSB0ZW1wb3JhcnkgdmFyaWFibGUuIFRoaXMgaXMgcmVxdWlyZWQgYmVjYXVzZSB0aGUgY29sdW1uIHdpZHRoIGNhbGN1bGF0aW9uIGlzIGRvbmUKCQkJICogYmVmb3JlIHRoaXMgdGFibGUgRE9NIGlzIGNyZWF0ZWQuCgkJCSAqLwoJCQlpU2FuaXR5V2lkdGggPSAkKG8ublRhYmxlKS5vdXRlcldpZHRoKCk7CgkJCQoJCQkvKiBXZSB3YW50IHRoZSBoaWRkZW4gaGVhZGVyIHRvIGhhdmUgemVybyBoZWlnaHQsIHNvIHJlbW92ZSBwYWRkaW5nIGFuZCBib3JkZXJzLiBUaGVuCgkJCSAqIHNldCB0aGUgd2lkdGggYmFzZWQgb24gdGhlIHJlYWwgaGVhZGVycwoJCQkgKi8KCQkJYW5IZWFkVG9TaXplID0gby5uVEhlYWQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ3RyJyk7CgkJCWFuSGVhZFNpemVycyA9IG5UaGVhZFNpemUuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ3RyJyk7CgkJCQoJCQlfZm5BcHBseVRvQ2hpbGRyZW4oIGZ1bmN0aW9uKG5TaXplciwgblRvU2l6ZSkgewoJCQkJb1N0eWxlID0gblNpemVyLnN0eWxlOwoJCQkJb1N0eWxlLnBhZGRpbmdUb3AgPSAiMCI7CgkJCQlvU3R5bGUucGFkZGluZ0JvdHRvbSA9ICIwIjsKCQkJCW9TdHlsZS5ib3JkZXJUb3BXaWR0aCA9ICIwIjsKCQkJCW9TdHlsZS5ib3JkZXJCb3R0b21XaWR0aCA9ICIwIjsKCQkJCW9TdHlsZS5oZWlnaHQgPSAwOwoJCQkJCgkJCQlpV2lkdGggPSAkKG5TaXplcikud2lkdGgoKTsKCQkJCW5Ub1NpemUuc3R5bGUud2lkdGggPSBfZm5TdHJpbmdUb0NzcyggaVdpZHRoICk7CgkJCQlhQXBwbGllZC5wdXNoKCBpV2lkdGggKTsKCQkJfSwgYW5IZWFkU2l6ZXJzLCBhbkhlYWRUb1NpemUgKTsKCQkJJChhbkhlYWRTaXplcnMpLmhlaWdodCgwKTsKCQkJCgkJCWlmICggby5uVEZvb3QgIT09IG51bGwgKQoJCQl7CgkJCQkvKiBDbG9uZSB0aGUgY3VycmVudCBmb290ZXIgYW5kIHRoZW4gcGxhY2UgaXQgaW50byB0aGUgYm9keSB0YWJsZSBhcyBhICJoaWRkZW4gaGVhZGVyIiAqLwoJCQkJYW5Gb290U2l6ZXJzID0gblRmb290U2l6ZS5nZXRFbGVtZW50c0J5VGFnTmFtZSgndHInKTsKCQkJCWFuRm9vdFRvU2l6ZSA9IG8ublRGb290LmdldEVsZW1lbnRzQnlUYWdOYW1lKCd0cicpOwoJCQkJCgkJCQlfZm5BcHBseVRvQ2hpbGRyZW4oIGZ1bmN0aW9uKG5TaXplciwgblRvU2l6ZSkgewoJCQkJCW9TdHlsZSA9IG5TaXplci5zdHlsZTsKCQkJCQlvU3R5bGUucGFkZGluZ1RvcCA9ICIwIjsKCQkJCQlvU3R5bGUucGFkZGluZ0JvdHRvbSA9ICIwIjsKCQkJCQlvU3R5bGUuYm9yZGVyVG9wV2lkdGggPSAiMCI7CgkJCQkJb1N0eWxlLmJvcmRlckJvdHRvbVdpZHRoID0gIjAiOwoJCQkJCQoJCQkJCWlXaWR0aCA9ICQoblNpemVyKS53aWR0aCgpOwoJCQkJCW5Ub1NpemUuc3R5bGUud2lkdGggPSBfZm5TdHJpbmdUb0NzcyggaVdpZHRoICk7CgkJCQkJYUFwcGxpZWQucHVzaCggaVdpZHRoICk7CgkJCQl9LCBhbkZvb3RTaXplcnMsIGFuRm9vdFRvU2l6ZSApOwoJCQkJJChhbkZvb3RTaXplcnMpLmhlaWdodCgwKTsKCQkJfQoJCQkKCQkJLyoKCQkJICogMy4gQXBwbHkgdGhlIG1lYXN1cmVtZW50cwoJCQkgKi8KCQkJCgkJCS8qICJIaWRlIiB0aGUgaGVhZGVyIGFuZCBmb290ZXIgdGhhdCB3ZSB1c2VkIGZvciB0aGUgc2l6aW5nLiBXZSB3YW50IHRvIGFsc28gZml4IHRoZWlyIHdpZHRoCgkJCSAqIHRvIHdoYXQgdGhleSBjdXJyZW50bHkgYXJlCgkJCSAqLwoJCQlfZm5BcHBseVRvQ2hpbGRyZW4oIGZ1bmN0aW9uKG5TaXplcikgewoJCQkJblNpemVyLmlubmVySFRNTCA9ICIiOwoJCQkJblNpemVyLnN0eWxlLndpZHRoID0gX2ZuU3RyaW5nVG9Dc3MoIGFBcHBsaWVkLnNoaWZ0KCkgKTsKCQkJfSwgYW5IZWFkU2l6ZXJzICk7CgkJCQoJCQlpZiAoIG8ublRGb290ICE9PSBudWxsICkKCQkJewoJCQkJX2ZuQXBwbHlUb0NoaWxkcmVuKCBmdW5jdGlvbihuU2l6ZXIpIHsKCQkJCQluU2l6ZXIuaW5uZXJIVE1MID0gIiI7CgkJCQkJblNpemVyLnN0eWxlLndpZHRoID0gX2ZuU3RyaW5nVG9Dc3MoIGFBcHBsaWVkLnNoaWZ0KCkgKTsKCQkJCX0sIGFuRm9vdFNpemVycyApOwoJCQl9CgkJCQoJCQkvKiBTYW5pdHkgY2hlY2sgdGhhdCB0aGUgdGFibGUgaXMgb2YgYSBzZW5zaWJsZSB3aWR0aC4gSWYgbm90IHRoZW4gd2UgYXJlIGdvaW5nIHRvIGdldAoJCQkgKiBtaXNhbGlnbm1lbnQKCQkJICovCgkJCWlmICggJChvLm5UYWJsZSkub3V0ZXJXaWR0aCgpIDwgaVNhbml0eVdpZHRoICkKCQkJewoJCQkJaWYgKCBvLm9TY3JvbGwuc1ggPT09ICIiICkKCQkJCXsKCQkJCQlfZm5Mb2coIG8sIDEsICJUaGUgdGFibGUgY2Fubm90IGZpdCBpbnRvIHRoZSBjdXJyZW50IGVsZW1lbnQgd2hpY2ggd2lsbCBjYXVzZSBjb2x1bW4iKwoJCQkJCQkiIG1pc2FsaWdubWVudC4gSXQgaXMgc3VnZ2VzdGVkIHRoYXQgeW91IGVuYWJsZSB4LXNjcm9sbGluZyBvciBpbmNyZWFzZSB0aGUgd2lkdGgiKwoJCQkJCQkiIHRoZSB0YWJsZSBoYXMgaW4gd2hpY2ggdG8gYmUgZHJhd24iICk7CgkJCQl9CgkJCQllbHNlIGlmICggby5vU2Nyb2xsLnNYSW5uZXIgIT09ICIiICkKCQkJCXsKCQkJCQlfZm5Mb2coIG8sIDEsICJUaGUgdGFibGUgY2Fubm90IGZpdCBpbnRvIHRoZSBjdXJyZW50IGVsZW1lbnQgd2hpY2ggd2lsbCBjYXVzZSBjb2x1bW4iKwoJCQkJCQkiIG1pc2FsaWdubWVudC4gSXQgaXMgc3VnZ2VzdGVkIHRoYXQgeW91IGluY3JlYXNlIHRoZSBzU2Nyb2xsWElubmVyIHByb3BlcnR5IHRvIisKCQkJCQkJIiBhbGxvdyBpdCB0byBkcmF3IGluIGEgbGFyZ2VyIGFyZWEsIG9yIHNpbXBseSByZW1vdmUgdGhhdCBwYXJhbWV0ZXIgdG8gYWxsb3ciKwoJCQkJCQkiIGF1dG9tYXRpYyBjYWxjdWxhdGlvbiIgKTsKCQkJCX0KCQkJfQoJCQkKCQkJCgkJCS8qCgkJCSAqIDQuIENsZWFuIHVwCgkJCSAqLwoJCQkKCQkJaWYgKCBvLm9TY3JvbGwuc1kgPT09ICIiICkKCQkJewoJCQkJLyogSUU3PCBwdXRzIGEgdmVydGljYWwgc2Nyb2xsYmFyIGluIHBsYWNlICh3aGVuIGl0IHNob3VsZG4ndCBiZSkgZHVlIHRvIHN1YnRyYWN0aW5nCgkJCQkgKiB0aGUgc2Nyb2xsYmFyIGhlaWdodCBmcm9tIHRoZSB2aXNpYmxlIGRpc3BsYXksIHJhdGhlciB0aGFuIGFkZGluZyBpdCBvbi4gV2UgbmVlZCB0bwoJCQkJICogc2V0IHRoZSBoZWlnaHQgaW4gb3JkZXIgdG8gc29ydCB0aGlzLiBEb24ndCB3YW50IHRvIGRvIGl0IGluIGFueSBvdGhlciBicm93c2Vycy4KCQkJCSAqLwoJCQkJaWYgKCAkLmJyb3dzZXIubXNpZSAmJiAkLmJyb3dzZXIudmVyc2lvbiA8PSA3ICkKCQkJCXsKCQkJCQluU2Nyb2xsQm9keS5zdHlsZS5oZWlnaHQgPSBfZm5TdHJpbmdUb0Nzcyggby5uVGFibGUub2Zmc2V0SGVpZ2h0K28ub1Njcm9sbC5pQmFyV2lkdGggKTsKCQkJCX0KCQkJfQoJCQkKCQkJaWYgKCBvLm9TY3JvbGwuc1kgIT09ICIiICYmIG8ub1Njcm9sbC5iQ29sbGFwc2UgKQoJCQl7CgkJCQluU2Nyb2xsQm9keS5zdHlsZS5oZWlnaHQgPSBfZm5TdHJpbmdUb0Nzcyggby5vU2Nyb2xsLnNZICk7CgkJCQkKCQkJCXZhciBpRXh0cmEgPSAoby5vU2Nyb2xsLnNYICE9PSAiIiAmJiBvLm5UYWJsZS5vZmZzZXRXaWR0aCA+IG5TY3JvbGxCb2R5Lm9mZnNldFdpZHRoKSA/CgkJCQkgCW8ub1Njcm9sbC5pQmFyV2lkdGggOiAwOwoJCQkJaWYgKCBvLm5UYWJsZS5vZmZzZXRIZWlnaHQgPCBuU2Nyb2xsQm9keS5vZmZzZXRIZWlnaHQgKQoJCQkJewoJCQkJCW5TY3JvbGxCb2R5LnN0eWxlLmhlaWdodCA9IF9mblN0cmluZ1RvQ3NzKCAkKG8ublRhYmxlKS5oZWlnaHQoKStpRXh0cmEgKTsKCQkJCX0KCQkJfQoJCQkKCQkJLyogRmluYWxseSBzZXQgdGhlIHdpZHRoJ3Mgb2YgdGhlIGhlYWRlciBhbmQgZm9vdGVyIHRhYmxlcyAqLwoJCQl2YXIgaU91dGVyV2lkdGggPSAkKG8ublRhYmxlKS5vdXRlcldpZHRoKCk7CgkJCW5TY3JvbGxIZWFkVGFibGUuc3R5bGUud2lkdGggPSBfZm5TdHJpbmdUb0NzcyggaU91dGVyV2lkdGggKTsKCQkJblNjcm9sbEhlYWRJbm5lci5zdHlsZS53aWR0aCA9IF9mblN0cmluZ1RvQ3NzKCBpT3V0ZXJXaWR0aCtvLm9TY3JvbGwuaUJhcldpZHRoICk7CgkJCW5TY3JvbGxIZWFkSW5uZXIucGFyZW50Tm9kZS5zdHlsZS53aWR0aCA9IF9mblN0cmluZ1RvQ3NzKCAkKG5TY3JvbGxCb2R5KS53aWR0aCgpICk7CgkJCQoJCQlpZiAoIG8ublRGb290ICE9PSBudWxsICkKCQkJewoJCQkJdmFyCgkJCQkJblNjcm9sbEZvb3RJbm5lciA9IG8ublNjcm9sbEZvb3QuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ2RpdicpWzBdLAoJCQkJCW5TY3JvbGxGb290VGFibGUgPSBuU2Nyb2xsRm9vdElubmVyLmdldEVsZW1lbnRzQnlUYWdOYW1lKCd0YWJsZScpWzBdOwoJCQkJCgkJCQluU2Nyb2xsRm9vdElubmVyLnN0eWxlLndpZHRoID0gX2ZuU3RyaW5nVG9Dc3MoIG8ublRhYmxlLm9mZnNldFdpZHRoK28ub1Njcm9sbC5pQmFyV2lkdGggKTsKCQkJCW5TY3JvbGxGb290VGFibGUuc3R5bGUud2lkdGggPSBfZm5TdHJpbmdUb0Nzcyggby5uVGFibGUub2Zmc2V0V2lkdGggKTsKCQkJfQoJCQkKCQkJLyogSWYgc29ydGluZyBvciBmaWx0ZXJpbmcgaGFzIG9jY3VyZWQsIGp1bXAgdGhlIHNjcm9sbGluZyBiYWNrIHRvIHRoZSB0b3AgKi8KCQkJaWYgKCBvLmJTb3J0ZWQgfHwgby5iRmlsdGVyZWQgKQoJCQl7CgkJCQluU2Nyb2xsQm9keS5zY3JvbGxUb3AgPSAwOwoJCQl9CgkJfQoJCQoJCS8qCgkJICogRnVuY3Rpb246IF9mbkFqdXN0Q29sdW1uU2l6aW5nCgkJICogUHVycG9zZTogIEFqdXN0IHRoZSB0YWJsZSBjb2x1bW4gd2lkdGhzIGZvciBuZXcgZGF0YQoJCSAqIFJldHVybnM6ICAtCgkJICogSW5wdXRzOiAgIG9iamVjdDpvU2V0dGluZ3MgLSBkYXRhVGFibGVzIHNldHRpbmdzIG9iamVjdAoJCSAqIE5vdGVzOiAgICBZb3Ugd291bGQgcHJvYmFibHkgd2FudCB0byBkbyBhIHJlZHJhdyBhZnRlciBjYWxsaW5nIHRoaXMgZnVuY3Rpb24hCgkJICovCgkJZnVuY3Rpb24gX2ZuQWp1c3RDb2x1bW5TaXppbmcgKCBvU2V0dGluZ3MgKQoJCXsKCQkJLyogTm90IGludGVyZXN0ZWQgaW4gZG9pbmcgY29sdW1uIHdpZHRoIGNhbGN1bGF0aW9uIGlmIGF1dG93aWR0aCBpcyBkaXNhYmxlZCAqLwoJCQlpZiAoIG9TZXR0aW5ncy5vRmVhdHVyZXMuYkF1dG9XaWR0aCA9PT0gZmFsc2UgKQoJCQl7CgkJCQlyZXR1cm4gZmFsc2U7CgkJCX0KCQkJCgkJCV9mbkNhbGN1bGF0ZUNvbHVtbldpZHRocyggb1NldHRpbmdzICk7CgkJCWZvciAoIHZhciBpPTAgLCBpTGVuPW9TZXR0aW5ncy5hb0NvbHVtbnMubGVuZ3RoIDsgaTxpTGVuIDsgaSsrICkKCQkJewoJCQkJb1NldHRpbmdzLmFvQ29sdW1uc1tpXS5uVGguc3R5bGUud2lkdGggPSBvU2V0dGluZ3MuYW9Db2x1bW5zW2ldLnNXaWR0aDsKCQkJfQoJCX0KCQkKCQkKCQkvKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKgoJCSAqIFNlY3Rpb24gLSBGZWF0dXJlOiBGaWx0ZXJpbmcKCQkgKi8KCQkKCQkvKgoJCSAqIEZ1bmN0aW9uOiBfZm5GZWF0dXJlSHRtbEZpbHRlcgoJCSAqIFB1cnBvc2U6ICBHZW5lcmF0ZSB0aGUgbm9kZSByZXF1aXJlZCBmb3IgZmlsdGVyaW5nIHRleHQKCQkgKiBSZXR1cm5zOiAgbm9kZQoJCSAqIElucHV0czogICBvYmplY3Q6b1NldHRpbmdzIC0gZGF0YVRhYmxlcyBzZXR0aW5ncyBvYmplY3QKCQkgKi8KCQlmdW5jdGlvbiBfZm5GZWF0dXJlSHRtbEZpbHRlciAoIG9TZXR0aW5ncyApCgkJewoJCQl2YXIgbkZpbHRlciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoICdkaXYnICk7CgkJCWlmICggb1NldHRpbmdzLnNUYWJsZUlkICE9PSAnJyAmJiB0eXBlb2Ygb1NldHRpbmdzLmFhbkZlYXR1cmVzLmYgPT0gInVuZGVmaW5lZCIgKQoJCQl7CgkJCQluRmlsdGVyLnNldEF0dHJpYnV0ZSggJ2lkJywgb1NldHRpbmdzLnNUYWJsZUlkKydfZmlsdGVyJyApOwoJCQl9CgkJCW5GaWx0ZXIuY2xhc3NOYW1lID0gb1NldHRpbmdzLm9DbGFzc2VzLnNGaWx0ZXI7CgkJCXZhciBzU3BhY2UgPSBvU2V0dGluZ3Mub0xhbmd1YWdlLnNTZWFyY2g9PT0iIiA/ICIiIDogIiAiOwoJCQluRmlsdGVyLmlubmVySFRNTCA9IG9TZXR0aW5ncy5vTGFuZ3VhZ2Uuc1NlYXJjaCtzU3BhY2UrJzxpbnB1dCB0eXBlPSJ0ZXh0IiAvPic7CgkJCQoJCQl2YXIganFGaWx0ZXIgPSAkKCJpbnB1dCIsIG5GaWx0ZXIpOwoJCQlqcUZpbHRlci52YWwoIG9TZXR0aW5ncy5vUHJldmlvdXNTZWFyY2guc1NlYXJjaC5yZXBsYWNlKCciJywnJnF1b3Q7JykgKTsKCQkJanFGaWx0ZXIua2V5dXAoIGZ1bmN0aW9uKGUpIHsKCQkJCS8qIFVwZGF0ZSBhbGwgb3RoZXIgZmlsdGVyIGlucHV0IGVsZW1lbnRzIGZvciB0aGUgbmV3IGRpc3BsYXkgKi8KCQkJCXZhciBuID0gb1NldHRpbmdzLmFhbkZlYXR1cmVzLmY7CgkJCQlmb3IgKCB2YXIgaT0wLCBpTGVuPW4ubGVuZ3RoIDsgaTxpTGVuIDsgaSsrICkKCQkJCXsKCQkJCQlpZiAoIG5baV0gIT0gdGhpcy5wYXJlbnROb2RlICkKCQkJCQl7CgkJCQkJCSQoJ2lucHV0JywgbltpXSkudmFsKCB0aGlzLnZhbHVlICk7CgkJCQkJfQoJCQkJfQoJCQkJCgkJCQkvKiBOb3cgZG8gdGhlIGZpbHRlciAqLwoJCQkJaWYgKCB0aGlzLnZhbHVlICE9IG9TZXR0aW5ncy5vUHJldmlvdXNTZWFyY2guc1NlYXJjaCApCgkJCQl7CgkJCQkJX2ZuRmlsdGVyQ29tcGxldGUoIG9TZXR0aW5ncywgeyAKCQkJCQkJInNTZWFyY2giOiB0aGlzLnZhbHVlLCAKCQkJCQkJImJSZWdleCI6ICBvU2V0dGluZ3Mub1ByZXZpb3VzU2VhcmNoLmJSZWdleCwKCQkJCQkJImJTbWFydCI6ICBvU2V0dGluZ3Mub1ByZXZpb3VzU2VhcmNoLmJTbWFydCAKCQkJCQl9ICk7CgkJCQl9CgkJCX0gKTsKCQkJCgkJCWpxRmlsdGVyLmtleXByZXNzKCBmdW5jdGlvbihlKSB7CgkJCQkvKiBQcmV2ZW50IGRlZmF1bHQgKi8KCQkJCWlmICggZS5rZXlDb2RlID09IDEzICkKCQkJCXsKCQkJCQlyZXR1cm4gZmFsc2U7CgkJCQl9CgkJCX0gKTsKCQkJCgkJCXJldHVybiBuRmlsdGVyOwoJCX0KCQkKCQkvKgoJCSAqIEZ1bmN0aW9uOiBfZm5GaWx0ZXJDb21wbGV0ZQoJCSAqIFB1cnBvc2U6ICBGaWx0ZXIgdGhlIHRhYmxlIHVzaW5nIGJvdGggdGhlIGdsb2JhbCBmaWx0ZXIgYW5kIGNvbHVtbiBiYXNlZCBmaWx0ZXJpbmcKCQkgKiBSZXR1cm5zOiAgLQoJCSAqIElucHV0czogICBvYmplY3Q6b1NldHRpbmdzIC0gZGF0YVRhYmxlcyBzZXR0aW5ncyBvYmplY3QKCQkgKiAgICAgICAgICAgb2JqZWN0Om9TZWFyY2g6IHNlYXJjaCBpbmZvcm1hdGlvbgoJCSAqICAgICAgICAgICBpbnQ6aUZvcmNlIC0gb3B0aW9uYWwgLSBmb3JjZSBhIHJlc2VhcmNoIG9mIHRoZSBtYXN0ZXIgYXJyYXkgKDEpIG9yIG5vdCAodW5kZWZpbmVkIG9yIDApCgkJICovCgkJZnVuY3Rpb24gX2ZuRmlsdGVyQ29tcGxldGUgKCBvU2V0dGluZ3MsIG9JbnB1dCwgaUZvcmNlICkKCQl7CgkJCS8qIEZpbHRlciBvbiBldmVyeXRoaW5nICovCgkJCV9mbkZpbHRlciggb1NldHRpbmdzLCBvSW5wdXQuc1NlYXJjaCwgaUZvcmNlLCBvSW5wdXQuYlJlZ2V4LCBvSW5wdXQuYlNtYXJ0ICk7CgkJCQoJCQkvKiBOb3cgZG8gdGhlIGluZGl2aWR1YWwgY29sdW1uIGZpbHRlciAqLwoJCQlmb3IgKCB2YXIgaT0wIDsgaTxvU2V0dGluZ3MuYW9QcmVTZWFyY2hDb2xzLmxlbmd0aCA7IGkrKyApCgkJCXsKCQkJCV9mbkZpbHRlckNvbHVtbiggb1NldHRpbmdzLCBvU2V0dGluZ3MuYW9QcmVTZWFyY2hDb2xzW2ldLnNTZWFyY2gsIGksIAoJCQkJCW9TZXR0aW5ncy5hb1ByZVNlYXJjaENvbHNbaV0uYlJlZ2V4LCBvU2V0dGluZ3MuYW9QcmVTZWFyY2hDb2xzW2ldLmJTbWFydCApOwoJCQl9CgkJCQoJCQkvKiBDdXN0b20gZmlsdGVyaW5nICovCgkJCWlmICggX29FeHQuYWZuRmlsdGVyaW5nLmxlbmd0aCAhPT0gMCApCgkJCXsKCQkJCV9mbkZpbHRlckN1c3RvbSggb1NldHRpbmdzICk7CgkJCX0KCQkJCgkJCS8qIFRlbGwgdGhlIGRyYXcgZnVuY3Rpb24gd2UgaGF2ZSBiZWVuIGZpbHRlcmluZyAqLwoJCQlvU2V0dGluZ3MuYkZpbHRlcmVkID0gdHJ1ZTsKCQkJCgkJCS8qIFJlZHJhdyB0aGUgdGFibGUgKi8KCQkJb1NldHRpbmdzLl9pRGlzcGxheVN0YXJ0ID0gMDsKCQkJX2ZuQ2FsY3VsYXRlRW5kKCBvU2V0dGluZ3MgKTsKCQkJX2ZuRHJhdyggb1NldHRpbmdzICk7CgkJCQoJCQkvKiBSZWJ1aWxkIHNlYXJjaCBhcnJheSAnb2ZmbGluZScgKi8KCQkJX2ZuQnVpbGRTZWFyY2hBcnJheSggb1NldHRpbmdzLCAwICk7CgkJfQoJCQoJCS8qCgkJICogRnVuY3Rpb246IF9mbkZpbHRlckN1c3RvbQoJCSAqIFB1cnBvc2U6ICBBcHBseSBjdXN0b20gZmlsdGVyaW5nIGZ1bmN0aW9ucwoJCSAqIFJldHVybnM6ICAtCgkJICogSW5wdXRzOiAgIG9iamVjdDpvU2V0dGluZ3MgLSBkYXRhVGFibGVzIHNldHRpbmdzIG9iamVjdAoJCSAqLwoJCWZ1bmN0aW9uIF9mbkZpbHRlckN1c3RvbSggb1NldHRpbmdzICkKCQl7CgkJCXZhciBhZm5GaWx0ZXJzID0gX29FeHQuYWZuRmlsdGVyaW5nOwoJCQlmb3IgKCB2YXIgaT0wLCBpTGVuPWFmbkZpbHRlcnMubGVuZ3RoIDsgaTxpTGVuIDsgaSsrICkKCQkJewoJCQkJdmFyIGlDb3JyZWN0b3IgPSAwOwoJCQkJZm9yICggdmFyIGo9MCwgakxlbj1vU2V0dGluZ3MuYWlEaXNwbGF5Lmxlbmd0aCA7IGo8akxlbiA7IGorKyApCgkJCQl7CgkJCQkJdmFyIGlEaXNJbmRleCA9IG9TZXR0aW5ncy5haURpc3BsYXlbai1pQ29ycmVjdG9yXTsKCQkJCQkKCQkJCQkvKiBDaGVjayBpZiB3ZSBzaG91bGQgdXNlIHRoaXMgcm93IGJhc2VkIG9uIHRoZSBmaWx0ZXJpbmcgZnVuY3Rpb24gKi8KCQkJCQlpZiAoICFhZm5GaWx0ZXJzW2ldKCBvU2V0dGluZ3MsIG9TZXR0aW5ncy5hb0RhdGFbaURpc0luZGV4XS5fYURhdGEsIGlEaXNJbmRleCApICkKCQkJCQl7CgkJCQkJCW9TZXR0aW5ncy5haURpc3BsYXkuc3BsaWNlKCBqLWlDb3JyZWN0b3IsIDEgKTsKCQkJCQkJaUNvcnJlY3RvcisrOwoJCQkJCX0KCQkJCX0KCQkJfQoJCX0KCQkKCQkvKgoJCSAqIEZ1bmN0aW9uOiBfZm5GaWx0ZXJDb2x1bW4KCQkgKiBQdXJwb3NlOiAgRmlsdGVyIHRoZSB0YWJsZSBvbiBhIHBlci1jb2x1bW4gYmFzaXMKCQkgKiBSZXR1cm5zOiAgLQoJCSAqIElucHV0czogICBvYmplY3Q6b1NldHRpbmdzIC0gZGF0YVRhYmxlcyBzZXR0aW5ncyBvYmplY3QKCQkgKiAgICAgICAgICAgc3RyaW5nOnNJbnB1dCAtIHN0cmluZyB0byBmaWx0ZXIgb24KCQkgKiAgICAgICAgICAgaW50OmlDb2x1bW4gLSBjb2x1bW4gdG8gZmlsdGVyCgkJICogICAgICAgICAgIGJvb2w6YlJlZ2V4IC0gdHJlYXQgc2VhcmNoIHN0cmluZyBhcyBhIHJlZ3VsYXIgZXhwcmVzc2lvbiBvciBub3QKCQkgKiAgICAgICAgICAgYm9vbDpiU21hcnQgLSB1c2Ugc21hcnQgZmlsdGVyaW5nIG9yIG5vdAoJCSAqLwoJCWZ1bmN0aW9uIF9mbkZpbHRlckNvbHVtbiAoIG9TZXR0aW5ncywgc0lucHV0LCBpQ29sdW1uLCBiUmVnZXgsIGJTbWFydCApCgkJewoJCQlpZiAoIHNJbnB1dCA9PT0gIiIgKQoJCQl7CgkJCQlyZXR1cm47CgkJCX0KCQkJCgkJCXZhciBpSW5kZXhDb3JyZWN0b3IgPSAwOwoJCQl2YXIgcnBTZWFyY2ggPSBfZm5GaWx0ZXJDcmVhdGVTZWFyY2goIHNJbnB1dCwgYlJlZ2V4LCBiU21hcnQgKTsKCQkJCgkJCWZvciAoIHZhciBpPW9TZXR0aW5ncy5haURpc3BsYXkubGVuZ3RoLTEgOyBpPj0wIDsgaS0tICkKCQkJewoJCQkJdmFyIHNEYXRhID0gX2ZuRGF0YVRvU2VhcmNoKCBvU2V0dGluZ3MuYW9EYXRhWyBvU2V0dGluZ3MuYWlEaXNwbGF5W2ldIF0uX2FEYXRhW2lDb2x1bW5dLAoJCQkJCW9TZXR0aW5ncy5hb0NvbHVtbnNbaUNvbHVtbl0uc1R5cGUgKTsKCQkJCWlmICggISBycFNlYXJjaC50ZXN0KCBzRGF0YSApICkKCQkJCXsKCQkJCQlvU2V0dGluZ3MuYWlEaXNwbGF5LnNwbGljZSggaSwgMSApOwoJCQkJCWlJbmRleENvcnJlY3RvcisrOwoJCQkJfQoJCQl9CgkJfQoJCQoJCS8qCgkJICogRnVuY3Rpb246IF9mbkZpbHRlcgoJCSAqIFB1cnBvc2U6ICBGaWx0ZXIgdGhlIGRhdGEgdGFibGUgYmFzZWQgb24gdXNlciBpbnB1dCBhbmQgZHJhdyB0aGUgdGFibGUKCQkgKiBSZXR1cm5zOiAgLQoJCSAqIElucHV0czogICBvYmplY3Q6b1NldHRpbmdzIC0gZGF0YVRhYmxlcyBzZXR0aW5ncyBvYmplY3QKCQkgKiAgICAgICAgICAgc3RyaW5nOnNJbnB1dCAtIHN0cmluZyB0byBmaWx0ZXIgb24KCQkgKiAgICAgICAgICAgaW50OmlGb3JjZSAtIG9wdGlvbmFsIC0gZm9yY2UgYSByZXNlYXJjaCBvZiB0aGUgbWFzdGVyIGFycmF5ICgxKSBvciBub3QgKHVuZGVmaW5lZCBvciAwKQoJCSAqICAgICAgICAgICBib29sOmJSZWdleCAtIHRyZWF0IGFzIGEgcmVndWxhciBleHByZXNzaW9uIG9yIG5vdAoJCSAqICAgICAgICAgICBib29sOmJTbWFydCAtIHBlcmZvcm0gc21hcnQgZmlsdGVyaW5nIG9yIG5vdAoJCSAqLwoJCWZ1bmN0aW9uIF9mbkZpbHRlciggb1NldHRpbmdzLCBzSW5wdXQsIGlGb3JjZSwgYlJlZ2V4LCBiU21hcnQgKQoJCXsKCQkJdmFyIGk7CgkJCXZhciBycFNlYXJjaCA9IF9mbkZpbHRlckNyZWF0ZVNlYXJjaCggc0lucHV0LCBiUmVnZXgsIGJTbWFydCApOwoJCQkKCQkJLyogQ2hlY2sgaWYgd2UgYXJlIGZvcmNpbmcgb3Igbm90IC0gb3B0aW9uYWwgcGFyYW1ldGVyICovCgkJCWlmICggdHlwZW9mIGlGb3JjZSA9PSAndW5kZWZpbmVkJyB8fCBpRm9yY2UgPT09IG51bGwgKQoJCQl7CgkJCQlpRm9yY2UgPSAwOwoJCQl9CgkJCQoJCQkvKiBOZWVkIHRvIHRha2UgYWNjb3VudCBvZiBjdXN0b20gZmlsdGVyaW5nIGZ1bmN0aW9ucyAtIGFsd2F5cyBmaWx0ZXIgKi8KCQkJaWYgKCBfb0V4dC5hZm5GaWx0ZXJpbmcubGVuZ3RoICE9PSAwICkKCQkJewoJCQkJaUZvcmNlID0gMTsKCQkJfQoJCQkKCQkJLyoKCQkJICogSWYgdGhlIGlucHV0IGlzIGJsYW5rIC0gd2Ugd2FudCB0aGUgZnVsbCBkYXRhIHNldAoJCQkgKi8KCQkJaWYgKCBzSW5wdXQubGVuZ3RoIDw9IDAgKQoJCQl7CgkJCQlvU2V0dGluZ3MuYWlEaXNwbGF5LnNwbGljZSggMCwgb1NldHRpbmdzLmFpRGlzcGxheS5sZW5ndGgpOwoJCQkJb1NldHRpbmdzLmFpRGlzcGxheSA9IG9TZXR0aW5ncy5haURpc3BsYXlNYXN0ZXIuc2xpY2UoKTsKCQkJfQoJCQllbHNlCgkJCXsKCQkJCS8qCgkJCQkgKiBXZSBhcmUgc3RhcnRpbmcgYSBuZXcgc2VhcmNoIG9yIHRoZSBuZXcgc2VhcmNoIHN0cmluZyBpcyBzbWFsbGVyIAoJCQkJICogdGhlbiB0aGUgb2xkIG9uZSAoaS5lLiBkZWxldGUpLiBTZWFyY2ggZnJvbSB0aGUgbWFzdGVyIGFycmF5CgkJCSAJICovCgkJCQlpZiAoIG9TZXR0aW5ncy5haURpc3BsYXkubGVuZ3RoID09IG9TZXR0aW5ncy5haURpc3BsYXlNYXN0ZXIubGVuZ3RoIHx8CgkJCQkJICAgb1NldHRpbmdzLm9QcmV2aW91c1NlYXJjaC5zU2VhcmNoLmxlbmd0aCA+IHNJbnB1dC5sZW5ndGggfHwgaUZvcmNlID09IDEgfHwKCQkJCQkgICBzSW5wdXQuaW5kZXhPZihvU2V0dGluZ3Mub1ByZXZpb3VzU2VhcmNoLnNTZWFyY2gpICE9PSAwICkKCQkJCXsKCQkJCQkvKiBOdWtlIHRoZSBvbGQgZGlzcGxheSBhcnJheSAtIHdlIGFyZSBnb2luZyB0byByZWJ1aWxkIGl0ICovCgkJCQkJb1NldHRpbmdzLmFpRGlzcGxheS5zcGxpY2UoIDAsIG9TZXR0aW5ncy5haURpc3BsYXkubGVuZ3RoKTsKCQkJCQkKCQkJCQkvKiBGb3JjZSBhIHJlYnVpbGQgb2YgdGhlIHNlYXJjaCBhcnJheSAqLwoJCQkJCV9mbkJ1aWxkU2VhcmNoQXJyYXkoIG9TZXR0aW5ncywgMSApOwoJCQkJCQoJCQkJCS8qIFNlYXJjaCB0aHJvdWdoIGFsbCByZWNvcmRzIHRvIHBvcHVsYXRlIHRoZSBzZWFyY2ggYXJyYXkKCQkJCQkgKiBUaGUgdGhlIG9TZXR0aW5ncy5haURpc3BsYXlNYXN0ZXIgYW5kIGFzRGF0YVNlYXJjaCBhcnJheXMgaGF2ZSAxIHRvIDEgCgkJCQkJICogbWFwcGluZwoJCQkJCSAqLwoJCQkJCWZvciAoIGk9MCA7IGk8b1NldHRpbmdzLmFpRGlzcGxheU1hc3Rlci5sZW5ndGggOyBpKysgKQoJCQkJCXsKCQkJCQkJaWYgKCBycFNlYXJjaC50ZXN0KG9TZXR0aW5ncy5hc0RhdGFTZWFyY2hbaV0pICkKCQkJCQkJewoJCQkJCQkJb1NldHRpbmdzLmFpRGlzcGxheS5wdXNoKCBvU2V0dGluZ3MuYWlEaXNwbGF5TWFzdGVyW2ldICk7CgkJCQkJCX0KCQkJCQl9CgkJCSAgfQoJCQkgIGVsc2UKCQkJCXsKCQkJICAJLyogVXNpbmcgb2xkIHNlYXJjaCBhcnJheSAtIHJlZmluZSBpdCAtIGRvIGl0IHRoaXMgd2F5IGZvciBzcGVlZAoJCQkgIAkgKiBEb24ndCBoYXZlIHRvIHNlYXJjaCB0aGUgd2hvbGUgbWFzdGVyIGFycmF5IGFnYWluCgkJCSAJCSAqLwoJCQkgIAl2YXIgaUluZGV4Q29ycmVjdG9yID0gMDsKCQkJICAJCgkJCSAgCS8qIFNlYXJjaCB0aGUgY3VycmVudCByZXN1bHRzICovCgkJCSAgCWZvciAoIGk9MCA7IGk8b1NldHRpbmdzLmFzRGF0YVNlYXJjaC5sZW5ndGggOyBpKysgKQoJCQkJCXsKCQkJICAJCWlmICggISBycFNlYXJjaC50ZXN0KG9TZXR0aW5ncy5hc0RhdGFTZWFyY2hbaV0pICkKCQkJCQkJewoJCQkgIAkJCW9TZXR0aW5ncy5haURpc3BsYXkuc3BsaWNlKCBpLWlJbmRleENvcnJlY3RvciwgMSApOwoJCQkgIAkJCWlJbmRleENvcnJlY3RvcisrOwoJCQkgIAkJfQoJCQkgIAl9CgkJCSAgfQoJCQl9CgkJCW9TZXR0aW5ncy5vUHJldmlvdXNTZWFyY2guc1NlYXJjaCA9IHNJbnB1dDsKCQkJb1NldHRpbmdzLm9QcmV2aW91c1NlYXJjaC5iUmVnZXggPSBiUmVnZXg7CgkJCW9TZXR0aW5ncy5vUHJldmlvdXNTZWFyY2guYlNtYXJ0ID0gYlNtYXJ0OwoJCX0KCQkKCQkvKgoJCSAqIEZ1bmN0aW9uOiBfZm5CdWlsZFNlYXJjaEFycmF5CgkJICogUHVycG9zZTogIENyZWF0ZSBhbiBhcnJheSB3aGljaCBjYW4gYmUgcXVpY2tseSBzZWFyY2ggdGhyb3VnaAoJCSAqIFJldHVybnM6ICAtCgkJICogSW5wdXRzOiAgIG9iamVjdDpvU2V0dGluZ3MgLSBkYXRhVGFibGVzIHNldHRpbmdzIG9iamVjdAoJCSAqICAgICAgICAgICBpbnQ6aU1hc3RlciAtIHVzZSB0aGUgbWFzdGVyIGRhdGEgYXJyYXkgLSBvcHRpb25hbAoJCSAqLwoJCWZ1bmN0aW9uIF9mbkJ1aWxkU2VhcmNoQXJyYXkgKCBvU2V0dGluZ3MsIGlNYXN0ZXIgKQoJCXsKCQkJLyogQ2xlYXIgb3V0IHRoZSBvbGQgZGF0YSAqLwoJCQlvU2V0dGluZ3MuYXNEYXRhU2VhcmNoLnNwbGljZSggMCwgb1NldHRpbmdzLmFzRGF0YVNlYXJjaC5sZW5ndGggKTsKCQkJCgkJCXZhciBhQXJyYXkgPSAodHlwZW9mIGlNYXN0ZXIgIT0gJ3VuZGVmaW5lZCcgJiYgaU1hc3RlciA9PSAxKSA/CgkJCSAJb1NldHRpbmdzLmFpRGlzcGxheU1hc3RlciA6IG9TZXR0aW5ncy5haURpc3BsYXk7CgkJCQoJCQlmb3IgKCB2YXIgaT0wLCBpTGVuPWFBcnJheS5sZW5ndGggOyBpPGlMZW4gOyBpKysgKQoJCQl7CgkJCQlvU2V0dGluZ3MuYXNEYXRhU2VhcmNoW2ldID0gX2ZuQnVpbGRTZWFyY2hSb3coIG9TZXR0aW5ncywgCgkJCQkJb1NldHRpbmdzLmFvRGF0YVsgYUFycmF5W2ldIF0uX2FEYXRhICk7CgkJCX0KCQl9CgkJCgkJLyoKCQkgKiBGdW5jdGlvbjogX2ZuQnVpbGRTZWFyY2hSb3cKCQkgKiBQdXJwb3NlOiAgQ3JlYXRlIGEgc2VhcmNoYWJsZSBzdHJpbmcgZnJvbSBhIHNpbmdsZSBkYXRhIHJvdwoJCSAqIFJldHVybnM6ICAtCgkJICogSW5wdXRzOiAgIG9iamVjdDpvU2V0dGluZ3MgLSBkYXRhVGFibGVzIHNldHRpbmdzIG9iamVjdAoJCSAqICAgICAgICAgICBhcnJheTphRGF0YSAtIGFvRGF0YVtdLl9hRGF0YSBhcnJheSB0byB1c2UgZm9yIHRoZSBkYXRhIHRvIHNlYXJjaAoJCSAqLwoJCWZ1bmN0aW9uIF9mbkJ1aWxkU2VhcmNoUm93KCBvU2V0dGluZ3MsIGFEYXRhICkKCQl7CgkJCXZhciBzU2VhcmNoID0gJyc7CgkJCXZhciBuVG1wID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7CgkJCQoJCQlmb3IgKCB2YXIgaj0wLCBqTGVuPW9TZXR0aW5ncy5hb0NvbHVtbnMubGVuZ3RoIDsgajxqTGVuIDsgaisrICkKCQkJewoJCQkJaWYgKCBvU2V0dGluZ3MuYW9Db2x1bW5zW2pdLmJTZWFyY2hhYmxlICkKCQkJCXsKCQkJCQl2YXIgc0RhdGEgPSBhRGF0YVtqXTsKCQkJCQlzU2VhcmNoICs9IF9mbkRhdGFUb1NlYXJjaCggc0RhdGEsIG9TZXR0aW5ncy5hb0NvbHVtbnNbal0uc1R5cGUgKSsnICAnOwoJCQkJfQoJCQl9CgkJCQoJCQkvKiBJZiBpdCBsb29rcyBsaWtlIHRoZXJlIGlzIGFuIEhUTUwgZW50aXR5IGluIHRoZSBzdHJpbmcsIGF0dGVtcHQgdG8gZGVjb2RlIGl0ICovCgkJCWlmICggc1NlYXJjaC5pbmRleE9mKCcmJykgIT09IC0xICkKCQkJewoJCQkJblRtcC5pbm5lckhUTUwgPSBzU2VhcmNoOwoJCQkJc1NlYXJjaCA9IG5UbXAudGV4dENvbnRlbnQgPyBuVG1wLnRleHRDb250ZW50IDogblRtcC5pbm5lclRleHQ7CgkJCQkKCQkJCS8qIElFIGFuZCBPcGVyYSBhcHBlYXIgdG8gcHV0IGFuIG5ld2xpbmUgd2hlcmUgdGhlcmUgaXMgYSA8YnI+IHRhZyAtIHJlbW92ZSBpdCAqLwoJCQkJc1NlYXJjaCA9IHNTZWFyY2gucmVwbGFjZSgvXG4vZywiICIpLnJlcGxhY2UoL1xyL2csIiIpOwoJCQl9CgkJCQoJCQlyZXR1cm4gc1NlYXJjaDsKCQl9CgkJCgkJLyoKCQkgKiBGdW5jdGlvbjogX2ZuRmlsdGVyQ3JlYXRlU2VhcmNoCgkJICogUHVycG9zZTogIEJ1aWxkIGEgcmVndWxhciBleHByZXNzaW9uIG9iamVjdCBzdWl0YWJsZSBmb3Igc2VhcmNoaW5nIGEgdGFibGUKCQkgKiBSZXR1cm5zOiAgUmVnRXhwOiAtIGNvbnN0cnVjdGVkIG9iamVjdAoJCSAqIElucHV0czogICBzdHJpbmc6c1NlYXJjaCAtIHN0cmluZyB0byBzZWFyY2ggZm9yCgkJICogICAgICAgICAgIGJvb2w6YlJlZ2V4IC0gdHJlYXQgYXMgYSByZWd1bGFyIGV4cHJlc3Npb24gb3Igbm90CgkJICogICAgICAgICAgIGJvb2w6YlNtYXJ0IC0gcGVyZm9ybSBzbWFydCBmaWx0ZXJpbmcgb3Igbm90CgkJICovCgkJZnVuY3Rpb24gX2ZuRmlsdGVyQ3JlYXRlU2VhcmNoKCBzU2VhcmNoLCBiUmVnZXgsIGJTbWFydCApCgkJewoJCQl2YXIgYXNTZWFyY2gsIHNSZWdFeHBTdHJpbmc7CgkJCQoJCQlpZiAoIGJTbWFydCApCgkJCXsKCQkJCS8qIEdlbmVyYXRlIHRoZSByZWd1bGFyIGV4cHJlc3Npb24gdG8gdXNlLiBTb21ldGhpbmcgYWxvbmcgdGhlIGxpbmVzIG9mOgoJCQkJICogXig/PS4qP1xib25lXGIpKD89Lio/XGJ0d29cYikoPz0uKj9cYnRocmVlXGIpLiokCgkJCQkgKi8KCQkJCWFzU2VhcmNoID0gYlJlZ2V4ID8gc1NlYXJjaC5zcGxpdCggJyAnICkgOiBfZm5Fc2NhcGVSZWdleCggc1NlYXJjaCApLnNwbGl0KCAnICcgKTsKCQkJCXNSZWdFeHBTdHJpbmcgPSAnXig/PS4qPycrYXNTZWFyY2guam9pbiggJykoPz0uKj8nICkrJykuKiQnOwoJCQkJcmV0dXJuIG5ldyBSZWdFeHAoIHNSZWdFeHBTdHJpbmcsICJpIiApOwoJCQl9CgkJCWVsc2UKCQkJewoJCQkJc1NlYXJjaCA9IGJSZWdleCA/IHNTZWFyY2ggOiBfZm5Fc2NhcGVSZWdleCggc1NlYXJjaCApOwoJCQkJcmV0dXJuIG5ldyBSZWdFeHAoIHNTZWFyY2gsICJpIiApOwoJCQl9CgkJfQoJCQoJCS8qCgkJICogRnVuY3Rpb246IF9mbkRhdGFUb1NlYXJjaAoJCSAqIFB1cnBvc2U6ICBDb252ZXJ0IHJhdyBkYXRhIGludG8gc29tZXRoaW5nIHRoYXQgdGhlIHVzZXIgY2FuIHNlYXJjaCBvbgoJCSAqIFJldHVybnM6ICBzdHJpbmc6IC0gc2VhcmNoIHN0cmluZwoJCSAqIElucHV0czogICBzdHJpbmc6c0RhdGEgLSBkYXRhIHRvIGJlIG1vZGlmaWVkCgkJICogICAgICAgICAgIHN0cmluZzpzVHlwZSAtIGRhdGEgdHlwZQoJCSAqLwoJCWZ1bmN0aW9uIF9mbkRhdGFUb1NlYXJjaCAoIHNEYXRhLCBzVHlwZSApCgkJewoJCQlpZiAoIHR5cGVvZiBfb0V4dC5vZm5TZWFyY2hbc1R5cGVdID09ICJmdW5jdGlvbiIgKQoJCQl7CgkJCQlyZXR1cm4gX29FeHQub2ZuU2VhcmNoW3NUeXBlXSggc0RhdGEgKTsKCQkJfQoJCQllbHNlIGlmICggc1R5cGUgPT0gImh0bWwiICkKCQkJewoJCQkJcmV0dXJuIHNEYXRhLnJlcGxhY2UoL1xuL2csIiAiKS5yZXBsYWNlKCAvPC4qPz4vZywgIiIgKTsKCQkJfQoJCQllbHNlIGlmICggdHlwZW9mIHNEYXRhID09ICJzdHJpbmciICkKCQkJewoJCQkJcmV0dXJuIHNEYXRhLnJlcGxhY2UoL1xuL2csIiAiKTsKCQkJfQoJCQlyZXR1cm4gc0RhdGE7CgkJfQoJCQoJCQoJCS8qICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICoKCQkgKiBTZWN0aW9uIC0gRmVhdHVyZTogU29ydGluZwoJCSAqLwoJCQoJCS8qCgkgCSAqIEZ1bmN0aW9uOiBfZm5Tb3J0CgkJICogUHVycG9zZTogIENoYW5nZSB0aGUgb3JkZXIgb2YgdGhlIHRhYmxlCgkJICogUmV0dXJuczogIC0KCQkgKiBJbnB1dHM6ICAgb2JqZWN0Om9TZXR0aW5ncyAtIGRhdGFUYWJsZXMgc2V0dGluZ3Mgb2JqZWN0CgkJICogICAgICAgICAgIGJvb2w6YkFwcGx5Q2xhc3NlcyAtIG9wdGlvbmFsIC0gc2hvdWxkIHdlIGFwcGx5IGNsYXNzZXMgb3Igbm90CgkJICogTm90ZXM6ICAgIFdlIGFsd2F5cyBzb3J0IHRoZSBtYXN0ZXIgYXJyYXkgYW5kIHRoZW4gYXBwbHkgYSBmaWx0ZXIgYWdhaW4KCQkgKiAgIGlmIGl0IGlzIG5lZWRlZC4gVGhpcyBwcm9iYWJseSBpc24ndCBvcHRpbWFsIC0gYnV0IGF0bSBJIGNhbid0IHRoaW5rCgkJICogICBvZiBhbnkgb3RoZXIgd2F5IHdoaWNoIGlzIChlYWNoIGhhcyBkaXNhZHZhbnRhZ2VzKS4gd2Ugd2FudCB0byBzb3J0IGFpRGlzcGxheU1hc3RlciAtIAoJCSAqICAgYnV0IGFjY29yZGluZyB0byBhb0RhdGFbXS5fYURhdGEKCQkgKi8KCQlmdW5jdGlvbiBfZm5Tb3J0ICggb1NldHRpbmdzLCBiQXBwbHlDbGFzc2VzICkKCQl7CgkJCXZhciBhYVNvcnQgPSBbXTsKCQkJdmFyIG9Tb3J0ID0gX29FeHQub1NvcnQ7CgkJCXZhciBhb0RhdGEgPSBvU2V0dGluZ3MuYW9EYXRhOwoJCQl2YXIgaURhdGFTb3J0OwoJCQl2YXIgaURhdGFUeXBlOwoJCQl2YXIgaSwgaiwgakxlbjsKCQkJCgkJCS8qIE5vIHNvcnRpbmcgcmVxdWlyZWQgaWYgc2VydmVyLXNpZGUgb3Igbm8gc29ydGluZyBhcnJheSAqLwoJCQlpZiAoICFvU2V0dGluZ3Mub0ZlYXR1cmVzLmJTZXJ2ZXJTaWRlICYmIAoJCQkJKG9TZXR0aW5ncy5hYVNvcnRpbmcubGVuZ3RoICE9PSAwIHx8IG9TZXR0aW5ncy5hYVNvcnRpbmdGaXhlZCAhPT0gbnVsbCkgKQoJCQl7CgkJCQlpZiAoIG9TZXR0aW5ncy5hYVNvcnRpbmdGaXhlZCAhPT0gbnVsbCApCgkJCQl7CgkJCQkJYWFTb3J0ID0gb1NldHRpbmdzLmFhU29ydGluZ0ZpeGVkLmNvbmNhdCggb1NldHRpbmdzLmFhU29ydGluZyApOwoJCQkJfQoJCQkJZWxzZQoJCQkJewoJCQkJCWFhU29ydCA9IG9TZXR0aW5ncy5hYVNvcnRpbmcuc2xpY2UoKTsKCQkJCX0KCQkJCQoJCQkJLyogSWYgdGhlcmUgaXMgYSBzb3J0aW5nIGRhdGEgdHlwZSwgYW5kIGEgZnVjdGlvbiBiZWxvbmdpbmcgdG8gaXQsIHRoZW4gd2UgbmVlZCB0bwoJCQkJICogZ2V0IHRoZSBkYXRhIGZyb20gdGhlIGRldmVsb3BlcidzIGZ1bmN0aW9uIGFuZCBhcHBseSBpdCBmb3IgdGhpcyBjb2x1bW4KCQkJCSAqLwoJCQkJZm9yICggaT0wIDsgaTxhYVNvcnQubGVuZ3RoIDsgaSsrICkKCQkJCXsKCQkJCQl2YXIgaUNvbHVtbiA9IGFhU29ydFtpXVswXTsKCQkJCQl2YXIgaVZpc0NvbHVtbiA9IF9mbkNvbHVtbkluZGV4VG9WaXNpYmxlKCBvU2V0dGluZ3MsIGlDb2x1bW4gKTsKCQkJCQl2YXIgc0RhdGFUeXBlID0gb1NldHRpbmdzLmFvQ29sdW1uc1sgaUNvbHVtbiBdLnNTb3J0RGF0YVR5cGU7CgkJCQkJaWYgKCB0eXBlb2YgX29FeHQuYWZuU29ydERhdGFbc0RhdGFUeXBlXSAhPSAndW5kZWZpbmVkJyApCgkJCQkJewoJCQkJCQl2YXIgYURhdGEgPSBfb0V4dC5hZm5Tb3J0RGF0YVtzRGF0YVR5cGVdKCBvU2V0dGluZ3MsIGlDb2x1bW4sIGlWaXNDb2x1bW4gKTsKCQkJCQkJZm9yICggaj0wLCBqTGVuPWFvRGF0YS5sZW5ndGggOyBqPGpMZW4gOyBqKysgKQoJCQkJCQl7CgkJCQkJCQlhb0RhdGFbal0uX2FEYXRhW2lDb2x1bW5dID0gYURhdGFbal07CgkJCQkJCX0KCQkJCQl9CgkJCQl9CgkJCQkKCQkJCS8qIERhdGFUYWJsZXMgb2ZmZXJzIHR3byBkaWZmZXJlbnQgbWV0aG9kcyBmb3IgZG9pbmcgdGhlIDJEIGFycmF5IHNvcnRpbmcgb3ZlciBtdWx0aXBsZQoJCQkJICogY29sdW1ucy4gVGhlIGZpcnN0IGlzIHRvIGNvbnN0cnVjdCBhIGZ1bmN0aW9uIGR5bmFtaWNhbGx5LCBhbmQgdGhlbiBldmFsdWF0ZSBhbmQgcnVuCgkJCQkgKiB0aGUgZnVuY3Rpb24sIHdoaWxlIHRoZSBzZWNvbmQgaGFzIG5vIG5lZWQgZm9yIGV2YWx1bGF0aW9uLCBidXQgaXMgYSBsaXR0bGUgYml0IHNsb3dlci4KCQkJCSAqIFRoaXMgaXMgdXNlZCBmb3IgZW52aXJvbm1lbnRzIHdoaWNoIGRvIG5vdCBhbGxvdyBldmFsKCkgZm9yIGNvZGUgZXhlY3VhdGlvbiBzdWNoIGFzIEFJUgoJCQkJICovCgkJCQlpZiAoICF3aW5kb3cucnVudGltZSApCgkJCQl7CgkJCQkJLyogRHluYW1pY2FsbHkgY3JlYXRlZCBzb3J0aW5nIGZ1bmN0aW9uLiBCYXNlZCBvbiB0aGUgaW5mb3JtYXRpb24gdGhhdCB3ZSBoYXZlLCB3ZSBjYW4KCQkJCQkgKiBjcmVhdGUgYSBzb3J0aW5nIGZ1bmN0aW9uIGFzIGlmIGl0IHdlcmUgc3BlY2lmaWNhbGx5IHdyaXR0ZW4gZm9yIHRoaXMgc29ydC4gSGVyZSB3ZQoJCQkJCSAqIHdhbnQgdG8gYnVpbGQgYSBmdW5jdGlvbiBzb21ldGhpbmcgbGlrZSAoZm9yIHR3byBjb2x1bW4gc29ydGluZyk6CgkJCQkJICogIGZuTG9jYWxTb3J0aW5nID0gZnVuY3Rpb24oYSxiKXsKCQkJCQkgKiAgCXZhciBpVGVzdDsKCQkJCQkgKiAgCWlUZXN0ID0gb1NvcnRbJ3N0cmluZy1hc2MnXSgnZGF0YTExJywgJ2RhdGExMicpOwoJCQkJCSAqICAJaWYgKGlUZXN0ID09PSAwKQoJCQkJCSAqICAJCWlUZXN0ID0gb1NvcnRbJ251bWVyaWMtZGVzYyddKCdkYXRhMjEnLCAnZGF0YTIyJyk7CgkJCQkJICogIAkJaWYgKGlUZXN0ID09PSAwKQoJCQkJCSAqICAJCQlyZXR1cm4gb1NvcnRbJ251bWVyaWMtZGVzYyddKDEsMik7CgkJCQkJICogIAlyZXR1cm4gaVRlc3Q7CgkJCQkJICogIH0KCQkJCQkgKiBTbyBiYXNpY2FsbHkgd2UgaGF2ZSBhIHRlc3QgZm9yIGVhY2ggY29sdW1uLCBhbmQgaWYgdGhhdCBjb2x1bW4gbWF0Y2hlcywgdGVzdCB0aGUKCQkJCQkgKiBuZXh0IG9uZS4gSWYgYWxsIGNvbHVtbnMgbWF0Y2gsIHRoZW4gd2UgdXNlIGEgbnVtZXJpYyBzb3J0IG9uIHRoZSBwb3NpdGlvbiB0aGUgdHdvCgkJCQkJICogcm93IGhhdmUgaW4gdGhlIG9yaWdpbmFsIGRhdGEgYXJyYXkgaW4gb3JkZXIgdG8gcHJvdmlkZSBhIHN0YWJsZSBzb3J0LiBJbiBvcmRlciB0bwoJCQkJCSAqIGdldCB0aGUgcG9zaXRpb24gZm9yIHRoZSBudW1lcmljIHN0YWJsaXNhdGlvbiwgd2UgbmVlZCB0byB0YWtlIGEgY2xvbmUgb2YgdGhlIGN1cnJlbnQKCQkJCQkgKiBkaXNwbGF5IGFycmF5IGFuZCB0aGVuIGdldCB0aGUgcG9zaXRpb24gb2YgdGhlIHNvcnRpbmcgdmFsdWUgZnJvbSB0aGF0IGR1cmluZyB0aGUKCQkJCQkgKiBzb3J0LgoJCQkJCSAqCgkJCQkJICogTm90ZSB0aGF0IGZvciB1c2Ugd2l0aCB0aGUgQ2xvc3VyZSBjb21waWxlciwgd2UgbmVlZCB0byBiZSB2ZXJ5IGNhcmVmdWwgaG93IHdlIGRlYWwgCgkJCQkJICogd2l0aCB0aGlzIGV2YWwuIENsb3N1cmUgd2lsbCByZW5hbWUgYWxsIG9mIG91ciBsb2NhbCB2YXJpYWJsZXMsIHJlc3V0bGluZyBpbiBicmVha2FnZQoJCQkJCSAqIGlmIHRoZSB2YXJpYWJsZXMgaW4gdGhlIGV2YWwgZG9uJ3QgYWxzbyByZWZsZWN0IHRoaXMuIEZvciB0aGlzIHJlYXNvbiwgd2UgbmVlZCB0byB1c2UKCQkJCQkgKiAndGhpcycgdG8gc3RvcmUgdGhlIHZhcmlhYmxlcyB3ZSBuZWVkIGluIHRoZSBldmFsLCBzbyB3ZSBjYW4gY29udHJvbCB0aGVtLiBBIGxpdHRsZQoJCQkJCSAqIG5hc3R5LCBidXQgd2VsbCB3b3J0aCBpdCBmb3IgdXNpbmcgQ2xvc3VyZS4KCQkJCQkgKi8KCQkJCQl0aGlzLkNsb3N1cmVEYXRhVGFibGVzID0gewoJCQkJCQkiZm4iOiBmdW5jdGlvbigpe30sCgkJCQkJCSJkYXRhIjogYW9EYXRhLAoJCQkJCQkic29ydCI6IF9vRXh0Lm9Tb3J0LAoJCQkJCQkibWFzdGVyIjogb1NldHRpbmdzLmFpRGlzcGxheU1hc3Rlci5zbGljZSgpCgkJCQkJfTsKCQkJCQl2YXIgc0R5bmFtaWNTb3J0ID0gInRoaXMuQ2xvc3VyZURhdGFUYWJsZXMuZm4gPSBmdW5jdGlvbihhLGIpeyIrCgkJCQkJCSJ2YXIgaVRlc3QsIG9Tb3J0PXRoaXMuQ2xvc3VyZURhdGFUYWJsZXMuc29ydCwgIisKCQkJCQkJImFvRGF0YT10aGlzLkNsb3N1cmVEYXRhVGFibGVzLmRhdGEsICIrCgkJCQkJCSJhaU9yaWc9dGhpcy5DbG9zdXJlRGF0YVRhYmxlcy5tYXN0ZXI7IjsKCQkJCQkKCQkJCQlmb3IgKCBpPTAgOyBpPGFhU29ydC5sZW5ndGgtMSA7IGkrKyApCgkJCQkJewoJCQkJCQlpRGF0YVNvcnQgPSBvU2V0dGluZ3MuYW9Db2x1bW5zWyBhYVNvcnRbaV1bMF0gXS5pRGF0YVNvcnQ7CgkJCQkJCWlEYXRhVHlwZSA9IG9TZXR0aW5ncy5hb0NvbHVtbnNbIGlEYXRhU29ydCBdLnNUeXBlOwoJCQkJCQlzRHluYW1pY1NvcnQgKz0gImlUZXN0ID0gb1NvcnRbJyIraURhdGFUeXBlKyItIithYVNvcnRbaV1bMV0rIiddIisKCQkJCQkJCSIoIGFvRGF0YVthXS5fYURhdGFbIitpRGF0YVNvcnQrIl0sIGFvRGF0YVtiXS5fYURhdGFbIitpRGF0YVNvcnQrIl0gKTsgaWYgKCBpVGVzdCA9PT0gMCApIjsKCQkJCQl9CgkJCQkJCgkJCQkJaWYgKCBhYVNvcnQubGVuZ3RoID4gMCApCgkJCQkJewoJCQkJCQlpRGF0YVNvcnQgPSBvU2V0dGluZ3MuYW9Db2x1bW5zWyBhYVNvcnRbYWFTb3J0Lmxlbmd0aC0xXVswXSBdLmlEYXRhU29ydDsKCQkJCQkJaURhdGFUeXBlID0gb1NldHRpbmdzLmFvQ29sdW1uc1sgaURhdGFTb3J0IF0uc1R5cGU7CgkJCQkJCXNEeW5hbWljU29ydCArPSAiaVRlc3QgPSBvU29ydFsnIitpRGF0YVR5cGUrIi0iK2FhU29ydFthYVNvcnQubGVuZ3RoLTFdWzFdKyInXSIrCgkJCQkJCQkiKCBhb0RhdGFbYV0uX2FEYXRhWyIraURhdGFTb3J0KyJdLCBhb0RhdGFbYl0uX2FEYXRhWyIraURhdGFTb3J0KyJdICk7IisKCQkJCQkJCSJpZiAoaVRlc3Q9PT0wKSAiKwoJCQkJCQkJCSJyZXR1cm4gb1NvcnRbJ251bWVyaWMtYXNjJ10oalF1ZXJ5LmluQXJyYXkoYSxhaU9yaWcpLCBqUXVlcnkuaW5BcnJheShiLGFpT3JpZykpOyAiKwoJCQkJCQkJInJldHVybiBpVGVzdDt9IjsKCQkJCQkJCgkJCQkJCS8qIFRoZSBldmFsIGhhcyB0byBiZSBkb25lIHRvIGEgdmFyaWFibGUgZm9yIElFICovCgkJCQkJCWV2YWwoIHNEeW5hbWljU29ydCApOwoJCQkJCQlvU2V0dGluZ3MuYWlEaXNwbGF5TWFzdGVyLnNvcnQoIHRoaXMuQ2xvc3VyZURhdGFUYWJsZXMuZm4gKTsKCQkJCQl9CgkJCQkJdGhpcy5DbG9zdXJlRGF0YVRhYmxlcyA9IHVuZGVmaW5lZDsKCQkJCX0KCQkJCWVsc2UKCQkJCXsKCQkJCQkvKgoJCQkJCSAqIE5vbi1ldmFsKCkgc29ydGluZyAoQUlSIGFuZCBvdGhlciBlbnZpcm9ubWVudHMgd2hpY2ggZG9lc24ndCBhbGxvdyBjb2RlIGluIGV2YWwoKQoJCQkJCSAqIE5vdGUgdGhhdCBmb3IgcmVhc29uYWJsZSBzaXplZCBkYXRhIHNldHMgdGhpcyBtZXRob2QgaXMgYXJvdW5kIDEuNSB0aW1lcyBzbG93ZXIgdGhhbgoJCQkJCSAqIHRoZSBldmFsIGFib3ZlIChoZW5jZSB3aHkgaXQgaXMgbm90IHVzZWQgYWxsIHRoZSB0aW1lKS4gT2RkbHkgZW5vdWdoLCBpdCBpcyBldmVyIHNvCgkJCQkJICogc2xpZ2h0bHkgZmFzdGVyIGZvciB2ZXJ5IHNtYWxsIHNldHMgKHByZXN1bWFibHkgdGhlIGV2YWwgaGFzIG92ZXJoZWFkKS4KCQkJCQkgKiAgIFNpbmdsZSBjb2x1bW4gKDEwODMgcmVjb3JkcykgLSBldmFsOiAzMm1TICAgQUlSOiAzOG1TCgkJCQkJICogICBUd28gY29sdW1ucyAoMTA4MyByZWNvcmRzKSAtICAgZXZhbDogNTVtUyAgIEFJUjogNjZtUwoJCQkJCSAqLwoJCQkJCQoJCQkJCS8qIEJ1aWxkIGEgY2FjaGVkIGFycmF5IHNvIHRoZSBzb3J0IGRvZXNuJ3QgaGF2ZSB0byBwcm9jZXNzIHRoaXMgc3R1ZmYgb24gZXZlcnkgY2FsbCAqLwoJCQkJCXZhciBhQWlyU29ydCA9IFtdOwoJCQkJCXZhciBpTGVuID0gYWFTb3J0Lmxlbmd0aDsKCQkJCQlmb3IgKCBpPTAgOyBpPGlMZW4gOyBpKysgKQoJCQkJCXsKCQkJCQkJaURhdGFTb3J0ID0gb1NldHRpbmdzLmFvQ29sdW1uc1sgYWFTb3J0W2ldWzBdIF0uaURhdGFTb3J0OwoJCQkJCQlhQWlyU29ydC5wdXNoKCBbCgkJCQkJCQlpRGF0YVNvcnQsCgkJCQkJCQlvU2V0dGluZ3MuYW9Db2x1bW5zWyBpRGF0YVNvcnQgXS5zVHlwZSsnLScrYWFTb3J0W2ldWzFdCgkJCQkJCV0gKTsKCQkJCQl9CgkJCQkJCgkJCQkJb1NldHRpbmdzLmFpRGlzcGxheU1hc3Rlci5zb3J0KCBmdW5jdGlvbiAoYSxiKSB7CgkJCQkJCXZhciBpVGVzdDsKCQkJCQkJZm9yICggdmFyIGk9MCA7IGk8aUxlbiA7IGkrKyApCgkJCQkJCXsKCQkJCQkJCWlUZXN0ID0gb1NvcnRbIGFBaXJTb3J0W2ldWzFdIF0oIGFvRGF0YVthXS5fYURhdGFbYUFpclNvcnRbaV1bMF1dLCBhb0RhdGFbYl0uX2FEYXRhW2FBaXJTb3J0W2ldWzBdXSApOwoJCQkJCQkJaWYgKCBpVGVzdCAhPT0gMCApCgkJCQkJCQl7CgkJCQkJCQkJcmV0dXJuIGlUZXN0OwoJCQkJCQkJfQoJCQkJCQl9CgkJCQkJCXJldHVybiAwOwoJCQkJCX0gKTsKCQkJCX0KCQkJfQoJCQkKCQkJLyogQWx0ZXIgdGhlIHNvcnRpbmcgY2xhc3NlcyB0byB0YWtlIGFjY291bnQgb2YgdGhlIGNoYW5nZXMgKi8KCQkJaWYgKCB0eXBlb2YgYkFwcGx5Q2xhc3NlcyA9PSAndW5kZWZpbmVkJyB8fCBiQXBwbHlDbGFzc2VzICkKCQkJewoJCQkJX2ZuU29ydGluZ0NsYXNzZXMoIG9TZXR0aW5ncyApOwoJCQl9CgkJCQoJCQkvKiBUZWxsIHRoZSBkcmF3IGZ1bmN0aW9uIHRoYXQgd2UgaGF2ZSBzb3J0ZWQgdGhlIGRhdGEgKi8KCQkJb1NldHRpbmdzLmJTb3J0ZWQgPSB0cnVlOwoJCQkKCQkJLyogQ29weSB0aGUgbWFzdGVyIGRhdGEgaW50byB0aGUgZHJhdyBhcnJheSBhbmQgcmUtZHJhdyAqLwoJCQlpZiAoIG9TZXR0aW5ncy5vRmVhdHVyZXMuYkZpbHRlciApCgkJCXsKCQkJCS8qIF9mbkZpbHRlcigpIHdpbGwgcmVkcmF3IHRoZSB0YWJsZSBmb3IgdXMgKi8KCQkJCV9mbkZpbHRlckNvbXBsZXRlKCBvU2V0dGluZ3MsIG9TZXR0aW5ncy5vUHJldmlvdXNTZWFyY2gsIDEgKTsKCQkJfQoJCQllbHNlCgkJCXsKCQkJCW9TZXR0aW5ncy5haURpc3BsYXkgPSBvU2V0dGluZ3MuYWlEaXNwbGF5TWFzdGVyLnNsaWNlKCk7CgkJCQlvU2V0dGluZ3MuX2lEaXNwbGF5U3RhcnQgPSAwOyAvKiByZXNldCBkaXNwbGF5IGJhY2sgdG8gcGFnZSAwICovCgkJCQlfZm5DYWxjdWxhdGVFbmQoIG9TZXR0aW5ncyApOwoJCQkJX2ZuRHJhdyggb1NldHRpbmdzICk7CgkJCX0KCQl9CgkJCgkJLyoKCQkgKiBGdW5jdGlvbjogX2ZuU29ydEF0dGFjaExpc3RlbmVyCgkJICogUHVycG9zZTogIEF0dGFjaCBhIHNvcnQgaGFuZGxlciAoY2xpY2spIHRvIGEgbm9kZQoJCSAqIFJldHVybnM6ICAtCgkJICogSW5wdXRzOiAgIG9iamVjdDpvU2V0dGluZ3MgLSBkYXRhVGFibGVzIHNldHRpbmdzIG9iamVjdAoJCSAqICAgICAgICAgICBub2RlOm5Ob2RlIC0gbm9kZSB0byBhdHRhY2ggdGhlIGhhbmRsZXIgdG8KCQkgKiAgICAgICAgICAgaW50OmlEYXRhSW5kZXggLSBjb2x1bW4gc29ydGluZyBpbmRleAoJCSAqICAgICAgICAgICBmdW5jdGlvbjpmbkNhbGxiYWNrIC0gY2FsbGJhY2sgZnVuY3Rpb24gLSBvcHRpb25hbAoJCSAqLwoJCWZ1bmN0aW9uIF9mblNvcnRBdHRhY2hMaXN0ZW5lciAoIG9TZXR0aW5ncywgbk5vZGUsIGlEYXRhSW5kZXgsIGZuQ2FsbGJhY2sgKQoJCXsKCQkJJChuTm9kZSkuY2xpY2soIGZ1bmN0aW9uIChlKSB7CgkJCQkvKiBJZiB0aGUgY29sdW1uIGlzIG5vdCBzb3J0YWJsZSAtIGRvbid0IHRvIGFueXRoaW5nICovCgkJCQlpZiAoIG9TZXR0aW5ncy5hb0NvbHVtbnNbaURhdGFJbmRleF0uYlNvcnRhYmxlID09PSBmYWxzZSApCgkJCQl7CgkJCQkJcmV0dXJuOwoJCQkJfQoJCQkJCgkJCQkvKgoJCQkJICogVGhpcyBpcyBhIGxpdHRsZSBiaXQgb2RkIEkgYWRtaXQuLi4gSSBkZWNsYXJlIGEgdGVtcG9yYXJ5IGZ1bmN0aW9uIGluc2lkZSB0aGUgc2NvcGUgb2YKCQkJCSAqIF9mbkRyYXdIZWFkIGFuZCB0aGUgY2xpY2sgaGFuZGxlciBpbiBvcmRlciB0aGF0IHRoZSBjb2RlIHByZXNlbnRlZCBoZXJlIGNhbiBiZSB1c2VkIAoJCQkJICogdHdpY2UgLSBvbmNlIGZvciB3aGVuIGJQcm9jZXNzaW5nIGlzIGVuYWJsZWQsIGFuZCBhbm90aGVyIHRpbWUgZm9yIHdoZW4gaXQgaXMgCgkJCQkgKiBkaXNhYmxlZCwgYXMgd2UgbmVlZCB0byBwZXJmb3JtIHNsaWdodGx5IGRpZmZlcmVudCBhY3Rpb25zLgoJCQkJICogICBCYXNpY2FsbHkgdGhlIGlzc3VlIGhlcmUgaXMgdGhhdCB0aGUgSmF2YXNjcmlwdCBlbmdpbmUgaW4gbW9kZXJuIGJyb3dzZXJzIGRvbid0IAoJCQkJICogYXBwZWFyIHRvIGFsbG93IHRoZSByZW5kZXJpbmcgZW5naW5lIHRvIHVwZGF0ZSB0aGUgZGlzcGxheSB3aGlsZSBpdCBpcyBzdGlsbCBleGN1dGluZwoJCQkJICogaXQncyB0aHJlYWQgKHdlbGwgLSBpdCBkb2VzIGJ1dCBvbmx5IGFmdGVyIGxvbmcgaW50ZXJ2YWxzKS4gVGhpcyBtZWFucyB0aGF0IHRoZSAKCQkJCSAqICdwcm9jZXNzaW5nJyBkaXNwbGF5IGRvZXNuJ3QgYXBwZWFyIGZvciBhIHRhYmxlIHNvcnQuIFRvIGJyZWFrIHRoZSBqcyB0aHJlYWQgdXAgYSBiaXQKCQkJCSAqIEkgZm9yY2UgYW4gZXhlY3V0aW9uIGJyZWFrIGJ5IHVzaW5nIHNldFRpbWVvdXQgLSBidXQgdGhpcyBicmVha3MgdGhlIGV4cGVjdGVkIAoJCQkJICogdGhyZWFkIGNvbnRpbnVhdGlvbiBmb3IgdGhlIGVuZC1kZXZlbG9wZXIncyBwb2ludCBvZiB2aWV3ICh0aGVpciBjb2RlIHdvdWxkIGV4ZWN1dGUKCQkJCSAqIHRvbyBlYXJseSksIHNvIHdlIG9uO3kgZG8gaXQgd2hlbiB3ZSBhYnNvbHV0ZWx5IGhhdmUgdG8uCgkJCQkgKi8KCQkJCXZhciBmbklubmVyU29ydGluZyA9IGZ1bmN0aW9uICgpIHsKCQkJCQl2YXIgaUNvbHVtbiwgaU5leHRTb3J0OwoJCQkJCQoJCQkJCS8qIElmIHRoZSBzaGlmdCBrZXkgaXMgcHJlc3NlZCB0aGVuIHdlIGFyZSBtdWx0aXBlIGNvbHVtbiBzb3J0aW5nICovCgkJCQkJaWYgKCBlLnNoaWZ0S2V5ICkKCQkJCQl7CgkJCQkJCS8qIEFyZSB3ZSBhbHJlYWR5IGRvaW5nIHNvbWUga2luZCBvZiBzb3J0IG9uIHRoaXMgY29sdW1uPyAqLwoJCQkJCQl2YXIgYkZvdW5kID0gZmFsc2U7CgkJCQkJCWZvciAoIHZhciBpPTAgOyBpPG9TZXR0aW5ncy5hYVNvcnRpbmcubGVuZ3RoIDsgaSsrICkKCQkJCQkJewoJCQkJCQkJaWYgKCBvU2V0dGluZ3MuYWFTb3J0aW5nW2ldWzBdID09IGlEYXRhSW5kZXggKQoJCQkJCQkJewoJCQkJCQkJCWJGb3VuZCA9IHRydWU7CgkJCQkJCQkJaUNvbHVtbiA9IG9TZXR0aW5ncy5hYVNvcnRpbmdbaV1bMF07CgkJCQkJCQkJaU5leHRTb3J0ID0gb1NldHRpbmdzLmFhU29ydGluZ1tpXVsyXSsxOwoJCQkJCQkJCQoJCQkJCQkJCWlmICggdHlwZW9mIG9TZXR0aW5ncy5hb0NvbHVtbnNbaUNvbHVtbl0uYXNTb3J0aW5nW2lOZXh0U29ydF0gPT0gJ3VuZGVmaW5lZCcgKQoJCQkJCQkJCXsKCQkJCQkJCQkJLyogUmVhY2hlZCB0aGUgZW5kIG9mIHRoZSBzb3J0aW5nIG9wdGlvbnMsIHJlbW92ZSBmcm9tIG11bHRpLWNvbCBzb3J0ICovCgkJCQkJCQkJCW9TZXR0aW5ncy5hYVNvcnRpbmcuc3BsaWNlKCBpLCAxICk7CgkJCQkJCQkJfQoJCQkJCQkJCWVsc2UKCQkJCQkJCQl7CgkJCQkJCQkJCS8qIE1vdmUgb250byBuZXh0IHNvcnRpbmcgZGlyZWN0aW9uICovCgkJCQkJCQkJCW9TZXR0aW5ncy5hYVNvcnRpbmdbaV1bMV0gPSBvU2V0dGluZ3MuYW9Db2x1bW5zW2lDb2x1bW5dLmFzU29ydGluZ1tpTmV4dFNvcnRdOwoJCQkJCQkJCQlvU2V0dGluZ3MuYWFTb3J0aW5nW2ldWzJdID0gaU5leHRTb3J0OwoJCQkJCQkJCX0KCQkJCQkJCQlicmVhazsKCQkJCQkJCX0KCQkJCQkJfQoJCQkJCQkKCQkJCQkJLyogTm8gc29ydCB5ZXQgLSBhZGQgaXQgaW4gKi8KCQkJCQkJaWYgKCBiRm91bmQgPT09IGZhbHNlICkKCQkJCQkJewoJCQkJCQkJb1NldHRpbmdzLmFhU29ydGluZy5wdXNoKCBbIGlEYXRhSW5kZXgsIAoJCQkJCQkJCW9TZXR0aW5ncy5hb0NvbHVtbnNbaURhdGFJbmRleF0uYXNTb3J0aW5nWzBdLCAwIF0gKTsKCQkJCQkJfQoJCQkJCX0KCQkJCQllbHNlCgkJCQkJewoJCQkJCQkvKiBJZiBubyBzaGlmdCBrZXkgdGhlbiBzaW5nbGUgY29sdW1uIHNvcnQgKi8KCQkJCQkJaWYgKCBvU2V0dGluZ3MuYWFTb3J0aW5nLmxlbmd0aCA9PSAxICYmIG9TZXR0aW5ncy5hYVNvcnRpbmdbMF1bMF0gPT0gaURhdGFJbmRleCApCgkJCQkJCXsKCQkJCQkJCWlDb2x1bW4gPSBvU2V0dGluZ3MuYWFTb3J0aW5nWzBdWzBdOwoJCQkJCQkJaU5leHRTb3J0ID0gb1NldHRpbmdzLmFhU29ydGluZ1swXVsyXSsxOwoJCQkJCQkJaWYgKCB0eXBlb2Ygb1NldHRpbmdzLmFvQ29sdW1uc1tpQ29sdW1uXS5hc1NvcnRpbmdbaU5leHRTb3J0XSA9PSAndW5kZWZpbmVkJyApCgkJCQkJCQl7CgkJCQkJCQkJaU5leHRTb3J0ID0gMDsKCQkJCQkJCX0KCQkJCQkJCW9TZXR0aW5ncy5hYVNvcnRpbmdbMF1bMV0gPSBvU2V0dGluZ3MuYW9Db2x1bW5zW2lDb2x1bW5dLmFzU29ydGluZ1tpTmV4dFNvcnRdOwoJCQkJCQkJb1NldHRpbmdzLmFhU29ydGluZ1swXVsyXSA9IGlOZXh0U29ydDsKCQkJCQkJfQoJCQkJCQllbHNlCgkJCQkJCXsKCQkJCQkJCW9TZXR0aW5ncy5hYVNvcnRpbmcuc3BsaWNlKCAwLCBvU2V0dGluZ3MuYWFTb3J0aW5nLmxlbmd0aCApOwoJCQkJCQkJb1NldHRpbmdzLmFhU29ydGluZy5wdXNoKCBbIGlEYXRhSW5kZXgsIAoJCQkJCQkJCW9TZXR0aW5ncy5hb0NvbHVtbnNbaURhdGFJbmRleF0uYXNTb3J0aW5nWzBdLCAwIF0gKTsKCQkJCQkJfQoJCQkJCX0KCQkJCQkKCQkJCQkvKiBSdW4gdGhlIHNvcnQgKi8KCQkJCQlfZm5Tb3J0KCBvU2V0dGluZ3MgKTsKCQkJCX07IC8qIC9mbklubmVyU29ydGluZyAqLwoJCQkJCgkJCQlpZiAoICFvU2V0dGluZ3Mub0ZlYXR1cmVzLmJQcm9jZXNzaW5nICkKCQkJCXsKCQkJCQlmbklubmVyU29ydGluZygpOwoJCQkJfQoJCQkJZWxzZQoJCQkJewoJCQkJCV9mblByb2Nlc3NpbmdEaXNwbGF5KCBvU2V0dGluZ3MsIHRydWUgKTsKCQkJCQlzZXRUaW1lb3V0KCBmdW5jdGlvbigpIHsKCQkJCQkJZm5Jbm5lclNvcnRpbmcoKTsKCQkJCQkJaWYgKCAhb1NldHRpbmdzLm9GZWF0dXJlcy5iU2VydmVyU2lkZSApCgkJCQkJCXsKCQkJCQkJCV9mblByb2Nlc3NpbmdEaXNwbGF5KCBvU2V0dGluZ3MsIGZhbHNlICk7CgkJCQkJCX0KCQkJCQl9LCAwICk7CgkJCQl9CgkJCQkKCQkJCS8qIENhbGwgdGhlIHVzZXIgc3BlY2lmaWVkIGNhbGxiYWNrIGZ1bmN0aW9uIC0gdXNlZCBmb3IgYXN5bmMgdXNlciBpbnRlcmFjdGlvbiAqLwoJCQkJaWYgKCB0eXBlb2YgZm5DYWxsYmFjayA9PSAnZnVuY3Rpb24nICkKCQkJCXsKCQkJCQlmbkNhbGxiYWNrKCBvU2V0dGluZ3MgKTsKCQkJCX0KCQkJfSApOwoJCX0KCQkKCQkvKgoJCSAqIEZ1bmN0aW9uOiBfZm5Tb3J0aW5nQ2xhc3NlcwoJCSAqIFB1cnBvc2U6ICBTZXQgdGhlIHNvcnR0aW5nIGNsYXNzZXMgb24gdGhlIGhlYWRlcgoJCSAqIFJldHVybnM6ICAtCgkJICogSW5wdXRzOiAgIG9iamVjdDpvU2V0dGluZ3MgLSBkYXRhVGFibGVzIHNldHRpbmdzIG9iamVjdAoJCSAqIE5vdGVzOiAgICBJdCBpcyBzYWZlIHRvIGNhbGwgdGhpcyBmdW5jdGlvbiB3aGVuIGJTb3J0IGFuZCBiU29ydENsYXNzZXMgYXJlIGZhbHNlCgkJICovCgkJZnVuY3Rpb24gX2ZuU29ydGluZ0NsYXNzZXMoIG9TZXR0aW5ncyApCgkJewoJCQl2YXIgaSwgaUxlbiwgaiwgakxlbiwgaUZvdW5kOwoJCQl2YXIgYWFTb3J0LCBzQ2xhc3M7CgkJCXZhciBpQ29sdW1ucyA9IG9TZXR0aW5ncy5hb0NvbHVtbnMubGVuZ3RoOwoJCQl2YXIgb0NsYXNzZXMgPSBvU2V0dGluZ3Mub0NsYXNzZXM7CgkJCQoJCQlmb3IgKCBpPTAgOyBpPGlDb2x1bW5zIDsgaSsrICkKCQkJewoJCQkJaWYgKCBvU2V0dGluZ3MuYW9Db2x1bW5zW2ldLmJTb3J0YWJsZSApCgkJCQl7CgkJCQkJJChvU2V0dGluZ3MuYW9Db2x1bW5zW2ldLm5UaCkucmVtb3ZlQ2xhc3MoIG9DbGFzc2VzLnNTb3J0QXNjICsiICIrIG9DbGFzc2VzLnNTb3J0RGVzYyArCgkJCQkgCQkiICIrIG9TZXR0aW5ncy5hb0NvbHVtbnNbaV0uc1NvcnRpbmdDbGFzcyApOwoJCQkJfQoJCQl9CgkJCQoJCQlpZiAoIG9TZXR0aW5ncy5hYVNvcnRpbmdGaXhlZCAhPT0gbnVsbCApCgkJCXsKCQkJCWFhU29ydCA9IG9TZXR0aW5ncy5hYVNvcnRpbmdGaXhlZC5jb25jYXQoIG9TZXR0aW5ncy5hYVNvcnRpbmcgKTsKCQkJfQoJCQllbHNlCgkJCXsKCQkJCWFhU29ydCA9IG9TZXR0aW5ncy5hYVNvcnRpbmcuc2xpY2UoKTsKCQkJfQoJCQkKCQkJLyogQXBwbHkgdGhlIHJlcXVpcmVkIGNsYXNzZXMgdG8gdGhlIGhlYWRlciAqLwoJCQlmb3IgKCBpPTAgOyBpPG9TZXR0aW5ncy5hb0NvbHVtbnMubGVuZ3RoIDsgaSsrICkKCQkJewoJCQkJaWYgKCBvU2V0dGluZ3MuYW9Db2x1bW5zW2ldLmJTb3J0YWJsZSApCgkJCQl7CgkJCQkJc0NsYXNzID0gb1NldHRpbmdzLmFvQ29sdW1uc1tpXS5zU29ydGluZ0NsYXNzOwoJCQkJCWlGb3VuZCA9IC0xOwoJCQkJCWZvciAoIGo9MCA7IGo8YWFTb3J0Lmxlbmd0aCA7IGorKyApCgkJCQkJewoJCQkJCQlpZiAoIGFhU29ydFtqXVswXSA9PSBpICkKCQkJCQkJewoJCQkJCQkJc0NsYXNzID0gKCBhYVNvcnRbal1bMV0gPT0gImFzYyIgKSA/CgkJCQkJCQkJb0NsYXNzZXMuc1NvcnRBc2MgOiBvQ2xhc3Nlcy5zU29ydERlc2M7CgkJCQkJCQlpRm91bmQgPSBqOwoJCQkJCQkJYnJlYWs7CgkJCQkJCX0KCQkJCQl9CgkJCQkJJChvU2V0dGluZ3MuYW9Db2x1bW5zW2ldLm5UaCkuYWRkQ2xhc3MoIHNDbGFzcyApOwoJCQkJCQoJCQkJCWlmICggb1NldHRpbmdzLmJKVUkgKQoJCQkJCXsKCQkJCQkJLyogalF1ZXJ5IFVJIHVzZXMgZXh0cmEgbWFya3VwICovCgkJCQkJCXZhciBqcVNwYW4gPSAkKCJzcGFuIiwgb1NldHRpbmdzLmFvQ29sdW1uc1tpXS5uVGgpOwoJCQkJCQlqcVNwYW4ucmVtb3ZlQ2xhc3Mob0NsYXNzZXMuc1NvcnRKVUlBc2MgKyIgIisgb0NsYXNzZXMuc1NvcnRKVUlEZXNjICsiICIrIAoJCQkJCQkJb0NsYXNzZXMuc1NvcnRKVUkgKyIgIisgb0NsYXNzZXMuc1NvcnRKVUlBc2NBbGxvd2VkICsiICIrIG9DbGFzc2VzLnNTb3J0SlVJRGVzY0FsbG93ZWQgKTsKCQkJCQkJCgkJCQkJCXZhciBzU3BhbkNsYXNzOwoJCQkJCQlpZiAoIGlGb3VuZCA9PSAtMSApCgkJCQkJCXsKCQkJCQkJIAlzU3BhbkNsYXNzID0gb1NldHRpbmdzLmFvQ29sdW1uc1tpXS5zU29ydGluZ0NsYXNzSlVJOwoJCQkJCQl9CgkJCQkJCWVsc2UgaWYgKCBhYVNvcnRbaUZvdW5kXVsxXSA9PSAiYXNjIiApCgkJCQkJCXsKCQkJCQkJCXNTcGFuQ2xhc3MgPSBvQ2xhc3Nlcy5zU29ydEpVSUFzYzsKCQkJCQkJfQoJCQkJCQllbHNlCgkJCQkJCXsKCQkJCQkJCXNTcGFuQ2xhc3MgPSBvQ2xhc3Nlcy5zU29ydEpVSURlc2M7CgkJCQkJCX0KCQkJCQkJCgkJCQkJCWpxU3Bhbi5hZGRDbGFzcyggc1NwYW5DbGFzcyApOwoJCQkJCX0KCQkJCX0KCQkJCWVsc2UKCQkJCXsKCQkJCQkvKiBObyBzb3J0aW5nIG9uIHRoaXMgY29sdW1uLCBzbyBhZGQgdGhlIGJhc2UgY2xhc3MuIFRoaXMgd2lsbCBoYXZlIGJlZW4gYXNzaWduZWQgYnkKCQkJCQkgKiBfZm5BZGRDb2x1bW4KCQkJCQkgKi8KCQkJCQkkKG9TZXR0aW5ncy5hb0NvbHVtbnNbaV0ublRoKS5hZGRDbGFzcyggb1NldHRpbmdzLmFvQ29sdW1uc1tpXS5zU29ydGluZ0NsYXNzICk7CgkJCQl9CgkJCX0KCQkJCgkJCS8qIAoJCQkgKiBBcHBseSB0aGUgcmVxdWlyZWQgY2xhc3NlcyB0byB0aGUgdGFibGUgYm9keQoJCQkgKiBOb3RlIHRoYXQgdGhpcyBpcyBnaXZlbiBhcyBhIGZlYXR1cmUgc3dpdGNoIHNpbmNlIGl0IGNhbiBzaWduaWZpY2FudGx5IHNsb3cgZG93biBhIHNvcnQKCQkJICogb24gbGFyZ2UgZGF0YSBzZXRzIChhZGRpbmcgYW5kIHJlbW92aW5nIG9mIGNsYXNzZXMgaXMgYWx3YXlzIHNsb3cgYXQgdGhlIGJlc3Qgb2YgdGltZXMuLikKCQkJICogRnVydGhlciB0byB0aGlzLCBub3RlIHRoYXQgdGhpcyBjb2RlIGlzIGFkbWl0YWRseSBmYWlybHkgdWdseS4gSXQgY291bGQgYmUgbWFkZSBhIGxvdCAKCQkJICogc2ltcGlsZXIgdXNpbmcgalF1ZXJ5IHNlbGVjdG9ycyBhbmQgYWRkL3JlbW92ZUNsYXNzLCBidXQgdGhhdCBpcyBzaWduaWZpY2FudGx5IHNsb3dlcgoJCQkgKiAob24gdGhlIG9yZGVyIG9mIDUgdGltZXMgc2xvd2VyKSAtIGhlbmNlIHRoZSBkaXJlY3QgRE9NIG1hbmlwdWxhdGlvbiBoZXJlLgoJCQkgKi8KCQkJc0NsYXNzID0gb0NsYXNzZXMuc1NvcnRDb2x1bW47CgkJCQoJCQlpZiAoIG9TZXR0aW5ncy5vRmVhdHVyZXMuYlNvcnQgJiYgb1NldHRpbmdzLm9GZWF0dXJlcy5iU29ydENsYXNzZXMgKQoJCQl7CgkJCQl2YXIgblRkcyA9IF9mbkdldFRkTm9kZXMoIG9TZXR0aW5ncyApOwoJCQkJCgkJCQkvKiBSZW1vdmUgdGhlIG9sZCBjbGFzc2VzICovCgkJCQlpZiAoIG5UZHMubGVuZ3RoID49IGlDb2x1bW5zICkKCQkJCXsKCQkJCQlmb3IgKCBpPTAgOyBpPGlDb2x1bW5zIDsgaSsrICkKCQkJCQl7CgkJCQkJCWlmICggblRkc1tpXS5jbGFzc05hbWUuaW5kZXhPZihzQ2xhc3MrIjEiKSAhPSAtMSApCgkJCQkJCXsKCQkJCQkJCWZvciAoIGo9MCwgakxlbj0oblRkcy5sZW5ndGgvaUNvbHVtbnMpIDsgajxqTGVuIDsgaisrICkKCQkJCQkJCXsKCQkJCQkJCQluVGRzWyhpQ29sdW1ucypqKStpXS5jbGFzc05hbWUgPSAKCQkJCQkJCQkJJC50cmltKCBuVGRzWyhpQ29sdW1ucypqKStpXS5jbGFzc05hbWUucmVwbGFjZSggc0NsYXNzKyIxIiwgIiIgKSApOwoJCQkJCQkJfQoJCQkJCQl9CgkJCQkJCWVsc2UgaWYgKCBuVGRzW2ldLmNsYXNzTmFtZS5pbmRleE9mKHNDbGFzcysiMiIpICE9IC0xICkKCQkJCQkJewoJCQkJCQkJZm9yICggaj0wLCBqTGVuPShuVGRzLmxlbmd0aC9pQ29sdW1ucykgOyBqPGpMZW4gOyBqKysgKQoJCQkJCQkJewoJCQkJCQkJCW5UZHNbKGlDb2x1bW5zKmopK2ldLmNsYXNzTmFtZSA9IAoJCQkJCQkJCQkkLnRyaW0oIG5UZHNbKGlDb2x1bW5zKmopK2ldLmNsYXNzTmFtZS5yZXBsYWNlKCBzQ2xhc3MrIjIiLCAiIiApICk7CgkJCQkJCQl9CgkJCQkJCX0KCQkJCQkJZWxzZSBpZiAoIG5UZHNbaV0uY2xhc3NOYW1lLmluZGV4T2Yoc0NsYXNzKyIzIikgIT0gLTEgKQoJCQkJCQl7CgkJCQkJCQlmb3IgKCBqPTAsIGpMZW49KG5UZHMubGVuZ3RoL2lDb2x1bW5zKSA7IGo8akxlbiA7IGorKyApCgkJCQkJCQl7CgkJCQkJCQkJblRkc1soaUNvbHVtbnMqaikraV0uY2xhc3NOYW1lID0gCgkJCQkJCQkJCSQudHJpbSggblRkc1soaUNvbHVtbnMqaikraV0uY2xhc3NOYW1lLnJlcGxhY2UoICIgIitzQ2xhc3MrIjMiLCAiIiApICk7CgkJCQkJCQl9CgkJCQkJCX0KCQkJCQl9CgkJCQl9CgkJCQkKCQkJCS8qIEFkZCB0aGUgbmV3IGNsYXNzZXMgdG8gdGhlIHRhYmxlICovCgkJCQl2YXIgaUNsYXNzID0gMSwgaVRhcmdldENvbDsKCQkJCWZvciAoIGk9MCA7IGk8YWFTb3J0Lmxlbmd0aCA7IGkrKyApCgkJCQl7CgkJCQkJaVRhcmdldENvbCA9IHBhcnNlSW50KCBhYVNvcnRbaV1bMF0sIDEwICk7CgkJCQkJZm9yICggaj0wLCBqTGVuPShuVGRzLmxlbmd0aC9pQ29sdW1ucykgOyBqPGpMZW4gOyBqKysgKQoJCQkJCXsKCQkJCQkJblRkc1soaUNvbHVtbnMqaikraVRhcmdldENvbF0uY2xhc3NOYW1lICs9ICIgIitzQ2xhc3MraUNsYXNzOwoJCQkJCX0KCQkJCQkKCQkJCQlpZiAoIGlDbGFzcyA8IDMgKQoJCQkJCXsKCQkJCQkJaUNsYXNzKys7CgkJCQkJfQoJCQkJfQoJCQl9CgkJfQoJCQoJCQoJCS8qICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqCgkJICogU2VjdGlvbiAtIEZlYXR1cmU6IFBhZ2luYXRpb24uIE5vdGUgdGhhdCBtb3N0IG9mIHRoZSBwYWdpbmcgbG9naWMgaXMgZG9uZSBpbiAKCQkgKiBfb0V4dC5vUGFnaW5hdGlvbgoJCSAqLwoJCQoJCS8qCgkJICogRnVuY3Rpb246IF9mbkZlYXR1cmVIdG1sUGFnaW5hdGUKCQkgKiBQdXJwb3NlOiAgR2VuZXJhdGUgdGhlIG5vZGUgcmVxdWlyZWQgZm9yIGRlZmF1bHQgcGFnaW5hdGlvbgoJCSAqIFJldHVybnM6ICBub2RlCgkJICogSW5wdXRzOiAgIG9iamVjdDpvU2V0dGluZ3MgLSBkYXRhVGFibGVzIHNldHRpbmdzIG9iamVjdAoJCSAqLwoJCWZ1bmN0aW9uIF9mbkZlYXR1cmVIdG1sUGFnaW5hdGUgKCBvU2V0dGluZ3MgKQoJCXsKCQkJaWYgKCBvU2V0dGluZ3Mub1Njcm9sbC5iSW5maW5pdGUgKQoJCQl7CgkJCQlyZXR1cm4gbnVsbDsKCQkJfQoJCQkKCQkJdmFyIG5QYWdpbmF0ZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoICdkaXYnICk7CgkJCW5QYWdpbmF0ZS5jbGFzc05hbWUgPSBvU2V0dGluZ3Mub0NsYXNzZXMuc1BhZ2luZytvU2V0dGluZ3Muc1BhZ2luYXRpb25UeXBlOwoJCQkKCQkJX29FeHQub1BhZ2luYXRpb25bIG9TZXR0aW5ncy5zUGFnaW5hdGlvblR5cGUgXS5mbkluaXQoIG9TZXR0aW5ncywgblBhZ2luYXRlLCAKCQkJCWZ1bmN0aW9uKCBvU2V0dGluZ3MgKSB7CgkJCQkJX2ZuQ2FsY3VsYXRlRW5kKCBvU2V0dGluZ3MgKTsKCQkJCQlfZm5EcmF3KCBvU2V0dGluZ3MgKTsKCQkJCX0KCQkJKTsKCQkJCgkJCS8qIEFkZCBhIGRyYXcgY2FsbGJhY2sgZm9yIHRoZSBwYWdpbmF0aW9uIG9uIGZpcnN0IGluc3RhbmNlLCB0byB1cGRhdGUgdGhlIHBhZ2luZyBkaXNwbGF5ICovCgkJCWlmICggdHlwZW9mIG9TZXR0aW5ncy5hYW5GZWF0dXJlcy5wID09ICJ1bmRlZmluZWQiICkKCQkJewoJCQkJb1NldHRpbmdzLmFvRHJhd0NhbGxiYWNrLnB1c2goIHsKCQkJCQkiZm4iOiBmdW5jdGlvbiggb1NldHRpbmdzICkgewoJCQkJCQlfb0V4dC5vUGFnaW5hdGlvblsgb1NldHRpbmdzLnNQYWdpbmF0aW9uVHlwZSBdLmZuVXBkYXRlKCBvU2V0dGluZ3MsIGZ1bmN0aW9uKCBvU2V0dGluZ3MgKSB7CgkJCQkJCQlfZm5DYWxjdWxhdGVFbmQoIG9TZXR0aW5ncyApOwoJCQkJCQkJX2ZuRHJhdyggb1NldHRpbmdzICk7CgkJCQkJCX0gKTsKCQkJCQl9LAoJCQkJCSJzTmFtZSI6ICJwYWdpbmF0aW9uIgoJCQkJfSApOwoJCQl9CgkJCXJldHVybiBuUGFnaW5hdGU7CgkJfQoJCQoJCS8qCgkJICogRnVuY3Rpb246IF9mblBhZ2VDaGFuZ2UKCQkgKiBQdXJwb3NlOiAgQWx0ZXIgdGhlIGRpc3BsYXkgc2V0dGluZ3MgdG8gY2hhbmdlIHRoZSBwYWdlCgkJICogUmV0dXJuczogIGJvb2w6dHJ1ZSAtIHBhZ2UgaGFzIGNoYW5nZWQsIGZhbHNlIC0gbm8gY2hhbmdlIChubyBlZmZlY3QpIGVnICdmaXJzdCcgb24gcGFnZSAxCgkJICogSW5wdXRzOiAgIG9iamVjdDpvU2V0dGluZ3MgLSBkYXRhVGFibGVzIHNldHRpbmdzIG9iamVjdAoJCSAqICAgICAgICAgICBzdHJpbmc6c0FjdGlvbiAtIHBhZ2luZyBhY3Rpb24gdG8gdGFrZTogImZpcnN0IiwgInByZXZpb3VzIiwgIm5leHQiIG9yICJsYXN0IgoJCSAqLwoJCWZ1bmN0aW9uIF9mblBhZ2VDaGFuZ2UgKCBvU2V0dGluZ3MsIHNBY3Rpb24gKQoJCXsKCQkJdmFyIGlPbGRTdGFydCA9IG9TZXR0aW5ncy5faURpc3BsYXlTdGFydDsKCQkJCgkJCWlmICggc0FjdGlvbiA9PSAiZmlyc3QiICkKCQkJewoJCQkJb1NldHRpbmdzLl9pRGlzcGxheVN0YXJ0ID0gMDsKCQkJfQoJCQllbHNlIGlmICggc0FjdGlvbiA9PSAicHJldmlvdXMiICkKCQkJewoJCQkJb1NldHRpbmdzLl9pRGlzcGxheVN0YXJ0ID0gb1NldHRpbmdzLl9pRGlzcGxheUxlbmd0aD49MCA/CgkJCQkJb1NldHRpbmdzLl9pRGlzcGxheVN0YXJ0IC0gb1NldHRpbmdzLl9pRGlzcGxheUxlbmd0aCA6CgkJCQkJMDsKCQkJCQoJCQkJLyogQ29ycmVjdCBmb3IgdW5kZXJydW4gKi8KCQkJCWlmICggb1NldHRpbmdzLl9pRGlzcGxheVN0YXJ0IDwgMCApCgkJCQl7CgkJCQkgIG9TZXR0aW5ncy5faURpc3BsYXlTdGFydCA9IDA7CgkJCQl9CgkJCX0KCQkJZWxzZSBpZiAoIHNBY3Rpb24gPT0gIm5leHQiICkKCQkJewoJCQkJaWYgKCBvU2V0dGluZ3MuX2lEaXNwbGF5TGVuZ3RoID49IDAgKQoJCQkJewoJCQkJCS8qIE1ha2Ugc3VyZSB3ZSBhcmUgbm90IG92ZXIgcnVubmluZyB0aGUgZGlzcGxheSBhcnJheSAqLwoJCQkJCWlmICggb1NldHRpbmdzLl9pRGlzcGxheVN0YXJ0ICsgb1NldHRpbmdzLl9pRGlzcGxheUxlbmd0aCA8IG9TZXR0aW5ncy5mblJlY29yZHNEaXNwbGF5KCkgKQoJCQkJCXsKCQkJCQkJb1NldHRpbmdzLl9pRGlzcGxheVN0YXJ0ICs9IG9TZXR0aW5ncy5faURpc3BsYXlMZW5ndGg7CgkJCQkJfQoJCQkJfQoJCQkJZWxzZQoJCQkJewoJCQkJCW9TZXR0aW5ncy5faURpc3BsYXlTdGFydCA9IDA7CgkJCQl9CgkJCX0KCQkJZWxzZSBpZiAoIHNBY3Rpb24gPT0gImxhc3QiICkKCQkJewoJCQkJaWYgKCBvU2V0dGluZ3MuX2lEaXNwbGF5TGVuZ3RoID49IDAgKQoJCQkJewoJCQkJCXZhciBpUGFnZXMgPSBwYXJzZUludCggKG9TZXR0aW5ncy5mblJlY29yZHNEaXNwbGF5KCktMSkgLyBvU2V0dGluZ3MuX2lEaXNwbGF5TGVuZ3RoLCAxMCApICsgMTsKCQkJCQlvU2V0dGluZ3MuX2lEaXNwbGF5U3RhcnQgPSAoaVBhZ2VzLTEpICogb1NldHRpbmdzLl9pRGlzcGxheUxlbmd0aDsKCQkJCX0KCQkJCWVsc2UKCQkJCXsKCQkJCQlvU2V0dGluZ3MuX2lEaXNwbGF5U3RhcnQgPSAwOwoJCQkJfQoJCQl9CgkJCWVsc2UKCQkJewoJCQkJX2ZuTG9nKCBvU2V0dGluZ3MsIDAsICJVbmtub3duIHBhZ2luZyBhY3Rpb246ICIrc0FjdGlvbiApOwoJCQl9CgkJCQoJCQlyZXR1cm4gaU9sZFN0YXJ0ICE9IG9TZXR0aW5ncy5faURpc3BsYXlTdGFydDsKCQl9CgkJCgkJCgkJLyogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICoKCQkgKiBTZWN0aW9uIC0gRmVhdHVyZTogSFRNTCBpbmZvCgkJICovCgkJCgkJLyoKCQkgKiBGdW5jdGlvbjogX2ZuRmVhdHVyZUh0bWxJbmZvCgkJICogUHVycG9zZTogIEdlbmVyYXRlIHRoZSBub2RlIHJlcXVpcmVkIGZvciB0aGUgaW5mbyBkaXNwbGF5CgkJICogUmV0dXJuczogIG5vZGUKCQkgKiBJbnB1dHM6ICAgb2JqZWN0Om9TZXR0aW5ncyAtIGRhdGFUYWJsZXMgc2V0dGluZ3Mgb2JqZWN0CgkJICovCgkJZnVuY3Rpb24gX2ZuRmVhdHVyZUh0bWxJbmZvICggb1NldHRpbmdzICkKCQl7CgkJCXZhciBuSW5mbyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoICdkaXYnICk7CgkJCW5JbmZvLmNsYXNzTmFtZSA9IG9TZXR0aW5ncy5vQ2xhc3Nlcy5zSW5mbzsKCQkJCgkJCS8qIEFjdGlvbnMgdGhhdCBhcmUgdG8gYmUgdGFrZW4gb25jZSBvbmx5IGZvciB0aGlzIGZlYXR1cmUgKi8KCQkJaWYgKCB0eXBlb2Ygb1NldHRpbmdzLmFhbkZlYXR1cmVzLmkgPT0gInVuZGVmaW5lZCIgKQoJCQl7CgkJCQkvKiBBZGQgZHJhdyBjYWxsYmFjayAqLwoJCQkJb1NldHRpbmdzLmFvRHJhd0NhbGxiYWNrLnB1c2goIHsKCQkJCQkiZm4iOiBfZm5VcGRhdGVJbmZvLAoJCQkJCSJzTmFtZSI6ICJpbmZvcm1hdGlvbiIKCQkJCX0gKTsKCQkJCQoJCQkJLyogQWRkIGlkICovCgkJCQlpZiAoIG9TZXR0aW5ncy5zVGFibGVJZCAhPT0gJycgKQoJCQkJewoJCQkJCW5JbmZvLnNldEF0dHJpYnV0ZSggJ2lkJywgb1NldHRpbmdzLnNUYWJsZUlkKydfaW5mbycgKTsKCQkJCX0KCQkJfQoJCQkKCQkJcmV0dXJuIG5JbmZvOwoJCX0KCQkKCQkvKgoJCSAqIEZ1bmN0aW9uOiBfZm5VcGRhdGVJbmZvCgkJICogUHVycG9zZTogIFVwZGF0ZSB0aGUgaW5mb3JtYXRpb24gZWxlbWVudHMgaW4gdGhlIGRpc3BsYXkKCQkgKiBSZXR1cm5zOiAgLQoJCSAqIElucHV0czogICBvYmplY3Q6b1NldHRpbmdzIC0gZGF0YVRhYmxlcyBzZXR0aW5ncyBvYmplY3QKCQkgKi8KCQlmdW5jdGlvbiBfZm5VcGRhdGVJbmZvICggb1NldHRpbmdzICkKCQl7CgkJCS8qIFNob3cgaW5mb3JtYXRpb24gYWJvdXQgdGhlIHRhYmxlICovCgkJCWlmICggIW9TZXR0aW5ncy5vRmVhdHVyZXMuYkluZm8gfHwgb1NldHRpbmdzLmFhbkZlYXR1cmVzLmkubGVuZ3RoID09PSAwICkKCQkJewoJCQkJcmV0dXJuOwoJCQl9CgkJCQoJCQl2YXIKCQkJCWlTdGFydCA9IG9TZXR0aW5ncy5faURpc3BsYXlTdGFydCsxLCBpRW5kID0gb1NldHRpbmdzLmZuRGlzcGxheUVuZCgpLAoJCQkJaU1heCA9IG9TZXR0aW5ncy5mblJlY29yZHNUb3RhbCgpLCBpVG90YWwgPSBvU2V0dGluZ3MuZm5SZWNvcmRzRGlzcGxheSgpLAoJCQkJc1N0YXJ0ID0gb1NldHRpbmdzLmZuRm9ybWF0TnVtYmVyKCBpU3RhcnQgKSwgc0VuZCA9IG9TZXR0aW5ncy5mbkZvcm1hdE51bWJlciggaUVuZCApLAoJCQkJc01heCA9IG9TZXR0aW5ncy5mbkZvcm1hdE51bWJlciggaU1heCApLCBzVG90YWwgPSBvU2V0dGluZ3MuZm5Gb3JtYXROdW1iZXIoIGlUb3RhbCApLAoJCQkJc091dDsKCQkJCgkJCS8qIFdoZW4gaW5maW5pdGUgc2Nyb2xsaW5nLCB3ZSBhcmUgYWx3YXlzIHN0YXJ0aW5nIGF0IDEuIF9pRGlzcGxheVN0YXJ0IGlzIHVzZWQgb25seQoJCQkgKiBpbnRlcm5hbGx5CgkJCSAqLwoJCQlpZiAoIG9TZXR0aW5ncy5vU2Nyb2xsLmJJbmZpbml0ZSApCgkJCXsKCQkJCXNTdGFydCA9IG9TZXR0aW5ncy5mbkZvcm1hdE51bWJlciggMSApOwoJCQl9CgkJCQoJCQlpZiAoIG9TZXR0aW5ncy5mblJlY29yZHNEaXNwbGF5KCkgPT09IDAgJiYgCgkJCQkgICBvU2V0dGluZ3MuZm5SZWNvcmRzRGlzcGxheSgpID09IG9TZXR0aW5ncy5mblJlY29yZHNUb3RhbCgpICkKCQkJewoJCQkJLyogRW1wdHkgcmVjb3JkIHNldCAqLwoJCQkJc091dCA9IG9TZXR0aW5ncy5vTGFuZ3VhZ2Uuc0luZm9FbXB0eSsgb1NldHRpbmdzLm9MYW5ndWFnZS5zSW5mb1Bvc3RGaXg7CgkJCX0KCQkJZWxzZSBpZiAoIG9TZXR0aW5ncy5mblJlY29yZHNEaXNwbGF5KCkgPT09IDAgKQoJCQl7CgkJCQkvKiBSbXB0eSByZWNvcmQgc2V0IGFmdGVyIGZpbHRlcmluZyAqLwoJCQkJc091dCA9IG9TZXR0aW5ncy5vTGFuZ3VhZ2Uuc0luZm9FbXB0eSArJyAnKyAKCQkJCQlvU2V0dGluZ3Mub0xhbmd1YWdlLnNJbmZvRmlsdGVyZWQucmVwbGFjZSgnX01BWF8nLCBzTWF4KSsKCQkJCQkJb1NldHRpbmdzLm9MYW5ndWFnZS5zSW5mb1Bvc3RGaXg7CgkJCX0KCQkJZWxzZSBpZiAoIG9TZXR0aW5ncy5mblJlY29yZHNEaXNwbGF5KCkgPT0gb1NldHRpbmdzLmZuUmVjb3Jkc1RvdGFsKCkgKQoJCQl7CgkJCQkvKiBOb3JtYWwgcmVjb3JkIHNldCAqLwoJCQkJc091dCA9IG9TZXR0aW5ncy5vTGFuZ3VhZ2Uuc0luZm8uCgkJCQkJCXJlcGxhY2UoJ19TVEFSVF8nLCBzU3RhcnQpLgoJCQkJCQlyZXBsYWNlKCdfRU5EXycsICAgc0VuZCkuCgkJCQkJCXJlcGxhY2UoJ19UT1RBTF8nLCBzVG90YWwpKyAKCQkJCQlvU2V0dGluZ3Mub0xhbmd1YWdlLnNJbmZvUG9zdEZpeDsKCQkJfQoJCQllbHNlCgkJCXsKCQkJCS8qIFJlY29yZCBzZXQgYWZ0ZXIgZmlsdGVyaW5nICovCgkJCQlzT3V0ID0gb1NldHRpbmdzLm9MYW5ndWFnZS5zSW5mby4KCQkJCQkJcmVwbGFjZSgnX1NUQVJUXycsIHNTdGFydCkuCgkJCQkJCXJlcGxhY2UoJ19FTkRfJywgICBzRW5kKS4KCQkJCQkJcmVwbGFjZSgnX1RPVEFMXycsIHNUb3RhbCkgKycgJysgCgkJCQkJb1NldHRpbmdzLm9MYW5ndWFnZS5zSW5mb0ZpbHRlcmVkLnJlcGxhY2UoJ19NQVhfJywgCgkJCQkJCW9TZXR0aW5ncy5mbkZvcm1hdE51bWJlcihvU2V0dGluZ3MuZm5SZWNvcmRzVG90YWwoKSkpKyAKCQkJCQlvU2V0dGluZ3Mub0xhbmd1YWdlLnNJbmZvUG9zdEZpeDsKCQkJfQoJCQkKCQkJaWYgKCBvU2V0dGluZ3Mub0xhbmd1YWdlLmZuSW5mb0NhbGxiYWNrICE9PSBudWxsICkKCQkJewoJCQkJc091dCA9IG9TZXR0aW5ncy5vTGFuZ3VhZ2UuZm5JbmZvQ2FsbGJhY2soIG9TZXR0aW5ncywgaVN0YXJ0LCBpRW5kLCBpTWF4LCBpVG90YWwsIHNPdXQgKTsKCQkJfQoJCQkKCQkJdmFyIG4gPSBvU2V0dGluZ3MuYWFuRmVhdHVyZXMuaTsKCQkJZm9yICggdmFyIGk9MCwgaUxlbj1uLmxlbmd0aCA7IGk8aUxlbiA7IGkrKyApCgkJCXsKCQkJCSQobltpXSkuaHRtbCggc091dCApOwoJCQl9CgkJfQoJCQoJCQoJCS8qICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICoKCQkgKiBTZWN0aW9uIC0gRmVhdHVyZTogTGVuZ3RoIGNoYW5nZQoJCSAqLwoJCQoJCS8qCgkJICogRnVuY3Rpb246IF9mbkZlYXR1cmVIdG1sTGVuZ3RoCgkJICogUHVycG9zZTogIEdlbmVyYXRlIHRoZSBub2RlIHJlcXVpcmVkIGZvciB1c2VyIGRpc3BsYXkgbGVuZ3RoIGNoYW5naW5nCgkJICogUmV0dXJuczogIG5vZGUKCQkgKiBJbnB1dHM6ICAgb2JqZWN0Om9TZXR0aW5ncyAtIGRhdGFUYWJsZXMgc2V0dGluZ3Mgb2JqZWN0CgkJICovCgkJZnVuY3Rpb24gX2ZuRmVhdHVyZUh0bWxMZW5ndGggKCBvU2V0dGluZ3MgKQoJCXsKCQkJaWYgKCBvU2V0dGluZ3Mub1Njcm9sbC5iSW5maW5pdGUgKQoJCQl7CgkJCQlyZXR1cm4gbnVsbDsKCQkJfQoJCQkKCQkJLyogVGhpcyBjYW4gYmUgb3ZlcnJ1bGVkIGJ5IG5vdCB1c2luZyB0aGUgX01FTlVfIHZhci9tYWNybyBpbiB0aGUgbGFuZ3VhZ2UgdmFyaWFibGUgKi8KCQkJdmFyIHNOYW1lID0gKG9TZXR0aW5ncy5zVGFibGVJZCA9PT0gIiIpID8gIiIgOiAnbmFtZT0iJytvU2V0dGluZ3Muc1RhYmxlSWQrJ19sZW5ndGgiJzsKCQkJdmFyIHNTdGRNZW51ID0gJzxzZWxlY3Qgc2l6ZT0iMSIgJytzTmFtZSsnPic7CgkJCXZhciBpLCBpTGVuOwoJCQkKCQkJaWYgKCBvU2V0dGluZ3MuYUxlbmd0aE1lbnUubGVuZ3RoID09IDIgJiYgdHlwZW9mIG9TZXR0aW5ncy5hTGVuZ3RoTWVudVswXSA9PSAnb2JqZWN0JyAmJiAKCQkJCQl0eXBlb2Ygb1NldHRpbmdzLmFMZW5ndGhNZW51WzFdID09ICdvYmplY3QnICkKCQkJewoJCQkJZm9yICggaT0wLCBpTGVuPW9TZXR0aW5ncy5hTGVuZ3RoTWVudVswXS5sZW5ndGggOyBpPGlMZW4gOyBpKysgKQoJCQkJewoJCQkJCXNTdGRNZW51ICs9ICc8b3B0aW9uIHZhbHVlPSInK29TZXR0aW5ncy5hTGVuZ3RoTWVudVswXVtpXSsnIj4nKwoJCQkJCQlvU2V0dGluZ3MuYUxlbmd0aE1lbnVbMV1baV0rJzwvb3B0aW9uPic7CgkJCQl9CgkJCX0KCQkJZWxzZQoJCQl7CgkJCQlmb3IgKCBpPTAsIGlMZW49b1NldHRpbmdzLmFMZW5ndGhNZW51Lmxlbmd0aCA7IGk8aUxlbiA7IGkrKyApCgkJCQl7CgkJCQkJc1N0ZE1lbnUgKz0gJzxvcHRpb24gdmFsdWU9Iicrb1NldHRpbmdzLmFMZW5ndGhNZW51W2ldKyciPicrCgkJCQkJCW9TZXR0aW5ncy5hTGVuZ3RoTWVudVtpXSsnPC9vcHRpb24+JzsKCQkJCX0KCQkJfQoJCQlzU3RkTWVudSArPSAnPC9zZWxlY3Q+JzsKCQkJCgkJCXZhciBuTGVuZ3RoID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCggJ2RpdicgKTsKCQkJaWYgKCBvU2V0dGluZ3Muc1RhYmxlSWQgIT09ICcnICYmIHR5cGVvZiBvU2V0dGluZ3MuYWFuRmVhdHVyZXMubCA9PSAidW5kZWZpbmVkIiApCgkJCXsKCQkJCW5MZW5ndGguc2V0QXR0cmlidXRlKCAnaWQnLCBvU2V0dGluZ3Muc1RhYmxlSWQrJ19sZW5ndGgnICk7CgkJCX0KCQkJbkxlbmd0aC5jbGFzc05hbWUgPSBvU2V0dGluZ3Mub0NsYXNzZXMuc0xlbmd0aDsKCQkJbkxlbmd0aC5pbm5lckhUTUwgPSBvU2V0dGluZ3Mub0xhbmd1YWdlLnNMZW5ndGhNZW51LnJlcGxhY2UoICdfTUVOVV8nLCBzU3RkTWVudSApOwoJCQkKCQkJLyoKCQkJICogU2V0IHRoZSBsZW5ndGggdG8gdGhlIGN1cnJlbnQgZGlzcGxheSBsZW5ndGggLSB0aGFua3MgdG8gQW5kcmVhIFBhdmxvdmljIGZvciB0aGlzIGZpeCwKCQkJICogYW5kIFN0ZWZhbiBTa29wbmlrIGZvciBmaXhpbmcgdGhlIGZpeCEKCQkJICovCgkJCSQoJ3NlbGVjdCBvcHRpb25bdmFsdWU9Iicrb1NldHRpbmdzLl9pRGlzcGxheUxlbmd0aCsnIl0nLG5MZW5ndGgpLmF0dHIoInNlbGVjdGVkIix0cnVlKTsKCQkJCgkJCSQoJ3NlbGVjdCcsIG5MZW5ndGgpLmNoYW5nZSggZnVuY3Rpb24oZSkgewoJCQkJdmFyIGlWYWwgPSAkKHRoaXMpLnZhbCgpOwoJCQkJCgkJCQkvKiBVcGRhdGUgYWxsIG90aGVyIGxlbmd0aCBvcHRpb25zIGZvciB0aGUgbmV3IGRpc3BsYXkgKi8KCQkJCXZhciBuID0gb1NldHRpbmdzLmFhbkZlYXR1cmVzLmw7CgkJCQlmb3IgKCBpPTAsIGlMZW49bi5sZW5ndGggOyBpPGlMZW4gOyBpKysgKQoJCQkJewoJCQkJCWlmICggbltpXSAhPSB0aGlzLnBhcmVudE5vZGUgKQoJCQkJCXsKCQkJCQkJJCgnc2VsZWN0JywgbltpXSkudmFsKCBpVmFsICk7CgkJCQkJfQoJCQkJfQoJCQkJCgkJCQkvKiBSZWRyYXcgdGhlIHRhYmxlICovCgkJCQlvU2V0dGluZ3MuX2lEaXNwbGF5TGVuZ3RoID0gcGFyc2VJbnQoaVZhbCwgMTApOwoJCQkJX2ZuQ2FsY3VsYXRlRW5kKCBvU2V0dGluZ3MgKTsKCQkJCQoJCQkJLyogSWYgd2UgaGF2ZSBzcGFjZSB0byBzaG93IGV4dHJhIHJvd3MgKGJhY2tpbmcgdXAgZnJvbSB0aGUgZW5kIHBvaW50IC0gdGhlbiBkbyBzbyAqLwoJCQkJaWYgKCBvU2V0dGluZ3MuZm5EaXNwbGF5RW5kKCkgPT0gb1NldHRpbmdzLmZuUmVjb3Jkc0Rpc3BsYXkoKSApCgkJCQl7CgkJCQkJb1NldHRpbmdzLl9pRGlzcGxheVN0YXJ0ID0gb1NldHRpbmdzLmZuRGlzcGxheUVuZCgpIC0gb1NldHRpbmdzLl9pRGlzcGxheUxlbmd0aDsKCQkJCQlpZiAoIG9TZXR0aW5ncy5faURpc3BsYXlTdGFydCA8IDAgKQoJCQkJCXsKCQkJCQkJb1NldHRpbmdzLl9pRGlzcGxheVN0YXJ0ID0gMDsKCQkJCQl9CgkJCQl9CgkJCQkKCQkJCWlmICggb1NldHRpbmdzLl9pRGlzcGxheUxlbmd0aCA9PSAtMSApCgkJCQl7CgkJCQkJb1NldHRpbmdzLl9pRGlzcGxheVN0YXJ0ID0gMDsKCQkJCX0KCQkJCQoJCQkJX2ZuRHJhdyggb1NldHRpbmdzICk7CgkJCX0gKTsKCQkJCgkJCXJldHVybiBuTGVuZ3RoOwoJCX0KCQkKCQkKCQkvKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqCgkJICogU2VjdGlvbiAtIEZlYXR1cmU6IFByb2Nlc3NpbmcgaW5jaWRhdG9yCgkJICovCgkJCgkJLyoKCQkgKiBGdW5jdGlvbjogX2ZuRmVhdHVyZUh0bWxQcm9jZXNzaW5nCgkJICogUHVycG9zZTogIEdlbmVyYXRlIHRoZSBub2RlIHJlcXVpcmVkIGZvciB0aGUgcHJvY2Vzc2luZyBub2RlCgkJICogUmV0dXJuczogIG5vZGUKCQkgKiBJbnB1dHM6ICAgb2JqZWN0Om9TZXR0aW5ncyAtIGRhdGFUYWJsZXMgc2V0dGluZ3Mgb2JqZWN0CgkJICovCgkJZnVuY3Rpb24gX2ZuRmVhdHVyZUh0bWxQcm9jZXNzaW5nICggb1NldHRpbmdzICkKCQl7CgkJCXZhciBuUHJvY2Vzc2luZyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoICdkaXYnICk7CgkJCQoJCQlpZiAoIG9TZXR0aW5ncy5zVGFibGVJZCAhPT0gJycgJiYgdHlwZW9mIG9TZXR0aW5ncy5hYW5GZWF0dXJlcy5yID09ICJ1bmRlZmluZWQiICkKCQkJewoJCQkJblByb2Nlc3Npbmcuc2V0QXR0cmlidXRlKCAnaWQnLCBvU2V0dGluZ3Muc1RhYmxlSWQrJ19wcm9jZXNzaW5nJyApOwoJCQl9CgkJCW5Qcm9jZXNzaW5nLmlubmVySFRNTCA9IG9TZXR0aW5ncy5vTGFuZ3VhZ2Uuc1Byb2Nlc3Npbmc7CgkJCW5Qcm9jZXNzaW5nLmNsYXNzTmFtZSA9IG9TZXR0aW5ncy5vQ2xhc3Nlcy5zUHJvY2Vzc2luZzsKCQkJb1NldHRpbmdzLm5UYWJsZS5wYXJlbnROb2RlLmluc2VydEJlZm9yZSggblByb2Nlc3NpbmcsIG9TZXR0aW5ncy5uVGFibGUgKTsKCQkJCgkJCXJldHVybiBuUHJvY2Vzc2luZzsKCQl9CgkJCgkJLyoKCQkgKiBGdW5jdGlvbjogX2ZuUHJvY2Vzc2luZ0Rpc3BsYXkKCQkgKiBQdXJwb3NlOiAgRGlzcGxheSBvciBoaWRlIHRoZSBwcm9jZXNzaW5nIGluZGljYXRvcgoJCSAqIFJldHVybnM6ICAtCgkJICogSW5wdXRzOiAgIG9iamVjdDpvU2V0dGluZ3MgLSBkYXRhVGFibGVzIHNldHRpbmdzIG9iamVjdAoJCSAqICAgICAgICAgICBib29sOgoJCSAqICAgdHJ1ZSAtIHNob3cgdGhlIHByb2Nlc3NpbmcgaW5kaWNhdG9yCgkJICogICBmYWxzZSAtIGRvbid0IHNob3cKCQkgKi8KCQlmdW5jdGlvbiBfZm5Qcm9jZXNzaW5nRGlzcGxheSAoIG9TZXR0aW5ncywgYlNob3cgKQoJCXsKCQkJaWYgKCBvU2V0dGluZ3Mub0ZlYXR1cmVzLmJQcm9jZXNzaW5nICkKCQkJewoJCQkJdmFyIGFuID0gb1NldHRpbmdzLmFhbkZlYXR1cmVzLnI7CgkJCQlmb3IgKCB2YXIgaT0wLCBpTGVuPWFuLmxlbmd0aCA7IGk8aUxlbiA7IGkrKyApCgkJCQl7CgkJCQkJYW5baV0uc3R5bGUudmlzaWJpbGl0eSA9IGJTaG93ID8gInZpc2libGUiIDogImhpZGRlbiI7CgkJCQl9CgkJCX0KCQl9CgkJCgkJCgkJLyogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICoKCQkgKiBTZWN0aW9uIC0gU3VwcG9ydCBmdW5jdGlvbnMKCQkgKi8KCQkKCQkvKgoJCSAqIEZ1bmN0aW9uOiBfZm5WaXNpYmxlVG9Db2x1bW5JbmRleAoJCSAqIFB1cnBvc2U6ICBDb3ZlcnQgdGhlIGluZGV4IG9mIGEgdmlzaWJsZSBjb2x1bW4gdG8gdGhlIGluZGV4IGluIHRoZSBkYXRhIGFycmF5ICh0YWtlIGFjY291bnQKCQkgKiAgIG9mIGhpZGRlbiBjb2x1bW5zKQoJCSAqIFJldHVybnM6ICBpbnQ6aSAtIHRoZSBkYXRhIGluZGV4CgkJICogSW5wdXRzOiAgIG9iamVjdDpvU2V0dGluZ3MgLSBkYXRhVGFibGVzIHNldHRpbmdzIG9iamVjdAoJCSAqLwoJCWZ1bmN0aW9uIF9mblZpc2libGVUb0NvbHVtbkluZGV4KCBvU2V0dGluZ3MsIGlNYXRjaCApCgkJewoJCQl2YXIgaUNvbHVtbiA9IC0xOwoJCQkKCQkJZm9yICggdmFyIGk9MCA7IGk8b1NldHRpbmdzLmFvQ29sdW1ucy5sZW5ndGggOyBpKysgKQoJCQl7CgkJCQlpZiAoIG9TZXR0aW5ncy5hb0NvbHVtbnNbaV0uYlZpc2libGUgPT09IHRydWUgKQoJCQkJewoJCQkJCWlDb2x1bW4rKzsKCQkJCX0KCQkJCQoJCQkJaWYgKCBpQ29sdW1uID09IGlNYXRjaCApCgkJCQl7CgkJCQkJcmV0dXJuIGk7CgkJCQl9CgkJCX0KCQkJCgkJCXJldHVybiBudWxsOwoJCX0KCQkKCQkvKgoJCSAqIEZ1bmN0aW9uOiBfZm5Db2x1bW5JbmRleFRvVmlzaWJsZQoJCSAqIFB1cnBvc2U6ICBDb3ZlcnQgdGhlIGluZGV4IG9mIGFuIGluZGV4IGluIHRoZSBkYXRhIGFycmF5IGFuZCBjb252ZXJ0IGl0IHRvIHRoZSB2aXNpYmxlCgkJICogICBjb2x1bW4gaW5kZXggKHRha2UgYWNjb3VudCBvZiBoaWRkZW4gY29sdW1ucykKCQkgKiBSZXR1cm5zOiAgaW50OmkgLSB0aGUgZGF0YSBpbmRleAoJCSAqIElucHV0czogICBvYmplY3Q6b1NldHRpbmdzIC0gZGF0YVRhYmxlcyBzZXR0aW5ncyBvYmplY3QKCQkgKi8KCQlmdW5jdGlvbiBfZm5Db2x1bW5JbmRleFRvVmlzaWJsZSggb1NldHRpbmdzLCBpTWF0Y2ggKQoJCXsKCQkJdmFyIGlWaXNpYmxlID0gLTE7CgkJCWZvciAoIHZhciBpPTAgOyBpPG9TZXR0aW5ncy5hb0NvbHVtbnMubGVuZ3RoIDsgaSsrICkKCQkJewoJCQkJaWYgKCBvU2V0dGluZ3MuYW9Db2x1bW5zW2ldLmJWaXNpYmxlID09PSB0cnVlICkKCQkJCXsKCQkJCQlpVmlzaWJsZSsrOwoJCQkJfQoJCQkJCgkJCQlpZiAoIGkgPT0gaU1hdGNoICkKCQkJCXsKCQkJCQlyZXR1cm4gb1NldHRpbmdzLmFvQ29sdW1uc1tpXS5iVmlzaWJsZSA9PT0gdHJ1ZSA/IGlWaXNpYmxlIDogbnVsbDsKCQkJCX0KCQkJfQoJCQkKCQkJcmV0dXJuIG51bGw7CgkJfQoJCQoJCQoJCS8qCgkJICogRnVuY3Rpb246IF9mbk5vZGVUb0RhdGFJbmRleAoJCSAqIFB1cnBvc2U6ICBUYWtlIGEgVFIgZWxlbWVudCBhbmQgY29udmVydCBpdCB0byBhbiBpbmRleCBpbiBhb0RhdGEKCQkgKiBSZXR1cm5zOiAgaW50OmkgLSBpbmRleCBpZiBmb3VuZCwgbnVsbCBpZiBub3QKCQkgKiBJbnB1dHM6ICAgb2JqZWN0OnMgLSBkYXRhVGFibGVzIHNldHRpbmdzIG9iamVjdAoJCSAqICAgICAgICAgICBub2RlOm4gLSB0aGUgVFIgZWxlbWVudCB0byBmaW5kCgkJICovCgkJZnVuY3Rpb24gX2ZuTm9kZVRvRGF0YUluZGV4KCBzLCBuICkKCQl7CgkJCXZhciBpLCBpTGVuOwoJCQkKCQkJLyogT3B0aW1pc2F0aW9uIC0gc2VlIGlmIHRoZSBub2RlcyB3aGljaCBhcmUgY3VycmVudGx5IHZpc2libGUgbWF0Y2gsIHNpbmNlIHRoYXQgaXMKCQkJICogdGhlIG1vc3QgbGlrZWx5IG5vZGUgdG8gYmUgYXNrZWQgZm9yIChhIHNlbGVjdG9yIG9yIGV2ZW50IGZvciBleGFtcGxlKQoJCQkgKi8KCQkJZm9yICggaT1zLl9pRGlzcGxheVN0YXJ0LCBpTGVuPXMuX2lEaXNwbGF5RW5kIDsgaTxpTGVuIDsgaSsrICkKCQkJewoJCQkJaWYgKCBzLmFvRGF0YVsgcy5haURpc3BsYXlbaV0gXS5uVHIgPT0gbiApCgkJCQl7CgkJCQkJcmV0dXJuIHMuYWlEaXNwbGF5W2ldOwoJCQkJfQoJCQl9CgkJCQoJCQkvKiBPdGhlcndpc2Ugd2UgYXJlIGluIGZvciBhIHNsb2cgdGhyb3VnaCB0aGUgd2hvbGUgZGF0YSBjYWNoZSAqLwoJCQlmb3IgKCBpPTAsIGlMZW49cy5hb0RhdGEubGVuZ3RoIDsgaTxpTGVuIDsgaSsrICkKCQkJewoJCQkJaWYgKCBzLmFvRGF0YVtpXS5uVHIgPT0gbiApCgkJCQl7CgkJCQkJcmV0dXJuIGk7CgkJCQl9CgkJCX0KCQkJcmV0dXJuIG51bGw7CgkJfQoJCQoJCS8qCgkJICogRnVuY3Rpb246IF9mblZpc2JsZUNvbHVtbnMKCQkgKiBQdXJwb3NlOiAgR2V0IHRoZSBudW1iZXIgb2YgdmlzaWJsZSBjb2x1bW5zCgkJICogUmV0dXJuczogIGludDppIC0gdGhlIG51bWJlciBvZiB2aXNpYmxlIGNvbHVtbnMKCQkgKiBJbnB1dHM6ICAgb2JqZWN0Om9TIC0gZGF0YVRhYmxlcyBzZXR0aW5ncyBvYmplY3QKCQkgKi8KCQlmdW5jdGlvbiBfZm5WaXNibGVDb2x1bW5zKCBvUyApCgkJewoJCQl2YXIgaVZpcyA9IDA7CgkJCWZvciAoIHZhciBpPTAgOyBpPG9TLmFvQ29sdW1ucy5sZW5ndGggOyBpKysgKQoJCQl7CgkJCQlpZiAoIG9TLmFvQ29sdW1uc1tpXS5iVmlzaWJsZSA9PT0gdHJ1ZSApCgkJCQl7CgkJCQkJaVZpcysrOwoJCQkJfQoJCQl9CgkJCXJldHVybiBpVmlzOwoJCX0KCQkKCQkvKgoJCSAqIEZ1bmN0aW9uOiBfZm5DYWxjdWxhdGVFbmQKCQkgKiBQdXJwb3NlOiAgUmNhbGN1bGF0ZSB0aGUgZW5kIHBvaW50IGJhc2VkIG9uIHRoZSBzdGFydCBwb2ludAoJCSAqIFJldHVybnM6ICAtCgkJICogSW5wdXRzOiAgIG9iamVjdDpvU2V0dGluZ3MgLSBkYXRhVGFibGVzIHNldHRpbmdzIG9iamVjdAoJCSAqLwoJCWZ1bmN0aW9uIF9mbkNhbGN1bGF0ZUVuZCggb1NldHRpbmdzICkKCQl7CgkJCWlmICggb1NldHRpbmdzLm9GZWF0dXJlcy5iUGFnaW5hdGUgPT09IGZhbHNlICkKCQkJewoJCQkJb1NldHRpbmdzLl9pRGlzcGxheUVuZCA9IG9TZXR0aW5ncy5haURpc3BsYXkubGVuZ3RoOwoJCQl9CgkJCWVsc2UKCQkJewoJCQkJLyogU2V0IHRoZSBlbmQgcG9pbnQgb2YgdGhlIGRpc3BsYXkgLSBiYXNlZCBvbiBob3cgbWFueSBlbGVtZW50cyB0aGVyZSBhcmUKCQkJCSAqIHN0aWxsIHRvIGRpc3BsYXkKCQkJCSAqLwoJCQkJaWYgKCBvU2V0dGluZ3MuX2lEaXNwbGF5U3RhcnQgKyBvU2V0dGluZ3MuX2lEaXNwbGF5TGVuZ3RoID4gb1NldHRpbmdzLmFpRGlzcGxheS5sZW5ndGggfHwKCQkJCQkgICBvU2V0dGluZ3MuX2lEaXNwbGF5TGVuZ3RoID09IC0xICkKCQkJCXsKCQkJCQlvU2V0dGluZ3MuX2lEaXNwbGF5RW5kID0gb1NldHRpbmdzLmFpRGlzcGxheS5sZW5ndGg7CgkJCQl9CgkJCQllbHNlCgkJCQl7CgkJCQkJb1NldHRpbmdzLl9pRGlzcGxheUVuZCA9IG9TZXR0aW5ncy5faURpc3BsYXlTdGFydCArIG9TZXR0aW5ncy5faURpc3BsYXlMZW5ndGg7CgkJCQl9CgkJCX0KCQl9CgkJCgkJLyoKCQkgKiBGdW5jdGlvbjogX2ZuQ29udmVydFRvV2lkdGgKCQkgKiBQdXJwb3NlOiAgQ29udmVydCBhIENTUyB1bml0IHdpZHRoIHRvIHBpeGVscyAoZS5nLiAyZW0pCgkJICogUmV0dXJuczogIGludDppV2lkdGggLSB3aWR0aCBpbiBwaXhlbHMKCQkgKiBJbnB1dHM6ICAgc3RyaW5nOnNXaWR0aCAtIHdpZHRoIHRvIGJlIGNvbnZlcnRlZAoJCSAqICAgICAgICAgICBub2RlOm5QYXJlbnQgLSBwYXJlbnQgdG8gZ2V0IHRoZSB3aXRoIGZvciAocmVxdWlyZWQgZm9yCgkJICogICAgICAgICAgICAgcmVsYXRpdmUgd2lkdGhzKSAtIG9wdGlvbmFsCgkJICovCgkJZnVuY3Rpb24gX2ZuQ29udmVydFRvV2lkdGggKCBzV2lkdGgsIG5QYXJlbnQgKQoJCXsKCQkJaWYgKCAhc1dpZHRoIHx8IHNXaWR0aCA9PT0gbnVsbCB8fCBzV2lkdGggPT09ICcnICkKCQkJewoJCQkJcmV0dXJuIDA7CgkJCX0KCQkJCgkJCWlmICggdHlwZW9mIG5QYXJlbnQgPT0gInVuZGVmaW5lZCIgKQoJCQl7CgkJCQluUGFyZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ2JvZHknKVswXTsKCQkJfQoJCQkKCQkJdmFyIGlXaWR0aDsKCQkJdmFyIG5UbXAgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCAiZGl2IiApOwoJCQluVG1wLnN0eWxlLndpZHRoID0gc1dpZHRoOwoJCQkKCQkJblBhcmVudC5hcHBlbmRDaGlsZCggblRtcCApOwoJCQlpV2lkdGggPSBuVG1wLm9mZnNldFdpZHRoOwoJCQluUGFyZW50LnJlbW92ZUNoaWxkKCBuVG1wICk7CgkJCQoJCQlyZXR1cm4gKCBpV2lkdGggKTsKCQl9CgkJCgkJLyoKCQkgKiBGdW5jdGlvbjogX2ZuQ2FsY3VsYXRlQ29sdW1uV2lkdGhzCgkJICogUHVycG9zZTogIENhbGN1bGF0ZSB0aGUgd2lkdGggb2YgY29sdW1ucyBmb3IgdGhlIHRhYmxlCgkJICogUmV0dXJuczogIC0KCQkgKiBJbnB1dHM6ICAgb2JqZWN0Om9TZXR0aW5ncyAtIGRhdGFUYWJsZXMgc2V0dGluZ3Mgb2JqZWN0CgkJICovCgkJZnVuY3Rpb24gX2ZuQ2FsY3VsYXRlQ29sdW1uV2lkdGhzICggb1NldHRpbmdzICkKCQl7CgkJCXZhciBpVGFibGVXaWR0aCA9IG9TZXR0aW5ncy5uVGFibGUub2Zmc2V0V2lkdGg7CgkJCXZhciBpVXNlcklucHV0cyA9IDA7CgkJCXZhciBpVG1wV2lkdGg7CgkJCXZhciBpVmlzaWJsZUNvbHVtbnMgPSAwOwoJCQl2YXIgaUNvbHVtcyA9IG9TZXR0aW5ncy5hb0NvbHVtbnMubGVuZ3RoOwoJCQl2YXIgaTsKCQkJdmFyIG9IZWFkZXJzID0gJCgndGgnLCBvU2V0dGluZ3MublRIZWFkKTsKCQkJCgkJCS8qIENvbnZlcnQgYW55IHVzZXIgaW5wdXQgc2l6ZXMgaW50byBwaXhlbCBzaXplcyAqLwoJCQlmb3IgKCBpPTAgOyBpPGlDb2x1bXMgOyBpKysgKQoJCQl7CgkJCQlpZiAoIG9TZXR0aW5ncy5hb0NvbHVtbnNbaV0uYlZpc2libGUgKQoJCQkJewoJCQkJCWlWaXNpYmxlQ29sdW1ucysrOwoJCQkJCQoJCQkJCWlmICggb1NldHRpbmdzLmFvQ29sdW1uc1tpXS5zV2lkdGggIT09IG51bGwgKQoJCQkJCXsKCQkJCQkJaVRtcFdpZHRoID0gX2ZuQ29udmVydFRvV2lkdGgoIG9TZXR0aW5ncy5hb0NvbHVtbnNbaV0uc1dpZHRoT3JpZywgCgkJCQkJCQlvU2V0dGluZ3MublRhYmxlLnBhcmVudE5vZGUgKTsKCQkJCQkJaWYgKCBpVG1wV2lkdGggIT09IG51bGwgKQoJCQkJCQl7CgkJCQkJCQlvU2V0dGluZ3MuYW9Db2x1bW5zW2ldLnNXaWR0aCA9IF9mblN0cmluZ1RvQ3NzKCBpVG1wV2lkdGggKTsKCQkJCQkJfQoJCQkJCQkJCgkJCQkJCWlVc2VySW5wdXRzKys7CgkJCQkJfQoJCQkJfQoJCQl9CgkJCQoJCQkvKiBJZiB0aGUgbnVtYmVyIG9mIGNvbHVtbnMgaW4gdGhlIERPTSBlcXVhbHMgdGhlIG51bWJlciB0aGF0IHdlIGhhdmUgdG8gcHJvY2VzcyBpbiAKCQkJICogRGF0YVRhYmxlcywgdGhlbiB3ZSBjYW4gdXNlIHRoZSBvZmZzZXRzIHRoYXQgYXJlIGNyZWF0ZWQgYnkgdGhlIHdlYi1icm93c2VyLiBObyBjdXN0b20gCgkJCSAqIHNpemVzIGNhbiBiZSBzZXQgaW4gb3JkZXIgZm9yIHRoaXMgdG8gaGFwcGVuLCBub3Igc2Nyb2xsaW5nIHVzZWQKCQkJICovCgkJCWlmICggaUNvbHVtcyA9PSBvSGVhZGVycy5sZW5ndGggJiYgaVVzZXJJbnB1dHMgPT09IDAgJiYgaVZpc2libGVDb2x1bW5zID09IGlDb2x1bXMgJiYKCQkJCW9TZXR0aW5ncy5vU2Nyb2xsLnNYID09PSAiIiAmJiBvU2V0dGluZ3Mub1Njcm9sbC5zWSA9PT0gIiIgKQoJCQl7CgkJCQlmb3IgKCBpPTAgOyBpPG9TZXR0aW5ncy5hb0NvbHVtbnMubGVuZ3RoIDsgaSsrICkKCQkJCXsKCQkJCQlpVG1wV2lkdGggPSAkKG9IZWFkZXJzW2ldKS53aWR0aCgpOwoJCQkJCWlmICggaVRtcFdpZHRoICE9PSBudWxsICkKCQkJCQl7CgkJCQkJCW9TZXR0aW5ncy5hb0NvbHVtbnNbaV0uc1dpZHRoID0gX2ZuU3RyaW5nVG9Dc3MoIGlUbXBXaWR0aCApOwoJCQkJCX0KCQkJCX0KCQkJfQoJCQllbHNlCgkJCXsKCQkJCS8qIE90aGVyd2lzZSB3ZSBhcmUgZ29pbmcgdG8gaGF2ZSB0byBkbyBzb21lIGNhbGN1bGF0aW9ucyB0byBnZXQgdGhlIHdpZHRoIG9mIGVhY2ggY29sdW1uLgoJCQkJICogQ29uc3RydWN0IGEgMSByb3cgdGFibGUgd2l0aCB0aGUgd2lkZXN0IG5vZGUgaW4gdGhlIGRhdGEsIGFuZCBhbnkgdXNlciBkZWZpbmVkIHdpZHRocywKCQkJCSAqIHRoZW4gaW5zZXJ0IGl0IGludG8gdGhlIERPTSBhbmQgYWxsb3cgdGhlIGJyb3dzZXIgdG8gZG8gYWxsIHRoZSBoYXJkIHdvcmsgb2YKCQkJCSAqIGNhbGN1bGF0aW5nIHRhYmxlIHdpZHRocy4KCQkJCSAqLwoJCQkJdmFyCgkJCQkJbkNhbGNUbXAgPSBvU2V0dGluZ3MublRhYmxlLmNsb25lTm9kZSggZmFsc2UgKSwKCQkJCQluQm9keSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoICd0Ym9keScgKSwKCQkJCQluVHIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCAndHInICksCgkJCQkJbkRpdlNpemluZzsKCQkJCQoJCQkJbkNhbGNUbXAucmVtb3ZlQXR0cmlidXRlKCAiaWQiICk7CgkJCQluQ2FsY1RtcC5hcHBlbmRDaGlsZCggb1NldHRpbmdzLm5USGVhZC5jbG9uZU5vZGUodHJ1ZSkgKTsKCQkJCWlmICggb1NldHRpbmdzLm5URm9vdCAhPT0gbnVsbCApCgkJCQl7CgkJCQkJbkNhbGNUbXAuYXBwZW5kQ2hpbGQoIG9TZXR0aW5ncy5uVEZvb3QuY2xvbmVOb2RlKHRydWUpICk7CgkJCQkJX2ZuQXBwbHlUb0NoaWxkcmVuKCBmdW5jdGlvbihuKSB7CgkJCQkJCW4uc3R5bGUud2lkdGggPSAiIjsKCQkJCQl9LCBuQ2FsY1RtcC5nZXRFbGVtZW50c0J5VGFnTmFtZSgndHInKSApOwoJCQkJfQoJCQkJCgkJCQluQ2FsY1RtcC5hcHBlbmRDaGlsZCggbkJvZHkgKTsKCQkJCW5Cb2R5LmFwcGVuZENoaWxkKCBuVHIgKTsKCQkJCQoJCQkJLyogUmVtb3ZlIGFueSBzaXppbmcgdGhhdCB3YXMgcHJldmlvdXNseSBhcHBsaWVkIGJ5IHRoZSBzdHlsZXMgKi8KCQkJCXZhciBqcUNvbFNpemluZyA9ICQoJ3RoZWFkIHRoJywgbkNhbGNUbXApOwoJCQkJaWYgKCBqcUNvbFNpemluZy5sZW5ndGggPT09IDAgKQoJCQkJewoJCQkJCWpxQ29sU2l6aW5nID0gJCgndGJvZHkgdHI6ZXEoMCk+dGQnLCBuQ2FsY1RtcCk7CgkJCQl9CgkJCQlqcUNvbFNpemluZy5lYWNoKCBmdW5jdGlvbiAoaSkgewoJCQkJCXRoaXMuc3R5bGUud2lkdGggPSAiIjsKCQkJCQkKCQkJCQl2YXIgaUluZGV4ID0gX2ZuVmlzaWJsZVRvQ29sdW1uSW5kZXgoIG9TZXR0aW5ncywgaSApOwoJCQkJCWlmICggaUluZGV4ICE9PSBudWxsICYmIG9TZXR0aW5ncy5hb0NvbHVtbnNbaUluZGV4XS5zV2lkdGhPcmlnICE9PSAiIiApCgkJCQkJewoJCQkJCQl0aGlzLnN0eWxlLndpZHRoID0gb1NldHRpbmdzLmFvQ29sdW1uc1tpSW5kZXhdLnNXaWR0aE9yaWc7CgkJCQkJfQoJCQkJfSApOwoJCQkJCgkJCQkvKiBGaW5kIHRoZSBiaWdnZXN0IHRkIGZvciBlYWNoIGNvbHVtbiBhbmQgcHV0IGl0IGludG8gdGhlIHRhYmxlICovCgkJCQlmb3IgKCBpPTAgOyBpPGlDb2x1bXMgOyBpKysgKQoJCQkJewoJCQkJCWlmICggb1NldHRpbmdzLmFvQ29sdW1uc1tpXS5iVmlzaWJsZSApCgkJCQkJewoJCQkJCQl2YXIgblRkID0gX2ZuR2V0V2lkZXN0Tm9kZSggb1NldHRpbmdzLCBpICk7CgkJCQkJCWlmICggblRkICE9PSBudWxsICkKCQkJCQkJewoJCQkJCQkJblRkID0gblRkLmNsb25lTm9kZSh0cnVlKTsKCQkJCQkJCW5Uci5hcHBlbmRDaGlsZCggblRkICk7CgkJCQkJCX0KCQkJCQl9CgkJCQl9CgkJCQkKCQkJCS8qIEJ1aWxkIHRoZSB0YWJsZSBhbmQgJ2Rpc3BsYXknIGl0ICovCgkJCQl2YXIgbldyYXBwZXIgPSBvU2V0dGluZ3MublRhYmxlLnBhcmVudE5vZGU7CgkJCQluV3JhcHBlci5hcHBlbmRDaGlsZCggbkNhbGNUbXAgKTsKCQkJCQoJCQkJLyogV2hlbiBzY3JvbGxpbmcgKFggb3IgWSkgd2Ugd2FudCB0byBzZXQgdGhlIHdpZHRoIG9mIHRoZSB0YWJsZSBhcyBhcHByb3ByaWF0ZS4gSG93ZXZlciwKCQkJCSAqIHdoZW4gbm90IHNjcm9sbGluZyBsZWF2ZSB0aGUgdGFibGUgd2lkdGggYXMgaXQgaXMuIFRoaXMgcmVzdWx0cyBpbiBzbGlnaHRseSBkaWZmZXJlbnQsCgkJCQkgKiBidXQgSSB0aGluayBjb3JyZWN0IGJlaGF2aW91cgoJCQkJICovCgkJCQlpZiAoIG9TZXR0aW5ncy5vU2Nyb2xsLnNYICE9PSAiIiAmJiBvU2V0dGluZ3Mub1Njcm9sbC5zWElubmVyICE9PSAiIiApCgkJCQl7CgkJCQkJbkNhbGNUbXAuc3R5bGUud2lkdGggPSBfZm5TdHJpbmdUb0NzcyhvU2V0dGluZ3Mub1Njcm9sbC5zWElubmVyKTsKCQkJCX0KCQkJCWVsc2UgaWYgKCBvU2V0dGluZ3Mub1Njcm9sbC5zWCAhPT0gIiIgKQoJCQkJewoJCQkJCW5DYWxjVG1wLnN0eWxlLndpZHRoID0gIiI7CgkJCQkJaWYgKCAkKG5DYWxjVG1wKS53aWR0aCgpIDwgbldyYXBwZXIub2Zmc2V0V2lkdGggKQoJCQkJCXsKCQkJCQkJbkNhbGNUbXAuc3R5bGUud2lkdGggPSBfZm5TdHJpbmdUb0NzcyggbldyYXBwZXIub2Zmc2V0V2lkdGggKTsKCQkJCQl9CgkJCQl9CgkJCQllbHNlIGlmICggb1NldHRpbmdzLm9TY3JvbGwuc1kgIT09ICIiICkKCQkJCXsKCQkJCQluQ2FsY1RtcC5zdHlsZS53aWR0aCA9IF9mblN0cmluZ1RvQ3NzKCBuV3JhcHBlci5vZmZzZXRXaWR0aCApOwoJCQkJfQoJCQkJbkNhbGNUbXAuc3R5bGUudmlzaWJpbGl0eSA9ICJoaWRkZW4iOwoJCQkJCgkJCQkvKiBTY3JvbGxpbmcgY29uc2lkZXJhdGlvbnMgKi8KCQkJCV9mblNjcm9sbGluZ1dpZHRoQWRqdXN0KCBvU2V0dGluZ3MsIG5DYWxjVG1wICk7CgkJCQkKCQkJCS8qIFJlYWQgdGhlIHdpZHRoJ3MgY2FsY3VsYXRlZCBieSB0aGUgYnJvd3NlciBhbmQgc3RvcmUgdGhlbSBmb3IgdXNlIGJ5IHRoZSBjYWxsZXIuIFdlCgkJCQkgKiBmaXJzdCBvZiBhbGwgdHJ5IHRvIHVzZSB0aGUgZWxlbWVudHMgaW4gdGhlIGJvZHksIGJ1dCBpdCBpcyBwb3NzaWJsZSB0aGF0IHRoZXJlIGFyZQoJCQkJICogbm8gZWxlbWVudHMgdGhlcmUsIHVuZGVyIHdoaWNoIGNpcmN1bXN0YW5jZXMgd2UgdXNlIHRoZSBoZWFkZXIgZWxlbWVudHMKCQkJCSAqLwoJCQkJdmFyIG9Ob2RlcyA9ICQoInRib2R5IHRyOmVxKDApPnRkIiwgbkNhbGNUbXApOwoJCQkJaWYgKCBvTm9kZXMubGVuZ3RoID09PSAwICkKCQkJCXsKCQkJCQlvTm9kZXMgPSAkKCJ0aGVhZCB0cjplcSgwKT50aCIsIG5DYWxjVG1wKTsKCQkJCX0KCQkJCQoJCQkJdmFyIGlJbmRleCwgaUNvcnJlY3RvciA9IDAsIGlXaWR0aDsKCQkJCWZvciAoIGk9MCA7IGk8b1NldHRpbmdzLmFvQ29sdW1ucy5sZW5ndGggOyBpKysgKQoJCQkJewoJCQkJCWlmICggb1NldHRpbmdzLmFvQ29sdW1uc1tpXS5iVmlzaWJsZSApCgkJCQkJewoJCQkJCQlpV2lkdGggPSAkKG9Ob2Rlc1tpQ29ycmVjdG9yXSkud2lkdGgoKTsKCQkJCQkJaWYgKCBpV2lkdGggIT09IG51bGwgJiYgaVdpZHRoID4gMCApCgkJCQkJCXsKCQkJCQkJCW9TZXR0aW5ncy5hb0NvbHVtbnNbaV0uc1dpZHRoID0gX2ZuU3RyaW5nVG9Dc3MoIGlXaWR0aCApOwoJCQkJCQl9CgkJCQkJCWlDb3JyZWN0b3IrKzsKCQkJCQl9CgkJCQl9CgkJCQkKCQkJCW9TZXR0aW5ncy5uVGFibGUuc3R5bGUud2lkdGggPSBfZm5TdHJpbmdUb0NzcyggJChuQ2FsY1RtcCkub3V0ZXJXaWR0aCgpICk7CgkJCQluQ2FsY1RtcC5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKCBuQ2FsY1RtcCApOwoJCQl9CgkJfQoJCQoJCS8qCgkJICogRnVuY3Rpb246IF9mblNjcm9sbGluZ1dpZHRoQWRqdXN0CgkJICogUHVycG9zZTogIEFkanVzdCBhIHRhYmxlJ3Mgd2lkdGggdG8gdGFrZSBhY2NvdW50IG9mIHNjcm9sbGluZwoJCSAqIFJldHVybnM6ICAtCgkJICogSW5wdXRzOiAgIG9iamVjdDpvU2V0dGluZ3MgLSBkYXRhVGFibGVzIHNldHRpbmdzIG9iamVjdAoJCSAqICAgICAgICAgICBub2RlOm4gLSB0YWJsZSBub2RlCgkJICovCgkJZnVuY3Rpb24gX2ZuU2Nyb2xsaW5nV2lkdGhBZGp1c3QgKCBvU2V0dGluZ3MsIG4gKQoJCXsKCQkJaWYgKCBvU2V0dGluZ3Mub1Njcm9sbC5zWCA9PT0gIiIgJiYgb1NldHRpbmdzLm9TY3JvbGwuc1kgIT09ICIiICkKCQkJewoJCQkJLyogV2hlbiB5LXNjcm9sbGluZyBvbmx5LCB3ZSB3YW50IHRvIHJlbW92ZSB0aGUgd2lkdGggb2YgdGhlIHNjcm9sbCBiYXIgc28gdGhlIHRhYmxlCgkJCQkgKiArIHNjcm9sbCBiYXIgd2lsbCBmaXQgaW50byB0aGUgYXJlYSBhdmFpYWxibGUuCgkJCQkgKi8KCQkJCXZhciBpT3JpZ1dpZHRoID0gJChuKS53aWR0aCgpOwoJCQkJbi5zdHlsZS53aWR0aCA9IF9mblN0cmluZ1RvQ3NzKCAkKG4pLm91dGVyV2lkdGgoKS1vU2V0dGluZ3Mub1Njcm9sbC5pQmFyV2lkdGggKTsKCQkJfQoJCQllbHNlIGlmICggb1NldHRpbmdzLm9TY3JvbGwuc1ggIT09ICIiICkKCQkJewoJCQkJLyogV2hlbiB4LXNjcm9sbGluZyBib3RoIHdheXMsIGZpeCB0aGUgdGFibGUgYXQgaXQncyBjdXJyZW50IHNpemUsIHdpdGhvdXQgYWRqdXN0aW5nICovCgkJCQluLnN0eWxlLndpZHRoID0gX2ZuU3RyaW5nVG9Dc3MoICQobikub3V0ZXJXaWR0aCgpICk7CgkJCX0KCQl9CgkJCgkJLyoKCQkgKiBGdW5jdGlvbjogX2ZuR2V0V2lkZXN0Tm9kZQoJCSAqIFB1cnBvc2U6ICBHZXQgdGhlIHdpZGVzdCBub2RlCgkJICogUmV0dXJuczogIHN0cmluZzogLSBtYXggc3RybGVucyBmb3IgZWFjaCBjb2x1bW4KCQkgKiBJbnB1dHM6ICAgb2JqZWN0Om9TZXR0aW5ncyAtIGRhdGFUYWJsZXMgc2V0dGluZ3Mgb2JqZWN0CgkJICogICAgICAgICAgIGludDppQ29sIC0gY29sdW1uIG9mIGludGVyZXN0CgkJICogICAgICAgICAgIGJvb2xlYW46YkZhc3QgLSBTaG91bGQgd2UgdXNlIGZhc3QgKGJ1dCBub24tYWNjdXJhdGUpIGNhbGN1bGF0aW9uIC0gb3B0aW9uYWwsCgkJICogICAgICAgICAgICAgZGVmYXVsdCB0cnVlCgkJICogTm90ZXM6ICAgIFRoaXMgb3BlcmF0aW9uIGlzIF9leHBlbnNpdmVfICghISEpLiBJdCByZXF1aXJlcyBhIGxvdCBvZiBET00gaW50ZXJhY3Rpb24sIGJ1dAoJCSAqICAgdGhpcyBpcyB0aGUgb25seSB3YXkgdG8gcmVsaWFibHkgZ2V0IHRoZSB3aWRlc3Qgc3RyaW5nLiBGb3IgZXhhbXBsZSAnbW1tJyB3b3VsZCBiZSB3aWRlcgoJCSAqICAgdGhhbiAnaWlpaScgc28gd2UgY2FuJ3QganVzdCBvY3VudCBjaGFyYWN0ZXJzLiBJZiB0aGlzIGNhbiBiZSBvcHRpbWlzZWQgaXQgd291bGQgYmUgZ29vZAoJCSAqICAgdG8gZG8gc28hCgkJICovCgkJZnVuY3Rpb24gX2ZuR2V0V2lkZXN0Tm9kZSggb1NldHRpbmdzLCBpQ29sLCBiRmFzdCApCgkJewoJCQkvKiBVc2UgZmFzdCBub3Qgbm9uLWFjY3VyYXRlIGNhbGN1bGF0ZSBiYXNlZCBvbiB0aGUgc3RybGVuICovCgkJCWlmICggdHlwZW9mIGJGYXN0ID09ICd1bmRlZmluZWQnIHx8IGJGYXN0ICkKCQkJewoJCQkJdmFyIGlNYXhMZW4gPSBfZm5HZXRNYXhMZW5TdHJpbmcoIG9TZXR0aW5ncywgaUNvbCApOwoJCQkJdmFyIGlGYXN0VmlzID0gX2ZuQ29sdW1uSW5kZXhUb1Zpc2libGUoIG9TZXR0aW5ncywgaUNvbCk7CgkJCQlpZiAoIGlNYXhMZW4gPCAwICkKCQkJCXsKCQkJCQlyZXR1cm4gbnVsbDsKCQkJCX0KCQkJCXJldHVybiBvU2V0dGluZ3MuYW9EYXRhW2lNYXhMZW5dLm5Uci5nZXRFbGVtZW50c0J5VGFnTmFtZSgndGQnKVtpRmFzdFZpc107CgkJCX0KCQkJCgkJCS8qIFVzZSB0aGUgc2xvdyBhcHByb2FjaCwgYnV0IGdldCBoaWdoIHF1YWxpdHkgYW5zd2VycyAtIG5vdGUgdGhhdCB0aGlzIGNvZGUgaXMgbm90IGFjdHVhbGx5CgkJCSAqIHVzZWQgYnkgRGF0YVRhYmxlcyBieSBkZWZhdWx0LiBJZiB5b3Ugd2FudCB0byB1c2UgaXQgeW91IGNhbiBhbHRlciB0aGUgY2FsbCB0byAKCQkJICogX2ZuR2V0V2lkZXN0Tm9kZSB0byBwYXNzICdmYWxzZScgYXMgdGhlIHRoaXJkIGFyZ3VtZW50CgkJCSAqLwoJCQl2YXIKCQkJCWlNYXggPSAtMSwgaSwgaUxlbiwKCQkJCWlNYXhJbmRleCA9IC0xLAoJCQkJbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOwoJCQkKCQkJbi5zdHlsZS52aXNpYmlsaXR5ID0gImhpZGRlbiI7CgkJCW4uc3R5bGUucG9zaXRpb24gPSAiYWJzb2x1dGUiOwoJCQlkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKCBuICk7CgkJCQoJCQlmb3IgKCBpPTAsIGlMZW49b1NldHRpbmdzLmFvRGF0YS5sZW5ndGggOyBpPGlMZW4gOyBpKysgKQoJCQl7CgkJCQluLmlubmVySFRNTCA9IG9TZXR0aW5ncy5hb0RhdGFbaV0uX2FEYXRhW2lDb2xdOwoJCQkJaWYgKCBuLm9mZnNldFdpZHRoID4gaU1heCApCgkJCQl7CgkJCQkJaU1heCA9IG4ub2Zmc2V0V2lkdGg7CgkJCQkJaU1heEluZGV4ID0gaTsKCQkJCX0KCQkJfQoJCQlkb2N1bWVudC5ib2R5LnJlbW92ZUNoaWxkKCBuICk7CgkJCQoJCQlpZiAoIGlNYXhJbmRleCA+PSAwICkKCQkJewoJCQkJdmFyIGlWaXMgPSBfZm5Db2x1bW5JbmRleFRvVmlzaWJsZSggb1NldHRpbmdzLCBpQ29sKTsKCQkJCXZhciBuUmV0ID0gb1NldHRpbmdzLmFvRGF0YVtpTWF4SW5kZXhdLm5Uci5nZXRFbGVtZW50c0J5VGFnTmFtZSgndGQnKVtpVmlzXTsKCQkJCWlmICggblJldCApCgkJCQl7CgkJCQkJcmV0dXJuIG5SZXQ7CgkJCQl9CgkJCX0KCQkJcmV0dXJuIG51bGw7CgkJfQoJCQoJCS8qCgkJICogRnVuY3Rpb246IF9mbkdldE1heExlblN0cmluZwoJCSAqIFB1cnBvc2U6ICBHZXQgdGhlIG1heGltdW0gc3RybGVuIGZvciBlYWNoIGRhdGEgY29sdW1uCgkJICogUmV0dXJuczogIHN0cmluZzogLSBtYXggc3RybGVucyBmb3IgZWFjaCBjb2x1bW4KCQkgKiBJbnB1dHM6ICAgb2JqZWN0Om9TZXR0aW5ncyAtIGRhdGFUYWJsZXMgc2V0dGluZ3Mgb2JqZWN0CgkJICogICAgICAgICAgIGludDppQ29sIC0gY29sdW1uIG9mIGludGVyZXN0CgkJICovCgkJZnVuY3Rpb24gX2ZuR2V0TWF4TGVuU3RyaW5nKCBvU2V0dGluZ3MsIGlDb2wgKQoJCXsKCQkJdmFyIGlNYXggPSAtMTsKCQkJdmFyIGlNYXhJbmRleCA9IC0xOwoJCQkKCQkJZm9yICggdmFyIGk9MCA7IGk8b1NldHRpbmdzLmFvRGF0YS5sZW5ndGggOyBpKysgKQoJCQl7CgkJCQl2YXIgcyA9IG9TZXR0aW5ncy5hb0RhdGFbaV0uX2FEYXRhW2lDb2xdOwoJCQkJaWYgKCBzLmxlbmd0aCA+IGlNYXggKQoJCQkJewoJCQkJCWlNYXggPSBzLmxlbmd0aDsKCQkJCQlpTWF4SW5kZXggPSBpOwoJCQkJfQoJCQl9CgkJCQoJCQlyZXR1cm4gaU1heEluZGV4OwoJCX0KCQkKCQkvKgoJCSAqIEZ1bmN0aW9uOiBfZm5TdHJpbmdUb0NzcwoJCSAqIFB1cnBvc2U6ICBBcHBlbmQgYSBDU1MgdW5pdCAob25seSBpZiByZXF1aXJlZCkgdG8gYSBzdHJpbmcKCQkgKiBSZXR1cm5zOiAgMCBpZiBtYXRjaCwgMSBpZiBsZW5ndGggaXMgZGlmZmVyZW50LCAyIGlmIG5vIG1hdGNoCgkJICogSW5wdXRzOiAgIGFycmF5OmFBcnJheTEgLSBmaXJzdCBhcnJheQoJCSAqICAgICAgICAgICBhcnJheTphQXJyYXkyIC0gc2Vjb25kIGFycmF5CgkJICovCgkJZnVuY3Rpb24gX2ZuU3RyaW5nVG9Dc3MoIHMgKQoJCXsKCQkJaWYgKCBzID09PSBudWxsICkKCQkJewoJCQkJcmV0dXJuICIwcHgiOwoJCQl9CgkJCQoJCQlpZiAoIHR5cGVvZiBzID09ICdudW1iZXInICkKCQkJewoJCQkJaWYgKCBzIDwgMCApCgkJCQl7CgkJCQkJcmV0dXJuICIwcHgiOwoJCQkJfQoJCQkJcmV0dXJuIHMrInB4IjsKCQkJfQoJCQkKCQkJLyogQ2hlY2sgaWYgdGhlIGxhc3QgY2hhcmFjdGVyIGlzIG5vdCAwLTkgKi8KCQkJdmFyIGMgPSBzLmNoYXJDb2RlQXQoIHMubGVuZ3RoLTEgKTsKCQkJaWYgKGMgPCAweDMwIHx8IGMgPiAweDM5KQoJCQl7CgkJCQlyZXR1cm4gczsKCQkJfQoJCQlyZXR1cm4gcysicHgiOwoJCX0KCQkKCQkvKgoJCSAqIEZ1bmN0aW9uOiBfZm5BcnJheUNtcAoJCSAqIFB1cnBvc2U6ICBDb21wYXJlIHR3byBhcnJheXMKCQkgKiBSZXR1cm5zOiAgMCBpZiBtYXRjaCwgMSBpZiBsZW5ndGggaXMgZGlmZmVyZW50LCAyIGlmIG5vIG1hdGNoCgkJICogSW5wdXRzOiAgIGFycmF5OmFBcnJheTEgLSBmaXJzdCBhcnJheQoJCSAqICAgICAgICAgICBhcnJheTphQXJyYXkyIC0gc2Vjb25kIGFycmF5CgkJICovCgkJZnVuY3Rpb24gX2ZuQXJyYXlDbXAoIGFBcnJheTEsIGFBcnJheTIgKQoJCXsKCQkJaWYgKCBhQXJyYXkxLmxlbmd0aCAhPSBhQXJyYXkyLmxlbmd0aCApCgkJCXsKCQkJCXJldHVybiAxOwoJCQl9CgkJCQoJCQlmb3IgKCB2YXIgaT0wIDsgaTxhQXJyYXkxLmxlbmd0aCA7IGkrKyApCgkJCXsKCQkJCWlmICggYUFycmF5MVtpXSAhPSBhQXJyYXkyW2ldICkKCQkJCXsKCQkJCQlyZXR1cm4gMjsKCQkJCX0KCQkJfQoJCQkKCQkJcmV0dXJuIDA7CgkJfQoJCQoJCS8qCgkJICogRnVuY3Rpb246IF9mbkRldGVjdFR5cGUKCQkgKiBQdXJwb3NlOiAgR2V0IHRoZSBzb3J0IHR5cGUgYmFzZWQgb24gYW4gaW5wdXQgc3RyaW5nCgkJICogUmV0dXJuczogIHN0cmluZzogLSB0eXBlIChkZWZhdWx0cyB0byAnc3RyaW5nJyBpZiBubyB0eXBlIGNhbiBiZSBkZXRlY3RlZCkKCQkgKiBJbnB1dHM6ICAgc3RyaW5nOnNEYXRhIC0gZGF0YSB3ZSB3aXNoIHRvIGtub3cgdGhlIHR5cGUgb2YKCQkgKiBOb3RlczogICAgVGhpcyBmdW5jdGlvbiBtYWtlcyB1c2Ugb2YgdGhlIERhdGFUYWJsZXMgcGx1Z2luIG9iamN0IF9vRXh0IAoJCSAqICAgKC5hVHlwZXMpIHN1Y2ggdGhhdCBuZXcgdHlwZXMgY2FuIGVhc2lseSBiZSBhZGRlZC4KCQkgKi8KCQlmdW5jdGlvbiBfZm5EZXRlY3RUeXBlKCBzRGF0YSApCgkJewoJCQl2YXIgYVR5cGVzID0gX29FeHQuYVR5cGVzOwoJCQl2YXIgaUxlbiA9IGFUeXBlcy5sZW5ndGg7CgkJCQoJCQlmb3IgKCB2YXIgaT0wIDsgaTxpTGVuIDsgaSsrICkKCQkJewoJCQkJdmFyIHNUeXBlID0gYVR5cGVzW2ldKCBzRGF0YSApOwoJCQkJaWYgKCBzVHlwZSAhPT0gbnVsbCApCgkJCQl7CgkJCQkJcmV0dXJuIHNUeXBlOwoJCQkJfQoJCQl9CgkJCQoJCQlyZXR1cm4gJ3N0cmluZyc7CgkJfQoJCQoJCS8qCgkJICogRnVuY3Rpb246IF9mblNldHRpbmdzRnJvbU5vZGUKCQkgKiBQdXJwb3NlOiAgUmV0dXJuIHRoZSBzZXR0aW5ncyBvYmplY3QgZm9yIGEgcGFydGljdWxhciB0YWJsZQoJCSAqIFJldHVybnM6ICBvYmplY3Q6IFNldHRpbmdzIG9iamVjdCAtIG9yIG51bGwgaWYgbm90IGZvdW5kCgkJICogSW5wdXRzOiAgIG5vZGU6blRhYmxlIC0gdGFibGUgd2UgYXJlIHVzaW5nIGFzIGEgZGF0YVRhYmxlCgkJICovCgkJZnVuY3Rpb24gX2ZuU2V0dGluZ3NGcm9tTm9kZSAoIG5UYWJsZSApCgkJewoJCQlmb3IgKCB2YXIgaT0wIDsgaTxfYW9TZXR0aW5ncy5sZW5ndGggOyBpKysgKQoJCQl7CgkJCQlpZiAoIF9hb1NldHRpbmdzW2ldLm5UYWJsZSA9PSBuVGFibGUgKQoJCQkJewoJCQkJCXJldHVybiBfYW9TZXR0aW5nc1tpXTsKCQkJCX0KCQkJfQoJCQkKCQkJcmV0dXJuIG51bGw7CgkJfQoJCQoJCS8qCgkJICogRnVuY3Rpb246IF9mbkdldERhdGFNYXN0ZXIKCQkgKiBQdXJwb3NlOiAgUmV0dXJuIGFuIGFycmF5IHdpdGggdGhlIGZ1bGwgdGFibGUgZGF0YQoJCSAqIFJldHVybnM6ICBhcnJheSBhcnJheTphRGF0YSAtIE1hc3RlciBkYXRhIGFycmF5CgkJICogSW5wdXRzOiAgIG9iamVjdDpvU2V0dGluZ3MgLSBkYXRhVGFibGVzIHNldHRpbmdzIG9iamVjdAoJCSAqLwoJCWZ1bmN0aW9uIF9mbkdldERhdGFNYXN0ZXIgKCBvU2V0dGluZ3MgKQoJCXsKCQkJdmFyIGFEYXRhID0gW107CgkJCXZhciBpTGVuID0gb1NldHRpbmdzLmFvRGF0YS5sZW5ndGg7CgkJCWZvciAoIHZhciBpPTAgOyBpPGlMZW47IGkrKyApCgkJCXsKCQkJCWFEYXRhLnB1c2goIG9TZXR0aW5ncy5hb0RhdGFbaV0uX2FEYXRhICk7CgkJCX0KCQkJcmV0dXJuIGFEYXRhOwoJCX0KCQkKCQkvKgoJCSAqIEZ1bmN0aW9uOiBfZm5HZXRUck5vZGVzCgkJICogUHVycG9zZTogIFJldHVybiBhbiBhcnJheSB3aXRoIHRoZSBUUiBub2RlcyBmb3IgdGhlIHRhYmxlCgkJICogUmV0dXJuczogIGFycmF5OiAtIFRSIGFycmF5CgkJICogSW5wdXRzOiAgIG9iamVjdDpvU2V0dGluZ3MgLSBkYXRhVGFibGVzIHNldHRpbmdzIG9iamVjdAoJCSAqLwoJCWZ1bmN0aW9uIF9mbkdldFRyTm9kZXMgKCBvU2V0dGluZ3MgKQoJCXsKCQkJdmFyIGFOb2RlcyA9IFtdOwoJCQl2YXIgaUxlbiA9IG9TZXR0aW5ncy5hb0RhdGEubGVuZ3RoOwoJCQlmb3IgKCB2YXIgaT0wIDsgaTxpTGVuIDsgaSsrICkKCQkJewoJCQkJYU5vZGVzLnB1c2goIG9TZXR0aW5ncy5hb0RhdGFbaV0ublRyICk7CgkJCX0KCQkJcmV0dXJuIGFOb2RlczsKCQl9CgkJCgkJLyoKCQkgKiBGdW5jdGlvbjogX2ZuR2V0VGROb2RlcwoJCSAqIFB1cnBvc2U6ICBSZXR1cm4gYW4gYXJyYXkgd2l0aCB0aGUgVEQgbm9kZXMgZm9yIHRoZSB0YWJsZQoJCSAqIFJldHVybnM6ICBhcnJheTogLSBURCBhcnJheQoJCSAqIElucHV0czogICBvYmplY3Q6b1NldHRpbmdzIC0gZGF0YVRhYmxlcyBzZXR0aW5ncyBvYmplY3QKCQkgKi8KCQlmdW5jdGlvbiBfZm5HZXRUZE5vZGVzICggb1NldHRpbmdzICkKCQl7CgkJCXZhciBuVHJzID0gX2ZuR2V0VHJOb2Rlcyggb1NldHRpbmdzICk7CgkJCXZhciBuVGRzID0gW10sIG5UZDsKCQkJdmFyIGFuUmV0dXJuID0gW107CgkJCXZhciBpQ29ycmVjdG9yOwoJCQl2YXIgaVJvdywgaVJvd3MsIGlDb2x1bW4sIGlDb2x1bW5zOwoJCQkKCQkJZm9yICggaVJvdz0wLCBpUm93cz1uVHJzLmxlbmd0aCA7IGlSb3c8aVJvd3MgOyBpUm93KysgKQoJCQl7CgkJCQluVGRzID0gW107CgkJCQlmb3IgKCBpQ29sdW1uPTAsIGlDb2x1bW5zPW5UcnNbaVJvd10uY2hpbGROb2Rlcy5sZW5ndGggOyBpQ29sdW1uPGlDb2x1bW5zIDsgaUNvbHVtbisrICkKCQkJCXsKCQkJCQluVGQgPSBuVHJzW2lSb3ddLmNoaWxkTm9kZXNbaUNvbHVtbl07CgkJCQkJaWYgKCBuVGQubm9kZU5hbWUudG9VcHBlckNhc2UoKSA9PSAiVEQiICkKCQkJCQl7CgkJCQkJCW5UZHMucHVzaCggblRkICk7CgkJCQkJfQoJCQkJfQoJCQkJCgkJCQlpQ29ycmVjdG9yID0gMDsKCQkJCWZvciAoIGlDb2x1bW49MCwgaUNvbHVtbnM9b1NldHRpbmdzLmFvQ29sdW1ucy5sZW5ndGggOyBpQ29sdW1uPGlDb2x1bW5zIDsgaUNvbHVtbisrICkKCQkJCXsKCQkJCQlpZiAoIG9TZXR0aW5ncy5hb0NvbHVtbnNbaUNvbHVtbl0uYlZpc2libGUgKQoJCQkJCXsKCQkJCQkJYW5SZXR1cm4ucHVzaCggblRkc1tpQ29sdW1uLWlDb3JyZWN0b3JdICk7CgkJCQkJfQoJCQkJCWVsc2UKCQkJCQl7CgkJCQkJCWFuUmV0dXJuLnB1c2goIG9TZXR0aW5ncy5hb0RhdGFbaVJvd10uX2FuSGlkZGVuW2lDb2x1bW5dICk7CgkJCQkJCWlDb3JyZWN0b3IrKzsKCQkJCQl9CgkJCQl9CgkJCX0KCQkJcmV0dXJuIGFuUmV0dXJuOwoJCX0KCQkKCQkvKgoJCSAqIEZ1bmN0aW9uOiBfZm5Fc2NhcGVSZWdleAoJCSAqIFB1cnBvc2U6ICBzY2FwZSBhIHN0cmluZyBzdHVjaCB0aGF0IGl0IGNhbiBiZSB1c2VkIGluIGEgcmVndWxhciBleHByZXNzaW9uCgkJICogUmV0dXJuczogIHN0cmluZzogLSBlc2NhcGVkIHN0cmluZwoJCSAqIElucHV0czogICBzdHJpbmc6c1ZhbCAtIHN0cmluZyB0byBlc2NhcGUKCQkgKi8KCQlmdW5jdGlvbiBfZm5Fc2NhcGVSZWdleCAoIHNWYWwgKQoJCXsKCQkJdmFyIGFjRXNjYXBlID0gWyAnLycsICcuJywgJyonLCAnKycsICc/JywgJ3wnLCAnKCcsICcpJywgJ1snLCAnXScsICd7JywgJ30nLCAnXFwnLCAnJCcsICdeJyBdOwoJCSAgdmFyIHJlUmVwbGFjZSA9IG5ldyBSZWdFeHAoICcoXFwnICsgYWNFc2NhcGUuam9pbignfFxcJykgKyAnKScsICdnJyApOwoJCSAgcmV0dXJuIHNWYWwucmVwbGFjZShyZVJlcGxhY2UsICdcXCQxJyk7CgkJfQoJCQoJCS8qCgkJICogRnVuY3Rpb246IF9mbkRlbGV0ZUluZGV4CgkJICogUHVycG9zZTogIFRha2UgYW4gYXJyYXkgb2YgaW50ZWdlcnMgKGluZGV4IGFycmF5KSBhbmQgcmVtb3ZlIGEgdGFyZ2V0IGludGVnZXIgKHZhbHVlIC0gbm90IAoJCSAqICAgICAgICAgICAgIHRoZSBrZXkhKQoJCSAqIFJldHVybnM6ICAtCgkJICogSW5wdXRzOiAgIGE6YXJyYXkgaW50IC0gSW5kZXggYXJyYXkgdG8gdGFyZ2V0CgkJICogICAgICAgICAgIGludDppVGFyZ2V0IC0gdmFsdWUgdG8gZmluZAoJCSAqLwoJCWZ1bmN0aW9uIF9mbkRlbGV0ZUluZGV4KCBhLCBpVGFyZ2V0ICkKCQl7CgkJCXZhciBpVGFyZ2V0SW5kZXggPSAtMTsKCQkJCgkJCWZvciAoIHZhciBpPTAsIGlMZW49YS5sZW5ndGggOyBpPGlMZW4gOyBpKysgKQoJCQl7CgkJCQlpZiAoIGFbaV0gPT0gaVRhcmdldCApCgkJCQl7CgkJCQkJaVRhcmdldEluZGV4ID0gaTsKCQkJCX0KCQkJCWVsc2UgaWYgKCBhW2ldID4gaVRhcmdldCApCgkJCQl7CgkJCQkJYVtpXS0tOwoJCQkJfQoJCQl9CgkJCQoJCQlpZiAoIGlUYXJnZXRJbmRleCAhPSAtMSApCgkJCXsKCQkJCWEuc3BsaWNlKCBpVGFyZ2V0SW5kZXgsIDEgKTsKCQkJfQoJCX0KCQkKCQkvKgoJCSAqIEZ1bmN0aW9uOiBfZm5SZU9yZGVySW5kZXgKCQkgKiBQdXJwb3NlOiAgRmlndXJlIG91dCBob3cgdG8gcmVvcmRlciBhIGRpc3BsYXkgbGlzdAoJCSAqIFJldHVybnM6ICBhcnJheSBpbnQ6YWlSZXR1cm4gLSBpbmRleCBsaXN0IGZvciByZW9yZGVyaW5nCgkJICogSW5wdXRzOiAgIG9iamVjdDpvU2V0dGluZ3MgLSBkYXRhVGFibGVzIHNldHRpbmdzIG9iamVjdAoJCSAqLwoJCWZ1bmN0aW9uIF9mblJlT3JkZXJJbmRleCAoIG9TZXR0aW5ncywgc0NvbHVtbnMgKQoJCXsKCQkJdmFyIGFDb2x1bW5zID0gc0NvbHVtbnMuc3BsaXQoJywnKTsKCQkJdmFyIGFpUmV0dXJuID0gW107CgkJCQoJCQlmb3IgKCB2YXIgaT0wLCBpTGVuPW9TZXR0aW5ncy5hb0NvbHVtbnMubGVuZ3RoIDsgaTxpTGVuIDsgaSsrICkKCQkJewoJCQkJZm9yICggdmFyIGo9MCA7IGo8aUxlbiA7IGorKyApCgkJCQl7CgkJCQkJaWYgKCBvU2V0dGluZ3MuYW9Db2x1bW5zW2ldLnNOYW1lID09IGFDb2x1bW5zW2pdICkKCQkJCQl7CgkJCQkJCWFpUmV0dXJuLnB1c2goIGogKTsKCQkJCQkJYnJlYWs7CgkJCQkJfQoJCQkJfQoJCQl9CgkJCQoJCQlyZXR1cm4gYWlSZXR1cm47CgkJfQoJCQoJCS8qCgkJICogRnVuY3Rpb246IF9mbkNvbHVtbk9yZGVyaW5nCgkJICogUHVycG9zZTogIEdldCB0aGUgY29sdW1uIG9yZGVyaW5nIHRoYXQgRGF0YVRhYmxlcyBleHBlY3RzCgkJICogUmV0dXJuczogIHN0cmluZzogLSBjb21tYSBzZXBhcmF0ZWQgbGlzdCBvZiBuYW1lcwoJCSAqIElucHV0czogICBvYmplY3Q6b1NldHRpbmdzIC0gZGF0YVRhYmxlcyBzZXR0aW5ncyBvYmplY3QKCQkgKi8KCQlmdW5jdGlvbiBfZm5Db2x1bW5PcmRlcmluZyAoIG9TZXR0aW5ncyApCgkJewoJCQl2YXIgc05hbWVzID0gJyc7CgkJCWZvciAoIHZhciBpPTAsIGlMZW49b1NldHRpbmdzLmFvQ29sdW1ucy5sZW5ndGggOyBpPGlMZW4gOyBpKysgKQoJCQl7CgkJCQlzTmFtZXMgKz0gb1NldHRpbmdzLmFvQ29sdW1uc1tpXS5zTmFtZSsnLCc7CgkJCX0KCQkJaWYgKCBzTmFtZXMubGVuZ3RoID09IGlMZW4gKQoJCQl7CgkJCQlyZXR1cm4gIiI7CgkJCX0KCQkJcmV0dXJuIHNOYW1lcy5zbGljZSgwLCAtMSk7CgkJfQoJCQoJCS8qCgkJICogRnVuY3Rpb246IF9mbkxvZwoJCSAqIFB1cnBvc2U6ICBMb2cgYW4gZXJyb3IgbWVzc2FnZQoJCSAqIFJldHVybnM6ICAtCgkJICogSW5wdXRzOiAgIGludDppTGV2ZWwgLSBsb2cgZXJyb3IgbWVzc2FnZXMsIG9yIGRpc3BsYXkgdGhlbSB0byB0aGUgdXNlcgoJCSAqICAgICAgICAgICBzdHJpbmc6c01lc2cgLSBlcnJvciBtZXNzYWdlCgkJICovCgkJZnVuY3Rpb24gX2ZuTG9nKCBvU2V0dGluZ3MsIGlMZXZlbCwgc01lc2cgKQoJCXsKCQkJdmFyIHNBbGVydCA9IG9TZXR0aW5ncy5zVGFibGVJZCA9PT0gIiIgPwoJCQkgCSJEYXRhVGFibGVzIHdhcm5pbmc6ICIgK3NNZXNnIDoKCQkJIAkiRGF0YVRhYmxlcyB3YXJuaW5nICh0YWJsZSBpZCA9ICciK29TZXR0aW5ncy5zVGFibGVJZCsiJyk6ICIgK3NNZXNnOwoJCQkKCQkJaWYgKCBpTGV2ZWwgPT09IDAgKQoJCQl7CgkJCQlpZiAoIF9vRXh0LnNFcnJNb2RlID09ICdhbGVydCcgKQoJCQkJewoJCQkJCWFsZXJ0KCBzQWxlcnQgKTsKCQkJCX0KCQkJCWVsc2UKCQkJCXsKCQkJCQl0aHJvdyBzQWxlcnQ7CgkJCQl9CgkJCQlyZXR1cm47CgkJCX0KCQkJZWxzZSBpZiAoIHR5cGVvZiBjb25zb2xlICE9ICd1bmRlZmluZWQnICYmIHR5cGVvZiBjb25zb2xlLmxvZyAhPSAndW5kZWZpbmVkJyApCgkJCXsKCQkJCWNvbnNvbGUubG9nKCBzQWxlcnQgKTsKCQkJfQoJCX0KCQkKCQkvKgoJCSAqIEZ1bmN0aW9uOiBfZm5DbGVhclRhYmxlCgkJICogUHVycG9zZTogIE51a2UgdGhlIHRhYmxlCgkJICogUmV0dXJuczogIC0KCQkgKiBJbnB1dHM6ICAgb2JqZWN0Om9TZXR0aW5ncyAtIGRhdGFUYWJsZXMgc2V0dGluZ3Mgb2JqZWN0CgkJICovCgkJZnVuY3Rpb24gX2ZuQ2xlYXJUYWJsZSggb1NldHRpbmdzICkKCQl7CgkJCW9TZXR0aW5ncy5hb0RhdGEuc3BsaWNlKCAwLCBvU2V0dGluZ3MuYW9EYXRhLmxlbmd0aCApOwoJCQlvU2V0dGluZ3MuYWlEaXNwbGF5TWFzdGVyLnNwbGljZSggMCwgb1NldHRpbmdzLmFpRGlzcGxheU1hc3Rlci5sZW5ndGggKTsKCQkJb1NldHRpbmdzLmFpRGlzcGxheS5zcGxpY2UoIDAsIG9TZXR0aW5ncy5haURpc3BsYXkubGVuZ3RoICk7CgkJCV9mbkNhbGN1bGF0ZUVuZCggb1NldHRpbmdzICk7CgkJfQoJCQoJCS8qCgkJICogRnVuY3Rpb246IF9mblNhdmVTdGF0ZQoJCSAqIFB1cnBvc2U6ICBTYXZlIHRoZSBzdGF0ZSBvZiBhIHRhYmxlIGluIGEgY29va2llIHN1Y2ggdGhhdCB0aGUgcGFnZSBjYW4gYmUgcmVsb2FkZWQKCQkgKiBSZXR1cm5zOiAgLQoJCSAqIElucHV0czogICBvYmplY3Q6b1NldHRpbmdzIC0gZGF0YVRhYmxlcyBzZXR0aW5ncyBvYmplY3QKCQkgKi8KCQlmdW5jdGlvbiBfZm5TYXZlU3RhdGUgKCBvU2V0dGluZ3MgKQoJCXsKCQkJaWYgKCAhb1NldHRpbmdzLm9GZWF0dXJlcy5iU3RhdGVTYXZlIHx8IHR5cGVvZiBvU2V0dGluZ3MuYkRlc3Ryb3lpbmcgIT0gJ3VuZGVmaW5lZCcgKQoJCQl7CgkJCQlyZXR1cm47CgkJCX0KCQkJCgkJCS8qIFN0b3JlIHRoZSBpbnRlcmVzdGluZyB2YXJpYWJsZXMgKi8KCQkJdmFyIGksIGlMZW4sIHNUbXA7CgkJCXZhciBzVmFsdWUgPSAieyI7CgkJCXNWYWx1ZSArPSAnImlDcmVhdGUiOicrIG5ldyBEYXRlKCkuZ2V0VGltZSgpKycsJzsKCQkJc1ZhbHVlICs9ICciaVN0YXJ0IjonKyBvU2V0dGluZ3MuX2lEaXNwbGF5U3RhcnQrJywnOwoJCQlzVmFsdWUgKz0gJyJpRW5kIjonKyBvU2V0dGluZ3MuX2lEaXNwbGF5RW5kKycsJzsKCQkJc1ZhbHVlICs9ICciaUxlbmd0aCI6Jysgb1NldHRpbmdzLl9pRGlzcGxheUxlbmd0aCsnLCc7CgkJCXNWYWx1ZSArPSAnInNGaWx0ZXIiOiInKyBlbmNvZGVVUklDb21wb25lbnQob1NldHRpbmdzLm9QcmV2aW91c1NlYXJjaC5zU2VhcmNoKSsnIiwnOwoJCQlzVmFsdWUgKz0gJyJzRmlsdGVyRXNjIjonKyAhb1NldHRpbmdzLm9QcmV2aW91c1NlYXJjaC5iUmVnZXgrJywnOwoJCQkKCQkJc1ZhbHVlICs9ICciYWFTb3J0aW5nIjpbICc7CgkJCWZvciAoIGk9MCA7IGk8b1NldHRpbmdzLmFhU29ydGluZy5sZW5ndGggOyBpKysgKQoJCQl7CgkJCQlzVmFsdWUgKz0gJ1snK29TZXR0aW5ncy5hYVNvcnRpbmdbaV1bMF0rJywiJytvU2V0dGluZ3MuYWFTb3J0aW5nW2ldWzFdKyciXSwnOwoJCQl9CgkJCXNWYWx1ZSA9IHNWYWx1ZS5zdWJzdHJpbmcoMCwgc1ZhbHVlLmxlbmd0aC0xKTsKCQkJc1ZhbHVlICs9ICJdLCI7CgkJCQoJCQlzVmFsdWUgKz0gJyJhYVNlYXJjaENvbHMiOlsgJzsKCQkJZm9yICggaT0wIDsgaTxvU2V0dGluZ3MuYW9QcmVTZWFyY2hDb2xzLmxlbmd0aCA7IGkrKyApCgkJCXsKCQkJCXNWYWx1ZSArPSAnWyInK2VuY29kZVVSSUNvbXBvbmVudChvU2V0dGluZ3MuYW9QcmVTZWFyY2hDb2xzW2ldLnNTZWFyY2gpKwoJCQkJCSciLCcrIW9TZXR0aW5ncy5hb1ByZVNlYXJjaENvbHNbaV0uYlJlZ2V4KyddLCc7CgkJCX0KCQkJc1ZhbHVlID0gc1ZhbHVlLnN1YnN0cmluZygwLCBzVmFsdWUubGVuZ3RoLTEpOwoJCQlzVmFsdWUgKz0gIl0sIjsKCQkJCgkJCXNWYWx1ZSArPSAnImFiVmlzQ29scyI6WyAnOwoJCQlmb3IgKCBpPTAgOyBpPG9TZXR0aW5ncy5hb0NvbHVtbnMubGVuZ3RoIDsgaSsrICkKCQkJewoJCQkJc1ZhbHVlICs9IG9TZXR0aW5ncy5hb0NvbHVtbnNbaV0uYlZpc2libGUrIiwiOwoJCQl9CgkJCXNWYWx1ZSA9IHNWYWx1ZS5zdWJzdHJpbmcoMCwgc1ZhbHVlLmxlbmd0aC0xKTsKCQkJc1ZhbHVlICs9ICJdIjsKCQkJCgkJCS8qIFNhdmUgc3RhdGUgZnJvbSBhbnkgcGx1Zy1pbnMgKi8KCQkJZm9yICggaT0wLCBpTGVuPW9TZXR0aW5ncy5hb1N0YXRlU2F2ZS5sZW5ndGggOyBpPGlMZW4gOyBpKysgKQoJCQl7CgkJCQlzVG1wID0gb1NldHRpbmdzLmFvU3RhdGVTYXZlW2ldLmZuKCBvU2V0dGluZ3MsIHNWYWx1ZSApOwoJCQkJaWYgKCBzVG1wICE9PSAiIiApCgkJCQl7CgkJCQkJc1ZhbHVlID0gc1RtcDsKCQkJCX0KCQkJfQoJCQkKCQkJc1ZhbHVlICs9ICJ9IjsKCQkJCgkJCV9mbkNyZWF0ZUNvb2tpZSggb1NldHRpbmdzLnNDb29raWVQcmVmaXgrb1NldHRpbmdzLnNJbnN0YW5jZSwgc1ZhbHVlLCAKCQkJCW9TZXR0aW5ncy5pQ29va2llRHVyYXRpb24sIG9TZXR0aW5ncy5zQ29va2llUHJlZml4LCBvU2V0dGluZ3MuZm5Db29raWVDYWxsYmFjayApOwoJCX0KCQkKCQkvKgoJCSAqIEZ1bmN0aW9uOiBfZm5Mb2FkU3RhdGUKCQkgKiBQdXJwb3NlOiAgQXR0ZW1wdCB0byBsb2FkIGEgc2F2ZWQgdGFibGUgc3RhdGUgZnJvbSBhIGNvb2tpZQoJCSAqIFJldHVybnM6ICAtCgkJICogSW5wdXRzOiAgIG9iamVjdDpvU2V0dGluZ3MgLSBkYXRhVGFibGVzIHNldHRpbmdzIG9iamVjdAoJCSAqICAgICAgICAgICBvYmplY3Q6b0luaXQgLSBEYXRhVGFibGVzIGluaXQgb2JqZWN0IHNvIHdlIGNhbiBvdmVycmlkZSBzZXR0aW5ncwoJCSAqLwoJCWZ1bmN0aW9uIF9mbkxvYWRTdGF0ZSAoIG9TZXR0aW5ncywgb0luaXQgKQoJCXsKCQkJaWYgKCAhb1NldHRpbmdzLm9GZWF0dXJlcy5iU3RhdGVTYXZlICkKCQkJewoJCQkJcmV0dXJuOwoJCQl9CgkJCQoJCQl2YXIgb0RhdGEsIGksIGlMZW47CgkJCXZhciBzRGF0YSA9IF9mblJlYWRDb29raWUoIG9TZXR0aW5ncy5zQ29va2llUHJlZml4K29TZXR0aW5ncy5zSW5zdGFuY2UgKTsKCQkJaWYgKCBzRGF0YSAhPT0gbnVsbCAmJiBzRGF0YSAhPT0gJycgKQoJCQl7CgkJCQkvKiBUcnkvY2F0Y2ggdGhlIEpTT04gZXZhbCAtIGlmIGl0IGlzIGJhZCB0aGVuIHdlIGlnbm9yZSBpdCAtIG5vdGUgdGhhdCAxLjcuMCBhbmQgYmVmb3JlCgkJCQkgKiBpbmNvcnJlY3RseSB1c2VkIHNpbmdsZSBxdW90ZXMgZm9yIHNvbWUgc3RyaW5ncyAtIGhlbmNlIHRoZSByZXBsYWNlIGJlbG93CgkJCQkgKi8KCQkJCXRyeQoJCQkJewoJCQkJCW9EYXRhID0gKHR5cGVvZiAkLnBhcnNlSlNPTiA9PSAnZnVuY3Rpb24nKSA/IAoJCQkJCQkkLnBhcnNlSlNPTiggc0RhdGEucmVwbGFjZSgvJy9nLCAnIicpICkgOiBldmFsKCAnKCcrc0RhdGErJyknICk7CgkJCQl9CgkJCQljYXRjaCggZSApCgkJCQl7CgkJCQkJcmV0dXJuOwoJCQkJfQoJCQkJCgkJCQkvKiBBbGxvdyBjdXN0b20gYW5kIHBsdWctaW4gbWFuaXB1bGF0aW9uIGZ1bmN0aW9ucyB0byBhbHRlciB0aGUgZGF0YSBzZXQgd2hpY2ggd2FzCgkJCQkgKiBzYXZlZCwgYW5kIGFsc28gcmVqZWN0IGFueSBzYXZlZCBzdGF0ZSBieSByZXR1cm5pbmcgZmFsc2UKCQkJCSAqLwoJCQkJZm9yICggaT0wLCBpTGVuPW9TZXR0aW5ncy5hb1N0YXRlTG9hZC5sZW5ndGggOyBpPGlMZW4gOyBpKysgKQoJCQkJewoJCQkJCWlmICggIW9TZXR0aW5ncy5hb1N0YXRlTG9hZFtpXS5mbiggb1NldHRpbmdzLCBvRGF0YSApICkKCQkJCQl7CgkJCQkJCXJldHVybjsKCQkJCQl9CgkJCQl9CgkJCQkKCQkJCS8qIFN0b3JlIHRoZSBzYXZlZCBzdGF0ZSBzbyBpdCBtaWdodCBiZSBhY2Nlc3NlZCBhdCBhbnkgdGltZSAocGFydGljdWFscmx5IGEgcGx1Zy1pbiAqLwoJCQkJb1NldHRpbmdzLm9Mb2FkZWRTdGF0ZSA9ICQuZXh0ZW5kKCB0cnVlLCB7fSwgb0RhdGEgKTsKCQkJCQoJCQkJLyogUmVzdG9yZSBrZXkgZmVhdHVyZXMgKi8KCQkJCW9TZXR0aW5ncy5faURpc3BsYXlTdGFydCA9IG9EYXRhLmlTdGFydDsKCQkJCW9TZXR0aW5ncy5pSW5pdERpc3BsYXlTdGFydCA9IG9EYXRhLmlTdGFydDsKCQkJCW9TZXR0aW5ncy5faURpc3BsYXlFbmQgPSBvRGF0YS5pRW5kOwoJCQkJb1NldHRpbmdzLl9pRGlzcGxheUxlbmd0aCA9IG9EYXRhLmlMZW5ndGg7CgkJCQlvU2V0dGluZ3Mub1ByZXZpb3VzU2VhcmNoLnNTZWFyY2ggPSBkZWNvZGVVUklDb21wb25lbnQob0RhdGEuc0ZpbHRlcik7CgkJCQlvU2V0dGluZ3MuYWFTb3J0aW5nID0gb0RhdGEuYWFTb3J0aW5nLnNsaWNlKCk7CgkJCQlvU2V0dGluZ3Muc2F2ZWRfYWFTb3J0aW5nID0gb0RhdGEuYWFTb3J0aW5nLnNsaWNlKCk7CgkJCQkKCQkJCS8qCgkJCQkgKiBTZWFyY2ggZmlsdGVyaW5nIC0gZ2xvYmFsIHJlZmVyZW5jZSBhZGRlZCBpbiAxLjQuMQoJCQkJICogTm90ZSB0aGF0IHdlIHVzZSBhICdub3QnIGZvciB0aGUgdmFsdWUgb2YgdGhlIHJlZ3VsYXIgZXhwcmVzc2lvbiBpbmRpY2F0b3IgdG8gbWFpbnRhaW4KCQkJCSAqIGNvbXBhdGliaWxpdHkgd2l0aCBwcmUgMS43IHZlcnNpb25zLCB3aGVyZSB0aGlzIHdhcyBiYXNpY2FsbHkgaW52ZXJ0ZWQuIEFkZGVkIGluIDEuNy4wCgkJCQkgKi8KCQkJCWlmICggdHlwZW9mIG9EYXRhLnNGaWx0ZXJFc2MgIT0gJ3VuZGVmaW5lZCcgKQoJCQkJewoJCQkJCW9TZXR0aW5ncy5vUHJldmlvdXNTZWFyY2guYlJlZ2V4ID0gIW9EYXRhLnNGaWx0ZXJFc2M7CgkJCQl9CgkJCQkKCQkJCS8qIENvbHVtbiBmaWx0ZXJpbmcgLSBhZGRlZCBpbiAxLjUuMCBiZXRhIDYgKi8KCQkJCWlmICggdHlwZW9mIG9EYXRhLmFhU2VhcmNoQ29scyAhPSAndW5kZWZpbmVkJyApCgkJCQl7CgkJCQkJZm9yICggaT0wIDsgaTxvRGF0YS5hYVNlYXJjaENvbHMubGVuZ3RoIDsgaSsrICkKCQkJCQl7CgkJCQkJCW9TZXR0aW5ncy5hb1ByZVNlYXJjaENvbHNbaV0gPSB7CgkJCQkJCQkic1NlYXJjaCI6IGRlY29kZVVSSUNvbXBvbmVudChvRGF0YS5hYVNlYXJjaENvbHNbaV1bMF0pLAoJCQkJCQkJImJSZWdleCI6ICFvRGF0YS5hYVNlYXJjaENvbHNbaV1bMV0KCQkJCQkJfTsKCQkJCQl9CgkJCQl9CgkJCQkKCQkJCS8qIENvbHVtbiB2aXNpYmlsaXR5IHN0YXRlIC0gYWRkZWQgaW4gMS41LjAgYmV0YSAxMCAqLwoJCQkJaWYgKCB0eXBlb2Ygb0RhdGEuYWJWaXNDb2xzICE9ICd1bmRlZmluZWQnICkKCQkJCXsKCQkJCQkvKiBQYXNzIGJhY2sgdmlzaWJpbGl5IHNldHRpbmdzIHRvIHRoZSBpbml0IGhhbmRsZXIsIGJ1dCB0byBkbyBub3QgaGVyZSBvdmVycmlkZQoJCQkJCSAqIHRoZSBpbml0IG9iamVjdCB0aGF0IHRoZSB1c2VyIG1pZ2h0IGhhdmUgcGFzc2VkIGluCgkJCQkJICovCgkJCQkJb0luaXQuc2F2ZWRfYW9Db2x1bW5zID0gW107CgkJCQkJZm9yICggaT0wIDsgaTxvRGF0YS5hYlZpc0NvbHMubGVuZ3RoIDsgaSsrICkKCQkJCQl7CgkJCQkJCW9Jbml0LnNhdmVkX2FvQ29sdW1uc1tpXSA9IHt9OwoJCQkJCQlvSW5pdC5zYXZlZF9hb0NvbHVtbnNbaV0uYlZpc2libGUgPSBvRGF0YS5hYlZpc0NvbHNbaV07CgkJCQkJfQoJCQkJfQoJCQl9CgkJfQoJCQoJCS8qCgkJICogRnVuY3Rpb246IF9mbkNyZWF0ZUNvb2tpZQoJCSAqIFB1cnBvc2U6ICBDcmVhdGUgYSBuZXcgY29va2llIHdpdGggYSB2YWx1ZSB0byBzdG9yZSB0aGUgc3RhdGUgb2YgYSB0YWJsZQoJCSAqIFJldHVybnM6ICAtCgkJICogSW5wdXRzOiAgIHN0cmluZzpzTmFtZSAtIG5hbWUgb2YgdGhlIGNvb2tpZSB0byBjcmVhdGUKCQkgKiAgICAgICAgICAgc3RyaW5nOnNWYWx1ZSAtIHRoZSB2YWx1ZSB0aGUgY29va2llIHNob3VsZCB0YWtlCgkJICogICAgICAgICAgIGludDppU2VjcyAtIGR1cmF0aW9uIG9mIHRoZSBjb29raWUKCQkgKiAgICAgICAgICAgc3RyaW5nOnNCYXNlTmFtZSAtIHNOYW1lIGlzIG1hZGUgdXAgb2YgdGhlIGJhc2UgKyBmaWxlIG5hbWUgLSB0aGlzIGlzIHRoZSBiYXNlCgkJICogICAgICAgICAgIGZ1bmN0aW9uOmZuQ2FsbGJhY2sgLSBVc2VyIGRlZmluYWJsZSBmdW5jdGlvbiB0byBtb2RpZnkgdGhlIGNvb2tpZQoJCSAqLwoJCWZ1bmN0aW9uIF9mbkNyZWF0ZUNvb2tpZSAoIHNOYW1lLCBzVmFsdWUsIGlTZWNzLCBzQmFzZU5hbWUsIGZuQ2FsbGJhY2sgKQoJCXsKCQkJdmFyIGRhdGUgPSBuZXcgRGF0ZSgpOwoJCQlkYXRlLnNldFRpbWUoIGRhdGUuZ2V0VGltZSgpKyhpU2VjcyoxMDAwKSApOwoJCQkKCQkJLyogCgkJCSAqIFNob2NraW5nIGJ1dCB0cnVlIC0gaXQgd291bGQgYXBwZWFyIElFIGhhcyBtYWpvciBpc3N1ZXMgd2l0aCBoYXZpbmcgdGhlIHBhdGggbm90IGhhdmluZwoJCQkgKiBhIHRyYWlsaW5nIHNsYXNoIG9uIGl0LiBXZSBuZWVkIHRoZSBjb29raWUgdG8gYmUgYXZhaWxhYmxlIGJhc2VkIG9uIHRoZSBwYXRoLCBzbyB3ZQoJCQkgKiBoYXZlIHRvIGFwcGVuZCB0aGUgZmlsZSBuYW1lIHRvIHRoZSBjb29raWUgbmFtZS4gQXBwYWxsaW5nLiBUaGFua3MgdG8gdmV4IGZvciBhZGRpbmcgdGhlCgkJCSAqIHBhdGNoIHRvIHVzZSBhdCBsZWFzdCBzb21lIG9mIHRoZSBwYXRoCgkJCSAqLwoJCQl2YXIgYVBhcnRzID0gd2luZG93LmxvY2F0aW9uLnBhdGhuYW1lLnNwbGl0KCcvJyk7CgkJCXZhciBzTmFtZUZpbGUgPSBzTmFtZSArICdfJyArIGFQYXJ0cy5wb3AoKS5yZXBsYWNlKC9bXC86XS9nLCIiKS50b0xvd2VyQ2FzZSgpOwoJCQl2YXIgc0Z1bGxDb29raWUsIG9EYXRhOwoJCQkKCQkJaWYgKCBmbkNhbGxiYWNrICE9PSBudWxsICkKCQkJewoJCQkJb0RhdGEgPSAodHlwZW9mICQucGFyc2VKU09OID09ICdmdW5jdGlvbicpID8gCgkJCQkJJC5wYXJzZUpTT04oIHNWYWx1ZSApIDogZXZhbCggJygnK3NWYWx1ZSsnKScgKTsKCQkJCXNGdWxsQ29va2llID0gZm5DYWxsYmFjayggc05hbWVGaWxlLCBvRGF0YSwgZGF0ZS50b0dNVFN0cmluZygpLAoJCQkJCWFQYXJ0cy5qb2luKCcvJykrIi8iICk7CgkJCX0KCQkJZWxzZQoJCQl7CgkJCQlzRnVsbENvb2tpZSA9IHNOYW1lRmlsZSArICI9IiArIGVuY29kZVVSSUNvbXBvbmVudChzVmFsdWUpICsKCQkJCQkiOyBleHBpcmVzPSIgKyBkYXRlLnRvR01UU3RyaW5nKCkgKyI7IHBhdGg9IiArIGFQYXJ0cy5qb2luKCcvJykrIi8iOwoJCQl9CgkJCQoJCQkvKiBBcmUgd2UgZ29pbmcgdG8gZ28gb3ZlciB0aGUgY29va2llIGxpbWl0IG9mIDRLaUI/IElmIHNvLCB0cnkgdG8gZGVsZXRlIGEgY29va2llcwoJCQkgKiBiZWxvbmdpbmcgdG8gRGF0YVRhYmxlcy4gVGhpcyBpcyBGQVIgZnJvbSBidWxsZXQgcHJvb2YKCQkJICovCgkJCXZhciBzT2xkTmFtZT0iIiwgaU9sZFRpbWU9OTk5OTk5OTk5OTk5OTsKCQkJdmFyIGlMZW5ndGggPSBfZm5SZWFkQ29va2llKCBzTmFtZUZpbGUgKSE9PW51bGwgPyBkb2N1bWVudC5jb29raWUubGVuZ3RoIDogCgkJCQlzRnVsbENvb2tpZS5sZW5ndGggKyBkb2N1bWVudC5jb29raWUubGVuZ3RoOwoJCQkKCQkJaWYgKCBpTGVuZ3RoKzEwID4gNDA5NiApIC8qIE1hZ2ljIDEwIGZvciBwYWRkaW5nICovCgkJCXsKCQkJCXZhciBhQ29va2llcyA9ZG9jdW1lbnQuY29va2llLnNwbGl0KCc7Jyk7CgkJCQlmb3IgKCB2YXIgaT0wLCBpTGVuPWFDb29raWVzLmxlbmd0aCA7IGk8aUxlbiA7IGkrKyApCgkJCQl7CgkJCQkJaWYgKCBhQ29va2llc1tpXS5pbmRleE9mKCBzQmFzZU5hbWUgKSAhPSAtMSApCgkJCQkJewoJCQkJCQkvKiBJdCdzIGEgRGF0YVRhYmxlcyBjb29raWUsIHNvIGV2YWwgaXQgYW5kIGNoZWNrIHRoZSB0aW1lIHN0YW1wICovCgkJCQkJCXZhciBhU3BsaXRDb29raWUgPSBhQ29va2llc1tpXS5zcGxpdCgnPScpOwoJCQkJCQl0cnkgeyBvRGF0YSA9IGV2YWwoICcoJytkZWNvZGVVUklDb21wb25lbnQoYVNwbGl0Q29va2llWzFdKSsnKScgKTsgfQoJCQkJCQljYXRjaCggZSApIHsgY29udGludWU7IH0KCQkJCQkJCgkJCQkJCWlmICggdHlwZW9mIG9EYXRhLmlDcmVhdGUgIT0gJ3VuZGVmaW5lZCcgJiYgb0RhdGEuaUNyZWF0ZSA8IGlPbGRUaW1lICkKCQkJCQkJewoJCQkJCQkJc09sZE5hbWUgPSBhU3BsaXRDb29raWVbMF07CgkJCQkJCQlpT2xkVGltZSA9IG9EYXRhLmlDcmVhdGU7CgkJCQkJCX0KCQkJCQl9CgkJCQl9CgkJCQkKCQkJCWlmICggc09sZE5hbWUgIT09ICIiICkKCQkJCXsKCQkJCQlkb2N1bWVudC5jb29raWUgPSBzT2xkTmFtZSsiPTsgZXhwaXJlcz1UaHUsIDAxLUphbi0xOTcwIDAwOjAwOjAxIEdNVDsgcGF0aD0iKwoJCQkJCQlhUGFydHMuam9pbignLycpICsgIi8iOwoJCQkJfQoJCQl9CgkJCQoJCQlkb2N1bWVudC5jb29raWUgPSBzRnVsbENvb2tpZTsKCQl9CgkJCgkJLyoKCQkgKiBGdW5jdGlvbjogX2ZuUmVhZENvb2tpZQoJCSAqIFB1cnBvc2U6ICBSZWFkIGFuIG9sZCBjb29raWUgdG8gZ2V0IGEgY29va2llIHdpdGggYW4gb2xkIHRhYmxlIHN0YXRlCgkJICogUmV0dXJuczogIHN0cmluZzogLSBjb250ZW50cyBvZiB0aGUgY29va2llIC0gb3IgbnVsbCBpZiBubyBjb29raWUgd2l0aCB0aGF0IG5hbWUgZm91bmQKCQkgKiBJbnB1dHM6ICAgc3RyaW5nOnNOYW1lIC0gbmFtZSBvZiB0aGUgY29va2llIHRvIHJlYWQKCQkgKi8KCQlmdW5jdGlvbiBfZm5SZWFkQ29va2llICggc05hbWUgKQoJCXsKCQkJdmFyCgkJCQlhUGFydHMgPSB3aW5kb3cubG9jYXRpb24ucGF0aG5hbWUuc3BsaXQoJy8nKSwKCQkJCXNOYW1lRVEgPSBzTmFtZSArICdfJyArIGFQYXJ0c1thUGFydHMubGVuZ3RoLTFdLnJlcGxhY2UoL1tcLzpdL2csIiIpLnRvTG93ZXJDYXNlKCkgKyAnPScsCgkJCSAJc0Nvb2tpZUNvbnRlbnRzID0gZG9jdW1lbnQuY29va2llLnNwbGl0KCc7Jyk7CgkJCQoJCQlmb3IoIHZhciBpPTAgOyBpPHNDb29raWVDb250ZW50cy5sZW5ndGggOyBpKysgKQoJCQl7CgkJCQl2YXIgYyA9IHNDb29raWVDb250ZW50c1tpXTsKCQkJCQoJCQkJd2hpbGUgKGMuY2hhckF0KDApPT0nICcpCgkJCQl7CgkJCQkJYyA9IGMuc3Vic3RyaW5nKDEsYy5sZW5ndGgpOwoJCQkJfQoJCQkJCgkJCQlpZiAoYy5pbmRleE9mKHNOYW1lRVEpID09PSAwKQoJCQkJewoJCQkJCXJldHVybiBkZWNvZGVVUklDb21wb25lbnQoIGMuc3Vic3RyaW5nKHNOYW1lRVEubGVuZ3RoLGMubGVuZ3RoKSApOwoJCQkJfQoJCQl9CgkJCXJldHVybiBudWxsOwoJCX0KCQkKCQkvKgoJCSAqIEZ1bmN0aW9uOiBfZm5HZXRVbmlxdWVUaHMKCQkgKiBQdXJwb3NlOiAgR2V0IGFuIGFycmF5IG9mIHVuaXF1ZSB0aCBlbGVtZW50cywgb25lIGZvciBlYWNoIGNvbHVtbgoJCSAqIFJldHVybnM6ICBhcnJheSBub2RlOmFSZXR1cm4gLSBsaXN0IG9mIHVuaXF1ZSB0aHMKCQkgKiBJbnB1dHM6ICAgbm9kZTpuVGhlYWQgLSBUaGUgdGhlYWQgZWxlbWVudCBmb3IgdGhlIHRhYmxlCgkJICovCgkJZnVuY3Rpb24gX2ZuR2V0VW5pcXVlVGhzICggblRoZWFkICkKCQl7CgkJCXZhciBuVHJzID0gblRoZWFkLmdldEVsZW1lbnRzQnlUYWdOYW1lKCd0cicpOwoJCQkKCQkJLyogTmljZSBzaW1wbGUgY2FzZSAqLwoJCQlpZiAoIG5UcnMubGVuZ3RoID09IDEgKQoJCQl7CgkJCQlyZXR1cm4gblRyc1swXS5nZXRFbGVtZW50c0J5VGFnTmFtZSgndGgnKTsKCQkJfQoJCQkKCQkJLyogT3RoZXJ3aXNlIHdlIG5lZWQgdG8gZmlndXJlIG91dCB0aGUgbGF5b3V0IGFycmF5IHRvIGdldCB0aGUgbm9kZXMgKi8KCQkJdmFyIGFMYXlvdXQgPSBbXSwgYVJldHVybiA9IFtdOwoJCQl2YXIgUk9XU1BBTiA9IDIsIENPTFNQQU4gPSAzLCBUREVMRU0gPSA0OwoJCQl2YXIgaSwgaiwgaywgaUxlbiwgakxlbiwgaUNvbHVtblNoaWZ0ZWQ7CgkJCXZhciBmblNoaWZ0Q29sID0gZnVuY3Rpb24gKCBhLCBpLCBqICkgewoJCQkJd2hpbGUgKCB0eXBlb2YgYVtpXVtqXSAhPSAndW5kZWZpbmVkJyApIHsKCQkJCQlqKys7CgkJCQl9CgkJCQlyZXR1cm4gajsKCQkJfTsKCQkJdmFyIGZuQWRkUm93ID0gZnVuY3Rpb24gKCBpICkgewoJCQkJaWYgKCB0eXBlb2YgYUxheW91dFtpXSA9PSAndW5kZWZpbmVkJyApIHsKCQkJCQlhTGF5b3V0W2ldID0gW107CgkJCQl9CgkJCX07CgkJCQoJCQkvKiBDYWxjdWxhdGUgYSBsYXlvdXQgYXJyYXkgKi8KCQkJZm9yICggaT0wLCBpTGVuPW5UcnMubGVuZ3RoIDsgaTxpTGVuIDsgaSsrICkKCQkJewoJCQkJZm5BZGRSb3coIGkgKTsKCQkJCXZhciBpQ29sdW1uID0gMDsKCQkJCXZhciBuVGRzID0gW107CgkJCQkKCQkJCWZvciAoIGo9MCwgakxlbj1uVHJzW2ldLmNoaWxkTm9kZXMubGVuZ3RoIDsgajxqTGVuIDsgaisrICkKCQkJCXsKCQkJCQlpZiAoIG5UcnNbaV0uY2hpbGROb2Rlc1tqXS5ub2RlTmFtZS50b1VwcGVyQ2FzZSgpID09ICJURCIgfHwKCQkJCQkgICAgIG5UcnNbaV0uY2hpbGROb2Rlc1tqXS5ub2RlTmFtZS50b1VwcGVyQ2FzZSgpID09ICJUSCIgKQoJCQkJCXsKCQkJCQkJblRkcy5wdXNoKCBuVHJzW2ldLmNoaWxkTm9kZXNbal0gKTsKCQkJCQl9CgkJCQl9CgkJCQkKCQkJCWZvciAoIGo9MCwgakxlbj1uVGRzLmxlbmd0aCA7IGo8akxlbiA7IGorKyApCgkJCQl7CgkJCQkJdmFyIGlDb2xzcGFuID0gblRkc1tqXS5nZXRBdHRyaWJ1dGUoJ2NvbHNwYW4nKSAqIDE7CgkJCQkJdmFyIGlSb3dzcGFuID0gblRkc1tqXS5nZXRBdHRyaWJ1dGUoJ3Jvd3NwYW4nKSAqIDE7CgkJCQkJCgkJCQkJaWYgKCAhaUNvbHNwYW4gfHwgaUNvbHNwYW49PT0wIHx8IGlDb2xzcGFuPT09MSApCgkJCQkJewoJCQkJCQlpQ29sdW1uU2hpZnRlZCA9IGZuU2hpZnRDb2woIGFMYXlvdXQsIGksIGlDb2x1bW4gKTsKCQkJCQkJYUxheW91dFtpXVtpQ29sdW1uU2hpZnRlZF0gPSAoblRkc1tqXS5ub2RlTmFtZS50b1VwcGVyQ2FzZSgpPT0iVEQiKSA/IFRERUxFTSA6IG5UZHNbal07CgkJCQkJCWlmICggaVJvd3NwYW4gfHwgaVJvd3NwYW49PT0wIHx8IGlSb3dzcGFuPT09MSApCgkJCQkJCXsKCQkJCQkJCWZvciAoIGs9MSA7IGs8aVJvd3NwYW4gOyBrKysgKQoJCQkJCQkJewoJCQkJCQkJCWZuQWRkUm93KCBpK2sgKTsKCQkJCQkJCQlhTGF5b3V0W2kra11baUNvbHVtblNoaWZ0ZWRdID0gUk9XU1BBTjsKCQkJCQkJCX0KCQkJCQkJfQoJCQkJCQlpQ29sdW1uKys7CgkJCQkJfQoJCQkJCWVsc2UKCQkJCQl7CgkJCQkJCWlDb2x1bW5TaGlmdGVkID0gZm5TaGlmdENvbCggYUxheW91dCwgaSwgaUNvbHVtbiApOwoJCQkJCQlmb3IgKCBrPTAgOyBrPGlDb2xzcGFuIDsgaysrICkKCQkJCQkJewoJCQkJCQkJYUxheW91dFtpXVtpQ29sdW1uU2hpZnRlZCtrXSA9IENPTFNQQU47CgkJCQkJCX0KCQkJCQkJaUNvbHVtbiArPSBpQ29sc3BhbjsKCQkJCQl9CgkJCQl9CgkJCX0KCQkJCgkJCS8qIENvbnZlcnQgdGhlIGxheW91dCBhcnJheSBpbnRvIGEgbm9kZSBhcnJheSAqLwoJCQlmb3IgKCBpPTAsIGlMZW49YUxheW91dC5sZW5ndGggOyBpPGlMZW4gOyBpKysgKQoJCQl7CgkJCQlmb3IgKCBqPTAsIGpMZW49YUxheW91dFtpXS5sZW5ndGggOyBqPGpMZW4gOyBqKysgKQoJCQkJewoJCQkJCWlmICggdHlwZW9mIGFMYXlvdXRbaV1bal0gPT0gJ29iamVjdCcgKQoJCQkJCXsKCQkJCQkJYVJldHVybltqXSA9IGFMYXlvdXRbaV1bal07CgkJCQkJfQoJCQkJfQoJCQl9CgkJCQoJCQlyZXR1cm4gYVJldHVybjsKCQl9CgkJCgkJLyoKCQkgKiBGdW5jdGlvbjogX2ZuU2Nyb2xsQmFyV2lkdGgKCQkgKiBQdXJwb3NlOiAgR2V0IHRoZSB3aWR0aCBvZiBhIHNjcm9sbCBiYXIgaW4gdGhpcyBicm93c2VyIGJlaW5nIHVzZWQKCQkgKiBSZXR1cm5zOiAgaW50OiAtIHdpZHRoIGluIHBpeGVscwoJCSAqIElucHV0czogICAtCgkJICogTm90ZXM6ICAgIEFsbCBjcmVkaXQgZm9yIHRoaXMgZnVuY3Rpb24gYmVsb25ncyB0byBBbGV4YW5kcmUgR29tZXMuIFRoYW5rcyBmb3Igc2hhcmluZyEKCQkgKiAgIGh0dHA6Ly93d3cuYWxleGFuZHJlLWdvbWVzLmNvbS8/cD0xMTUKCQkgKi8KCQlmdW5jdGlvbiBfZm5TY3JvbGxCYXJXaWR0aCAoKQoJCXsgIAoJCQl2YXIgaW5uZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJyk7ICAKCQkJdmFyIHN0eWxlID0gaW5uZXIuc3R5bGU7CgkJCXN0eWxlLndpZHRoID0gIjEwMCUiOyAgCgkJCXN0eWxlLmhlaWdodCA9ICIyMDBweCI7ICAKCQkJCgkJCXZhciBvdXRlciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOyAgCgkJCXN0eWxlID0gb3V0ZXIuc3R5bGU7CgkJCXN0eWxlLnBvc2l0aW9uID0gImFic29sdXRlIjsgIAoJCQlzdHlsZS50b3AgPSAiMHB4IjsgIAoJCQlzdHlsZS5sZWZ0ID0gIjBweCI7ICAKCQkJc3R5bGUudmlzaWJpbGl0eSA9ICJoaWRkZW4iOyAgCgkJCXN0eWxlLndpZHRoID0gIjIwMHB4IjsgIAoJCQlzdHlsZS5oZWlnaHQgPSAiMTUwcHgiOyAgCgkJCXN0eWxlLm92ZXJmbG93ID0gImhpZGRlbiI7ICAKCQkJb3V0ZXIuYXBwZW5kQ2hpbGQoaW5uZXIpOyAgCgkJCQoJCQlkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKG91dGVyKTsgIAoJCQl2YXIgdzEgPSBpbm5lci5vZmZzZXRXaWR0aDsgIAoJCQlvdXRlci5zdHlsZS5vdmVyZmxvdyA9ICdzY3JvbGwnOyAgCgkJCXZhciB3MiA9IGlubmVyLm9mZnNldFdpZHRoOyAgCgkJCWlmICggdzEgPT0gdzIgKQoJCQl7CgkJCQl3MiA9IG91dGVyLmNsaWVudFdpZHRoOyAgCgkJCX0KCQkJCgkJCWRvY3VtZW50LmJvZHkucmVtb3ZlQ2hpbGQob3V0ZXIpOyAKCQkJcmV0dXJuICh3MSAtIHcyKTsgIAoJCX0KCQkKCQkvKgoJCSAqIEZ1bmN0aW9uOiBfZm5BcHBseVRvQ2hpbGRyZW4KCQkgKiBQdXJwb3NlOiAgQXBwbHkgYSBnaXZlbiBmdW5jdGlvbiB0byB0aGUgZGlzcGxheSBjaGlsZCBub2RlcyBvZiBhbiBlbGVtZW50IGFycmF5ICh0eXBpY2FsbHkKCQkgKiAgIFREIGNoaWxkcmVuIG9mIFRSIHJvd3MKCQkgKiBSZXR1cm5zOiAgLSAoZG9uZSBieSByZWZlcmVuY2UpCgkJICogSW5wdXRzOiAgIGZ1bmN0aW9uOmZuIC0gTWV0aG9kIHRvIGFwcGx5IHRvIHRoZSBvYmplY3RzCgkJICogICAgICAgICAgIGFycmF5IG5vZGVzOmFuMSAtIExpc3Qgb2YgZWxlbWVudHMgdG8gbG9vayB0aHJvdWdoIGZvciBkaXNwbGF5IGNoaWxkcmVuCgkJICogICAgICAgICAgIGFycmF5IG5vZGVzOmFuMiAtIEFub3RoZXIgbGlzdCAoaWRlbnRpY2FsIHN0cnVjdHVyZSB0byB0aGUgZmlyc3QpIC0gb3B0aW9uYWwKCQkgKi8KCQlmdW5jdGlvbiBfZm5BcHBseVRvQ2hpbGRyZW4oIGZuLCBhbjEsIGFuMiApCgkJewoJCQlmb3IgKCB2YXIgaT0wLCBpTGVuPWFuMS5sZW5ndGggOyBpPGlMZW4gOyBpKysgKQoJCQl7CgkJCQlmb3IgKCB2YXIgaj0wLCBqTGVuPWFuMVtpXS5jaGlsZE5vZGVzLmxlbmd0aCA7IGo8akxlbiA7IGorKyApCgkJCQl7CgkJCQkJaWYgKCBhbjFbaV0uY2hpbGROb2Rlc1tqXS5ub2RlVHlwZSA9PSAxICkKCQkJCQl7CgkJCQkJCWlmICggdHlwZW9mIGFuMiAhPSAndW5kZWZpbmVkJyApCgkJCQkJCXsKCQkJCQkJCWZuKCBhbjFbaV0uY2hpbGROb2Rlc1tqXSwgYW4yW2ldLmNoaWxkTm9kZXNbal0gKTsKCQkJCQkJfQoJCQkJCQllbHNlCgkJCQkJCXsKCQkJCQkJCWZuKCBhbjFbaV0uY2hpbGROb2Rlc1tqXSApOwoJCQkJCQl9CgkJCQkJfQoJCQkJfQoJCQl9CgkJfQoJCQoJCS8qCgkJICogRnVuY3Rpb246IF9mbk1hcAoJCSAqIFB1cnBvc2U6ICBTZWUgaWYgYSBwcm9wZXJ0eSBpcyBkZWZpbmVkIG9uIG9uZSBvYmplY3QsIGlmIHNvIGFzc2lnbiBpdCB0byB0aGUgb3RoZXIgb2JqZWN0CgkJICogUmV0dXJuczogIC0gKGRvbmUgYnkgcmVmZXJlbmNlKQoJCSAqIElucHV0czogICBvYmplY3Q6b1JldCAtIHRhcmdldCBvYmplY3QKCQkgKiAgICAgICAgICAgb2JqZWN0Om9TcmMgLSBzb3VyY2Ugb2JqZWN0CgkJICogICAgICAgICAgIHN0cmluZzpzTmFtZSAtIHByb3BlcnR5CgkJICogICAgICAgICAgIHN0cmluZzpzTWFwcGVkTmFtZSAtIG5hbWUgdG8gbWFwIHRvbyAtIG9wdGlvbmFsLCBzTmFtZSB1c2VkIGlmIG5vdCBnaXZlbgoJCSAqLwoJCWZ1bmN0aW9uIF9mbk1hcCggb1JldCwgb1NyYywgc05hbWUsIHNNYXBwZWROYW1lICkKCQl7CgkJCWlmICggdHlwZW9mIHNNYXBwZWROYW1lID09ICd1bmRlZmluZWQnICkKCQkJewoJCQkJc01hcHBlZE5hbWUgPSBzTmFtZTsKCQkJfQoJCQlpZiAoIHR5cGVvZiBvU3JjW3NOYW1lXSAhPSAndW5kZWZpbmVkJyApCgkJCXsKCQkJCW9SZXRbc01hcHBlZE5hbWVdID0gb1NyY1tzTmFtZV07CgkJCX0KCQl9CgkJCgkJLyogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICoKCQkgKiBTZWN0aW9uIC0gQVBJCgkJICogCgkJICogSSdtIG5vdCBvdmVybHkgaGFwcHkgd2l0aCB0aGlzIHNvbHV0aW9uIC0gSSdkIG11Y2ggcmF0aGVyIHRoYXQgdGhlcmUgd2FzIGEgd2F5IG9mIGdldHRpbmcKCQkgKiBhIGxpc3Qgb2YgYWxsIHRoZSBwcml2YXRlIGZ1bmN0aW9ucyBhbmQgZG8gd2hhdCB3ZSBuZWVkIHRvIGR5bmFtaWNhbGx5IC0gYnV0IHRoYXQgZG9lc24ndAoJCSAqIGFwcGVhciB0byBiZSBwb3NzaWJsZS4gQm9ua2Vycy4gQSBiZXR0ZXIgc29sdXRpb24gd291bGQgYmUgdG8gcHJvdmlkZSBhICdiaW5kJyB0eXBlIG9iamVjdAoJCSAqIFRvIGRvIC0gYmluZCB0eXBlIG1ldGhvZCBpbiBEVHMgMi54LgoJCSAqLwoJCXRoaXMub0FwaS5fZm5FeHRlcm5BcGlGdW5jID0gX2ZuRXh0ZXJuQXBpRnVuYzsKCQl0aGlzLm9BcGkuX2ZuSW5pdGFsaXNlID0gX2ZuSW5pdGFsaXNlOwoJCXRoaXMub0FwaS5fZm5MYW5ndWFnZVByb2Nlc3MgPSBfZm5MYW5ndWFnZVByb2Nlc3M7CgkJdGhpcy5vQXBpLl9mbkFkZENvbHVtbiA9IF9mbkFkZENvbHVtbjsKCQl0aGlzLm9BcGkuX2ZuQ29sdW1uT3B0aW9ucyA9IF9mbkNvbHVtbk9wdGlvbnM7CgkJdGhpcy5vQXBpLl9mbkFkZERhdGEgPSBfZm5BZGREYXRhOwoJCXRoaXMub0FwaS5fZm5HYXRoZXJEYXRhID0gX2ZuR2F0aGVyRGF0YTsKCQl0aGlzLm9BcGkuX2ZuRHJhd0hlYWQgPSBfZm5EcmF3SGVhZDsKCQl0aGlzLm9BcGkuX2ZuRHJhdyA9IF9mbkRyYXc7CgkJdGhpcy5vQXBpLl9mblJlRHJhdyA9IF9mblJlRHJhdzsKCQl0aGlzLm9BcGkuX2ZuQWpheFVwZGF0ZSA9IF9mbkFqYXhVcGRhdGU7CgkJdGhpcy5vQXBpLl9mbkFqYXhVcGRhdGVEcmF3ID0gX2ZuQWpheFVwZGF0ZURyYXc7CgkJdGhpcy5vQXBpLl9mbkFkZE9wdGlvbnNIdG1sID0gX2ZuQWRkT3B0aW9uc0h0bWw7CgkJdGhpcy5vQXBpLl9mbkZlYXR1cmVIdG1sVGFibGUgPSBfZm5GZWF0dXJlSHRtbFRhYmxlOwoJCXRoaXMub0FwaS5fZm5TY3JvbGxEcmF3ID0gX2ZuU2Nyb2xsRHJhdzsKCQl0aGlzLm9BcGkuX2ZuQWp1c3RDb2x1bW5TaXppbmcgPSBfZm5BanVzdENvbHVtblNpemluZzsKCQl0aGlzLm9BcGkuX2ZuRmVhdHVyZUh0bWxGaWx0ZXIgPSBfZm5GZWF0dXJlSHRtbEZpbHRlcjsKCQl0aGlzLm9BcGkuX2ZuRmlsdGVyQ29tcGxldGUgPSBfZm5GaWx0ZXJDb21wbGV0ZTsKCQl0aGlzLm9BcGkuX2ZuRmlsdGVyQ3VzdG9tID0gX2ZuRmlsdGVyQ3VzdG9tOwoJCXRoaXMub0FwaS5fZm5GaWx0ZXJDb2x1bW4gPSBfZm5GaWx0ZXJDb2x1bW47CgkJdGhpcy5vQXBpLl9mbkZpbHRlciA9IF9mbkZpbHRlcjsKCQl0aGlzLm9BcGkuX2ZuQnVpbGRTZWFyY2hBcnJheSA9IF9mbkJ1aWxkU2VhcmNoQXJyYXk7CgkJdGhpcy5vQXBpLl9mbkJ1aWxkU2VhcmNoUm93ID0gX2ZuQnVpbGRTZWFyY2hSb3c7CgkJdGhpcy5vQXBpLl9mbkZpbHRlckNyZWF0ZVNlYXJjaCA9IF9mbkZpbHRlckNyZWF0ZVNlYXJjaDsKCQl0aGlzLm9BcGkuX2ZuRGF0YVRvU2VhcmNoID0gX2ZuRGF0YVRvU2VhcmNoOwoJCXRoaXMub0FwaS5fZm5Tb3J0ID0gX2ZuU29ydDsKCQl0aGlzLm9BcGkuX2ZuU29ydEF0dGFjaExpc3RlbmVyID0gX2ZuU29ydEF0dGFjaExpc3RlbmVyOwoJCXRoaXMub0FwaS5fZm5Tb3J0aW5nQ2xhc3NlcyA9IF9mblNvcnRpbmdDbGFzc2VzOwoJCXRoaXMub0FwaS5fZm5GZWF0dXJlSHRtbFBhZ2luYXRlID0gX2ZuRmVhdHVyZUh0bWxQYWdpbmF0ZTsKCQl0aGlzLm9BcGkuX2ZuUGFnZUNoYW5nZSA9IF9mblBhZ2VDaGFuZ2U7CgkJdGhpcy5vQXBpLl9mbkZlYXR1cmVIdG1sSW5mbyA9IF9mbkZlYXR1cmVIdG1sSW5mbzsKCQl0aGlzLm9BcGkuX2ZuVXBkYXRlSW5mbyA9IF9mblVwZGF0ZUluZm87CgkJdGhpcy5vQXBpLl9mbkZlYXR1cmVIdG1sTGVuZ3RoID0gX2ZuRmVhdHVyZUh0bWxMZW5ndGg7CgkJdGhpcy5vQXBpLl9mbkZlYXR1cmVIdG1sUHJvY2Vzc2luZyA9IF9mbkZlYXR1cmVIdG1sUHJvY2Vzc2luZzsKCQl0aGlzLm9BcGkuX2ZuUHJvY2Vzc2luZ0Rpc3BsYXkgPSBfZm5Qcm9jZXNzaW5nRGlzcGxheTsKCQl0aGlzLm9BcGkuX2ZuVmlzaWJsZVRvQ29sdW1uSW5kZXggPSBfZm5WaXNpYmxlVG9Db2x1bW5JbmRleDsKCQl0aGlzLm9BcGkuX2ZuQ29sdW1uSW5kZXhUb1Zpc2libGUgPSBfZm5Db2x1bW5JbmRleFRvVmlzaWJsZTsKCQl0aGlzLm9BcGkuX2ZuTm9kZVRvRGF0YUluZGV4ID0gX2ZuTm9kZVRvRGF0YUluZGV4OwoJCXRoaXMub0FwaS5fZm5WaXNibGVDb2x1bW5zID0gX2ZuVmlzYmxlQ29sdW1uczsKCQl0aGlzLm9BcGkuX2ZuQ2FsY3VsYXRlRW5kID0gX2ZuQ2FsY3VsYXRlRW5kOwoJCXRoaXMub0FwaS5fZm5Db252ZXJ0VG9XaWR0aCA9IF9mbkNvbnZlcnRUb1dpZHRoOwoJCXRoaXMub0FwaS5fZm5DYWxjdWxhdGVDb2x1bW5XaWR0aHMgPSBfZm5DYWxjdWxhdGVDb2x1bW5XaWR0aHM7CgkJdGhpcy5vQXBpLl9mblNjcm9sbGluZ1dpZHRoQWRqdXN0ID0gX2ZuU2Nyb2xsaW5nV2lkdGhBZGp1c3Q7CgkJdGhpcy5vQXBpLl9mbkdldFdpZGVzdE5vZGUgPSBfZm5HZXRXaWRlc3ROb2RlOwoJCXRoaXMub0FwaS5fZm5HZXRNYXhMZW5TdHJpbmcgPSBfZm5HZXRNYXhMZW5TdHJpbmc7CgkJdGhpcy5vQXBpLl9mblN0cmluZ1RvQ3NzID0gX2ZuU3RyaW5nVG9Dc3M7CgkJdGhpcy5vQXBpLl9mbkFycmF5Q21wID0gX2ZuQXJyYXlDbXA7CgkJdGhpcy5vQXBpLl9mbkRldGVjdFR5cGUgPSBfZm5EZXRlY3RUeXBlOwoJCXRoaXMub0FwaS5fZm5TZXR0aW5nc0Zyb21Ob2RlID0gX2ZuU2V0dGluZ3NGcm9tTm9kZTsKCQl0aGlzLm9BcGkuX2ZuR2V0RGF0YU1hc3RlciA9IF9mbkdldERhdGFNYXN0ZXI7CgkJdGhpcy5vQXBpLl9mbkdldFRyTm9kZXMgPSBfZm5HZXRUck5vZGVzOwoJCXRoaXMub0FwaS5fZm5HZXRUZE5vZGVzID0gX2ZuR2V0VGROb2RlczsKCQl0aGlzLm9BcGkuX2ZuRXNjYXBlUmVnZXggPSBfZm5Fc2NhcGVSZWdleDsKCQl0aGlzLm9BcGkuX2ZuRGVsZXRlSW5kZXggPSBfZm5EZWxldGVJbmRleDsKCQl0aGlzLm9BcGkuX2ZuUmVPcmRlckluZGV4ID0gX2ZuUmVPcmRlckluZGV4OwoJCXRoaXMub0FwaS5fZm5Db2x1bW5PcmRlcmluZyA9IF9mbkNvbHVtbk9yZGVyaW5nOwoJCXRoaXMub0FwaS5fZm5Mb2cgPSBfZm5Mb2c7CgkJdGhpcy5vQXBpLl9mbkNsZWFyVGFibGUgPSBfZm5DbGVhclRhYmxlOwoJCXRoaXMub0FwaS5fZm5TYXZlU3RhdGUgPSBfZm5TYXZlU3RhdGU7CgkJdGhpcy5vQXBpLl9mbkxvYWRTdGF0ZSA9IF9mbkxvYWRTdGF0ZTsKCQl0aGlzLm9BcGkuX2ZuQ3JlYXRlQ29va2llID0gX2ZuQ3JlYXRlQ29va2llOwoJCXRoaXMub0FwaS5fZm5SZWFkQ29va2llID0gX2ZuUmVhZENvb2tpZTsKCQl0aGlzLm9BcGkuX2ZuR2V0VW5pcXVlVGhzID0gX2ZuR2V0VW5pcXVlVGhzOwoJCXRoaXMub0FwaS5fZm5TY3JvbGxCYXJXaWR0aCA9IF9mblNjcm9sbEJhcldpZHRoOwoJCXRoaXMub0FwaS5fZm5BcHBseVRvQ2hpbGRyZW4gPSBfZm5BcHBseVRvQ2hpbGRyZW47CgkJdGhpcy5vQXBpLl9mbk1hcCA9IF9mbk1hcDsKCQkKCQkKCQkvKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKgoJCSAqIFNlY3Rpb24gLSBDb25zdHJ1Y3RvcgoJCSAqLwoJCQoJCS8qIFdhbnQgdG8gYmUgYWJsZSB0byByZWZlcmVuY2UgInRoaXMiIGluc2lkZSB0aGUgdGhpcy5lYWNoIGZ1bmN0aW9uICovCgkJdmFyIF90aGF0ID0gdGhpczsKCQlyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCkKCQl7CgkJCXZhciBpPTAsIGlMZW4sIGosIGpMZW4sIGssIGtMZW47CgkJCQoJCQkvKiBDaGVjayB0byBzZWUgaWYgd2UgYXJlIHJlLWluaXRhbGlzaW5nIGEgdGFibGUgKi8KCQkJZm9yICggaT0wLCBpTGVuPV9hb1NldHRpbmdzLmxlbmd0aCA7IGk8aUxlbiA7IGkrKyApCgkJCXsKCQkJCS8qIEJhc2UgY2hlY2sgb24gdGFibGUgbm9kZSAqLwoJCQkJaWYgKCBfYW9TZXR0aW5nc1tpXS5uVGFibGUgPT0gdGhpcyApCgkJCQl7CgkJCQkJaWYgKCB0eXBlb2Ygb0luaXQgPT0gJ3VuZGVmaW5lZCcgfHwgCgkJCQkJICAgKCB0eXBlb2Ygb0luaXQuYlJldHJpZXZlICE9ICd1bmRlZmluZWQnICYmIG9Jbml0LmJSZXRyaWV2ZSA9PT0gdHJ1ZSApICkKCQkJCQl7CgkJCQkJCXJldHVybiBfYW9TZXR0aW5nc1tpXS5vSW5zdGFuY2U7CgkJCQkJfQoJCQkJCWVsc2UgaWYgKCB0eXBlb2Ygb0luaXQuYkRlc3Ryb3kgIT0gJ3VuZGVmaW5lZCcgJiYgb0luaXQuYkRlc3Ryb3kgPT09IHRydWUgKQoJCQkJCXsKCQkJCQkJX2FvU2V0dGluZ3NbaV0ub0luc3RhbmNlLmZuRGVzdHJveSgpOwoJCQkJCQlicmVhazsKCQkJCQl9CgkJCQkJZWxzZQoJCQkJCXsKCQkJCQkJX2ZuTG9nKCBfYW9TZXR0aW5nc1tpXSwgMCwgIkNhbm5vdCByZWluaXRpYWxpc2UgRGF0YVRhYmxlLlxuXG4iKwoJCQkJCQkJIlRvIHJldHJpZXZlIHRoZSBEYXRhVGFibGVzIG9iamVjdCBmb3IgdGhpcyB0YWJsZSwgcGxlYXNlIHBhc3MgZWl0aGVyIG5vIGFyZ3VtZW50cyAiKwoJCQkJCQkJInRvIHRoZSBkYXRhVGFibGUoKSBmdW5jdGlvbiwgb3Igc2V0IGJSZXRyaWV2ZSB0byB0cnVlLiBBbHRlcm5hdGl2ZWx5LCB0byBkZXN0b3J5ICIrCgkJCQkJCQkidGhlIG9sZCB0YWJsZSBhbmQgY3JlYXRlIGEgbmV3IG9uZSwgc2V0IGJEZXN0cm95IHRvIHRydWUgKG5vdGUgdGhhdCBhIGxvdCBvZiAiKwoJCQkJCQkJImNoYW5nZXMgdG8gdGhlIGNvbmZpZ3VyYXRpb24gY2FuIGJlIG1hZGUgdGhyb3VnaCB0aGUgQVBJIHdoaWNoIGlzIHVzdWFsbHkgbXVjaCAiKwoJCQkJCQkJImZhc3RlcikuIiApOwoJCQkJCQlyZXR1cm47CgkJCQkJfQoJCQkJfQoJCQkJCgkJCQkvKiBJZiB0aGUgZWxlbWVudCB3ZSBhcmUgaW5pdGlhbGlzaW5nIGhhcyB0aGUgc2FtZSBJRCBhcyBhIHRhYmxlIHdoaWNoIHdhcyBwcmV2aW91c2x5CgkJCQkgKiBpbml0aWFsaXNlZCwgYnV0IHRoZSB0YWJsZSBub2RlcyBkb24ndCBtYXRjaCAoZnJvbSBiZWZvcmUpIHRoZW4gd2UgZGVzdG9yeSB0aGUgb2xkCgkJCQkgKiBpbnN0YW5jZSBieSBzaW1wbHkgZGVsZXRpbmcgaXQuIFRoaXMgaXMgdW5kZXIgdGhlIGFzc3VtcHRpb24gdGhhdCB0aGUgdGFibGUgaGFzIGJlZW4KCQkJCSAqIGRlc3Ryb3llZCBieSBvdGhlciBtZXRob2RzLiBBbnlvbmUgdXNpbmcgbm9uLWlkIHNlbGVjdG9ycyB3aWxsIG5lZWQgdG8gZG8gdGhpcyBtYW51YWxseQoJCQkJICovCgkJCQlpZiAoIF9hb1NldHRpbmdzW2ldLnNUYWJsZUlkICE9PSAiIiAmJiBfYW9TZXR0aW5nc1tpXS5zVGFibGVJZCA9PSB0aGlzLmdldEF0dHJpYnV0ZSgnaWQnKSApCgkJCQl7CgkJCQkJX2FvU2V0dGluZ3Muc3BsaWNlKCBpLCAxICk7CgkJCQkJYnJlYWs7CgkJCQl9CgkJCX0KCQkJCgkJCS8qIE1ha2UgYSBjb21wbGV0ZSBhbmQgaW5kZXBlbmRlbnQgY29weSBvZiB0aGUgc2V0dGluZ3Mgb2JqZWN0ICovCgkJCXZhciBvU2V0dGluZ3MgPSBuZXcgY2xhc3NTZXR0aW5ncygpOwoJCQlfYW9TZXR0aW5ncy5wdXNoKCBvU2V0dGluZ3MgKTsKCQkJCgkJCXZhciBiSW5pdEhhbmRlZE9mZiA9IGZhbHNlOwoJCQl2YXIgYlVzZVBhc3NlZERhdGEgPSBmYWxzZTsKCQkJCgkJCS8qIFNldCB0aGUgaWQgKi8KCQkJdmFyIHNJZCA9IHRoaXMuZ2V0QXR0cmlidXRlKCAnaWQnICk7CgkJCWlmICggc0lkICE9PSBudWxsICkKCQkJewoJCQkJb1NldHRpbmdzLnNUYWJsZUlkID0gc0lkOwoJCQkJb1NldHRpbmdzLnNJbnN0YW5jZSA9IHNJZDsKCQkJfQoJCQllbHNlCgkJCXsKCQkJCW9TZXR0aW5ncy5zSW5zdGFuY2UgPSBfb0V4dC5fb0V4dGVybkNvbmZpZy5pTmV4dFVuaXF1ZSArKzsKCQkJfQoJCQkKCQkJLyogU2FuaXR5IGNoZWNrICovCgkJCWlmICggdGhpcy5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpICE9ICd0YWJsZScgKQoJCQl7CgkJCQlfZm5Mb2coIG9TZXR0aW5ncywgMCwgIkF0dGVtcHRlZCB0byBpbml0aWFsaXNlIERhdGFUYWJsZXMgb24gYSBub2RlIHdoaWNoIGlzIG5vdCBhICIrCgkJCQkJInRhYmxlOiAiK3RoaXMubm9kZU5hbWUgKTsKCQkJCXJldHVybjsKCQkJfQoJCQkKCQkJLyogU3RvcmUgJ3RoaXMnIGluIHRoZSBzZXR0aW5ncyBvYmplY3QgZm9yIGxhdGVyIHJldHJpZXZhbCAqLwoJCQlvU2V0dGluZ3Mub0luc3RhbmNlID0gX3RoYXQ7CgkJCQoJCQkvKiBTZXQgdGhlIHRhYmxlIG5vZGUgKi8KCQkJb1NldHRpbmdzLm5UYWJsZSA9IHRoaXM7CgkJCQoJCQkvKiBCaW5kIHRoZSBBUEkgZnVuY3Rpb25zIHRvIHRoZSBzZXR0aW5ncywgc28gd2UgY2FuIHBlcmZvcm0gYWN0aW9ucyB3aGVuZXZlciBvU2V0dGluZ3MgaXMKCQkJICogYXZhaWxhYmxlCgkJCSAqLwoJCQlvU2V0dGluZ3Mub0FwaSA9IF90aGF0Lm9BcGk7CgkJCQoJCQkvKiBTdGF0ZSB0aGUgdGFibGUncyB3aWR0aCBmb3IgaWYgYSBkZXN0cm95IGlzIGNhbGxlZCBhdCBhIGxhdGVyIHRpbWUgKi8KCQkJb1NldHRpbmdzLnNEZXN0cm95V2lkdGggPSAkKHRoaXMpLndpZHRoKCk7CgkJCQoJCQkvKiBTdG9yZSB0aGUgZmVhdHVyZXMgdGhhdCB3ZSBoYXZlIGF2YWlsYWJsZSAqLwoJCQlpZiAoIHR5cGVvZiBvSW5pdCAhPSAndW5kZWZpbmVkJyAmJiBvSW5pdCAhPT0gbnVsbCApCgkJCXsKCQkJCW9TZXR0aW5ncy5vSW5pdCA9IG9Jbml0OwoJCQkJX2ZuTWFwKCBvU2V0dGluZ3Mub0ZlYXR1cmVzLCBvSW5pdCwgImJQYWdpbmF0ZSIgKTsKCQkJCV9mbk1hcCggb1NldHRpbmdzLm9GZWF0dXJlcywgb0luaXQsICJiTGVuZ3RoQ2hhbmdlIiApOwoJCQkJX2ZuTWFwKCBvU2V0dGluZ3Mub0ZlYXR1cmVzLCBvSW5pdCwgImJGaWx0ZXIiICk7CgkJCQlfZm5NYXAoIG9TZXR0aW5ncy5vRmVhdHVyZXMsIG9Jbml0LCAiYlNvcnQiICk7CgkJCQlfZm5NYXAoIG9TZXR0aW5ncy5vRmVhdHVyZXMsIG9Jbml0LCAiYkluZm8iICk7CgkJCQlfZm5NYXAoIG9TZXR0aW5ncy5vRmVhdHVyZXMsIG9Jbml0LCAiYlByb2Nlc3NpbmciICk7CgkJCQlfZm5NYXAoIG9TZXR0aW5ncy5vRmVhdHVyZXMsIG9Jbml0LCAiYkF1dG9XaWR0aCIgKTsKCQkJCV9mbk1hcCggb1NldHRpbmdzLm9GZWF0dXJlcywgb0luaXQsICJiU29ydENsYXNzZXMiICk7CgkJCQlfZm5NYXAoIG9TZXR0aW5ncy5vRmVhdHVyZXMsIG9Jbml0LCAiYlNlcnZlclNpZGUiICk7CgkJCQlfZm5NYXAoIG9TZXR0aW5ncy5vU2Nyb2xsLCBvSW5pdCwgInNTY3JvbGxYIiwgInNYIiApOwoJCQkJX2ZuTWFwKCBvU2V0dGluZ3Mub1Njcm9sbCwgb0luaXQsICJzU2Nyb2xsWElubmVyIiwgInNYSW5uZXIiICk7CgkJCQlfZm5NYXAoIG9TZXR0aW5ncy5vU2Nyb2xsLCBvSW5pdCwgInNTY3JvbGxZIiwgInNZIiApOwoJCQkJX2ZuTWFwKCBvU2V0dGluZ3Mub1Njcm9sbCwgb0luaXQsICJiU2Nyb2xsQ29sbGFwc2UiLCAiYkNvbGxhcHNlIiApOwoJCQkJX2ZuTWFwKCBvU2V0dGluZ3Mub1Njcm9sbCwgb0luaXQsICJiU2Nyb2xsSW5maW5pdGUiLCAiYkluZmluaXRlIiApOwoJCQkJX2ZuTWFwKCBvU2V0dGluZ3Mub1Njcm9sbCwgb0luaXQsICJpU2Nyb2xsTG9hZEdhcCIsICJpTG9hZEdhcCIgKTsKCQkJCV9mbk1hcCggb1NldHRpbmdzLCBvSW5pdCwgImFzU3RyaXBDbGFzc2VzIiApOwoJCQkJX2ZuTWFwKCBvU2V0dGluZ3MsIG9Jbml0LCAiZm5Sb3dDYWxsYmFjayIgKTsKCQkJCV9mbk1hcCggb1NldHRpbmdzLCBvSW5pdCwgImZuSGVhZGVyQ2FsbGJhY2siICk7CgkJCQlfZm5NYXAoIG9TZXR0aW5ncywgb0luaXQsICJmbkZvb3RlckNhbGxiYWNrIiApOwoJCQkJX2ZuTWFwKCBvU2V0dGluZ3MsIG9Jbml0LCAiZm5Db29raWVDYWxsYmFjayIgKTsKCQkJCV9mbk1hcCggb1NldHRpbmdzLCBvSW5pdCwgImZuSW5pdENvbXBsZXRlIiApOwoJCQkJX2ZuTWFwKCBvU2V0dGluZ3MsIG9Jbml0LCAiZm5TZXJ2ZXJEYXRhIiApOwoJCQkJX2ZuTWFwKCBvU2V0dGluZ3MsIG9Jbml0LCAiZm5Gb3JtYXROdW1iZXIiICk7CgkJCQlfZm5NYXAoIG9TZXR0aW5ncywgb0luaXQsICJhYVNvcnRpbmciICk7CgkJCQlfZm5NYXAoIG9TZXR0aW5ncywgb0luaXQsICJhYVNvcnRpbmdGaXhlZCIgKTsKCQkJCV9mbk1hcCggb1NldHRpbmdzLCBvSW5pdCwgImFMZW5ndGhNZW51IiApOwoJCQkJX2ZuTWFwKCBvU2V0dGluZ3MsIG9Jbml0LCAic1BhZ2luYXRpb25UeXBlIiApOwoJCQkJX2ZuTWFwKCBvU2V0dGluZ3MsIG9Jbml0LCAic0FqYXhTb3VyY2UiICk7CgkJCQlfZm5NYXAoIG9TZXR0aW5ncywgb0luaXQsICJpQ29va2llRHVyYXRpb24iICk7CgkJCQlfZm5NYXAoIG9TZXR0aW5ncywgb0luaXQsICJzQ29va2llUHJlZml4IiApOwoJCQkJX2ZuTWFwKCBvU2V0dGluZ3MsIG9Jbml0LCAic0RvbSIgKTsKCQkJCV9mbk1hcCggb1NldHRpbmdzLCBvSW5pdCwgIm9TZWFyY2giLCAib1ByZXZpb3VzU2VhcmNoIiApOwoJCQkJX2ZuTWFwKCBvU2V0dGluZ3MsIG9Jbml0LCAiYW9TZWFyY2hDb2xzIiwgImFvUHJlU2VhcmNoQ29scyIgKTsKCQkJCV9mbk1hcCggb1NldHRpbmdzLCBvSW5pdCwgImlEaXNwbGF5TGVuZ3RoIiwgIl9pRGlzcGxheUxlbmd0aCIgKTsKCQkJCV9mbk1hcCggb1NldHRpbmdzLCBvSW5pdCwgImJKUXVlcnlVSSIsICJiSlVJIiApOwoJCQkJX2ZuTWFwKCBvU2V0dGluZ3Mub0xhbmd1YWdlLCBvSW5pdCwgImZuSW5mb0NhbGxiYWNrIiApOwoJCQkJCgkJCQkvKiBDYWxsYmFjayBmdW5jdGlvbnMgd2hpY2ggYXJlIGFycmF5IGRyaXZlbiAqLwoJCQkJaWYgKCB0eXBlb2Ygb0luaXQuZm5EcmF3Q2FsbGJhY2sgPT0gJ2Z1bmN0aW9uJyApCgkJCQl7CgkJCQkJb1NldHRpbmdzLmFvRHJhd0NhbGxiYWNrLnB1c2goIHsKCQkJCQkJImZuIjogb0luaXQuZm5EcmF3Q2FsbGJhY2ssCgkJCQkJCSJzTmFtZSI6ICJ1c2VyIgoJCQkJCX0gKTsKCQkJCX0KCQkJCQoJCQkJaWYgKCB0eXBlb2Ygb0luaXQuZm5TdGF0ZVNhdmVDYWxsYmFjayA9PSAnZnVuY3Rpb24nICkKCQkJCXsKCQkJCQlvU2V0dGluZ3MuYW9TdGF0ZVNhdmUucHVzaCggewoJCQkJCQkiZm4iOiBvSW5pdC5mblN0YXRlU2F2ZUNhbGxiYWNrLAoJCQkJCQkic05hbWUiOiAidXNlciIKCQkJCQl9ICk7CgkJCQl9CgkJCQkKCQkJCWlmICggdHlwZW9mIG9Jbml0LmZuU3RhdGVMb2FkQ2FsbGJhY2sgPT0gJ2Z1bmN0aW9uJyApCgkJCQl7CgkJCQkJb1NldHRpbmdzLmFvU3RhdGVMb2FkLnB1c2goIHsKCQkJCQkJImZuIjogb0luaXQuZm5TdGF0ZUxvYWRDYWxsYmFjaywKCQkJCQkJInNOYW1lIjogInVzZXIiCgkJCQkJfSApOwoJCQkJfQoJCQkJCgkJCQlpZiAoIG9TZXR0aW5ncy5vRmVhdHVyZXMuYlNlcnZlclNpZGUgJiYgb1NldHRpbmdzLm9GZWF0dXJlcy5iU29ydCAmJgoJCQkJCSAgIG9TZXR0aW5ncy5vRmVhdHVyZXMuYlNvcnRDbGFzc2VzICkKCQkJCXsKCQkJCQkvKiBFbmFibGUgc29ydCBjbGFzc2VzIGZvciBzZXJ2ZXItc2lkZSBwcm9jZXNzaW5nLiBTYWZlIHRvIGRvIGl0IGhlcmUsIHNpbmNlIHNlcnZlci1zaWRlCgkJCQkJICogcHJvY2Vzc2luZyBtdXN0IGJlIGVuYWJsZWQgYnkgdGhlIGRldmVsb3BlcgoJCQkJCSAqLwoJCQkJCW9TZXR0aW5ncy5hb0RyYXdDYWxsYmFjay5wdXNoKCB7CgkJCQkJCSJmbiI6IF9mblNvcnRpbmdDbGFzc2VzLAoJCQkJCQkic05hbWUiOiAic2VydmVyX3NpZGVfc29ydF9jbGFzc2VzIgoJCQkJCX0gKTsKCQkJCX0KCQkJCQoJCQkJaWYgKCB0eXBlb2Ygb0luaXQuYkpRdWVyeVVJICE9ICd1bmRlZmluZWQnICYmIG9Jbml0LmJKUXVlcnlVSSApCgkJCQl7CgkJCQkJLyogVXNlIHRoZSBKVUkgY2xhc3NlcyBvYmplY3QgZm9yIGRpc3BsYXkuIFlvdSBjb3VsZCBjbG9uZSB0aGUgb1N0ZENsYXNzZXMgb2JqZWN0IGlmIAoJCQkJCSAqIHlvdSB3YW50IHRvIGhhdmUgbXVsdGlwbGUgdGFibGVzIHdpdGggbXVsdGlwbGUgaW5kZXBlbmRlbnQgY2xhc3NlcyAKCQkJCQkgKi8KCQkJCQlvU2V0dGluZ3Mub0NsYXNzZXMgPSBfb0V4dC5vSlVJQ2xhc3NlczsKCQkJCQkKCQkJCQlpZiAoIHR5cGVvZiBvSW5pdC5zRG9tID09ICd1bmRlZmluZWQnICkKCQkJCQl7CgkJCQkJCS8qIFNldCB0aGUgRE9NIHRvIHVzZSBhIGxheW91dCBzdWl0YWJsZSBmb3IgalF1ZXJ5IFVJJ3MgdGhlbWluZyAqLwoJCQkJCQlvU2V0dGluZ3Muc0RvbSA9ICc8IkgibGZyPnQ8IkYiaXA+JzsKCQkJCQl9CgkJCQl9CgkJCQkKCQkJCS8qIENhbGN1bGF0ZSB0aGUgc2Nyb2xsIGJhciB3aWR0aCBhbmQgY2FjaGUgaXQgZm9yIHVzZSBsYXRlciBvbiAqLwoJCQkJaWYgKCBvU2V0dGluZ3Mub1Njcm9sbC5zWCAhPT0gIiIgfHwgb1NldHRpbmdzLm9TY3JvbGwuc1kgIT09ICIiICkKCQkJCXsKCQkJCQlvU2V0dGluZ3Mub1Njcm9sbC5pQmFyV2lkdGggPSBfZm5TY3JvbGxCYXJXaWR0aCgpOwoJCQkJfQoJCQkJCgkJCQlpZiAoIHR5cGVvZiBvSW5pdC5pRGlzcGxheVN0YXJ0ICE9ICd1bmRlZmluZWQnICYmIAoJCQkJICAgICB0eXBlb2Ygb1NldHRpbmdzLmlJbml0RGlzcGxheVN0YXJ0ID09ICd1bmRlZmluZWQnICkKCQkJCXsKCQkJCQkvKiBEaXNwbGF5IHN0YXJ0IHBvaW50LCB0YWtpbmcgaW50byBhY2NvdW50IHRoZSBzYXZlIHNhdmluZyAqLwoJCQkJCW9TZXR0aW5ncy5pSW5pdERpc3BsYXlTdGFydCA9IG9Jbml0LmlEaXNwbGF5U3RhcnQ7CgkJCQkJb1NldHRpbmdzLl9pRGlzcGxheVN0YXJ0ID0gb0luaXQuaURpc3BsYXlTdGFydDsKCQkJCX0KCQkJCQoJCQkJLyogTXVzdCBiZSBkb25lIGFmdGVyIGV2ZXJ5dGhpbmcgd2hpY2ggY2FuIGJlIG92ZXJyaWRkZW4gYnkgYSBjb29raWUhICovCgkJCQlpZiAoIHR5cGVvZiBvSW5pdC5iU3RhdGVTYXZlICE9ICd1bmRlZmluZWQnICkKCQkJCXsKCQkJCQlvU2V0dGluZ3Mub0ZlYXR1cmVzLmJTdGF0ZVNhdmUgPSBvSW5pdC5iU3RhdGVTYXZlOwoJCQkJCV9mbkxvYWRTdGF0ZSggb1NldHRpbmdzLCBvSW5pdCApOwoJCQkJCW9TZXR0aW5ncy5hb0RyYXdDYWxsYmFjay5wdXNoKCB7CgkJCQkJCSJmbiI6IF9mblNhdmVTdGF0ZSwKCQkJCQkJInNOYW1lIjogInN0YXRlX3NhdmUiCgkJCQkJfSApOwoJCQkJfQoJCQkJCgkJCQlpZiAoIHR5cGVvZiBvSW5pdC5hYURhdGEgIT0gJ3VuZGVmaW5lZCcgKQoJCQkJewoJCQkJCWJVc2VQYXNzZWREYXRhID0gdHJ1ZTsKCQkJCX0KCQkJCQoJCQkJLyogQmFja3dhcmRzIGNvbXBhdGFiaWxpdHkgKi8KCQkJCS8qIGFvQ29sdW1ucyAvIGFvRGF0YSAtIHJlbW92ZSBhdCBzb21lIHBvaW50Li4uICovCgkJCQlpZiAoIHR5cGVvZiBvSW5pdCAhPSAndW5kZWZpbmVkJyAmJiB0eXBlb2Ygb0luaXQuYW9EYXRhICE9ICd1bmRlZmluZWQnICkKCQkJCXsKCQkJCQlvSW5pdC5hb0NvbHVtbnMgPSBvSW5pdC5hb0RhdGE7CgkJCQl9CgkJCQkKCQkJCS8qIExhbmd1YWdlIGRlZmluaXRpb25zICovCgkJCQlpZiAoIHR5cGVvZiBvSW5pdC5vTGFuZ3VhZ2UgIT0gJ3VuZGVmaW5lZCcgKQoJCQkJewoJCQkJCWlmICggdHlwZW9mIG9Jbml0Lm9MYW5ndWFnZS5zVXJsICE9ICd1bmRlZmluZWQnICYmIG9Jbml0Lm9MYW5ndWFnZS5zVXJsICE9PSAiIiApCgkJCQkJewoJCQkJCQkvKiBHZXQgdGhlIGxhbmd1YWdlIGRlZmluaXRpb25zIGZyb20gYSBmaWxlICovCgkJCQkJCW9TZXR0aW5ncy5vTGFuZ3VhZ2Uuc1VybCA9IG9Jbml0Lm9MYW5ndWFnZS5zVXJsOwoJCQkJCQkkLmdldEpTT04oIG9TZXR0aW5ncy5vTGFuZ3VhZ2Uuc1VybCwgbnVsbCwgZnVuY3Rpb24oIGpzb24gKSB7IAoJCQkJCQkJX2ZuTGFuZ3VhZ2VQcm9jZXNzKCBvU2V0dGluZ3MsIGpzb24sIHRydWUgKTsgfSApOwoJCQkJCQliSW5pdEhhbmRlZE9mZiA9IHRydWU7CgkJCQkJfQoJCQkJCWVsc2UKCQkJCQl7CgkJCQkJCV9mbkxhbmd1YWdlUHJvY2Vzcyggb1NldHRpbmdzLCBvSW5pdC5vTGFuZ3VhZ2UsIGZhbHNlICk7CgkJCQkJfQoJCQkJfQoJCQkJLyogV2FybmluZzogVGhlIF9mbkxhbmd1YWdlUHJvY2VzcyBmdW5jdGlvbiBpcyBhc3luYyB0byB0aGUgcmVtYWluZGVyIG9mIHRoaXMgZnVuY3Rpb24gZHVlCgkJCQkgKiB0byB0aGUgWEhSLiBXZSB1c2UgX2JJbml0aWFsaXNlZCBpbiBfZm5MYW5ndWFnZVByb2Nlc3MoKSB0byBjaGVjayB0aGlzIHRoZSBwcm9jZXNzaW5nIAoJCQkJICogYmVsb3cgaXMgY29tcGxldGUuIFRoZSByZWFzb24gZm9yIHNwbGl0aW5nIGl0IGxpa2UgdGhpcyBpcyBvcHRpbWlzYXRpb24gLSB3ZSBjYW4gZmlyZQoJCQkJICogb2ZmIHRoZSBYSFIgKGlmIG5lZWRlZCkgYW5kIHRoZW4gY29udGludWUgcHJvY2Vzc2luZyB0aGUgZGF0YS4KCQkJCSAqLwoJCQl9CgkJCWVsc2UKCQkJewoJCQkJLyogQ3JlYXRlIGEgZHVtbXkgb2JqZWN0IGZvciBxdWljayBtYW5pcHVsYXRpb24gbGF0ZXIgb24uICovCgkJCQlvSW5pdCA9IHt9OwoJCQl9CgkJCQoJCQkvKgoJCQkgKiBTdHJpcGVzCgkJCSAqIEFkZCB0aGUgc3RyaXAgY2xhc3NlcyBub3cgdGhhdCB3ZSBrbm93IHdoaWNoIGNsYXNzZXMgdG8gYXBwbHkgLSB1bmxlc3Mgb3ZlcnJ1bGVkCgkJCSAqLwoJCQlpZiAoIHR5cGVvZiBvSW5pdC5hc1N0cmlwQ2xhc3NlcyA9PSAndW5kZWZpbmVkJyApCgkJCXsKCQkJCW9TZXR0aW5ncy5hc1N0cmlwQ2xhc3Nlcy5wdXNoKCBvU2V0dGluZ3Mub0NsYXNzZXMuc1N0cmlwT2RkICk7CgkJCQlvU2V0dGluZ3MuYXNTdHJpcENsYXNzZXMucHVzaCggb1NldHRpbmdzLm9DbGFzc2VzLnNTdHJpcEV2ZW4gKTsKCQkJfQoJCQkKCQkJLyogUmVtb3ZlIHJvdyBzdHJpcGUgY2xhc3NlcyBpZiB0aGV5IGFyZSBhbHJlYWR5IG9uIHRoZSB0YWJsZSByb3cgKi8KCQkJdmFyIGJTdHJpcGVSZW1vdmUgPSBmYWxzZTsKCQkJdmFyIGFuUm93cyA9ICQoJ3Rib2R5PnRyJywgdGhpcyk7CgkJCWZvciAoIGk9MCwgaUxlbj1vU2V0dGluZ3MuYXNTdHJpcENsYXNzZXMubGVuZ3RoIDsgaTxpTGVuIDsgaSsrICkKCQkJewoJCQkJaWYgKCBhblJvd3MuZmlsdGVyKCI6bHQoMikiKS5oYXNDbGFzcyggb1NldHRpbmdzLmFzU3RyaXBDbGFzc2VzW2ldKSApCgkJCQl7CgkJCQkJYlN0cmlwZVJlbW92ZSA9IHRydWU7CgkJCQkJYnJlYWs7CgkJCQl9CgkJCX0KCQkJCQkKCQkJaWYgKCBiU3RyaXBlUmVtb3ZlICkKCQkJewoJCQkJLyogU3RvcmUgdGhlIGNsYXNzZXMgd2hpY2ggd2UgYXJlIGFib3V0IHRvIHJlbW92ZSBzbyB0aGV5IGNhbiBiZSByZWFkZGVkIG9uIGRlc3RvcnkgKi8KCQkJCW9TZXR0aW5ncy5hc0Rlc3RvcnlTdHJpcHMgPSBbICcnLCAnJyBdOwoJCQkJaWYgKCAkKGFuUm93c1swXSkuaGFzQ2xhc3Mob1NldHRpbmdzLm9DbGFzc2VzLnNTdHJpcE9kZCkgKQoJCQkJewoJCQkJCW9TZXR0aW5ncy5hc0Rlc3RvcnlTdHJpcHNbMF0gKz0gb1NldHRpbmdzLm9DbGFzc2VzLnNTdHJpcE9kZCsiICI7CgkJCQl9CgkJCQlpZiAoICQoYW5Sb3dzWzBdKS5oYXNDbGFzcyhvU2V0dGluZ3Mub0NsYXNzZXMuc1N0cmlwRXZlbikgKQoJCQkJewoJCQkJCW9TZXR0aW5ncy5hc0Rlc3RvcnlTdHJpcHNbMF0gKz0gb1NldHRpbmdzLm9DbGFzc2VzLnNTdHJpcEV2ZW47CgkJCQl9CgkJCQlpZiAoICQoYW5Sb3dzWzFdKS5oYXNDbGFzcyhvU2V0dGluZ3Mub0NsYXNzZXMuc1N0cmlwT2RkKSApCgkJCQl7CgkJCQkJb1NldHRpbmdzLmFzRGVzdG9yeVN0cmlwc1sxXSArPSBvU2V0dGluZ3Mub0NsYXNzZXMuc1N0cmlwT2RkKyIgIjsKCQkJCX0KCQkJCWlmICggJChhblJvd3NbMV0pLmhhc0NsYXNzKG9TZXR0aW5ncy5vQ2xhc3Nlcy5zU3RyaXBFdmVuKSApCgkJCQl7CgkJCQkJb1NldHRpbmdzLmFzRGVzdG9yeVN0cmlwc1sxXSArPSBvU2V0dGluZ3Mub0NsYXNzZXMuc1N0cmlwRXZlbjsKCQkJCX0KCQkJCQoJCQkJYW5Sb3dzLnJlbW92ZUNsYXNzKCBvU2V0dGluZ3MuYXNTdHJpcENsYXNzZXMuam9pbignICcpICk7CgkJCX0KCQkJCgkJCS8qCgkJCSAqIENvbHVtbnMKCQkJICogU2VlIGlmIHdlIHNob3VsZCBsb2FkIGNvbHVtbnMgYXV0b21hdGljYWxseSBvciB1c2UgZGVmaW5lZCBvbmVzCgkJCSAqLwoJCQl2YXIgblRoZWFkID0gdGhpcy5nZXRFbGVtZW50c0J5VGFnTmFtZSgndGhlYWQnKTsKCQkJdmFyIGFuVGhzID0gblRoZWFkLmxlbmd0aD09PTAgPyBbXSA6IF9mbkdldFVuaXF1ZVRocyggblRoZWFkWzBdICk7CgkJCXZhciBhb0NvbHVtbnNJbml0OwoJCQkKCQkJLyogSWYgbm90IGdpdmVuIGEgY29sdW1uIGFycmF5LCBnZW5lcmF0ZSBvbmUgd2l0aCBudWxscyAqLwoJCQlpZiAoIHR5cGVvZiBvSW5pdC5hb0NvbHVtbnMgPT0gJ3VuZGVmaW5lZCcgKQoJCQl7CgkJCQlhb0NvbHVtbnNJbml0ID0gW107CgkJCQlmb3IgKCBpPTAsIGlMZW49YW5UaHMubGVuZ3RoIDsgaTxpTGVuIDsgaSsrICkKCQkJCXsKCQkJCQlhb0NvbHVtbnNJbml0LnB1c2goIG51bGwgKTsKCQkJCX0KCQkJfQoJCQllbHNlCgkJCXsKCQkJCWFvQ29sdW1uc0luaXQgPSBvSW5pdC5hb0NvbHVtbnM7CgkJCX0KCQkJCgkJCS8qIEFkZCB0aGUgY29sdW1ucyAqLwoJCQlmb3IgKCBpPTAsIGlMZW49YW9Db2x1bW5zSW5pdC5sZW5ndGggOyBpPGlMZW4gOyBpKysgKQoJCQl7CgkJCQkvKiBDaGVjayBpZiB3ZSBoYXZlIGNvbHVtbiB2aXNpYmlsdHkgc3RhdGUgdG8gcmVzdG9yZSAqLwoJCQkJaWYgKCB0eXBlb2Ygb0luaXQuc2F2ZWRfYW9Db2x1bW5zICE9ICd1bmRlZmluZWQnICYmIG9Jbml0LnNhdmVkX2FvQ29sdW1ucy5sZW5ndGggPT0gaUxlbiApCgkJCQl7CgkJCQkJaWYgKCBhb0NvbHVtbnNJbml0W2ldID09PSBudWxsICkKCQkJCQl7CgkJCQkJCWFvQ29sdW1uc0luaXRbaV0gPSB7fTsKCQkJCQl9CgkJCQkJYW9Db2x1bW5zSW5pdFtpXS5iVmlzaWJsZSA9IG9Jbml0LnNhdmVkX2FvQ29sdW1uc1tpXS5iVmlzaWJsZTsKCQkJCX0KCQkJCQoJCQkJX2ZuQWRkQ29sdW1uKCBvU2V0dGluZ3MsIGFuVGhzID8gYW5UaHNbaV0gOiBudWxsICk7CgkJCX0KCQkJCgkJCS8qIEFkZCBvcHRpb25zIGZyb20gY29sdW1uIGRlZmluYXRpb25zICovCgkJCWlmICggdHlwZW9mIG9Jbml0LmFvQ29sdW1uRGVmcyAhPSAndW5kZWZpbmVkJyApCgkJCXsKCQkJCS8qIExvb3Agb3ZlciB0aGUgY29sdW1uIGRlZnMgYXJyYXkgLSBsb29wIGluIHJldmVyc2Ugc28gZmlyc3QgaW5zdGFjZSBoYXMgcHJpb3JpdHkgKi8KCQkJCWZvciAoIGk9b0luaXQuYW9Db2x1bW5EZWZzLmxlbmd0aC0xIDsgaT49MCA7IGktLSApCgkJCQl7CgkJCQkJLyogRWFjaCBjb2x1bW4gZGVmIGNhbiB0YXJnZXQgbXVsdGlwbGUgY29sdW1ucywgYXMgaXQgaXMgYW4gYXJyYXkgKi8KCQkJCQl2YXIgYVRhcmdldHMgPSBvSW5pdC5hb0NvbHVtbkRlZnNbaV0uYVRhcmdldHM7CgkJCQkJaWYgKCAhJC5pc0FycmF5KCBhVGFyZ2V0cyApICkKCQkJCQl7CgkJCQkJCV9mbkxvZyggb1NldHRpbmdzLCAxLCAnYVRhcmdldHMgbXVzdCBiZSBhbiBhcnJheSBvZiB0YXJnZXRzLCBub3QgYSAnKyh0eXBlb2YgYVRhcmdldHMpICk7CgkJCQkJfQoJCQkJCWZvciAoIGo9MCwgakxlbj1hVGFyZ2V0cy5sZW5ndGggOyBqPGpMZW4gOyBqKysgKQoJCQkJCXsKCQkJCQkJaWYgKCB0eXBlb2YgYVRhcmdldHNbal0gPT0gJ251bWJlcicgJiYgYVRhcmdldHNbal0gPj0gMCApCgkJCQkJCXsKCQkJCQkJCS8qIDArIGludGVnZXIsIGxlZnQgdG8gcmlnaHQgY29sdW1uIGNvdW50aW5nLiBXZSBhZGQgY29sdW1ucyB3aGljaCBhcmUgdW5rbm93bgoJCQkJCQkJICogYXV0b21hdGljYWxseS4gSXMgdGhpcyB0aGUgcmlnaHQgYmVoYXZpb3VyIGZvciB0aGlzPyBXZSBzaG91bGQgYXQgbGVhc3QKCQkJCQkJCSAqIGxvZyBpdCBpbiBmdXR1cmUuIFdlIGNhbm5vdCBkbyB0aGlzIGZvciB0aGUgbmVnYXRpdmUgb3IgY2xhc3MgdGFyZ2V0cywgb25seSBoZXJlLgoJCQkJCQkJICovCgkJCQkJCQl3aGlsZSggb1NldHRpbmdzLmFvQ29sdW1ucy5sZW5ndGggPD0gYVRhcmdldHNbal0gKQoJCQkJCQkJewoJCQkJCQkJCV9mbkFkZENvbHVtbiggb1NldHRpbmdzICk7CgkJCQkJCQl9CgkJCQkJCQlfZm5Db2x1bW5PcHRpb25zKCBvU2V0dGluZ3MsIGFUYXJnZXRzW2pdLCBvSW5pdC5hb0NvbHVtbkRlZnNbaV0gKTsKCQkJCQkJfQoJCQkJCQllbHNlIGlmICggdHlwZW9mIGFUYXJnZXRzW2pdID09ICdudW1iZXInICYmIGFUYXJnZXRzW2pdIDwgMCApCgkJCQkJCXsKCQkJCQkJCS8qIE5lZ2F0aXZlIGludGVnZXIsIHJpZ2h0IHRvIGxlZnQgY29sdW1uIGNvdW50aW5nICovCgkJCQkJCQlfZm5Db2x1bW5PcHRpb25zKCBvU2V0dGluZ3MsIG9TZXR0aW5ncy5hb0NvbHVtbnMubGVuZ3RoK2FUYXJnZXRzW2pdLCAKCQkJCQkJCQlvSW5pdC5hb0NvbHVtbkRlZnNbaV0gKTsKCQkJCQkJfQoJCQkJCQllbHNlIGlmICggdHlwZW9mIGFUYXJnZXRzW2pdID09ICdzdHJpbmcnICkKCQkJCQkJewoJCQkJCQkJLyogQ2xhc3MgbmFtZSBtYXRjaGluZyBvbiBUSCBlbGVtZW50ICovCgkJCQkJCQlmb3IgKCBrPTAsIGtMZW49b1NldHRpbmdzLmFvQ29sdW1ucy5sZW5ndGggOyBrPGtMZW4gOyBrKysgKQoJCQkJCQkJewoJCQkJCQkJCWlmICggYVRhcmdldHNbal0gPT0gIl9hbGwiIHx8CgkJCQkJCQkJICAgICBvU2V0dGluZ3MuYW9Db2x1bW5zW2tdLm5UaC5jbGFzc05hbWUuaW5kZXhPZiggYVRhcmdldHNbal0gKSAhPSAtMSApCgkJCQkJCQkJewoJCQkJCQkJCQlfZm5Db2x1bW5PcHRpb25zKCBvU2V0dGluZ3MsIGssIG9Jbml0LmFvQ29sdW1uRGVmc1tpXSApOwoJCQkJCQkJCX0KCQkJCQkJCX0KCQkJCQkJfQoJCQkJCX0KCQkJCX0KCQkJfQoJCQkKCQkJLyogQWRkIG9wdGlvbnMgZnJvbSBjb2x1bW4gYXJyYXkgLSBhZnRlciB0aGUgZGVmcyBhcnJheSBzbyB0aGlzIGhhcyBwcmlvcml0eSAqLwoJCQlpZiAoIHR5cGVvZiBhb0NvbHVtbnNJbml0ICE9ICd1bmRlZmluZWQnICkKCQkJewoJCQkJZm9yICggaT0wLCBpTGVuPWFvQ29sdW1uc0luaXQubGVuZ3RoIDsgaTxpTGVuIDsgaSsrICkKCQkJCXsKCQkJCQlfZm5Db2x1bW5PcHRpb25zKCBvU2V0dGluZ3MsIGksIGFvQ29sdW1uc0luaXRbaV0gKTsKCQkJCX0KCQkJfQoJCQkKCQkJLyoKCQkJICogU29ydGluZwoJCQkgKiBDaGVjayB0aGUgYWFTb3J0aW5nIGFycmF5CgkJCSAqLwoJCQlmb3IgKCBpPTAsIGlMZW49b1NldHRpbmdzLmFhU29ydGluZy5sZW5ndGggOyBpPGlMZW4gOyBpKysgKQoJCQl7CgkJCQlpZiAoIG9TZXR0aW5ncy5hYVNvcnRpbmdbaV1bMF0gPj0gb1NldHRpbmdzLmFvQ29sdW1ucy5sZW5ndGggKQoJCQkJewoJCQkJCW9TZXR0aW5ncy5hYVNvcnRpbmdbaV1bMF0gPSAwOwoJCQkJfQoJCQkJdmFyIG9Db2x1bW4gPSBvU2V0dGluZ3MuYW9Db2x1bW5zWyBvU2V0dGluZ3MuYWFTb3J0aW5nW2ldWzBdIF07CgkJCQkKCQkJCS8qIEFkZCBhIGRlZmF1bHQgc29ydGluZyBpbmRleCAqLwoJCQkJaWYgKCB0eXBlb2Ygb1NldHRpbmdzLmFhU29ydGluZ1tpXVsyXSA9PSAndW5kZWZpbmVkJyApCgkJCQl7CgkJCQkJb1NldHRpbmdzLmFhU29ydGluZ1tpXVsyXSA9IDA7CgkJCQl9CgkJCQkKCQkJCS8qIElmIGFhU29ydGluZyBpcyBub3QgZGVmaW5lZCwgdGhlbiB3ZSB1c2UgdGhlIGZpcnN0IGluZGljYXRvciBpbiBhc1NvcnRpbmcgKi8KCQkJCWlmICggdHlwZW9mIG9Jbml0LmFhU29ydGluZyA9PSAidW5kZWZpbmVkIiAmJiAKCQkJCQkJIHR5cGVvZiBvU2V0dGluZ3Muc2F2ZWRfYWFTb3J0aW5nID09ICJ1bmRlZmluZWQiICkKCQkJCXsKCQkJCQlvU2V0dGluZ3MuYWFTb3J0aW5nW2ldWzFdID0gb0NvbHVtbi5hc1NvcnRpbmdbMF07CgkJCQl9CgkJCQkKCQkJCS8qIFNldCB0aGUgY3VycmVudCBzb3J0aW5nIGluZGV4IGJhc2VkIG9uIGFvQ29sdW1ucy5hc1NvcnRpbmcgKi8KCQkJCWZvciAoIGo9MCwgakxlbj1vQ29sdW1uLmFzU29ydGluZy5sZW5ndGggOyBqPGpMZW4gOyBqKysgKQoJCQkJewoJCQkJCWlmICggb1NldHRpbmdzLmFhU29ydGluZ1tpXVsxXSA9PSBvQ29sdW1uLmFzU29ydGluZ1tqXSApCgkJCQkJewoJCQkJCQlvU2V0dGluZ3MuYWFTb3J0aW5nW2ldWzJdID0gajsKCQkJCQkJYnJlYWs7CgkJCQkJfQoJCQkJfQoJCQl9CgkJCQkKCQkJLyogRG8gYSBmaXJzdCBwYXNzIG9uIHRoZSBzb3J0aW5nIGNsYXNzZXMgKGFsbG93cyBhbnkgc2l6ZSBjaGFuZ2VzIHRvIGJlIHRha2VuIGludG8KCQkJICogYWNjb3VudCwgYW5kIGFsc28gd2lsbCBhcHBseSBzb3J0aW5nIGRpc2FibGVkIGNsYXNzZXMgaWYgZGlzYWJsZWQKCQkJICovCgkJCV9mblNvcnRpbmdDbGFzc2VzKCBvU2V0dGluZ3MgKTsKCQkJCgkJCS8qCgkJCSAqIEZpbmFsIGluaXQKCQkJICogU2FuaXR5IGNoZWNrIHRoYXQgdGhlcmUgaXMgYSB0aGVhZCBhbmQgdGJvZHkuIElmIG5vdCBsZXQncyBqdXN0IGNyZWF0ZSB0aGVtCgkJCSAqLwoJCQlpZiAoIHRoaXMuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ3RoZWFkJykubGVuZ3RoID09PSAwICkKCQkJewoJCQkJdGhpcy5hcHBlbmRDaGlsZCggZG9jdW1lbnQuY3JlYXRlRWxlbWVudCggJ3RoZWFkJyApICk7CgkJCX0KCQkJCgkJCWlmICggdGhpcy5nZXRFbGVtZW50c0J5VGFnTmFtZSgndGJvZHknKS5sZW5ndGggPT09IDAgKQoJCQl7CgkJCQl0aGlzLmFwcGVuZENoaWxkKCBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCAndGJvZHknICkgKTsKCQkJfQoJCQkKCQkJb1NldHRpbmdzLm5USGVhZCA9IHRoaXMuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ3RoZWFkJylbMF07CgkJCW9TZXR0aW5ncy5uVEJvZHkgPSB0aGlzLmdldEVsZW1lbnRzQnlUYWdOYW1lKCd0Ym9keScpWzBdOwoJCQlpZiAoIHRoaXMuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ3Rmb290JykubGVuZ3RoID4gMCApCgkJCXsKCQkJCW9TZXR0aW5ncy5uVEZvb3QgPSB0aGlzLmdldEVsZW1lbnRzQnlUYWdOYW1lKCd0Zm9vdCcpWzBdOwoJCQl9CgkJCQoJCQkvKiBDaGVjayBpZiB0aGVyZSBpcyBkYXRhIHBhc3NpbmcgaW50byB0aGUgY29uc3RydWN0b3IgKi8KCQkJaWYgKCBiVXNlUGFzc2VkRGF0YSApCgkJCXsKCQkJCWZvciAoIGk9MCA7IGk8b0luaXQuYWFEYXRhLmxlbmd0aCA7IGkrKyApCgkJCQl7CgkJCQkJX2ZuQWRkRGF0YSggb1NldHRpbmdzLCBvSW5pdC5hYURhdGFbIGkgXSApOwoJCQkJfQoJCQl9CgkJCWVsc2UKCQkJewoJCQkJLyogR3JhYiB0aGUgZGF0YSBmcm9tIHRoZSBwYWdlICovCgkJCQlfZm5HYXRoZXJEYXRhKCBvU2V0dGluZ3MgKTsKCQkJfQoJCQkKCQkJLyogQ29weSB0aGUgZGF0YSBpbmRleCBhcnJheSAqLwoJCQlvU2V0dGluZ3MuYWlEaXNwbGF5ID0gb1NldHRpbmdzLmFpRGlzcGxheU1hc3Rlci5zbGljZSgpOwoJCQkKCQkJLyogSW5pdGlhbGlzYXRpb24gY29tcGxldGUgLSB0YWJsZSBjYW4gYmUgZHJhd24gKi8KCQkJb1NldHRpbmdzLmJJbml0aWFsaXNlZCA9IHRydWU7CgkJCQoJCQkvKiBDaGVjayBpZiB3ZSBuZWVkIHRvIGluaXRpYWxpc2UgdGhlIHRhYmxlIChpdCBtaWdodCBub3QgaGF2ZSBiZWVuIGhhbmRlZCBvZmYgdG8gdGhlCgkJCSAqIGxhbmd1YWdlIHByb2Nlc3NvcikKCQkJICovCgkJCWlmICggYkluaXRIYW5kZWRPZmYgPT09IGZhbHNlICkKCQkJewoJCQkJX2ZuSW5pdGFsaXNlKCBvU2V0dGluZ3MgKTsKCQkJfQoJCX0pOwoJfTsKfSkoalF1ZXJ5LCB3aW5kb3csIGRvY3VtZW50KTsK]]></Resource>
	</Resources>
	<SourceCode>
		<![CDATA[
import json

# changed: extension '.vdom' removed after '(target)s' in html_table - will be added in render() in target-variable
html_table=u"""<div style='%(show)s'>
<form method='%(method)s' action=\"/%(target)s\" name='%(id)s'>
<table id='%(id)s' >
<thead><tr> 
%(cap)s 
</tr></thead>
</table> 
<input type='hidden' value='' name='cmd'>
%(user_hidden_fields)s
</form>
</div>"""

hidden_field_text=u"<input type='hidden' value='%(value)s' name='%(name)s'>"

js_multiselect=u"""
	$.each(m, function(i, e){
		e.unshift('<input type="checkbox" name="checkbox_field_'+i+'">');
		datatables_%(id)s.fnAddData(e);
	});
	
	$('#%(id)s tr td input[name^=checkbox_field]').click( function() {
		var aReturn=[]
		if ( $(this).parent().parent().hasClass('row_selected') ){
			$(this).parent().parent().removeClass('row_selected');
			$(this).attr('checked', false);}
		else
			{$(this).parent().parent().addClass('row_selected');
			$(this).attr('checked', true);}
		var id='%(id)s';
		var aTrs =datatables_%(id)s.fnGetNodes();
		for ( var i=0 ; i<aTrs.length ; i++ ) { 
			jQuery(aTrs[i]).find('td:first  input:checked').each(function()
			{
			var aData = datatables_%(id)s.fnGetData(aTrs[i]);
			var data=aData[%(countt)s];
			aReturn.push(data);
			})  
				} 
		execEventBinded(id.substring(2, id.length), "selectedrows", {ID_list:aReturn});
	} );
	"""


js_rowselect=u"""
	$.each(m, function(i, e){
		datatables_%(id)s.fnAddData(e);
	});
	$('#%(id)s tr').click( function() {
		if ( $(this).hasClass('row_selected') ){
			$(this).removeClass('row_selected');}
		else
			{$(this).parent().find('tr').each( function(){
				if ( $(this).hasClass('row_selected') ){
					$(this).removeClass('row_selected');}
				});
			$(this).addClass('row_selected');}
	} ); 
	"""

cap_row=u"<th name='%(name)s'>%(show_name)s</th>"
cap_visible=u"[%(list)s]"
unvis_cap=u"{'bVisible': false }"
css_class=u"""<style type="text/css">
			.dataTables_wrapper_%(id)s table { width: 99.9%%!important; %(table_css)s}
			.dataTables_wrapper_%(id)s table td{%(table_td_css)s}
			.dataTables_wrapper_%(id)s table th{%(table_th_css)s}
			.dataTables_wrapper_%(id)s tr.row_selected td {%(selected)s}
			.dataTables_wrapper_%(id)s{
						left:%(wrapper_left)s;
						top:%(wrapper_top)s;}
			.dataTables_filter_%(id)s{%(css_filter)s}
			.dataTables_info_%(id)s{%(css_info)s}
			.dataTables_length_%(id)s{%(css_length)s}
			</style>
			"""

js_code=u"""<script type='text/javascript'>
jQuery(document).ready(function($){
$.fn.dataTableExt.oStdClasses.sStripOdd ="odd %(odd_css)s";
$.fn.dataTableExt.oStdClasses.sStripEven ="even %(even_css)s";
$.fn.dataTableExt.oStdClasses.sWrapper = "dataTables_wrapper_%(id)s";
$.fn.dataTableExt.oStdClasses.sInfo= "dataTables_info_%(id)s %(info_css)s";
$.fn.dataTableExt.oStdClasses.sFilter= "dataTables_filter_%(id)s %(search_css)s";
$.fn.dataTableExt.oStdClasses.sLength= "dataTables_length_%(id)s  %(length_css)s";
	datatables_%(id)s=$('#%(id)s').dataTable({
		"oLanguage": {
			"sLengthMenu": "%(lengthtext)s",
			"sZeroRecords": "%(zerorecords)s",
			"sInfo": "%(infotext)s",
			"sInfoEmpty": "%(infoempty)s",
			"sInfoFiltered": "%(infofiltred)s"
		},
		"oSearch": {"sSearch": "", "bSmart": true},
		"aoColumns": %(info)s,
		"bPaginate": false,
		"fnRowCallback": function( nRow, aData, iDisplayIndex ) {
			$('td', nRow).each(function(idx,el){
				$(el).addClass('cell-'+idx);
			});
			$('td:first', nRow).addClass('cell-first');
			$('td:last', nRow).addClass('cell-last');
			$(nRow).click( function () { 
				var aPos =datatables_%(id)s.fnGetPosition(this); 
				var data= aData[%(countt)s];
				var id='%(id)s'; 
				/*singleselect*/
				
				/*execEventBinded(id.substring(2, id.length), "rowclick", {ID:data});
				multiselect*/
				%(selected_rows)s
			});
			return nRow;
		}
		});
		
	var m = %(massiv)s;
	
	/*multiselect*/
	%(js_selection)s
	
	});
	function %(id)s_fnGetSelected(){
		var aReturn = new Array(); 
		var aTrs =datatables_%(id)s.fnGetNodes(); 
		for ( var i=0 ; i<aTrs.length ; i++ ) { 
			if ( jQuery(aTrs[i]).hasClass("row_selected") ) 
				{	var aData = datatables_%(id)s.fnGetData(aTrs[i]);
					var data=aData[%(countt)s];
					aReturn.push(data); }
				} 
		return aReturn;
		}
		
	function %(id)s_createEvent(id_list, button_command){
		var id='%(id)s';
		execEventBinded(id.substring(2, id.length), "process_requested", {ID_list:id_list,cmd:button_command});
		}
</script>"""

class VDOM_datatables(VDOM_object):
	
	def render(self, parent, contents=""):
		id = 'o_' + (self.id).replace('-', '_')
		result=u''
		
		# css for filter
		if self.showsearch=="0":
			css_filter=u"width:200px; height:25px; visibility:inherit; overflow:hidden;"
		else:
			css_filter=u"display:none"
		
		if self.showinformation=="0":
			css_info=u"overflow:hidden; width:155px; height:25px;visibility:inherit;"
		else:
			css_info=u"display:none"
		
		if self.showlength=="0":
			css_length=u"overflow:hidden; width:140px; height:25px;visibility:inherit; float:right;"
		else:
			css_length=u"display:none"

		result+=css_class%{"wrapper_left":self.left+"px", "wrapper_top":self.top+"px", "wrapper_width":self.width+"px", "id":id, "css_filter":css_filter, "css_info":css_info, "css_length":css_length,  "selected":(self.selected_css).strip(), "table_css":self.table_css, "table_td_css":self.table_td_css, "table_th_css":self.table_th_css}
		
		if self.visible == "0":
			show = u"overflow:auto;height:%(height)spx;position:absolute;left:%(left)spx;clear:both;top:%(top)spx;width:%(width)spx" %{"top":self.top, "left":self.left, "height":self.height, "width":self.width}
		else:
			show = u"display:none;"
		
		if self.target == '':
			target = u''
		else:
			# target = '/'+self.target+'.vdom'	# obsolete - page_guid.vdom
			target = '/'+request.application().search_object(self.target).name+'.vdom'
		
		#table header creation
		
		#parsing argument
		table_header = None
		if self.tableheader=="":
			self.tableheader="[]"
		try:
			table_header=json.loads(self.tableheader)
		except:
			raise Exception ("table header error", "Type of Tableheader parametr should be 'list'")
		if not isinstance(table_header, list):
			table_header=[]

		#getting keys
		datatable_keys = [column["Key"] for column in table_header]

		#checking keys
		if "checkbox_field" in datatable_keys:
			raise Exception ("key error", "Inside tableheader shouldn't be 'Keys':'checkbox_field'")

		#multiselect - add checkboxes
		if self.multiselect=="1":
			table_header.insert(0, {"Key":"checkbox_field", "Display_text":" ", "Visibility":"0"})
			datatable_keys.insert(0, "checkbox_field")
		
		
		#generating html for header
		datatable_header = "".join( [cap_row%{"name": column["Key"], "show_name": column["Display_text"]} for column in table_header ])
		
		#generating json for column attributes
		datatable_aoColumns = json.dumps( [ unvis_cap if column["Visibility"] == "1" else None for column in table_header ] )
		
		#find key position
		if len(datatable_keys)>1 and self.tablekey!="":
			datatable_key_position = datatable_keys.index( self.tablekey ) 
		else:
			datatable_key_position=0
		
		#table data
		
		#parsing argument htmlcode
		table_data = None
		if self.htmlcode=="":
			self.htmlcode="[]"
		try:
			table_data=json.loads(self.htmlcode)
		except:
			raise Exception ("table data error", "Type of Tabledata parametr should be 'list'")
		if not isinstance(table_data, list):
			table_data=[]
		
		#genering json for column data 
		
		rows_data=[]
		rows_data = [[row[column["Key"]] if column["Key"] in row else "" for column in table_header if column[ "Key" ] != "checkbox_field"] for row in table_data]
		
		#hidden fields
		
		#parsing argument hiddenfields
		hidden_fileds = None
		if self.hiddenfields=="":
			self.hiddenfields="{}"
		try:
			hidden_fileds=json.loads(self.hiddenfields)
		except:
			raise Exception ("table hiddenfields error", "Type of Hidden fields parametr should be 'dict'")
		if not isinstance(hidden_fileds, dict):
			hidden_fileds={}
		
		#generating html for hiddenfields
		datatable_hiddenfileds = "".join( [hidden_field_text%{"value":hidden_fileds[field], "name":field} for field in hidden_fileds if field!="cmd"])
		
		
		# result+=html_table%{"method":self.method, "show":show, "id":id, "cap":datatable_header , "target":self.target, "user_hidden_fields":datatable_hiddenfileds, "table_width":str(int(self.width)-15)}
		result+=html_table%{"method":self.method, "show":show, "id":id, "cap":datatable_header , "target":target, "user_hidden_fields":datatable_hiddenfileds, "table_width":str(int(self.width)-15)}
		
		
		if self.multiselect=="1":
			js_m=js_multiselect%{"id":id, "countt":datatable_key_position}
			single=u""
		else:
			js_m=js_rowselect%{"id":id}
			
			single=u"""
				execEventBinded(id.substring(2, id.length), "selectedrows", {ID_list:data}); """
		
		
		result+=js_code%{"id":id, "massiv":json.dumps(rows_data), "info":datatable_aoColumns.replace('"', ""), "lengthtext":self.lengthtext, "zerorecords":self.zerorecords, "infotext":self.information, "infoempty":self.infoempty, "infofiltred":self.infofiltred, "countt":datatable_key_position, "odd_css":(self.odd_css).strip(), "even_css":(self.even_css).strip(), "js_selection":js_m, "search_css":(self.search_css).strip(), "info_css":(self.info_css).strip(), "length_css":(self.length_css).strip(), "selected_rows":single}

		return VDOM_object.render(self, parent, contents=result)

	def wysiwyg(self, parent, contents=""):

		result="<container id=\"%s\" zindex=\"%s\" hierarchy=\"%s\" order=\"%s\" top=\"%s\" left=\"%s\" width=\"%s\" height=\"%s\">"\
					"<svg>"\
						"<rect x=\"%s\" y=\"%s\" width=\"%s\" height=\"%s\" fill=\"#EFEFEF\" fill-opacity=\".5\" />"\
					"</svg>%s"\
				"</container>"%(
					self.id, self.zindex, self.hierarchy, self.order, self.top, self.left, self.width, self.height,
					0, 0, self.width, self.height,
					contents)

		return VDOM_object.wysiwyg(self, parent, contents=result)

		]]>
	</SourceCode>
	<Libraries>
		<Library Target="HTML"><![CDATA[<script language='javascript' type='text/javascript' src='/b53f403c-efe7-4fa7-bff3-35e71027f393.res'></script>]]></Library>
		<Library Target="HTML"><![CDATA[<script language='javascript' type='text/javascript' src='/b53f403c-efe7-4fa7-bff3-35e71027f393.res'></script>]]></Library>
	</Libraries>
	<E2vdom>
		<Events>
			<Userinterfaceevents>
				<Event Name="mousemove">
					<Parameters>
						<Parameter Help="#Lang(105)" Name="X" Order="" VbType=""/>
						<Parameter Help="#Lang(104)" Name="Y" Order="" VbType=""/>
					</Parameters>
				</Event>
				<Event Name="mousedown">
					<Parameters>
						<Parameter Help="#Lang(105)" Name="X" Order="" VbType=""/>
						<Parameter Help="#Lang(104)" Name="Y" Order="" VbType=""/>
					</Parameters>
				</Event>
				<Event Name="mouseup">
					<Parameters>
						<Parameter Help="#Lang(105)" Name="X" Order="" VbType=""/>
						<Parameter Help="#Lang(104)" Name="Y" Order="" VbType=""/>
					</Parameters>
				</Event>
				<Event Name="mouseover">
					<Parameters>
						<Parameter Help="#Lang(105)" Name="X" Order="" VbType=""/>
						<Parameter Help="#Lang(104)" Name="Y" Order="" VbType=""/>
					</Parameters>
				</Event>
				<Event Name="mouseout">
					<Parameters>
						<Parameter Help="#Lang(745)" Name="X" Order="" VbType=""/>
						<Parameter Help="#Lang(745)" Name="Y" Order="" VbType=""/>
					</Parameters>
				</Event>
				<Event Name="click">
					<Parameters>
						<Parameter Help="#Lang(105)" Name="X" Order="" VbType=""/>
						<Parameter Help="#Lang(104)" Name="Y" Order="" VbType=""/>
					</Parameters>
				</Event>
				<Event Name="dblclick">
					<Parameters>
						<Parameter Help="#Lang(105)" Name="X" Order="" VbType=""/>
						<Parameter Help="#Lang(104)" Name="Y" Order="" VbType=""/>
					</Parameters>
				</Event>
				<Event Name="ctrlclick">
					<Parameters>
						<Parameter Help="#Lang(105)" Name="X" Order="" VbType=""/>
						<Parameter Help="#Lang(104)" Name="Y" Order="" VbType=""/>
					</Parameters>
				</Event>
				<Event Name="rowclick">
					<Parameters>
						<Parameter Help="#Lang(124)" Name="ID" Order="" VbType=""/>
					</Parameters>
				</Event>
				<Event Name="selectedrows">
					<Parameters>
						<Parameter Help="#Lang(124)" Name="ID_list" Order="" VbType=""/>
					</Parameters>
				</Event>
				<Event Name="process_requested">
					<Parameters>
						<Parameter Help="#Lang(124)" Name="ID_list" Order="" VbType=""/>
						<Parameter Help="#Lang(124)" Name="cmd" Order="" VbType=""/>
					</Parameters>
				</Event>
				<Event Name="submit">
					<Parameters>
						<Parameter Help="#Lang(105)" Name="params" Order="" VbType=""/>
					</Parameters>
				</Event>
			</Userinterfaceevents>
		</Events>
		<Actions>
			<Container ID="2330fe83-8cd6-4ed5-907d-11874e7ebcf4">
				<Action Description="#Lang(102)" InterfaceName="#Lang(102)" MethodName="hide">
					<Parameters>
						<Parameter DefaultValue="0" Help="#Lang(202)" Interface="" InterfaceName="#Lang(202)" RegularExpressionValidation=".*" ScriptName="fade"/>
					</Parameters>
					<Sourcecode><![CDATA[
jQuery(this.domCont).hide(fade);
					]]></Sourcecode>
				</Action>
				<Action Description="#Lang(102)" InterfaceName="#Lang(102)" MethodName="show">
					<Parameters>
						<Parameter DefaultValue="0" Help="#Lang(202)" Interface="" InterfaceName="#Lang(202)" RegularExpressionValidation=".*" ScriptName="fade"/>
					</Parameters>
					<Sourcecode><![CDATA[
jQuery(this.domCont).show(fade);
					]]></Sourcecode>
				</Action>
				<Action Description="#Lang(102)" InterfaceName="#Lang(102)" MethodName="resizeTo">
					<Parameters>
						<Parameter DefaultValue="0" Help="#Lang(202)" Interface="" InterfaceName="#Lang(202)" RegularExpressionValidation=".*" ScriptName="width"/>
						<Parameter DefaultValue="0" Help="#Lang(202)" Interface="" InterfaceName="#Lang(202)" RegularExpressionValidation=".*" ScriptName="height"/>
					</Parameters>
					<Sourcecode><![CDATA[
this.domCont.style.width = parseInt(newZindex);
this.domCont.style.height = parseInt(newZindex);
					]]></Sourcecode>
				</Action>
				 <Action Description="#Lang(102)" InterfaceName="#Lang(102)" MethodName="loadData">
					<Parameters>
						<Parameter DefaultValue="" Help="#Lang(202)" Interface="" InterfaceName="#Lang(202)" RegularExpressionValidation=".*" ScriptName="jsondata"/>
					</Parameters>
					<Sourcecode><![CDATA[
jQuery.plot(jQuery(this.domCont),jsondata,eval("opt_"+this.domCont.id));
					]]></Sourcecode>
				</Action>
				<Action Description="#Lang(102)" InterfaceName="#Lang(102)" MethodName="addTableDatarow">
					<Parameters>
						<Parameter DefaultValue="" Help="#Lang(202)" Interface="" InterfaceName="#Lang(202)" RegularExpressionValidation=".*" ScriptName="jsondata"/>
					</Parameters>
					<Sourcecode><![CDATA[
eval('datatables_'+this.domCont.id+'.fnAddData( jsondata );');
					]]></Sourcecode>
				</Action>
				<Action Description="#Lang(102)" InterfaceName="#Lang(102)" MethodName="process_selected">
					<Parameters>
						<Parameter DefaultValue="" Help="#Lang(202)" Interface="" InterfaceName="#Lang(202)" RegularExpressionValidation=".*" ScriptName="cmd"/>
					</Parameters>
					<Sourcecode><![CDATA[
var t = this.domCont;
eval('var x='+t.id+'_fnGetSelected();');
eval(t.id+'_createEvent(x, cmd)');
					]]></Sourcecode>
				</Action>
				<Action Description="#Lang(102)" InterfaceName="#Lang(102)" MethodName="submit">
					<Parameters>
						<Parameter DefaultValue="" Help="#Lang(202)" Interface="" InterfaceName="#Lang(202)" RegularExpressionValidation=".*" ScriptName="cmd"/>
					</Parameters>
					<Sourcecode><![CDATA[
/*
$("form[name="+this.domCont.id+"] input[name=cmd]").val(cmd);
$("form[name="+this.domCont.id+"]").submit();
*/
var id=this.domCont.id, f=$("form[name="+id+"]");
$("input[name=cmd]",f).val(cmd);
if(f.attr('method')=='event'){
	f.submit(function(){
		var x=[], a=f.serializeArray();
		for (k in a) if(typeof a[k].name !== 'undefined' && typeof a[k].value !== 'undefined') x[a[k].name]=a[k].value;
		execEventBinded(id.substring(2, id.length), "submit", x);
		return false;
	});
}
f.submit();
					]]></Sourcecode>
				</Action>
			</Container>
		</Actions>
	</E2vdom>
</Type>