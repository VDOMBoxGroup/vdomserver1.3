<?xml version="1.0" encoding="utf-8"?><Type>
  <Information>
    <Name>fullcalendar</Name>
    <DisplayName>#Lang(001)</DisplayName>
    <Description>#Lang(002)</Description>
    <ClassName>VDOM_fullcalendar</ClassName>
    <ID>036a5b8f-483f-48ca-fe57-6b767d76173f</ID>
    <Icon>#Res(31e094d1-d1ac-40d9-a3e3-980c6046fe0c)</Icon>
    <EditorIcon>#Res(9fb2658d-748f-4115-87da-7c52aca00ab5)</EditorIcon>
    <StructureIcon>#Res(2a475c2a-decc-4da1-a38a-15b55f87df85)</StructureIcon>
    <Moveable>1</Moveable>
    <Resizable>3</Resizable>
    <Container>1</Container>
    <Category>Usual</Category>
    <Dynamic>1</Dynamic>
    <Version>1.250.0</Version>
    <InterfaceType>1</InterfaceType>
    <OptimizationPriority>1</OptimizationPriority>
    <Containers>htmlcontainer,dialog,container,tablecell</Containers>
    <Languages>en_US ,ru_RU ,fr_FR</Languages>
    <Handlers>set_attr</Handlers>
    <RemoteMethods>
		</RemoteMethods>
    <WCAG>
		</WCAG>
    <XMLScriptName>
		</XMLScriptName>
  </Information>
  <Attributes>
    <Attribute>
      <Name>hierarchy</Name>
      <DisplayName>#Lang(101)</DisplayName>
      <DefaultValue>0</DefaultValue>
      <Visible>1</Visible>
      <Help>#Lang(201)</Help>
      <InterfaceType>0</InterfaceType>
      <CodeInterface>TextField(2)</CodeInterface>
      <Colorgroup>1</Colorgroup>
      <ErrorValidationMessage>#Lang(301)</ErrorValidationMessage>
      <RegularExpressionValidation>^\d{1,2}$</RegularExpressionValidation>
    </Attribute>
    <Attribute>
      <Name>visible</Name>
      <DisplayName>#Lang(102)</DisplayName>
      <DefaultValue>1</DefaultValue>
      <Visible>1</Visible>
      <Help>#Lang(202)</Help>
      <InterfaceType>0</InterfaceType>
      <CodeInterface>DropDown((#Lang(401)|0)|(#Lang(402)|1))</CodeInterface>
      <Colorgroup>1</Colorgroup>
      <ErrorValidationMessage>#Lang(302)</ErrorValidationMessage>
      <RegularExpressionValidation>^[01]$</RegularExpressionValidation>
    </Attribute>
    <Attribute>
      <Name>zindex</Name>
      <DisplayName>#Lang(103)</DisplayName>
      <DefaultValue>1</DefaultValue>
      <Visible>1</Visible>
      <Help>#Lang(203)</Help>
      <InterfaceType>0</InterfaceType>
      <CodeInterface>TextField(2)</CodeInterface>
      <Colorgroup>1</Colorgroup>
      <ErrorValidationMessage>#Lang(303)</ErrorValidationMessage>
      <RegularExpressionValidation>^\d{1,2}$</RegularExpressionValidation>
    </Attribute>
    <Attribute>
      <Name>top</Name>
      <DisplayName>#Lang(104)</DisplayName>
      <DefaultValue>0</DefaultValue>
      <Visible>1</Visible>
      <Help>#Lang(204)</Help>
      <InterfaceType>0</InterfaceType>
      <CodeInterface>TextField(4)</CodeInterface>
      <Colorgroup>1</Colorgroup>
      <ErrorValidationMessage>#Lang(304)</ErrorValidationMessage>
      <RegularExpressionValidation>^\d{1,4}$</RegularExpressionValidation>
    </Attribute>
    <Attribute>
      <Name>left</Name>
      <DisplayName>#Lang(105)</DisplayName>
      <DefaultValue>0</DefaultValue>
      <Visible>1</Visible>
      <Help>#Lang(205)</Help>
      <InterfaceType>0</InterfaceType>
      <CodeInterface>TextField(4)</CodeInterface>
      <Colorgroup>1</Colorgroup>
      <ErrorValidationMessage>#Lang(305)</ErrorValidationMessage>
      <RegularExpressionValidation>^\d{1,4}$</RegularExpressionValidation>
    </Attribute>
    <Attribute>
      <Name>width</Name>
      <DisplayName>#Lang(106)</DisplayName>
      <DefaultValue>140</DefaultValue>
      <Visible>1</Visible>
      <Help>#Lang(206)</Help>
      <InterfaceType>0</InterfaceType>
      <CodeInterface>TextField(4)</CodeInterface>
      <Colorgroup>1</Colorgroup>
      <ErrorValidationMessage>#Lang(306)</ErrorValidationMessage>
      <RegularExpressionValidation>^\d{1,4}$</RegularExpressionValidation>
    </Attribute>
    <Attribute>
      <Name>height</Name>
      <DisplayName>#Lang(107)</DisplayName>
      <DefaultValue>120</DefaultValue>
      <Visible>1</Visible>
      <Help>#Lang(207)</Help>
      <InterfaceType>0</InterfaceType>
      <CodeInterface>TextField(4)</CodeInterface>
      <Colorgroup>1</Colorgroup>
      <ErrorValidationMessage>#Lang(307)</ErrorValidationMessage>
      <RegularExpressionValidation>^\d{1,4}$</RegularExpressionValidation>
    </Attribute>
    <Attribute>
      <Name>events</Name>
      <DisplayName>#Lang(108)</DisplayName>
      <DefaultValue>
			</DefaultValue>
      <Visible>1</Visible>
      <Help>#Lang(208)</Help>
      <InterfaceType>0</InterfaceType>
      <CodeInterface>Multiline(300)</CodeInterface>
      <Colorgroup>4</Colorgroup>
      <ErrorValidationMessage>#Lang(308)</ErrorValidationMessage>
      <RegularExpressionValidation>.*</RegularExpressionValidation>
    </Attribute>
    <Attribute>
      <Name>view</Name>
      <DisplayName>#Lang(109)</DisplayName>
      <DefaultValue>week</DefaultValue>
      <Visible>1</Visible>
      <Help>#Lang(209)</Help>
      <InterfaceType>0</InterfaceType>
      <CodeInterface>DropDown((#Lang(403)|month)|(#Lang(404)|week)|(#Lang(405)|day))</CodeInterface>
      <Colorgroup>4</Colorgroup>
      <ErrorValidationMessage>#Lang(309)</ErrorValidationMessage>
      <RegularExpressionValidation>^.*$</RegularExpressionValidation>
    </Attribute>
    <Attribute>
      <Name>displayDate</Name>
      <DisplayName>#Lang(111)</DisplayName>
      <DefaultValue>2010-01-01</DefaultValue>
      <Visible>1</Visible>
      <Help>#Lang(211)</Help>
      <InterfaceType>0</InterfaceType>
      <CodeInterface>TextField(15)</CodeInterface>
      <Colorgroup>4</Colorgroup>
      <ErrorValidationMessage>#Lang(311)</ErrorValidationMessage>
      <RegularExpressionValidation>\d{4}-(1[0-2])|(0?[0-9])-([0-2]\d)|(0?\d)</RegularExpressionValidation>
    </Attribute>
    <Attribute>
      <Name>firstDay</Name>
      <DisplayName>#Lang(112)</DisplayName>
      <DefaultValue>0</DefaultValue>
      <Visible>1</Visible>
      <Help>#Lang(212)</Help>
      <InterfaceType>0</InterfaceType>
      <CodeInterface>TextField(1)</CodeInterface>
      <Colorgroup>4</Colorgroup>
      <ErrorValidationMessage>#Lang(312)</ErrorValidationMessage>
      <RegularExpressionValidation>[0,6]</RegularExpressionValidation>
    </Attribute>
    <Attribute>
      <Name>timeFormat</Name>
      <DisplayName>#Lang(113)</DisplayName>
      <DefaultValue>24</DefaultValue>
      <Visible>1</Visible>
      <Help>#Lang(213)</Help>
      <InterfaceType>0</InterfaceType>
      <CodeInterface>TextField(2)</CodeInterface>
      <Colorgroup>2</Colorgroup>
      <ErrorValidationMessage>#Lang(313)</ErrorValidationMessage>
      <RegularExpressionValidation>[24,12]</RegularExpressionValidation>
    </Attribute>
  </Attributes>
  <Languages>
    <Language Code="en_US">
      <Sentence ID="001">Full calendar</Sentence>
      <Sentence ID="002">Full calendar</Sentence>
      <Sentence ID="003">
			</Sentence>
      <Sentence ID="501">Visibility</Sentence>
      <Sentence ID="601">Visibility</Sentence>
      <Sentence ID="701">Incorrect value</Sentence>
      <Sentence ID="801">Incorrect value</Sentence>
      <Sentence ID="502">Visibility</Sentence>
      <Sentence ID="602">Visibility</Sentence>
      <Sentence ID="702">Incorrect value</Sentence>
      <Sentence ID="802">Incorrect value</Sentence>
      <Sentence ID="703">Incorrect value</Sentence>
      <Sentence ID="803">Incorrect value</Sentence>
      <Sentence ID="704">Incorrect value</Sentence>
      <Sentence ID="804">Incorrect value</Sentence>
      <Sentence ID="503">Visibility</Sentence>
      <Sentence ID="603">Visibility</Sentence>
      <Sentence ID="705">Incorrect value</Sentence>
      <Sentence ID="805">Incorrect value</Sentence>
      <Sentence ID="504">Next</Sentence>
      <Sentence ID="604">Next</Sentence>
      <Sentence ID="505">Previous</Sentence>
      <Sentence ID="605">Previous</Sentence>
      <Sentence ID="506">Visibility</Sentence>
      <Sentence ID="606">Visibility</Sentence>
      <Sentence ID="706">Incorrect value</Sentence>
      <Sentence ID="806">Incorrect value</Sentence>
      <Sentence ID="101">Hierarchy</Sentence>
      <Sentence ID="201">Hierarchy of object</Sentence>
      <Sentence ID="301">Incorrect value, must be positive integer</Sentence>
      <Sentence ID="102">Visibility</Sentence>
      <Sentence ID="202">Show or not object</Sentence>
      <Sentence ID="302">Incorrect value</Sentence>
      <Sentence ID="401">Invisible</Sentence>
      <Sentence ID="402">Visible</Sentence>
      <Sentence ID="103">Z-Index</Sentence>
      <Sentence ID="203">Position in visual hierarchy of objects</Sentence>
      <Sentence ID="303">Incorrect value, must be integer from 0 to 99</Sentence>
      <Sentence ID="104">Top</Sentence>
      <Sentence ID="204">Distance from the top edge of the parent object in pixels</Sentence>
      <Sentence ID="304">Incorrect value, must be positive integer</Sentence>
      <Sentence ID="105">Left</Sentence>
      <Sentence ID="205">Distance from the left edge of the parent object in pixels</Sentence>
      <Sentence ID="305">Incorrect value, must be positive integer</Sentence>
      <Sentence ID="106">Width</Sentence>
      <Sentence ID="206">Weight of the object in pixels</Sentence>
      <Sentence ID="306">Incorrect value, must be positive integer</Sentence>
      <Sentence ID="107">Height</Sentence>
      <Sentence ID="207">Height of the object in pixels</Sentence>
      <Sentence ID="307">Incorrect value, must be positive integer</Sentence>
      <Sentence ID="108">Events</Sentence>
      <Sentence ID="208">Hierarchy of object</Sentence>
      <Sentence ID="308">Incorrect value, must be positive integer</Sentence>
      <Sentence ID="109">View</Sentence>
      <Sentence ID="209">Alignment of the text</Sentence>
      <Sentence ID="309">Incorrect value</Sentence>
      <Sentence ID="403">month</Sentence>
      <Sentence ID="404">week</Sentence>
      <Sentence ID="405">day</Sentence>
      <Sentence ID="111">displayDate</Sentence>
      <Sentence ID="211">Alignment of the text</Sentence>
      <Sentence ID="311">Incorrect value</Sentence>
      <Sentence ID="112">firstDay</Sentence>
      <Sentence ID="212">firstDay</Sentence>
      <Sentence ID="312">week day must belong interval (0, 6)</Sentence>
      <Sentence ID="113">timeFormat</Sentence>
      <Sentence ID="213">time format</Sentence>
      <Sentence ID="313">time format error</Sentence>
      <Sentence ID="901">Left</Sentence>
      <Sentence ID="902">Top</Sentence>
      <Sentence ID="903">Left</Sentence>
      <Sentence ID="904">Top</Sentence>
      <Sentence ID="905">day</Sentence>
      <Sentence ID="906">Left</Sentence>
      <Sentence ID="907">Top</Sentence>
      <Sentence ID="908">id</Sentence>
      <Sentence ID="909">id</Sentence>
      <Sentence ID="911">start</Sentence>
      <Sentence ID="912">end</Sentence>
      <Sentence ID="913">Left</Sentence>
      <Sentence ID="914">Top</Sentence>
      <Sentence ID="915">Left</Sentence>
      <Sentence ID="916">Top</Sentence>
      <Sentence ID="917">
			</Sentence>
      <Sentence ID="918">
			</Sentence>
      <Sentence ID="919">Left</Sentence>
      <Sentence ID="921">Top</Sentence>
      <Sentence ID="922">Left</Sentence>
      <Sentence ID="923">Top</Sentence>
      <Sentence ID="925">end</Sentence>
      <Sentence ID="926">start</Sentence>
	  <Sentence ID="980">instance</Sentence>
    </Language>
    <Language Code="ru_RU">
      <Sentence ID="001">Кнопка</Sentence>
      <Sentence ID="002">Кнопка в виде ссылки или изображения</Sentence>
      <Sentence ID="003">
			</Sentence>
      <Sentence ID="501">Отображение</Sentence>
      <Sentence ID="601">Отображение</Sentence>
      <Sentence ID="701">Неправильное значение</Sentence>
      <Sentence ID="801">Неправильное значение</Sentence>
      <Sentence ID="502">Отображение</Sentence>
      <Sentence ID="602">Отображение</Sentence>
      <Sentence ID="702">Неправильное значение</Sentence>
      <Sentence ID="802">Неправильное значение</Sentence>
      <Sentence ID="703">Неправильное значение</Sentence>
      <Sentence ID="803">Неправильное значение</Sentence>
      <Sentence ID="704">Неправильное значение</Sentence>
      <Sentence ID="804">Неправильное значение</Sentence>
      <Sentence ID="503">Отображение</Sentence>
      <Sentence ID="603">Отображение</Sentence>
      <Sentence ID="705">Неправильное значение</Sentence>
      <Sentence ID="805">Неправильное значение</Sentence>
      <Sentence ID="504">Вперед</Sentence>
      <Sentence ID="604">Вперед</Sentence>
      <Sentence ID="505">Назад</Sentence>
      <Sentence ID="605">Назад</Sentence>
      <Sentence ID="506">Отображение</Sentence>
      <Sentence ID="606">Отображение</Sentence>
      <Sentence ID="706">Неправильное значение</Sentence>
      <Sentence ID="806">Неправильное значение</Sentence>
      <Sentence ID="101">Иерархия</Sentence>
      <Sentence ID="201">Приоритет в потоке гипертекста</Sentence>
      <Sentence ID="301">Неправильное значение</Sentence>
      <Sentence ID="102">Отображение</Sentence>
      <Sentence ID="202">Отображается объект или нет</Sentence>
      <Sentence ID="302">Неправильное значение</Sentence>
      <Sentence ID="401">Не отображается</Sentence>
      <Sentence ID="402">Отображается</Sentence>
      <Sentence ID="103">Z-Индекс</Sentence>
      <Sentence ID="203">Положение в визуальной иерархии объектов</Sentence>
      <Sentence ID="303">Неправильное значение, должно быть целое число от 0 до 99</Sentence>
      <Sentence ID="104">Верх</Sentence>
      <Sentence ID="204">Расстояние от верхней границы родительского контейнера до объекта в пикселях</Sentence>
      <Sentence ID="304">Неправильное значение, должно быть целое положительное число</Sentence>
      <Sentence ID="105">Лево</Sentence>
      <Sentence ID="205">Расстояние от левой границы родительского контейнера до объекта в пикселях</Sentence>
      <Sentence ID="305">Неправильное значение, должно быть целое положительное число</Sentence>
      <Sentence ID="106">Ширина</Sentence>
      <Sentence ID="206">Ширина объекта в пикселях</Sentence>
      <Sentence ID="306">Неправильное значение, должно быть целое положительное число</Sentence>
      <Sentence ID="107">Высота</Sentence>
      <Sentence ID="207">Высота объекта в пикселях</Sentence>
      <Sentence ID="307">Неправильное значение, должно быть целое положительное число</Sentence>
      <Sentence ID="108">События</Sentence>
      <Sentence ID="208">Приоритет в потоке гипертекста</Sentence>
      <Sentence ID="308">Неправильное значение</Sentence>
      <Sentence ID="109">Вид</Sentence>
      <Sentence ID="209">Расположение текста</Sentence>
      <Sentence ID="309">Неправильное значение</Sentence>
      <Sentence ID="403">месяц</Sentence>
      <Sentence ID="404">неделя</Sentence>
      <Sentence ID="405">день</Sentence>
      <Sentence ID="111">Отображаемая дата</Sentence>
      <Sentence ID="211">Расположение текста</Sentence>
      <Sentence ID="311">Неправильное значение</Sentence>
      <Sentence ID="112">firstDay</Sentence>
      <Sentence ID="212">firstDay</Sentence>
      <Sentence ID="312">week day must belong interval (0, 6)</Sentence>
      <Sentence ID="113">
			</Sentence>
      <Sentence ID="213">
			</Sentence>
      <Sentence ID="313">
			</Sentence>
      <Sentence ID="901">Лево</Sentence>
      <Sentence ID="902">Верх</Sentence>
      <Sentence ID="903">Лево</Sentence>
      <Sentence ID="904">Верх</Sentence>
      <Sentence ID="905">
			</Sentence>
      <Sentence ID="906">Лево</Sentence>
      <Sentence ID="907">Верх</Sentence>
      <Sentence ID="908">
			</Sentence>
      <Sentence ID="909">
			</Sentence>
      <Sentence ID="911">
			</Sentence>
      <Sentence ID="912">
			</Sentence>
      <Sentence ID="913">Лево</Sentence>
      <Sentence ID="914">Верх</Sentence>
      <Sentence ID="915">Лево</Sentence>
      <Sentence ID="916">Верх</Sentence>
      <Sentence ID="917">
			</Sentence>
      <Sentence ID="918">
			</Sentence>
      <Sentence ID="919">Лево</Sentence>
      <Sentence ID="921">Верх</Sentence>
      <Sentence ID="922">Лево</Sentence>
      <Sentence ID="923">Верх</Sentence>
      <Sentence ID="925">
			</Sentence>
      <Sentence ID="926">
			</Sentence>
	  <Sentence ID="980">номер</Sentence>
    </Language>
    <Language Code="fr_FR">
      <Sentence ID="001">Bouton</Sentence>
      <Sentence ID="002">Lien sur une image</Sentence>
      <Sentence ID="003">
			</Sentence>
      <Sentence ID="501">Visibilite</Sentence>
      <Sentence ID="601">Visibilite</Sentence>
      <Sentence ID="701">Valeur Incorrecte</Sentence>
      <Sentence ID="801">Valeur Incorrecte</Sentence>
      <Sentence ID="502">Visibilite</Sentence>
      <Sentence ID="602">Visibilite</Sentence>
      <Sentence ID="702">Valeur Incorrecte</Sentence>
      <Sentence ID="802">Valeur Incorrecte</Sentence>
      <Sentence ID="703">Valeur Incorrecte</Sentence>
      <Sentence ID="803">Valeur Incorrecte</Sentence>
      <Sentence ID="704">Valeur Incorrecte</Sentence>
      <Sentence ID="804">Valeur Incorrecte</Sentence>
      <Sentence ID="503">Visibilite</Sentence>
      <Sentence ID="603">Visibilite</Sentence>
      <Sentence ID="705">Valeur Incorrecte</Sentence>
      <Sentence ID="805">Valeur Incorrecte</Sentence>
      <Sentence ID="504">Prochaine</Sentence>
      <Sentence ID="604">Prochaine</Sentence>
      <Sentence ID="505">Précédente</Sentence>
      <Sentence ID="605">Précédente</Sentence>
      <Sentence ID="506">Visibilite</Sentence>
      <Sentence ID="606">Visibilite</Sentence>
      <Sentence ID="706">Valeur Incorrecte</Sentence>
      <Sentence ID="806">Valeur Incorrecte</Sentence>
      <Sentence ID="101">Hierarchie</Sentence>
      <Sentence ID="201">Hierarchie de l'objet, ordre de chargement de l'objet par rapport aux autres</Sentence>
      <Sentence ID="301">Valeur Incorrecte, doit etre positive</Sentence>
      <Sentence ID="102">Visibilite</Sentence>
      <Sentence ID="202">Afficher ou cacher l'objet</Sentence>
      <Sentence ID="302">Valeur Incorrecte</Sentence>
      <Sentence ID="401">Invisible</Sentence>
      <Sentence ID="402">Visible</Sentence>
      <Sentence ID="103">Z-Index</Sentence>
      <Sentence ID="203">Niveau de superposition de l'objet par rapport aux autres</Sentence>
      <Sentence ID="303">Valeur Incorrecte, doit etre comprise entre 0 et 99</Sentence>
      <Sentence ID="104">Haut</Sentence>
      <Sentence ID="204">Distance depuis le bord haut de l'objet parent en pixels</Sentence>
      <Sentence ID="304">Valeur Incorrecte, doit etre positive</Sentence>
      <Sentence ID="105">Gauche</Sentence>
      <Sentence ID="205">Distance depuis le bord gauche de l'objet parent en pixels</Sentence>
      <Sentence ID="305">Valeur Incorrecte, doit etre positive</Sentence>
      <Sentence ID="106">Largeur</Sentence>
      <Sentence ID="206">Largeur de l'objet en pixels</Sentence>
      <Sentence ID="306">Valeur Incorrecte, doit etre positive</Sentence>
      <Sentence ID="107">Hauteur</Sentence>
      <Sentence ID="207">Hauteur de l'objet en pixels</Sentence>
      <Sentence ID="307">Valeur Incorrecte, doit etre positive</Sentence>
      <Sentence ID="108">WTF</Sentence>
      <Sentence ID="208">Hierarchie de l'objet, ordre de chargement de l'objet par rapport aux autres</Sentence>
      <Sentence ID="308">Valeur Incorrecte, doit etre positive</Sentence>
      <Sentence ID="109">OMG</Sentence>
      <Sentence ID="209">Alignement du texte</Sentence>
      <Sentence ID="309">Valeur Incorrecte</Sentence>
      <Sentence ID="403">month</Sentence>
      <Sentence ID="404">week</Sentence>
      <Sentence ID="405">day</Sentence>
      <Sentence ID="111">displayDate</Sentence>
      <Sentence ID="211">Alignement du texte</Sentence>
      <Sentence ID="311">Valeur Incorrecte</Sentence>
      <Sentence ID="112">firstDay</Sentence>
      <Sentence ID="212">firstDay</Sentence>
      <Sentence ID="312">week day must belong interval (0, 6)</Sentence>
      <Sentence ID="113">
			</Sentence>
      <Sentence ID="213">
			</Sentence>
      <Sentence ID="313">
			</Sentence>
      <Sentence ID="901">Gauche</Sentence>
      <Sentence ID="902">Haut</Sentence>
      <Sentence ID="903">Gauche</Sentence>
      <Sentence ID="904">Haut</Sentence>
      <Sentence ID="905">
			</Sentence>
      <Sentence ID="906">Gauche</Sentence>
      <Sentence ID="907">Haut</Sentence>
      <Sentence ID="908">
			</Sentence>
      <Sentence ID="909">
			</Sentence>
      <Sentence ID="911">
			</Sentence>
      <Sentence ID="912">
			</Sentence>
      <Sentence ID="913">Gauche</Sentence>
      <Sentence ID="914">Haut</Sentence>
      <Sentence ID="915">Gauche</Sentence>
      <Sentence ID="916">Haut</Sentence>
      <Sentence ID="917">
			</Sentence>
      <Sentence ID="918">
			</Sentence>
      <Sentence ID="919">Gauche</Sentence>
      <Sentence ID="921">Haut</Sentence>
      <Sentence ID="922">Gauche</Sentence>
      <Sentence ID="923">Haut</Sentence>
      <Sentence ID="925">
			</Sentence>
      <Sentence ID="926">
			</Sentence>
	  <Sentence ID="980">
			</Sentence>
    </Language>
  </Languages>
  <SourceCode><![CDATA[
import json
import vobject
import datetime
from dateutil.relativedelta import *
import random

class VDOM_fullcalendar(VDOM_object):
	"""daysSelect, instance"""
	VERSION = "version 08.04"
	RENDER_DIV = """<div id="%s" style="%s"></div>"""	
	RENDER_SCRIPT = """<script type="text/javascript"> 
	$(document).ready(function() {
		var t="%(time_format)s";
		var time_format="H:mm";
		if (t == 12) {
			time_format="h(:mm)p'm'";
		}
		$("#%(id_out)s").fullCalendar({
			header: {
				left: '',
				center: '',
				right: ''
			},
			timeFormat: time_format,
			eventSources: %(event_sources)s,
			eventClick: function(event) {
				var id="%(id_out)s";
				execEventBinded(id.substring(2, id.length), "eventClick", {"id":event.id});
			},
			firstDay: %(first)s,
			dayClick: function(date) {
				var id="%(id_out)s";
				var year=date.getFullYear();
				var month=date.getMonth() + 1;
				if (month < 10) {
					month = "0" + month.toString();
				}
				var day=date.getDate();
				if (day < 10){
					day = "0" + day.toString();
				}
				var hour = date.getHours();
				if (hour < 10) {
					hour = "0" + hour.toString();
				}
				var min = date.getMinutes()
				if (min < 10) {
					min = "0" + min.toString();
				}
				var to_day = year.toString() + '-' + month + '-' + day + " " + hour + ":" + min; //yy-mm-dd HH:MM
				execEventBinded(id.substring(2, id.length), "dayClick", {"day":to_day})
			},
			editable: true,
			eventDrop: function(event) {
				var id = "%(id_out)s";
				date = event.start;
				var year = date.getFullYear();
				var month = date.getMonth() + 1;
				if (month < 10) {
					month = "0" + month.toString();
				}
				var day=date.getDate();
				if (day < 10){
					day = "0" + day.toString();
				}
				var hour = date.getHours();
				if (hour < 10) {
					hour = "0" + hour.toString();
				}
				var min = date.getMinutes()
				if (min < 10) {
					min = "0" + min.toString();
				}
				event_start = year.toString() + '-' + month + '-' + day + " " + hour + ":" + min;
				
				date = event.end;
				var year = date.getFullYear();
				var month = date.getMonth() + 1;
				if (month < 10) {
					month = "0" + month.toString();
				}
				var day=date.getDate();
				if (day < 10){
					day = "0" + day.toString();
				}
				var hour = date.getHours();
				if (hour < 10) {
					hour = "0" + hour.toString();
				}
				var min = date.getMinutes()
				if (min < 10) {
					min = "0" + min.toString();
				}
				event_end = year.toString() + '-' + month + '-' + day + " " + hour + ":" + min;
				if (event.instance >= 0) {
					execEventBinded(id.substring(2, id.length), "eventDrag", {"id":event.id, "start":event_start, "end":event_end, "instance":event.instance})
				}
				else {
					execEventBinded(id.substring(2, id.length), "eventDrag", {"id":event.id, "start":event_start, "end":event_end})
				}
			},
			eventResize: function(event) {
				var id = "%(id_out)s";
				date = event.start;
				var year = date.getFullYear();
				var month = date.getMonth() + 1;
				if (month < 10) {
					month = "0" + month.toString();
				}
				var day=date.getDate();
				if (day < 10){
					day = "0" + day.toString();
				}
				var hour = date.getHours();
				if (hour < 10) {
					hour = "0" + hour.toString();
				}
				var min = date.getMinutes()
				if (min < 10) {
					min = "0" + min.toString();
				}
				event_start = year.toString() + '-' + month + '-' + day + " " + hour + ":" + min;
				
				date = event.end;
				var year = date.getFullYear();
				var month = date.getMonth() + 1;
				if (month < 10) {
					month = "0" + month.toString();
				}
				var day=date.getDate();
				if (day < 10){
					day = "0" + day.toString();
				}
				var hour = date.getHours();
				if (hour < 10) {
					hour = "0" + hour.toString();
				}
				var min = date.getMinutes()
				if (min < 10) {
					min = "0" + min.toString();
				}
				event_end = year.toString() + '-' + month + '-' + day + " " + hour + ":" + min;
				if (event.instance >= 0) {
					execEventBinded(id.substring(2, id.length), "eventDrag", {"id":event.id, "start":event_start, "end":event_end, "instance":event.instance})
				}
				else {
					execEventBinded(id.substring(2, id.length), "eventDrag", {"id":event.id, "start":event_start, "end":event_end})
				}
			},
			selectable: "true",
			select: function(startDate, endDate, allDay) {
				$("#%(id_out)s").fullCalendar('unselect');
				var id = "%(id_out)s";
				var end = endDate.getFullYear() + "-" + (endDate.getMonth() + 1) + "-"  + endDate.getDate() + " " + endDate.getHours() + ":" + endDate.getMinutes();
				var start = startDate.getFullYear() + "-" + (startDate.getMonth() + 1) + "-" + startDate.getDate() + " " + startDate.getHours() + ":" + startDate.getMinutes();
				if (start != end) {
					event = { start: startDate, end: endDate, title: "New event", allDay: allDay, id: "-1" };
					$("#%(id_out)s").fullCalendar('renderEvent', event);
					execEventBinded(id.substring(2, id.length), "daysSelect", {"id":event.id, "start":start, "end":end})
				}
			},
		});
		$("#%(id_out)s").fullCalendar("changeView", "%(current_view)s");
		$("#%(id_out)s").fullCalendar("gotoDate", new Date(parseInt(%(year)s), parseInt(%(month)s - 1), parseInt(%(day)s)));
					
	});
</script>"""

	def render(self, parent, contents=""):
		time_format = self.timeFormat
		view = {"month": "month", "week": "agendaWeek", "day": "agendaDay"}
		current_view = view[self.view]
		id_out = 'o_' + (self.id).replace('-', '_')
		year_month_day = self.displayDate.split('-') if self.displayDate else str(datetime.date.today()).split('-')
		first_day = self.firstDay if self.firstDay else 0
		style_params = {"zindex": self.zindex, 
						"top": self.top, 
						"left": self.left, 
						"width": self.width, 
						"height": self.height} 
		mainstyle="""z-index:%(zindex)s; 
					position:absolute; 
					top: %(top)spx; 
					left: %(left)spx; 
					width: %(width)spx; 
					height: %(height)spx;"""%style_params
		render_params = {"id_out": id_out,
					"first": first_day,
					"current_view": current_view, 
					"year": str(year_month_day[0]), 
					"month": year_month_day[1], 
					"day": year_month_day[2],
					"event_sources": self.parse_events(),
					"time_format": time_format
					}
		return VDOM_fullcalendar.RENDER_SCRIPT%render_params + VDOM_fullcalendar.RENDER_DIV%(id_out, mainstyle)
		
	def get_start(event):
		if hasattr(event, 'dtstart'):
			start = event.dtstart.value.strftime("%Y-%m-%d %H:%M")
		else:
			start = datetime.datetime.today().strftime("%Y-%m-%d %H:%M")
		return start
		
	def get_end(event, start):
		if hasattr(event, 'dtend'):
			end = event.dtend.value.strftime("%Y-%m-%d %H:%M")
		else:
			end = start
		return end
	
	def get_date(self, date):
		str_date = str(date)
		a = datetime.datetime.strptime(str_date, "%Y-%m-%d %H:%M")
		return a.strftime("%Y-%m-%d %H:%M")

	def parse_events(self):
		event_sources = []
		if self.events:
			calendar = vobject.readOne(self.events)
			for event in calendar.vevent_list:
				start = getattr(event, 'dtstart', vobject.base.ContentLine('DTSTART', '', str(datetime.datetime.today().strftime("%Y-%m-%d %H:%M"))))
				end = getattr(event, 'dtend', vobject.base.ContentLine('DTEND', '', start.value))
				summary = getattr(event, 'summary', vobject.base.ContentLine('SUMMARY', '', 'Event'))
				description = getattr(event, 'description', vobject.base.ContentLine('DESCRIPTION', '', 'Event'))
				color = getattr(event, 'color', vobject.base.ContentLine('COLOR','','blue'))
				id = getattr(event, 'id', vobject.base.ContentLine('ID', '', random.randint(1000000, 2000000000)))	#random id. 
																			# WARNING: if few events have the same ids 
																			#they will change simultaneously
				#raise Exception(startDate.value)
				if event.rruleset == None:
					event_sources.append({ "events": [{ "id": id.value,
										"title": summary.value, 
										"description":description.value,
										"start": start.value.strftime("%Y-%m-%d %H:%M"),
										"end": end.value.strftime("%Y-%m-%d %H:%M"),
										"allDay": True if (len(str(start.value)) == len(str(end.value)) == 10) or (start.value == end.value) else False }],
										"color": color.value})
																	#if time is not set event lasts allDay, 
																	#otherwise - from start_time to end_time
					#raise Exception(event_sources)
				else:
					i = 0
					for rev in event.rruleset:
						event_sources.append({ "events": [{
										"title": summary.value, 
										"description":description.value,
										"id": id.value,
										"start": rev.strftime("%Y-%m-%d %H:%M"),
										"end": (rev + relativedelta(end.value, start.value)).strftime("%Y-%m-%d %H:%M"),
										"instance": i,
										"allDay": True if (len(str(start.value)) == len(str(end.value)) == 10) or (start.value == end.value) else False}],
										"color": color.value})
						i += 1
		return json.dumps(event_sources)
	
		
	def wysiwyg(self, parent, contents=""):
		minsize = min(int(self.width), int(self.height))
		result=""\
			"<container id=\"%(id)s\" visible=\"%(visible)s\" zindex=\"%(zindex)s\" hierarchy=\"%(hierarchy)s\" order=\"%(order)s\" top=\"%(top)s\" left=\"%(left)s\" width=\"%(width)s\" height=\"%(height)s\">"\
				"<svg>"\
					"<rect opacity=\"0.5\" x=\"0\" y=\"0\" width=\"%(width)s\" height=\"%(height)s\" fill=\"#FFFFFF\" stroke=\"#CCCCCC\"/>"\
					"<rect opacity=\"0.5\" x=\"0\" y=\"20\" width=\"%(width)s\" height=\"%(height20)s\" fill=\"#EEEEEE\" stroke=\"#CCCCCC\"/>"\
				"</svg>"\
				"<text top=\"5\" left=\"5\" width=\"%(width)s\" color=\"#333fff\">Full Calendar</text>"\
			"</container>"% {
				"id":			self.id,
				"visible":		self.visible,
				"zindex":		self.zindex,
				"hierarchy":	self.hierarchy,
				"order":		self.order,
				"top":			self.top,
				"left":			self.left,
				"width":		str(int(self.width)-20),
				"height":		str(int(self.height)-20),
				"height20":		str(int(self.height) - 20)
				}
		return VDOM_object.wysiwyg(self, parent, contents=result)
	]]></SourceCode>
  <Libraries>
    <Library Target="HTML"><![CDATA[<link rel='stylesheet' type='text/css' href='/02dfd9db-16fe-3690-73e1-baf58cd3e6f5.res'/>]]></Library>
    <Library Target="HTML"><![CDATA[<script type='text/javascript' src='/16a5175b-61d2-cfe6-fb3e-ebc2b43a1c78.res'></script>]]></Library>
  </Libraries>
  <E2vdom>
    <Events>
      <Userinterfaceevents>
        <Event Name="click">
          <Parameters>
            <Parameter Help="#Lang(901)" Name="X" Order="" VbType="">
						</Parameter>
            <Parameter Help="#Lang(902)" Name="Y" Order="" VbType="">
						</Parameter>
          </Parameters>
        </Event>
        <Event Name="ctrlclick">
          <Parameters>
            <Parameter Help="#Lang(903)" Name="X" Order="" VbType="">
						</Parameter>
            <Parameter Help="#Lang(904)" Name="Y" Order="" VbType="">
						</Parameter>
          </Parameters>
        </Event>
        <Event Name="dayClick">
          <Parameters>
            <Parameter Help="#Lang(905)" Name="day" Order="" VbType="">
						</Parameter>
          </Parameters>
        </Event>
        <Event Name="daysSelect">
          <Parameters>
            <Parameter Help="#Lang(925)" Name="end" Order="" VbType="">
						</Parameter>
            <Parameter Help="#Lang(926)" Name="start" Order="" VbType="">
						</Parameter>
          </Parameters>
        </Event>
        <Event Name="dblclick">
          <Parameters>
            <Parameter Help="#Lang(906)" Name="X" Order="" VbType="">
						</Parameter>
            <Parameter Help="#Lang(907)" Name="Y" Order="" VbType="">
						</Parameter>
          </Parameters>
        </Event>
        <Event Name="eventClick">
          <Parameters>
            <Parameter Help="#Lang(908)" Name="id" Order="" VbType="">
						</Parameter>
          </Parameters>
        </Event>
        <Event Name="eventDrag">
          <Parameters>
            <Parameter Help="#Lang(909)" Name="id" Order="" VbType="">
						</Parameter>
            <Parameter Help="#Lang(911)" Name="start" Order="" VbType="">
						</Parameter>
            <Parameter Help="#Lang(912)" Name="end" Order="" VbType="">
						</Parameter>
			<Parameter Help="#Lang(980)" Name="instance" Order="" VbType="">
						</Parameter>
          </Parameters>
        </Event>
        <Event Name="mousedown">
          <Parameters>
            <Parameter Help="#Lang(913)" Name="X" Order="" VbType="">
						</Parameter>
            <Parameter Help="#Lang(914)" Name="Y" Order="" VbType="">
						</Parameter>
          </Parameters>
        </Event>
        <Event Name="mousemove">
          <Parameters>
            <Parameter Help="#Lang(915)" Name="X" Order="" VbType="">
						</Parameter>
            <Parameter Help="#Lang(916)" Name="Y" Order="" VbType="">
						</Parameter>
          </Parameters>
        </Event>
        <Event Name="mouseout">
          <Parameters>
            <Parameter Help="#Lang(917)" Name="X" Order="" VbType="">
						</Parameter>
            <Parameter Help="#Lang(918)" Name="Y" Order="" VbType="">
						</Parameter>
          </Parameters>
        </Event>
        <Event Name="mouseover">
          <Parameters>
            <Parameter Help="#Lang(919)" Name="X" Order="" VbType="">
						</Parameter>
            <Parameter Help="#Lang(921)" Name="Y" Order="" VbType="">
						</Parameter>
          </Parameters>
        </Event>
        <Event Name="mouseup">
          <Parameters>
            <Parameter Help="#Lang(922)" Name="X" Order="" VbType="">
						</Parameter>
            <Parameter Help="#Lang(923)" Name="Y" Order="" VbType="">
						</Parameter>
          </Parameters>
        </Event>
      </Userinterfaceevents>
    </Events>
    <Actions>
      <Container ID="2330fe83-8cd6-4ed5-907d-11874e7ebcf4">
        <Action Description="#Lang(501)" InterfaceName="#Lang(601)" MethodName="hide">
          <Parameters>
            <Parameter DefaultValue="0" Help="#Lang(801)" Interface="" InterfaceName="#Lang(701)" RegularExpressionValidation=".*" ScriptName="fade">
						</Parameter>
          </Parameters>
          <SourceCode><![CDATA[	this.domCont.style.display = 'none';]]></SourceCode>
        </Action>
        <Action Description="#Lang(502)" InterfaceName="#Lang(602)" MethodName="moveTo">
          <Parameters>
            <Parameter DefaultValue="0" Help="#Lang(802)" Interface="" InterfaceName="#Lang(702)" RegularExpressionValidation=".*" ScriptName="newX">
						</Parameter>
            <Parameter DefaultValue="0" Help="#Lang(803)" Interface="" InterfaceName="#Lang(703)" RegularExpressionValidation=".*" ScriptName="newY">
						</Parameter>
            <Parameter DefaultValue="0" Help="#Lang(804)" Interface="" InterfaceName="#Lang(704)" RegularExpressionValidation=".*" ScriptName="Effect">
						</Parameter>
          </Parameters>
          <SourceCode><![CDATA[	vdom_ui_moveTo(this.domCont, newX, newY, Effect);]]></SourceCode>
        </Action>
        <Action Description="#Lang(503)" InterfaceName="#Lang(603)" MethodName="moveZindexTo">
          <Parameters>
            <Parameter DefaultValue="0" Help="#Lang(805)" Interface="" InterfaceName="#Lang(705)" RegularExpressionValidation=".*" ScriptName="newZindex">
						</Parameter>
          </Parameters>
          <SourceCode><![CDATA[
			this.domCont.style.zindex = parseInt(newZindex);
					]]></SourceCode>
        </Action>
        <Action Description="#Lang(504)" InterfaceName="#Lang(604)" MethodName="next">
          <Parameters>
					</Parameters>
          <SourceCode><![CDATA[
			var id = this.domCont.id;
			$id.fullCalendar('next');
			]]></SourceCode>
        </Action>
        <Action Description="#Lang(505)" InterfaceName="#Lang(605)" MethodName="prev">
          <Parameters>
					</Parameters>
          <SourceCode><![CDATA[
]]>
					</SourceCode>
        </Action>
        <Action Description="#Lang(506)" InterfaceName="#Lang(606)" MethodName="show">
          <Parameters>
            <Parameter DefaultValue="0" Help="#Lang(806)" Interface="" InterfaceName="#Lang(706)" RegularExpressionValidation=".*" ScriptName="fade">
						</Parameter>
          </Parameters>
          <SourceCode><![CDATA[
this.domCont.style.display = 'block';
					]]></SourceCode>
        </Action>
      </Container>
    </Actions>
  </E2vdom>

</Type>